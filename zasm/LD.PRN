			  Z80 ASSEMBLER - ZASM VER 1.6
                      	;	LSX-Dodgers for X1/turbo/Z
                      	;	Programmed by
                      	;	Gaku (Lovers/Tablacus)
                      	
  C600                	RUN	EQU	0C600h
                      	
  C5F9                		ORG	RUN-7
                      	
                      	;	MSX BINARY HEADER
  C5F9  FE            		DB	0FEH
                      	;	MSX BINARY START ADDRESS
  C5FA  00C6          		DW	RUN
                      	;	MSX BINARY END ADDRESS
  C5FC  E0ED          		DW	LDEND
                      	;	MSX BINARY EXEC ADDRESS
  C5FE  00C6          		DW	RUN
                      	;LDDEF.ASM
                      	
                      	;	LSX-Dodgers DEF
                      	
  1D80                	MAC	EQU	01D80H		;X1
  0001                	VER_1   EQU 1
  0002                	VER_2   EQU 2
  0009                	VER_3   EQU 9
  0129                	VER	EQU	VER_1 * 256 + VER_2 * 16 + VER_3
                      	
  0000                	STACK	EQU	00000H
  0005                	SYSTEM	EQU	00005H
  000F                	JP_HL	EQU	0000FH
  005C                	FCB1	EQU	0005CH
  006C                	FCB2	EQU	0006CH
  0080                	DTA1	EQU	00080H
  00DB                	FDRV	EQU	00100H-37
  00DC                	FNAME	EQU	FDRV+1
  00D6                	DECBF	EQU	FDRV-5
  EE00                	FATBF	EQU	0EE00H
  FA00                	DTBUF	EQU	0FA00H
  FE00                	KEYBF	EQU	0FE00H
  FF00                	KBUF	EQU	0FF00H
  FF51                	DTA	EQU	KBUF+81
  FFD4                	EXTSP	EQU	0FFD4H
  0018                	LINE	EQU	24
                      	
                      	;LDINIT.ASM
                      	
                      	;	LSX-Dodgers INIT
                      	
  C600  C307C6        		JP	START
  C603  801D          	MACHINE:DW	MAC
  C605  2901          	VERSION:DW	VER
                      	
  C607                	START:
  C607  F3            		DI
  C608  ED5E          		IM	2
  C60A  310000        		LD	SP,STACK
  C60D  3E1E          		LD	A,01EH
  C60F  D300          		OUT	(0),A
                      	
  C611  010000        		LD	BC,0
  C614  ED438CEC      		LD	(_CTC),BC
  C618  01040A        		LD	BC,00A04H
  C61B  CD60C9        		CALL	CHKCTC
  C61E  010407        		LD	BC,00704H
  C621  CD60C9        		CALL	CHKCTC
  C624  01A81F        		LD	BC,01FA8H
  C627  CD60C9        		CALL	CHKCTC
  C62A  01A01F        		LD	BC,01FA0H
  C62D  CD60C9        		CALL	CHKCTC
                      	;
  C630                	INISIO:
  C630  01911F        		LD	BC,01F91H	;INIT SIO
  C633  1601          		LD	D,1
  C635  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C637  ED71          		DB	0EDH,071H
  C639  0E93          		LD	C,093H
  C63B  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C63D  ED71          		DB	0EDH,071H
  C63F  0E99          		LD	C,099H		;INIT SIO
  C641  1601          		LD	D,1
  C643  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C645  ED71          		DB	0EDH,071H
  C647  0E9B          		LD	C,09BH
  C649  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C64B  ED71          		DB	0EDH,071H
                      	
  C64D  0E80          		LD	C,080H		;INIT DMA
  C64F  2106C3        		LD	HL,0C306H
  C652                	INIDMA:
  C652  ED61          		OUT	(C),H
  C654  2D            		DEC	L
  C655  20FB          		JR	NZ,INIDMA
                      	
  C657  3EE4          		LD	A,0E4H
  C659  CD53DB        		CALL	COMOUT
  C65C  AF            		XOR	A
  C65D  CD2DDB        		CALL	OT49SB
                      	
  C660  3EEC          		LD	A,INTVEC/256
  C662  ED47          		LD	I,A
                      	
  C664  ED4B8CEC      		LD	BC,(_CTC)
  C668  0B            		DEC	BC
  C669  0B            		DEC	BC
                      	
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C66A  ED71          		DB	0EDH,071H
  C66C  3EC0          		LD	A,CTC0
  C66E  ED79          		OUT	(C),A
                      	
  C670  0C            		INC	C
  C671  3E47          		LD	A,047H
  C673  ED79          		OUT	(C),A
  C675  3E0D          		LD	A,13		;Baudrate 9600-13
  C677  ED79          		OUT	(C),A
                      	
  C679  79            		LD	A,C
  C67A  D610          		SUB	010H
  C67C  4F            		LD	C,A
  C67D  ED43B6D7      		LD	(SIOAD+1),BC
  C681  ED43DFD7      		LD	(SIOAD0+1),BC
  C685  ED43E5D7      		LD	(SIOAD1+1),BC
                      	
  C689  2108CA        		LD	HL,SIODATA
  C68C                	SINIT1:
  C68C  7E            		LD	A,(HL)
  C68D  23            		INC	HL
  C68E  FEFF          		CP	0FFH
  C690  2804          		JR	Z,SINIT2
  C692  ED79          		OUT	(C),A
  C694  18F6          		JR	SINIT1
  C696                	SINIT2:
  C696  3EE4          		LD	A,0E4H
  C698  CD53DB        		CALL	COMOUT
  C69B  3EC8          		LD	A,INTVEC
  C69D  CD2DDB        		CALL	OT49SB
                      	;
  C6A0  01C41F        		LD	BC,01FC4H
  C6A3  3E0C          		LD	A,00CH
  C6A5  ED79          		OUT	(C),A
                      	
  C6A7  0EC0          		LD	C,0C0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6A9  ED71          		DB	0EDH,071H
                      	
  C6AB  0C            		INC	C
  C6AC  3E28          		LD	A,40
  C6AE  ED79          		OUT	(C),A
                      	
  C6B0  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B1  ED71          		DB	0EDH,071H
                      	
  C6B3  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B4  ED71          		DB	0EDH,071H
                      	
  C6B6  0EC5          		LD	C,0C5H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B8  ED71          		DB	0EDH,071H
                      	
  C6BA                	TEXT:
  C6BA  0EB0          		LD	C,0B0H
  C6BC  3E80          		LD	A,080H
  C6BE  ED79          		OUT	(C),A
  C6C0  1607          		LD	D,7
  C6C2  0EB9          		LD	C,0B9H
  C6C4  2101CA        		LD	HL,TEXTDT
  C6C7                	TEXT1:
  C6C7  04            		INC	B
  C6C8  EDA3          		OUTI
  C6CA  0C            		INC	C
  C6CB  15            		DEC	D
  C6CC  20F9          		JR	NZ,TEXT1
  C6CE  01B01F        		LD	BC,01FB0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D1  ED71          		DB	0EDH,071H
                      	
  C6D3  0EC4          		LD	C,0C4H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D5  ED71          		DB	0EDH,071H
                      	
  C6D7  01011A        		LD	BC,01A01H
  C6DA  ED78          		IN	A,(C)
  C6DC  E608          		AND	8
  C6DE  2809          		JR	Z,PRN
  C6E0  0E03          		LD	C,003H
  C6E2  3E0F          		LD	A,00FH
  C6E4  ED79          		OUT	(C),A
  C6E6  01040A        		LD	BC,00A04H
  C6E9                	PRN:
  C6E9  110100        		LD	DE,1
  C6EC  62            		LD	H,D
  C6ED  6A            		LD	L,D
  C6EE  017F00        		LD	BC,07FH
  C6F1  36FF          		LD	(HL),0FFH
  C6F3  EDB0          		LDIR
  C6F5  017F00        		LD	BC,07FH
  C6F8  3600          		LD	(HL),0
  C6FA  EDB0          		LDIR
                      	
  C6FC  3EC3          		LD	A,0C3H		;JP
  C6FE  21EEDA        		LD	HL,WBOOT
  C701  320000        		LD	(00000H),A
  C704  220100        		LD	(00001H),HL	;IPL
                      	
  C707  2A03C6        		LD	HL,(MACHINE)	;3 bit7  DPB Original(1)
  C70A  220300        		LD	(00003H),HL	;  bit6-0 Machine X1(0)
                      	;				;4 LSX-Dodgers(01DH)
  C70D  2106CC        		LD	HL,BDOS
  C710  320500        		LD	(00005H),A
  C713  220600        		LD	(00006H),HL	;BDOS
                      	
  C716  216FD6        		LD	HL,BIOS
  C719  321800        		LD	(00018H),A	;BIOS-ROM
  C71C  221900        		LD	(00019H),HL
                      	
  C71F  210000        		LD	HL,0
  C722  323800        		LD	(00038H),A	;RST038H
  C725  223900        		LD	(00039H),HL
                      	
  C728  3EEC          		LD	A,STABLE/256
  C72A  320B00        		LD	(0000BH),A
                      	
  C72D  3EE9          		LD	A,0E9H		;JP (HL)
  C72F  320F00        		LD	(0000FH),A
                      	
  C732  3A7DEC        		LD	A,(_FATBF+1)
  C735  321300        		LD	(00013H),A
                      	
  C738  3A7FEC        		LD	A,(_DTBUF+1)
  C73B  321700        		LD	(00017H),A
                      	
  C73E  3EFE          		LD	A,KEYBF/256
  C740  321B00        		LD	(0001BH),A
                      	
  C743  3EFF          		LD	A,KBUF/256
  C745  321F00        		LD	(0001FH),A
                      	
  C748  2A05C6        		LD	HL,(VERSION)
  C74B  225A00        		LD	(0005AH),HL
                      	
  C74E  3EE6          		LD	A,0E6H
  C750  CD53DB        		CALL	COMOUT
  C753  CD38DB        		CALL	IN49SB
  C756  F5            		PUSH	AF
  C757  CD38DB        		CALL	IN49SB
  C75A  F1            		POP	AF
  C75B  F5            		PUSH	AF
  C75C  E612          		AND	012H
  C75E  2005          		JR	NZ,KEYR
  C760  3E01          		LD	A,1
  C762  32BDC8        		LD	(KEYREP+1),A
  C765                	KEYR:
  C765  F1            		POP	AF
  C766  E603          		AND	3
  C768  280E          		JR	Z,NON
                      	
  C76A  01D03F        		LD	BC,03FD0H
  C76D  ED49          		OUT	(C),C
  C76F  3E37          		LD	A,037H
  C771  D3D0          		OUT	(0D0H),A
  C773  ED78          		IN	A,(C)
  C775  B9            		CP	C
  C776  2861          		JR	Z,TURBO
  C778                	NON:
  C778  3D            		DEC	A		;A=0FFH
  C779  321800        		LD	(00018H),A	;BIOS-ROM
                      	
  C77C  2114CA        		LD	HL,AT_SCR1
  C77F  11DDDB        		LD	DE,SCR1
                      	;	LD	BC,SCRNX-SCR1	;転送先のサイズ確認用
  C782  019F00        		LD	BC,AT_SCRE-AT_SCR1
  C785  EDB0          		LDIR
                      	
  C787  21B3CA        		LD	HL,AT_WTTRK
  C78A  1149EB        		LD	DE,WTTRK
                      	;	LD	BC,DMAE-WTTRK	;転送先のサイズ確認用
  C78D  019B00        		LD	BC,AT_CPUE-AT_WTTRK
  C790  EDB0          		LDIR
                      	
  C792  214ECB        		LD	HL,AT_EDWTC
  C795  11DACC        		LD	DE,EDWTC
                      	;	LD	BC,EMME-EDWTC	;転送先のサイズ確認用
  C798  014300        		LD	BC,AT_EMME-AT_EDWTC
  C79B  EDB0          		LDIR
                      	
  C79D  219DEB        		LD	HL,AT_DRD+AT_R
  C7A0  22ECEC        		LD	(_FDRD+1),HL
  C7A3  214DEB        		LD	HL,AT_DWT+AT_R
  C7A6  22EFEC        		LD	(_FDWT+1),HL
  C7A9  21EECC        		LD	HL,AT_EDRDC+AT_RE
  C7AC  2282ED        		LD	(EMMRD),HL
  C7AF  21DACC        		LD	HL,AT_EDWTC+AT_RE
  C7B2  2284ED        		LD	(EMMWR),HL
                      	
  C7B5  210000        		LD	HL,0
  C7B8  227EDB        		LD	(X1PAT),HL
                      	
  C7BB  3EAF          		LD	A,0AFH		;XOR	A
  C7BD  327DD9        		LD	(X1KPAT),A
                      	
  C7C0  217CDC        		LD	HL,SCRNX
  C7C3  22D1EC        		LD	(_SCRN+1),HL
                      	
  C7C6  CD87C9        		CALL	SETCRTC
  C7C9  0610          		LD	B,010H		;PALET
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CB  ED71          		DB	0EDH,071H
  C7CD  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CE  ED71          		DB	0EDH,071H
  C7D0  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7D1  ED71          		DB	0EDH,071H
  C7D3  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7D4  ED71          		DB	0EDH,071H
  C7D6  C379C8        		JP	NOBANK
                      	
  C7D9                	TURBO:
  C7D9  F3            		DI			;Check BIOS
  C7DA  061D          		LD	B,01DH
  C7DC  ED79          		OUT	(C),A		;BIOS ON
  C7DE  3A512F        		LD	A,(02F51H)
  C7E1  04            		INC	B		;B=01EH
  C7E2  ED79          		OUT	(C),A		;BIOS OFF
  C7E4  FB            		EI
  C7E5  FEC9          		CP	0C9H
  C7E7  280B          		JR	Z,BIOSOK
  C7E9  3EAF          		LD	A,0AFH		;XOR	A
  C7EB  327DD9        		LD	(X1KPAT),A
  C7EE  217CDC        		LD	HL,SCRNX
  C7F1  22D1EC        		LD	(_SCRN+1),HL
  C7F4                	BIOSOK:
  C7F4  3E1F          		LD	A,01FH
  C7F6  DBF0          		IN	A,(0F0H)
  C7F8  0F            		RRCA
  C7F9  380B          		JR	C,CRT1
  C7FB  21F1C9        		LD	HL,_C8025H
  C7FE  11B0EC        		LD	DE,CRTCD
  C801  011000        		LD	BC,16
  C804  EDB0          		LDIR
  C806                	CRT1:
  C806  CD87C9        		CALL	SETCRTC
  C809  01AA10        		LD	BC,010AAH	;PALET
  C80C  ED49          		OUT	(C),C
  C80E  01CC11        		LD	BC,011CCH
  C811  ED49          		OUT	(C),C
  C813  01F012        		LD	BC,012F0H
  C816  ED49          		OUT	(C),C
  C818  04            		INC	B
  C819  ED71          		DB	0EDH,071H
                      	
  C81B  3E1F          		LD	A,01FH
  C81D  DBF0          		IN	A,(0F0H)
  C81F  CB57          		BIT	2,A
  C821  2825          		JR	Z,BANK
                      	
  C823  AF            		XOR	A
  C824                	TZ1:
  C824  F5            		PUSH	AF
  C825  CDDCEC        		CALL	_GETDPB
  C828  DD7E12        		LD	A,(IX+012H)
  C82B  FE87          		CP	087H
  C82D  2013          		JR	NZ,TZ2
  C82F  DDE5          		PUSH	IX
  C831  D1            		POP	DE
  C832  211CEA        		LD	HL,M2HD
  C835  EDA0          		LDI
  C837  EDA0          		LDI
  C839  13            		INC	DE
  C83A  13            		INC	DE
  C83B  13            		INC	DE
  C83C  13            		INC	DE
  C83D  010C00        		LD	BC,12
  C840  EDB0          		LDIR
  C842                	TZ2:
  C842  F1            		POP	AF
  C843  3C            		INC	A
  C844  FE08          		CP	8
  C846  38DC          		JR	C,TZ1
                      	
  C848                	BANK:
  C848  01000B        		LD	BC,00B00H
  C84B  21007F        		LD	HL,07F00H
  C84E  F3            		DI
  C84F                	BANK1:
  C84F  ED69          		OUT	(C),L
  C851  5E            		LD	E,(HL)
  C852  7B            		LD	A,E
  C853  C6A5          		ADD	A,0A5H
  C855  77            		LD	(HL),A
  C856  BE            		CP	(HL)
  C857  73            		LD	(HL),E
  C858  2005          		JR	NZ,BANK2
  C85A  2C            		INC	L
  C85B  CB65          		BIT	4,L
  C85D  28F0          		JR	Z,BANK1
  C85F                	BANK2:
  C85F  3E10          		LD	A,010H
  C861  ED79          		OUT	(C),A
  C863  7D            		LD	A,L
  C864  B7            		OR	A
  C865  2812          		JR	Z,NOBANK
  C867  2600          		LD	H,0
  C869  29            		ADD	HL,HL
  C86A  29            		ADD	HL,HL
  C86B  29            		ADD	HL,HL
  C86C  29            		ADD	HL,HL
  C86D  29            		ADD	HL,HL
  C86E  2B            		DEC	HL
  C86F  2B            		DEC	HL
  C870  2B            		DEC	HL
  C871  22A8ED        		LD	(BANKCL),HL
  C874  3E01          		LD	A,1
  C876  32A0ED        		LD	(BANKFL),A
  C879                	NOBANK:
  C879                	EMM:
  C879  CD50C9        		CALL	EADR0
  C87C  ED78          		IN	A,(C)
  C87E  F5            		PUSH	AF
                      	
  C87F  110000        		LD	DE,0
  C882                	ECHECK1:
  C882  13            		INC	DE
  C883  CD33C9        		CALL	EADR2
  C886  ED60          		IN	H,(C)
  C888  CD33C9        		CALL	EADR2
  C88B  7C            		LD	A,H
  C88C  C6E5          		ADD	A,0E5H
  C88E  ED79          		OUT	(C),A
  C890  3C            		INC	A
  C891  CD50C9        		CALL	EADR0
  C894  ED79          		OUT	(C),A
  C896  3D            		DEC	A
  C897  CD33C9        		CALL	EADR2
  C89A  ED68          		IN	L,(C)
  C89C  CD33C9        		CALL	EADR2
  C89F  ED61          		OUT	(C),H
  C8A1  BD            		CP	L
  C8A2  2004          		JR	NZ,ECHECK2
  C8A4  CB5A          		BIT	3,D
  C8A6  28DA          		JR	Z,ECHECK1
  C8A8                	ECHECK2:
  C8A8  CD50C9        		CALL	EADR0
  C8AB  F1            		POP	AF
  C8AC  ED79          		OUT	(C),A
                      	
  C8AE  21F7FF        		LD	HL,0-9
  C8B1  19            		ADD	HL,DE
  C8B2  3008          		JR	NC,NOEMM
  C8B4  2288ED        		LD	(EMMCL),HL
  C8B7  3E03          		LD	A,3
  C8B9  3280ED        		LD	(EMMFL),A
  C8BC                	NOEMM:
  C8BC  3E00          	KEYREP:	LD	A,000H
  C8BE  B7            		OR	A
  C8BF  2807          		JR	Z,KEYR1
  C8C1  010000        		LD	BC,0
  C8C4  ED438CEC      		LD	(_CTC),BC
  C8C8                	KEYR1:
  C8C8  0130F8        		LD	BC,0-80*25
  C8CB  2ABAEC        		LD	HL,(CRTCD+10)
  C8CE  ED43BAEC      		LD	(CRTCD+10),BC
  C8D2  1E0C          		LD	E,00CH
  C8D4  CDCDEC        		CALL	_PRINT
  C8D7  22BAEC        		LD	(CRTCD+10),HL
                      	
  C8DA  21B2C9        		LD	HL,INIMES
  C8DD  CDF0D8        		CALL	MSX
                      	
  C8E0  3A87FF        		LD	A,(0FF87H)
  C8E3  FE08          		CP	8
  C8E5  301E          		JR	NC,INIT0
  C8E7  5F            		LD	E,A
  C8E8  C641          		ADD	A,'A'
  C8EA  32AFC9        		LD	(AUTODV),A
  C8ED  0E0E          		LD	C,00EH
  C8EF  CD0500        		CALL	SYSTEM
  C8F2  1C            		INC	E
  C8F3  2185EC        		LD	HL,_SEEKSP	;Disk error Ignore
  C8F6  CBFE          		SET	7,(HL)
  C8F8  0E1B          		LD	C,01BH
  C8FA  CD0500        		CALL	SYSTEM
                      	
  C8FD  2185EC        		LD	HL,_SEEKSP
  C900  CBBE          		RES	7,(HL)
                      	
  C902  3C            		INC	A
  C903  2008          		JR	NZ,INIT1
  C905                	INIT0:
  C905  1E00          		LD	E,0
  C907  0E0E          		LD	C,00EH
  C909  CD0500        		CALL	SYSTEM
  C90C  AF            		XOR	A
  C90D                	INIT1:
  C90D  2100FF        		LD	HL,0FF00H
  C910  1101FF        		LD	DE,0FF01H
  C913  01FF00        		LD	BC,000FFH
  C916  75            		LD	(HL),L
  C917  EDB0          		LDIR
                      	
  C919  210000        		LD	HL,0
  C91C  E5            		PUSH	HL
  C91D  B7            		OR	A
  C91E  C8            		RET	Z
                      	
  C91F  3EE6          		LD	A,0E6H
  C921  CD53DB        		CALL	COMOUT
  C924  CD38DB        		CALL	IN49SB
  C927  CD38DB        		CALL	IN49SB
  C92A  FE1B          		CP	01BH
  C92C  C8            		RET	Z
  C92D  11A6C9        		LD	DE,AUTOD
  C930  C3FDEC        		JP	_COMANL
                      	
  C933                	EADR2:
  C933  D5            		PUSH	DE
  C934  EB            		EX	DE,HL
  C935  29            		ADD	HL,HL
  C936  29            		ADD	HL,HL
  C937  ED4B8BED      		LD	BC,(EMMBL-1)
  C93B  0E00          		LD	C,0
  C93D  09            		ADD	HL,BC
  C93E  ED4B93ED      		LD	BC,(EMMDV)
  C942  060D          		LD	B,00DH
  C944  ED49          		OUT	(C),C
  C946  0C            		INC	C
  C947  ED69          		OUT	(C),L
  C949  0C            		INC	C
  C94A  ED61          		OUT	(C),H
  C94C  0C            		INC	C
  C94D  EB            		EX	DE,HL
  C94E  D1            		POP	DE
  C94F  C9            		RET
                      	
  C950                	EADR0:
  C950  ED4B93ED      		LD	BC,(EMMDV)
  C954  060D          		LD	B,00DH
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C956  ED71          		DB	0EDH,071H
  C958  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C959  ED71          		DB	0EDH,071H
  C95B  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C95C  ED71          		DB	0EDH,071H
  C95E  0C            		INC	C
  C95F  C9            		RET
                      	
  C960                	CHKCTC:
  C960  C5            		PUSH	BC
  C961  110347        		LD	DE,04703H
  C964                	INICTC1:
  C964  0C            		INC	C
  C965  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C967  ED71          		DB	0EDH,071H
  C969  1D            		DEC	E
  C96A  20F8          		JR	NZ,INICTC1
  C96C  C1            		POP	BC
                      	
  C96D  11FA07        		LD	DE,007FAH
  C970  ED51          		OUT	(C),D
  C972  ED59          		OUT	(C),E
  C974  ED78          		IN	A,(C)
  C976  BB            		CP	E
  C977  C0            		RET	NZ
  C978  ED51          		OUT	(C),D
  C97A  ED51          		OUT	(C),D
  C97C  ED78          		IN	A,(C)
  C97E  BA            		CP	D
  C97F  C0            		RET	NZ
  C980  03            		INC	BC
  C981  03            		INC	BC
  C982  ED438CEC      		LD	(_CTC),BC
  C986  C9            		RET
                      	
  C987                	SETCRTC:
  C987  21B0EC        		LD	HL,CRTCD
  C98A  AF            		XOR	A
  C98B                	SETCRT1:
  C98B  010018        		LD	BC,01800H
  C98E  ED79          		OUT	(C),A
  C990  0C            		INC	C
  C991  04            		INC	B
  C992  EDA3          		OUTI
  C994  3C            		INC	A
  C995  FE0C          		CP	12
  C997  20F2          		JR	NZ,SETCRT1
  C999  23            		INC	HL
  C99A  23            		INC	HL
  C99B  01031B        		LD	BC,01A03H+00100H
  C99E  EDA3          		OUTI
  C9A0  01D020        		LD	BC,01FD0H+00100H
  C9A3  EDA3          		OUTI
  C9A5  C9            		RET
                      	
  C9A6  4155544F455845	AUTOD:	DB	"AUTOEXEC "
  C9AF  413A00        	AUTODV:	DB	"A:",0
                      	
  C9B2  4C53582D446F64	INIMES:	DB	"LSX-Dodgers for X1/turbo version "
  C9D3  312E          		DB	030H + VER_1, '.'
  C9D5  3239          		DB	030H + VER_2 ,030H + VER_3
  C9D7  2047616B752028		DB	' Gaku (Lovers/Tablacus)',0DH,0AH
  C9F0  00            		DB	0
                      	
  C9F1                	_C8025H:
  C9F1  6B5059881B0119		DB	06BH,050H,059H,088H,01BH,001H,019H,01AH
  C9F9  000F          		DB	000H,00FH
  C9FB  80F8B0FF      		DW	0-80*LINE,0-80
  C9FF  0CA3          		DB	00CH,0A3H
                      	
  CA01  030C0F30333C3F	TEXTDT:	DB	003H,00CH,00FH,030H,033H,03CH,03FH
                      	
  CA08                	SIODATA:
  CA08  18            		DB	018H
  CA09  0100          		DB	1,0
  CA0B  0200          		DB	2,0
  CA0D  03C1          		DB	3,0C1H
  CA0F  0444          		DB	4,044H
  CA11  05E8          		DB	5,0E8H
  CA13  FF            		DB	0FFH
                      	
                      	;	ノンターボ用パッチ
                      	
  CA14                	AT_SCR1:
  CA14  D9            		EXX
  CA15  C5            		PUSH	BC
  CA16  015020        		LD	BC,02000H+80
  CA19  D9            		EXX
  CA1A  C5            		PUSH	BC
  CA1B  010020        		LD	BC,02000H
                      	
  CA1E  67            		LD	H,A
  CA1F  B7            		OR	A
  CA20                	AT_SCRUP1:
  CA20  2815          		JR	Z,AT_SCRCL
  CA22  C5            		PUSH	BC
  CA23  CBE0          		SET	4,B
  CA25  D9            		EXX
  CA26  C5            		PUSH	BC
  CA27  CBE0          		SET	4,B
  CA29  D9            		EXX
  CA2A  CD17DC        		CALL	AT_UPSUB+AT_RS
  CA2D  D9            		EXX
  CA2E  C1            		POP	BC
  CA2F  D9            		EXX
  CA30  C1            		POP	BC
  CA31  CD17DC        		CALL	AT_UPSUB+AT_RS
  CA34  25            		DEC	H
  CA35  18E9          		JR	AT_SCRUP1
                      	
  CA37                	AT_SCRCL:
  CA37  215020        		LD	HL,02000H+80
  CA3A  3A96EC        		LD	A,(_COLORF)
  CA3D                	AT_SCRCL1:
  CA3D  CBE0          		SET	4,B
  CA3F  ED61          		OUT	(C),H
  CA41  CBA0          		RES	4,B
  CA43  ED79          		OUT	(C),A
  CA45  03            		INC	BC
  CA46  2D            		DEC	L
  CA47  20F4          		JR	NZ,AT_SCRCL1
  CA49  C1            		POP	BC
  CA4A  D9            		EXX
  CA4B  C1            		POP	BC
  CA4C  D9            		EXX
  CA4D  C9            		RET
                      	
  CA4E                	AT_UPSUB:
  CA4E  2E28          		LD	L,40
  CA50                	AT_UPSUB1:
  CA50  D9            		EXX
  CA51  ED78          		IN	A,(C)
  CA53  03            		INC	BC
  CA54  D9            		EXX
  CA55  ED79          		OUT	(C),A
  CA57  03            		INC	BC
  CA58  D9            		EXX
  CA59  ED78          		IN	A,(C)
  CA5B  03            		INC	BC
  CA5C  D9            		EXX
  CA5D  ED79          		OUT	(C),A
  CA5F  03            		INC	BC
  CA60  2D            		DEC	L
  CA61  20ED          		JR	NZ,AT_UPSUB1
  CA63  C9            		RET
                      	
                      	;	FLOPPY DISK DRIVER(CPU)
                      	
  CA64                	DISKC:
  CA64  1B            		DEC	DE
  CA65  CB5F          		BIT	3,A
  CA67  C418EB        		CALL	NZ,RNF
  CA6A                	DISKD:
  CA6A  E5            		PUSH	HL
  CA6B  2148EB        		LD	HL,RETRY
  CA6E  35            		DEC	(HL)
  CA6F  E1            		POP	HL
  CA70  203E          		JR	NZ,AT_ERR		;Retry
  CA72  B7            		OR	A
  CA73  283B          		JR	Z,AT_ERR		;Error
                      	
  CA75                	AT_DELP:
  CA75  CD18EB        		CALL	RNF
  CA78  CDF4EA        		CALL	FDMOFF
  CA7B  3A85EC        		LD	A,(_SEEKSP)
  CA7E  87            		ADD	A,A
  CA7F  382E          		JR	C,AT_ERRZ
  CA81                	AT_DELP1:
  CA81  D5            		PUSH	DE
  CA82  211EEB        		LD	HL,DEMES
  CA85  CDF0D8        		CALL	MSX
  CA88  CD6ED7        		CALL	KEYBC
  CA8B                	AT_DELP2:
  CA8B  CDCAEC        		CALL	_INKEY
  CA8E  28FB          		JR	Z,AT_DELP2
                      	
  CA90  D1            		POP	DE
  CA91  CD65E0        		CALL	CAP
  CA94  FE52          		CP	'R'
  CA96  200A          		JR	NZ,AT_DELP3
  CA98  210000        	DHLPAT:	LD	HL,0
  CA9B  3E02          		LD	A,2
  CA9D  3248EB        		LD	(RETRY),A
  CAA0  B7            		OR	A
  CAA1  C9            		RET
  CAA2                	AT_DELP3:
  CAA2  FE49          		CP	'I'
  CAA4  2807          		JR	Z,AT_IGNORE
  CAA6  FE41          		CP	'A'
  CAA8  20D7          		JR	NZ,AT_DELP1
  CAAA  C3EBDA        		JP	BOOT
  CAAD                	AT_IGNORE:
  CAAD  3EFF          		LD	A,0FFH
  CAAF                	AT_ERRZ:
  CAAF  BF            		CP	A
  CAB0                	AT_ERR:
  CAB0  3EFF          		LD	A,0FFH
  CAB2  C9            		RET
                      	
  CAB3                	AT_SCRE:
                      	
  CAB3                	AT_WTTRK:
  CAB3  3EF0          		LD	A,0F0H
  CAB5  1802          		JR	AT_WTTRK1
                      	
  CAB7                	AT_DWT:
  CAB7  3EA0          		LD	A,0A0H
  CAB9                	AT_WTTRK1:
  CAB9  32BCEA        		LD	(FDCPAT+1),A
                      	
  CABC  3E02          		LD	A,2		;Retry count
  CABE  3248EB        		LD	(RETRY),A
                      	
  CAC1                	DWT0:
  CAC1  D5            		PUSH	DE
  CAC2  E5            		PUSH	HL
  CAC3  2262DC        		LD	(DHLPAT+1+AT_RS),HL
  CAC6  CD55EA        		CALL	SEEK		;Write disk
  CAC9  E1            		POP	HL
  CACA  3831          		JR	C,ERRDW
  CACC  F3            		DI
  CACD  3ABCEA        		LD	A,(FDCPAT+1)
  CAD0  CD00EB        		CALL	SECSET
  CAD3  0EFB          		LD	C,0FBH
                      	
  CAD5                	DWT1:
  CAD5  56            		LD	D,(HL)
  CAD6                	DWT2:
  CAD6  78            		LD	A,B
  CAD7  DBF8          		IN	A,(0F8H)
  CAD9  0F            		RRCA
  CADA  3008          		JR	NC,DWT4
  CADC  0F            		RRCA
  CADD  30F7          		JR	NC,DWT2
  CADF                	DWT3:
  CADF  ED51          		OUT	(C),D
  CAE1  23            		INC	HL
  CAE2  18F1          		JR	DWT1
                      	
  CAE4                	DWT4:
  CAE4  3D            		DEC	A
  CAE5  28F8          		JR	Z,DWT3
  CAE7  3C            		INC	A
  CAE8  FB            		EI
  CAE9  D1            		POP	DE
  CAEA  13            		INC	DE
  CAEB  CDF4EA        		CALL	FDMOFF
  CAEE  C8            		RET	Z
  CAEF  CD2DDC        		CALL	DISKC+AT_RS
  CAF2  20CD          		JR	NZ,DWT0
  CAF4  B7            		OR	A
  CAF5  C8            		RET	Z
  CAF6                	ERRW:
  CAF6  3EFF          		LD	A,0FFH
  CAF8                	ERRZ:
  CAF8  BF            		CP	A
  CAF9  37            		SCF
  CAFA  C3F4EA        		JP	FDMOFF
                      	
  CAFD                	ERRDW:
  CAFD  D1            		POP	DE
  CAFE  CD3EDC        		CALL	AT_DELP+AT_RS
  CB01  20BE          		JR	NZ,DWT0
  CB03  B7            		OR	A
  CB04  20F0          		JR	NZ,ERRW
  CB06  C9            		RET
                      	
  CB07                	AT_DRD:
  CB07  3E80          		LD	A,080H
  CB09  32BCEA        		LD	(FDCPAT+1),A
                      	
  CB0C  3E02          		LD	A,2		;Retry count
  CB0E  3248EB        		LD	(RETRY),A
                      	
  CB11                	DRD0:
  CB11  D5            		PUSH	DE
  CB12  E5            		PUSH	HL
  CB13  2262DC        		LD	(DHLPAT+1+AT_RS),HL
  CB16  CD55EA        		CALL	SEEK		;Read disk
  CB19  E1            		POP	HL
  CB1A  3828          		JR	C,ERRDR
  CB1C  F3            		DI
  CB1D  3ABCEA        		LD	A,(FDCPAT+1)
  CB20  CD00EB        		CALL	SECSET
  CB23  0EFB          		LD	C,0FBH
  CB25                	DRD1:
  CB25  78            		LD	A,B
  CB26  DBF8          		IN	A,(0F8H)
  CB28  0F            		RRCA
  CB29  3008          		JR	NC,DRD3
  CB2B  0F            		RRCA
  CB2C  30F7          		JR	NC,DRD1
  CB2E  EDA2          		INI
  CB30  04            		INC	B
  CB31  18F2          		JR	DRD1
                      	
  CB33                	DRD3:
  CB33  B7            		OR	A
  CB34  FB            		EI
  CB35  D1            		POP	DE
  CB36  13            		INC	DE
  CB37  CDF4EA        		CALL	FDMOFF
  CB3A  C8            		RET	Z
  CB3B  CD2DDC        		CALL	DISKC+AT_RS
  CB3E  20D1          		JR	NZ,DRD0
  CB40  B7            		OR	A
  CB41  20B3          		JR	NZ,ERRW
  CB43  C9            		RET
                      	
  CB44                	ERRDR:
  CB44  D1            		POP	DE
  CB45  CD3EDC        		CALL	AT_DELP+AT_RS
  CB48  20C7          		JR	NZ,DRD0
  CB4A  B7            		OR	A
  CB4B  20A9          		JR	NZ,ERRW
  CB4D  C9            		RET
                      	
  CB4E                	AT_CPUE:
                      	
                      	
                      	;	EMM DRIVER(CPU)
                      	
                      	
  CB4E                	AT_EDWTC:
  CB4E  CD02CD        		CALL	AT_EADR+AT_RE
  CB51                	AT_EDWTC1:
  CB51  04            		INC	B
  CB52  EDA3          		OUTI
  CB54  04            		INC	B
  CB55  EDA3          		OUTI
  CB57  04            		INC	B
  CB58  EDA3          		OUTI
  CB5A  04            		INC	B
  CB5B  EDA3          		OUTI
  CB5D  3D            		DEC	A
  CB5E  20F1          		JR	NZ,AT_EDWTC1
  CB60  AF            		XOR	A
  CB61  C9            		RET
                      	
  CB62                	AT_EDRDC:
  CB62  CD02CD        		CALL	AT_EADR+AT_RE
  CB65                	AT_EDRDC1:
  CB65  EDA2          		INI
  CB67  04            		INC	B
  CB68  EDA2          		INI
  CB6A  04            		INC	B
  CB6B  EDA2          		INI
  CB6D  04            		INC	B
  CB6E  EDA2          		INI
  CB70  04            		INC	B
  CB71  3D            		DEC	A
  CB72  20F1          		JR	NZ,AT_EDRDC1
  CB74  AF            		XOR	A
  CB75  C9            		RET
                      	
  CB76                	AT_EADR:
  CB76  D5            		PUSH	DE
  CB77  EB            		EX	DE,HL
  CB78  29            		ADD	HL,HL
  CB79  29            		ADD	HL,HL
  CB7A  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CB7E  0E00          		LD	C,0
  CB80  09            		ADD	HL,BC
  CB81  060D          		LD	B,00DH
  CB83  ED49          		OUT	(C),C
  CB85  0C            		INC	C
  CB86  ED69          		OUT	(C),L
  CB88  0C            		INC	C
  CB89  ED61          		OUT	(C),H
  CB8B  0C            		INC	C
  CB8C  EB            		EX	DE,HL
  CB8D  D1            		POP	DE
  CB8E  13            		INC	DE
  CB8F  AF            		XOR	A
  CB90  C9            		RET
                      	
  CB91                	AT_EMME:
                      	
  CB91                	INITE:
  CB91                		DS	0CC06H-INITE
                      	
  CC06                	BDOS:
  CC06  C351D3        		JP	BDOS0
  CC09                		DS	13	;Reserved
                      	
                      	;LDDISK2.ASM
                      	
                      	;	LSX-Dodgers DISK2
                      	
                      	
                      	;	GRAPHIC RAM DISK DRIVER
                      	
                      	
  CC16                	GDRDC:
  CC16  CD3FCC        		CALL	GADR
  CC19  D5            		PUSH	DE
  CC1A  110004        		LD	DE,0400H
  CC1D                	GDRDC1:
  CC1D  EDA2          		INI
  CC1F  04            		INC	B
  CC20  03            		INC	BC
  CC21  1D            		DEC	E
  CC22  20F9          		JR	NZ,GDRDC1
  CC24  15            		DEC	D
  CC25  20F6          		JR	NZ,GDRDC1
  CC27                	GDWTC2:
  CC27  D1            		POP	DE
  CC28  E6EF          		AND	0EFH		;BANK0
  CC2A  1821          		JR	S1FD0
                      	
  CC2C                	GDWTC:
  CC2C  CD3FCC        		CALL	GADR
  CC2F  D5            		PUSH	DE
  CC30  110004        		LD	DE,0400H
  CC33                	GDWTC1:
  CC33  04            		INC	B
  CC34  EDA3          		OUTI
  CC36  03            		INC	BC
  CC37  1D            		DEC	E
  CC38  20F9          		JR	NZ,GDWTC1
  CC3A  15            		DEC	D
  CC3B  20F6          		JR	NZ,GDWTC1
  CC3D  18E8          		JR	GDWTC2
                      	
  CC3F                	GADR:
  CC3F  0E00          		LD	C,0
  CC41  7B            		LD	A,E
  CC42  87            		ADD	A,A
  CC43  87            		ADD	A,A
  CC44  C640          		ADD	A,040H
  CC46  47            		LD	B,A
  CC47  13            		INC	DE
  CC48  3ABFEC        		LD	A,(WK1FD0)
  CC4B  F610          		OR	010H		;BANK1
  CC4D                	S1FD0:
  CC4D  C5            		PUSH	BC
  CC4E  32BFEC        		LD	(WK1FD0),A
  CC51  01D01F        		LD	BC,01FD0H
  CC54  ED79          		OUT	(C),A
  CC56  C1            		POP	BC
  CC57  C9            		RET
                      	
                      	
                      	;	BANK RAM DISK DRIVER
                      	
                      	
  CC58                	BDRDC:
  CC58  ED7377CC      		LD	(BANKSP+1),SP
  CC5C  3A78CC        		LD	A,(BANKSP+2)
  CC5F  87            		ADD	A,A
  CC60  3803          		JR	C,BDRDC1
  CC62  31D4FF        		LD	SP,EXTSP
  CC65                	BDRDC1:
  CC65  D5            		PUSH	DE
  CC66  D9            		EXX
  CC67  C5            		 PUSH	 BC
  CC68  D5            		 PUSH	 DE
  CC69  CD9DCC        		 CALL	 BADR
  CC6C  CDBACC        		CALL	BTFR
  CC6F  D9            		EXX
  CC70                	BDWTCE:
  CC70  D1            		 POP	 DE
  CC71  C1            		 POP	 BC
  CC72  D9            		 EXX
  CC73  D1            		POP	DE
  CC74  13            		INC	DE
  CC75  FB            		EI
  CC76  310000        	BANKSP:	LD	SP,0
  CC79  AF            		XOR	A
  CC7A  C9            		RET
                      	
  CC7B                	BDWTC:
  CC7B  ED7377CC      		LD	(BANKSP+1),SP
  CC7F  3A78CC        		LD	A,(BANKSP+2)
  CC82  87            		ADD	A,A
  CC83  3803          		JR	C,BDWTC1
  CC85  31D4FF        		LD	SP,EXTSP
  CC88                	BDWTC1:
  CC88  D5            		PUSH	DE
  CC89  D9            		EXX
  CC8A  C5            		 PUSH	 BC
  CC8B  D5            		 PUSH	 DE
  CC8C  CD9DCC        		 CALL	 BADR
  CC8F  D9            		EXX
  CC90  53            		 LD	D,E
  CC91  5F            		 LD	E,A
  CC92  D9            		 EXX
  CC93  EB            		EX	DE,HL
  CC94  CDBACC        		CALL	BTFR
  CC97  EB            		EX	DE,HL
  CC98  D9            		EXX
  CC99  ED51          		 OUT	 (C),D	 ;MAIN
  CC9B  18D3          		 JR	 BDWTCE
                      	
  CC9D                	BADR:
  CC9D  D9            		 EXX
  CC9E  7B            		LD	A,E
  CC9F  87            		ADD	A,A
  CCA0  CB12          		RL	D
  CCA2  87            		ADD	A,A
  CCA3  CB12          		RL	D
  CCA5  F5            		PUSH	AF
  CCA6  87            		ADD	A,A
  CCA7  7A            		LD	A,D
  CCA8  8F            		ADC	A,A
  CCA9  E60F          		AND	00FH
  CCAB  D9            		EXX
  CCAC  01000B        		 LD	 BC,00B00H
  CCAF  57            		 LD	 D,A	  ;BANK
  CCB0  1E10          		 LD	 E,010H	  ;MAIN
  CCB2  D9            		 EXX
  CCB3  D1            		POP	DE
  CCB4  0600          		LD	B,0
  CCB6  58            		LD	E,B
  CCB7  CBBA          		RES	7,D
  CCB9  C9            		RET
                      	
  CCBA                	BTFR:
  CCBA  D5            		PUSH	DE
  CCBB  F3            		DI
                      	
  CCBC                	BTFR1:
  CCBC  D9            		EXX
  CCBD  ED51          		 OUT	 (C),D	 ;BANK(MAIN)
  CCBF  D9            		 EXX
  CCC0  E3            		EX	(SP),HL
  CCC1  7E            		LD	A,(HL)
  CCC2  23            		INC	HL
  CCC3  4E            		LD	C,(HL)
  CCC4  23            		INC	HL
  CCC5  56            		LD	D,(HL)
  CCC6  23            		INC	HL
  CCC7  5E            		LD	E,(HL)
  CCC8  23            		INC	HL
  CCC9  E3            		EX	(SP),HL
  CCCA  D9            		EXX
  CCCB  ED59          		 OUT	 (C),E	 ;MAIN(BANK)
  CCCD  D9            		 EXX
  CCCE  77            		LD	(HL),A
  CCCF  23            		INC	HL
  CCD0  71            		LD	(HL),C
  CCD1  23            		INC	HL
  CCD2  72            		LD	(HL),D
  CCD3  23            		INC	HL
  CCD4  73            		LD	(HL),E
  CCD5  23            		INC	HL
  CCD6  10E4          		DJNZ	BTFR1
  CCD8  D1            		POP	DE
  CCD9  C9            		RET
                      	
                      	
                      	;	EMM DRIVER(DMA)
                      	
                      	
  CCDA                	EDWTC:
  CCDA  3E11          		LD	A,17
  CCDC  01            		DB	1
  CCDD                	EDRDC:
  CCDD  3E0F          		LD	A,15
  CCDF                	EDWTC1:
  CCDF  D5            		PUSH	DE
  CCE0  221CCD        		LD	(EDMAD+12),HL
  CCE3  EB            		EX	DE,HL
  CCE4  29            		ADD	HL,HL
  CCE5  29            		ADD	HL,HL
  CCE6  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CCEA  0E00          		LD	C,0
  CCEC  09            		ADD	HL,BC
  CCED  ED4B84EC      		LD	BC,(_DRIVE)
  CCF1  060D          		LD	B,00DH
  CCF3  ED49          		OUT	(C),C
  CCF5  0C            		INC	C
  CCF6  ED69          		OUT	(C),L
  CCF8  0C            		INC	C
  CCF9  ED61          		OUT	(C),H
                      	
  CCFB  2110CD        		LD	HL,EDMAD
  CCFE  CDE6EB        		CALL	SETDMA
  CD01  3EB3          		LD	A,0B3H
  CD03  ED79          		OUT	(C),A
  CD05  ED49          		OUT	(C),C		;OUT 01F87H,087H
  CD07  EB            		EX	DE,HL
  CD08  24            		INC	H
  CD09  24            		INC	H
  CD0A  24            		INC	H
  CD0B  24            		INC	H
  CD0C  D1            		POP	DE
  CD0D  13            		INC	DE
  CD0E  AF            		XOR	A
  CD0F  C9            		RET
                      	
  CD10  C37D030DFF032C	EDMAD:	DB	0C3H,07DH,003H,00DH,0FFH,003H,02CH,050H,002H
  CD19  809AAD0000CF01		DB	080H,09AH,0ADH,000H,000H,0CFH,001H,0CFH
                      	
  CD21                	EMME:
                      	
  018C                	AT_RE	EQU	EDWTC-AT_EDWTC
                      	
                      	
                      	;LDCCP.ASM
                      	
                      	;	LSX-Dodgers CCP
                      	
  0040                	PATHX	EQU	64
  CD21                	PATHD:	DS	PATHX
  CD61  00            	PATHE:	DB	0
                      	
  CD62  4F4B24        	OK:	DB	"OK$"
  CD65  536B697024    	SKIP:	DB	"Skip$"
  CD6A  6B206279746573	KBFREE:	DB	"k bytes free",9,'$'
  CD78  20202020646972	DIRMES:	DB	"    dir $"
  CD81  074572726F7221	COMERM:	DB	7,"Error!$"
                      	
  0009                	COMS	EQU	9
  CD89                	COMTB:
  CD89  44202020      		DB	"D   "	;1
  CD8D  E1CF          		DW	C_DIR
  CD8F  44495220      		DB	"DIR "	;2
  CD93  E1CF          		DW	C_DIR
  CD95  434F5059      		DB	"COPY"	;3
  CD99  D8D1          		DW	C_COPY
  CD9B  43442020      		DB	"CD  "	;4
  CD9F  D7CE          		DW	C_CD
  CDA1  44454C20      		DB	"DEL "	;5
  CDA5  C2CF          		DW	C_DEL
  CDA7  50415448      		DB	"PATH"	;6
  CDAB  8DD0          		DW	C_PATH
  CDAD  52454E20      		DB	"REN "	;7
  CDB1  CECF          		DW	C_REN
  CDB3  54595045      		DB	"TYPE"	;8
  CDB7  FBD2          		DW	C_TYPE
  CDB9  52454D20      		DB	"REM "	;9
  CDBD  C0CF          		DW	C_REM
                      	
  CDBF                	WBOOT1:
  CDBF  F3            		DI
  CDC0  310000        		LD	SP,STACK
                      	
  CDC3  3EEC          		LD	A,INTVEC/256
  CDC5  ED47          		LD	I,A
                      	
  CDC7  3EE4          		LD	A,0E4H
  CDC9  CD53DB        		CALL	COMOUT
  CDCC  3EC8          		LD	A,INTVEC
  CDCE  CD2DDB        		CALL	OT49SB
                      	
  CDD1  3ABCEC        		LD	A,(CRTCD+12)
  CDD4  B7            		OR	A
  CDD5  200C          		JR	NZ,SETCRT0
  CDD7  2180F8        		LD	HL,0-80*LINE
  CDDA  22BAEC        		LD	(CRTCD+10),HL
  CDDD  21B0FF        		LD	HL,0-80
  CDE0  22BCEC        		LD	(CRTCD+12),HL
  CDE3                	SETCRT0:
  CDE3  21B0EC        		LD	HL,CRTCD
  CDE6  AF            		XOR	A
  CDE7                	SETCRT2:
  CDE7  010018        		LD	BC,01800H
  CDEA  ED79          		OUT	(C),A
  CDEC  0C            		INC	C
  CDED  04            		INC	B
  CDEE  EDA3          		OUTI
  CDF0  3C            		INC	A
  CDF1  FE0C          		CP	12
  CDF3  20F2          		JR	NZ,SETCRT2
  CDF5  0D            		DEC	C
  CDF6  ED79          		OUT	(C),A
  CDF8  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CDF9  ED71          		DB	0EDH,071H
  CDFB  0D            		DEC	C
  CDFC  3C            		INC	A
  CDFD  ED79          		OUT	(C),A
  CDFF  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CE00  ED71          		DB	0EDH,071H
  CE02  23            		INC	HL
  CE03  23            		INC	HL
  CE04  01031B        		LD	BC,01A03H+00100H
  CE07  EDA3          		OUTI
  CE09  01D020        		LD	BC,01FD0H+00100H
  CE0C  EDA3          		OUTI
  CE0E  CD83D0        		CALL	LTNL
  CE11                	COMMAND:
  CE11  CDCBCE        		CALL	SETDTA1
  CE14  D5            		PUSH	DE
  CE15  3A87EC        		LD	A,(_DVSW)
  CE18  C641          		ADD	A,'A'
  CE1A  5F            		LD	E,A
  CE1B  CDCDEC        		CALL	_PRINT
  CE1E  1E3E          		LD	E,'>'
  CE20  CDCDEC        		CALL	_PRINT
  CE23  D1            		POP	DE		;DE=DTA1
  CE24  3E50          		LD	A,80
  CE26  12            		LD	(DE),A
  CE27  0E0A          		LD	C,00AH
  CE29  CD0500        		CALL	SYSTEM
  CE2C  CD83D0        		CALL	LTNL
                      	
  CE2F  118200        		LD	DE,DTA1+2
  CE32  CDFDEC        		CALL	_COMANL
  CE35  30DA          		JR	NC,COMMAND
  CE37  CD6ED7        		CALL	KEYBC
  CE3A  1181CD        		LD	DE,COMERM
  CE3D  CD8AD3        		CALL	_SYS09
  CE40  C7            		RST	0
                      	
  CE41                	COMANL:
  CE41  CD7CDD        		CALL	FILE
  CE44  D5            		PUSH	DE
  CE45  11DC00        		LD	DE,FNAME
  CE48  1A            		LD	A,(DE)
  CE49  FE20          		CP	020H
  CE4B  2848          		JR	Z,SDVSW
  CE4D  1B            		DEC	DE
  CE4E  1A            		LD	A,(DE)
  CE4F  C6FF          		ADD	A,0FFH
  CE51  380A          		JR	C,COMB
  CE53  13            		INC	DE
                      	
  CE54  2189CD        		LD	HL,COMTB
  CE57  3E09          		LD	A,COMS
  CE59  47            		LD	B,A
  CE5A  CDFEDF        		CALL	CPNAME
  CE5D                	COMB:
  CE5D  D1            		POP	DE
  CE5E  D20F00        		JP	NC,JP_HL
  CE61  EB            		EX	DE,HL
  CE62  2241CF        		LD	(COMPAT+1),HL
  CE65  2298CF        		LD	(BATPAT+1),HL
  CE68  F5            		PUSH	AF
  CE69  CDE9CE        		CALL	CEXE4
  CE6C  F1            		POP	AF
  CE6D  21DC00        		LD	HL,FNAME
  CE70  116D00        		LD	DE,FCB2+1	;COMMAND NAME
  CE73  010B00        		LD	BC,11
  CE76  EDB0          		LDIR
  CE78  1121CD        		LD	DE,PATHD
  CE7B                	CEX1:
  CE7B  1A            		LD	A,(DE)
  CE7C  FE20          		CP	020H
  CE7E  D8            		RET	C
  CE7F  CD71DD        		CALL	FILEC
  CE82  D5            		PUSH	DE
  CE83  216D00        		LD	HL,FCB2+1	;COMMAND NAME
  CE86  11DC00        		LD	DE,FNAME
  CE89  010B00        		LD	BC,11
  CE8C  EDB0          		LDIR
  CE8E  CDE9CE        		CALL	CEXE4
  CE91  D1            		POP	DE
  CE92  13            		INC	DE
  CE93  18E6          		JR	CEX1
                      	
  CE95                	SDVSW:
  CE95  F1            		POP	AF
  CE96  3ADB00        		LD	A,(FDRV)
  CE99  3D            		DEC	A
  CE9A  5F            		LD	E,A
  CE9B  0E0E          		LD	C,00EH
  CE9D  1833          		JR	SYSTEM0
                      	
  CE9F                	OPEN1:
  CE9F  21DB00        		LD	HL,FDRV
  CEA2                	OPEN:
  CEA2  0E11          		LD	C,011H
  CEA4                	OPEN3:
  CEA4  D5            		PUSH	DE
  CEA5  1151FF        		LD	DE,DTA
  CEA8  CDC8CE        		CALL	SETDTA
  CEAB  EB            		EX	DE,HL
  CEAC  CD0500        		CALL	SYSTEM
  CEAF  D1            		POP	DE
  CEB0  B7            		OR	A
  CEB1  C9            		RET
                      	
  CEB2                	OPEN2:
  CEB2  0E12          		LD	C,012H
  CEB4  18EE          		JR	OPEN3
                      	
  CEB6                	DEFCB:				;Z=Ok NZ=Error
  CEB6  1151FF        		LD	DE,DTA
  CEB9  CDD0CE        		CALL	SYSC0F
                      	
  CEBC  210000        		LD	HL,0
  CEBF  2272FF        		LD	(DTA+33),HL
  CEC2  2274FF        		LD	(DTA+35),HL
  CEC5  110001        		LD	DE,00100H
  CEC8                	SETDTA:
  CEC8  C3C3D5        		JP	_SYS1A
                      	
  CECB                	SETDTA1:
  CECB  118000        		LD	DE,DTA1
  CECE  18F8          		JR	SETDTA
                      	
  CED0                	SYSC0F:
  CED0  0E0F          		LD	C,00FH		;(BDOS)ファイルのオープン
  CED2                	SYSTEM0:
  CED2  CD0500        		CALL	SYSTEM
  CED5  B7            		OR	A
  CED6  C9            		RET
                      	
  CED7                	C_CD:
  CED7  CD71DD        		CALL	FILEC
  CEDA  210000        		LD	HL,0
  CEDD  11DB00        		LD	DE,FDRV
  CEE0  1803          		JR	S27
                      	
  CEE2                	S27DTA:
  CEE2  1151FF        		LD	DE,DTA
  CEE5                	S27:
  CEE5  0E27          		LD	C,027H		;(BDOS)ランダム・ブロック・リード
  CEE7  18E9          		JR	SYSTEM0
                      	
  CEE9                	CEXE4:
  CEE9  3ADB00        		LD	A,(FDRV)
  CEEC  325700        		LD	(00057H),A
  CEEF  2AE900        		LD	HL,(FDRV+14)
  CEF2  225800        		LD	(00058H),HL
                      	
  CEF5  21E400        		LD	HL,FNAME+8
  CEF8  7E            		LD	A,(HL)
  CEF9  FE20          		CP	020H
  CEFB  2007          		JR	NZ,CEXE7
  CEFD  3E3F          		LD	A,'?'
  CEFF  77            		LD	(HL),A
  CF00  23            		INC	HL
  CF01  77            		LD	(HL),A
  CF02  23            		INC	HL
  CF03  77            		LD	(HL),A
  CF04                	CEXE7:
  CF04  CD9FCE        		CALL	OPEN1
  CF07                	CEXE5:
  CF07  C0            		RET	NZ
  CF08  2A5BFF        		LD	HL,(DTA+1+9)
  CF0B  7C            		LD	A,H
  CF0C  CD65E0        		CALL	CAP
  CF0F  67            		LD	H,A
  CF10  7D            		LD	A,L
  CF11  CD65E0        		CALL	CAP
  CF14  6F            		LD	L,A
  CF15  3A5AFF        		LD	A,(DTA+1+8)
  CF18  CD65E0        		CALL	CAP
  CF1B  D642          		SUB	'B'
  CF1D  282E          		JR	Z,C_BAT
  CF1F  3D            		DEC	A		;'C'
  CF20  2805          		JR	Z,C_EXE
  CF22                	CEXE6:
  CF22  CDB2CE        		CALL	OPEN2
  CF25  18E0          		JR	CEXE5
                      	
  CF27                	C_EXE:
  CF27  7C            		LD	A,H
  CF28  FE4D          		CP	'M'
  CF2A  20F6          		JR	NZ,CEXE6
                      	
  CF2C  CDB6CE        		CALL	DEFCB
  CF2F  2A0600        		LD	HL,(SYSTEM+1)
  CF32  25            		DEC	H
  CF33  CDE2CE        		CALL	S27DTA
  CF36  3D            		DEC	A
  CF37  37            		SCF
  CF38  C0            		RET	NZ
  CF39  7C            		LD	A,H
  CF3A  B5            		OR	L
  CF3B  37            		SCF
  CF3C  C8            		RET	Z
  CF3D  CDCBCE        		CALL	SETDTA1
  CF40  110000        	COMPAT:	LD	DE,0
  CF43  CD93D1        		CALL	SETFCB
  CF46  AF            		XOR	A
  CF47  67            		LD	H,A
  CF48  6F            		LD	L,A	;HL=0x0000
  CF49  F9            		LD	SP,HL	;STACK=0
  CF4A  E5            		PUSH	HL
  CF4B  24            		INC	H	;HL=0x0100
  CF4C  E9            		JP	(HL)
                      	
  CF4D                	C_BAT:
  CF4D  114154        		LD	DE,'A'+'T'*256
  CF50  ED52          		SBC	HL,DE
  CF52  20CE          		JR	NZ,CEXE6
                      	
  CF54  F1            		POP	AF
  CF55  F1            		POP	AF
  CF56  CDB6CE        		CALL	DEFCB
  CF59  210002        		LD	HL,00200H
  CF5C  CDE2CE        		CALL	S27DTA
  CF5F  C6FE          		ADD	A,0FEH
  CF61  D8            		RET	C
  CF62  7D            		LD	A,L
  CF63  B7            		OR	A
  CF64  37            		SCF
  CF65  C8            		RET	Z
  CF66  3C            		INC	A
  CF67  F5            		PUSH	AF
                      	
  CF68  CD6ED7        		CALL	KEYBC
  CF6B  1E1A          		LD	E,01AH
  CF6D  CDCDEC        		CALL	_PRINT
  CF70  C1            		POP	BC
  CF71  210001        		LD	HL,00100H
  CF74                	BAT1:
  CF74  A7            		AND	A
  CF75  05            		DEC	B
  CF76  C8            		RET	Z
  CF77  7E            		LD	A,(HL)
  CF78  FE25          		CP	'%'
  CF7A  280C          		JR	Z,BAT2
  CF7C                	BAT1X:
  CF7C  7E            		LD	A,(HL)
  CF7D  23            		INC	HL
  CF7E  FE1A          		CP	01AH
  CF80  C8            		RET	Z
  CF81  FE0A          		CP	00AH
  CF83  C454D7        		CALL	NZ,KEYBS
  CF86  18EC          		JR	BAT1
                      	
  CF88                	BAT2:
  CF88  23            		INC	HL
  CF89  7E            		LD	A,(HL)
  CF8A  2B            		DEC	HL
  CF8B  D631          		SUB	'1'
  CF8D  38ED          		JR	C,BAT1X
  CF8F  FE09          		CP	9
  CF91  30E9          		JR	NC,BAT1X
  CF93  23            		INC	HL
  CF94  23            		INC	HL
  CF95  3C            		INC	A
  CF96  4F            		LD	C,A
  CF97  110000        	BATPAT:	LD	DE,0
  CF9A                	BAT3:
  CF9A  1A            		LD	A,(DE)
  CF9B  B7            		OR	A
  CF9C  28D6          		JR	Z,BAT1
  CF9E  CD56DE        		CALL	SPCUT
  CFA1  0D            		DEC	C
  CFA2  2808          		JR	Z,BAT5
  CFA4                	BAT4:
  CFA4  1A            		LD	A,(DE)
  CFA5  FE21          		CP	021H
  CFA7  38F1          		JR	C,BAT3
  CFA9  13            		INC	DE
  CFAA  18F8          		JR	BAT4
  CFAC                	BAT5:
  CFAC  1A            		LD	A,(DE)
  CFAD  FE21          		CP	021H
  CFAF  38C3          		JR	C,BAT1
  CFB1  13            		INC	DE
  CFB2  CD54D7        		CALL	KEYBS
  CFB5  18F5          		JR	BAT5
                      	
  CFB7                	SWITCH:
  CFB7  1A            		LD	A,(DE)
  CFB8                	SW1:
  CFB8  13            		INC	DE
  CFB9  B9            		CP	C
  CFBA  1A            		LD	A,(DE)
  CFBB  C8            		RET	Z
  CFBC  FE20          		CP	020H
  CFBE  30F8          		JR	NC,SW1
  CFC0                	C_REM:
  CFC0  AF            		XOR	A
  CFC1  C9            		RET
                      	
  CFC2                	C_DEL:
  CFC2  CD93D1        		CALL	SETFCB
  CFC5  0E08          		LD	C,8
  CFC7  CD0500        		CALL	SYSTEM
                      	
  CFCA  0E13          		LD	C,013H
  CFCC  180A          		JR	CDEL1
                      	
  CFCE                	C_REN:
  CFCE  CD93D1        		CALL	SETFCB
  CFD1  3E10          		LD	A,010H		;ディレクトリも対象にする
  CFD3  326900        		LD	(FCB1+13),A	;属性
  CFD6  0E17          		LD	C,017H
  CFD8                	CDEL1:
  CFD8  115C00        		LD	DE,FCB1
  CFDB  CD0500        		CALL	SYSTEM
  CFDE  C6FF          		ADD	A,0FFH
  CFE0  C9            		RET
                      	
  CFE1                	C_DIR:
  CFE1  CD71DD        		CALL	FILEC
  CFE4  21DC00        		LD	HL,FDRV+1
  CFE7  CD37D3        		CALL	CWILD1
  CFEA  3EF1          		LD	A,0F1H
  CFEC  32E800        		LD	(FDRV+13),A
  CFEF  CD9FCE        		CALL	OPEN1
  CFF2                	CDIR1:
  CFF2  B7            		OR	A
  CFF3  2008          		JR	NZ,PDSKF
  CFF5  CD3CD0        		CALL	P_NAME
  CFF8  CDB2CE        		CALL	OPEN2
  CFFB  18F5          		JR	CDIR1
                      	
  CFFD                	PDSKF:
  CFFD  3ADB00        		LD	A,(FDRV)
  D000  5F            		LD	E,A
  D001  0E1B          		LD	C,01BH
  D003  CD0500        		CALL	SYSTEM
  D006  4F            		LD	C,A
  D007  C601          		ADD	A,001H
  D009  D8            		RET	C
  D00A  AF            		XOR	A
  D00B                	PDS1:
  D00B  0D            		DEC	C
  D00C  2804          		JR	Z,PDS2
  D00E  29            		ADD	HL,HL
  D00F  8F            		ADC	A,A
  D010  18F9          		JR	PDS1
  D012                	PDS2:
  D012  CB50          		BIT	2,B
  D014  2006          		JR	NZ,PDSKF1
  D016  CB3F          		SRL	A
  D018  CB1C          		RR	H
  D01A  CB1D          		RR	L
  D01C                	PDSKF1:
  D01C  CDBFD0        		CALL	PRDEC
  D01F  116ACD        		LD	DE,KBFREE
  D022  CD8AD3        		CALL	_SYS09
  D025  CDB1D0        		CALL	PUTDRV
  D028  3E5C          		LD	A,05CH
  D02A  CDA5D7        		CALL	MSG_
  D02D  2AE900        		LD	HL,(FDRV+14)
  D030  7C            		LD	A,H
  D031  B5            		OR	L
  D032  284F          		JR	Z,LTNL
  D034  2B            		DEC	HL
  D035  7C            		LD	A,H
  D036  B5            		OR	L
  D037  C4BED0        		CALL	NZ,PRDEC0
  D03A  1847          		JR	LTNL
                      	
  D03C                	P_NAME:
  D03C  3A52FF        		LD	A,(DTA+1)
  D03F  FE2E          		CP	'.'
  D041  C8            		RET	Z
  D042  3E20          		LD	A,020H
  D044  CDA5D7        		CALL	MSG_
  D047  CDA5D7        		CALL	MSG_
  D04A  3E3A          		LD	A,':'
  D04C  CDA5D7        		CALL	MSG_
  D04F  3A5DFF        		LD	A,(DTA+1+00BH)
  D052  F5            		PUSH	AF
  D053  0F            		RRCA
  D054  9F            		SBC	A,A
  D055  E60A          		AND	'*'-020H
  D057  C620          		ADD	A,020H
  D059  CDA5D7        		CALL	MSG_
  D05C  CDB1D0        		CALL	PUTDRV
  D05F  2152FF        		LD	HL,DTA+1
  D062  CD00D1        		CALL	FPRNT
                      	
  D065  F1            		POP	AF
  D066  CB67          		BIT	4,A
  D068  2808          		JR	Z,DIR3
  D06A  1178CD        		LD	DE,DIRMES
  D06D  CD8AD3        		CALL	_SYS09
  D070  1809          		JR	DIR6
  D072                	DIR3:
  D072  3A70FF        		LD	A,(DTA+1+01EH)
  D075  2A6EFF        		LD	HL,(DTA+1+01CH)
  D078  CDBFD0        		CALL	PRDEC
  D07B                	DIR6:
  D07B  3AB1EC        		LD	A,(CRTCD+1)
  D07E  FE29          		CP	40+1
  D080  D422D1        		CALL	NC,PRTTMS
                      	
  D083                	LTNL:
  D083  1E0D          		LD	E,00DH
  D085  CD1FD8        		CALL	PRINTX
  D088  1E0A          		LD	E,00AH
  D08A  C31FD8        		JP	PRINTX
                      	
  D08D                	C_PATH:
  D08D  CD56DE        		CALL	SPCUT
  D090  2121CD        		LD	HL,PATHD
  D093  FE21          		CP	021H
  D095  300E          		JR	NC,CPATH0
  D097  2B            		DEC	HL
  D098  2B            		DEC	HL
  D099                	CPATHP:
  D099  7E            		LD	A,(HL)
  D09A  23            		INC	HL
  D09B  FE20          		CP	020H
  D09D  3F            		CCF
  D09E  30E3          		JR	NC,LTNL
  D0A0  CDA5D7        		CALL	MSG_
  D0A3  18F4          		JR	CPATHP
  D0A5                	CPATH0:
  D0A5  FE3B          		CP	';'
  D0A7  2001          		JR	NZ,CPATH1
  D0A9  13            		INC	DE
  D0AA                	CPATH1:
  D0AA  EB            		EX	DE,HL
  D0AB  014000        		LD	BC,PATHX
  D0AE  EDB0          		LDIR
  D0B0  C9            		RET
                      	
  D0B1                	PUTDRV:
  D0B1  3ADB00        		LD	A,(FDRV)
  D0B4  C640          		ADD	A,'A'-1
  D0B6  CDA5D7        		CALL	MSG_
  D0B9  3E3A          		LD	A,':'
  D0BB                	MSGR:
  D0BB  C3A5D7        		JP	MSG_
                      	
  D0BE                	PRDEC0:
  D0BE  AF            		XOR	A
  D0BF                	PRDEC:
  D0BF  5F            		LD	E,A
  D0C0  010000        		LD	BC,0
  D0C3  ED43D600      		LD	(DECBF),BC
  D0C7  ED43D800      		LD	(DECBF+2),BC
                      	
  D0CB  0E18          		LD	C,24
  D0CD                	DEC1:
  D0CD  29            		ADD	HL,HL
  D0CE  7B            		LD	A,E
  D0CF  8F            		ADC	A,A
  D0D0  5F            		LD	E,A
  D0D1  E5            		PUSH	HL
  D0D2  21D900        		LD	HL,DECBF+3
  D0D5  0604          		LD	B,4
  D0D7                	DEC2:
  D0D7  7E            		LD	A,(HL)
  D0D8  8F            		ADC	A,A
  D0D9  27            		DAA
  D0DA  77            		LD	(HL),A
  D0DB  2B            		DEC	HL
  D0DC  10F9          		DJNZ	DEC2
  D0DE  E1            		POP	HL
  D0DF  0D            		DEC	C
  D0E0  20EB          		JR	NZ,DEC1
                      	
  D0E2  21D600        		LD	HL,DECBF
  D0E5  3E20          		LD	A,020H
  D0E7  0603          		LD	B,3
  D0E9                	DEC3:
  D0E9  CDF6D0        		CALL	DEC4
  D0EC  CDF6D0        		CALL	DEC4
  D0EF  23            		INC	HL
  D0F0  10F7          		DJNZ	DEC3
  D0F2                	DECX:
  D0F2  CDF6D0        		CALL	DEC4
  D0F5  AF            		XOR	A
  D0F6                	DEC4:
  D0F6  ED6F          		RLD
  D0F8  FE20          		CP	020H
  D0FA  2802          		JR	Z,DEC5
  D0FC  F630          		OR	030H
  D0FE                	DEC5:
  D0FE  18BB          		JR	MSGR
                      	
  D100                	FPRNT:
  D100  0608          		LD	B,8
  D102  CD13D1        		CALL	P_N1
  D105  7E            		LD	A,(HL)
  D106  C680          		ADD	A,0A0H-020H
  D108  FEA0          		CP	0A0H
  D10A  2802          		JR	Z,FPR1
  D10C  3E2E          		LD	A,'.'
  D10E                	FPR1:
  D10E  CDA5D7        		CALL	MSG_
  D111  0603          		LD	B,3
                      	
  D113                	P_N1:
  D113  C5            		PUSH	BC
  D114  E5            		PUSH	HL
  D115  7E            		LD	A,(HL)
  D116  CD71E0        		CALL	CAP3
  D119  CDA5D7        		CALL	MSG_
  D11C  E1            		POP	HL
  D11D  C1            		POP	BC
  D11E  23            		INC	HL
  D11F  10F2          		DJNZ	P_N1
  D121  C9            		RET
                      	
  D122                	PRTTMS:
  D122  3E20          		LD	A,020H
  D124  CDA5D7        		CALL	MSG_
                      	
  D127  2A6AFF        		LD	HL,(DTA+1+24)
  D12A  7D            		LD	A,L
  D12B  B7            		OR	A
  D12C  C8            		RET	Z
  D12D  CB3C          		SRL	H
  D12F  17            		RLA
  D130  17            		RLA
  D131  17            		RLA
  D132  17            		RLA
  D133  E60F          		AND	00FH
  D135  57            		LD	D,A
  D136  7C            		LD	A,H
  D137  C650          		ADD	A,80
  D139  CD7ED1        		CALL	PRTA
  D13C  3E2D          		LD	A,'-'
  D13E  CDA5D7        		CALL	MSG_
  D141  7A            		LD	A,D
  D142  CD7ED1        		CALL	PRTA
  D145  3E2D          		LD	A,'-'
  D147  CDA5D7        		CALL	MSG_
  D14A  7D            		LD	A,L
  D14B  E61F          		AND	01FH
  D14D  CD7ED1        		CALL	PRTA
                      	
  D150  2A68FF        		LD	HL,(DTA+1+22)
                      	
  D153  3E20          		LD	A,020H
  D155  CDA5D7        		CALL	MSG_
  D158  7C            		LD	A,H
  D159  65            		LD	H,L
  D15A  1F            		RRA
  D15B  CB1D          		RR	L
  D15D  1F            		RRA
  D15E  CB1D          		RR	L
  D160  1F            		RRA
  D161  CB1D          		RR	L
  D163  E61F          		AND	01FH
  D165  CD7ED1        		CALL	PRTA
  D168  3E3A          		LD	A,':'
  D16A  CDA5D7        		CALL	MSG_
  D16D  7D            		LD	A,L
  D16E  0F            		RRCA
  D16F  0F            		RRCA
  D170  E63F          		AND	03FH
  D172  CD7ED1        		CALL	PRTA
  D175  3E3A          		LD	A,':'
  D177  CDA5D7        		CALL	MSG_
  D17A  7C            		LD	A,H
  D17B  E61F          		AND	01FH
  D17D  87            		ADD	A,A
                      	
                      	;	PRINT10
                      	
  D17E                	PRTA:
  D17E  E5            		PUSH	HL
  D17F  0608          		LD	B,8
  D181  4F            		LD	C,A
  D182  AF            		XOR	A
  D183                	PRTA1:
  D183  CB01          		RLC	C
  D185  8F            		ADC	A,A
  D186  27            		DAA
  D187  10FA          		DJNZ	PRTA1
  D189  21D600        		LD	HL,DECBF
  D18C  77            		LD	(HL),A
  D18D  AF            		XOR	A
  D18E  CDF2D0        		CALL	DECX
  D191  E1            		POP	HL
  D192  C9            		RET
                      	
  D193                	SETFCB:
  D193  CD56DE        		CALL	SPCUT
  D196  1A            		LD	A,(DE)
  D197  FE20          		CP	020H
  D199  3801          		JR	C,SETFCBA
  D19B  1B            		DEC	DE
  D19C                	SETFCBA:
  D19C  D5            		PUSH	DE
  D19D  215C00        		LD	HL,FCB1
  D1A0  115D00        		LD	DE,FCB1+1
  D1A3  012300        		LD	BC,00023H
  D1A6  70            		LD	(HL),B		;B=0
  D1A7  EDB0          		LDIR
  D1A9  D1            		POP	DE
  D1AA  D5            		PUSH	DE
  D1AB  215C00        		LD	HL,FCB1
  D1AE  0E29          		LD	C,029H
  D1B0  CD0500        		CALL	SYSTEM
  D1B3  216C00        		LD	HL,FCB2
  D1B6  0E29          		LD	C,029H
  D1B8  CD0500        		CALL	SYSTEM
  D1BB  E1            		POP	HL
  D1BC  010050        		LD	BC,05000H
  D1BF  118100        		LD	DE,00081H
  D1C2                	SETFCB1:
  D1C2  7E            		LD	A,(HL)
  D1C3  23            		INC	HL
  D1C4  FE20          		CP	020H
  D1C6  3805          		JR	C,SETFCB2
  D1C8  12            		LD	(DE),A
  D1C9  13            		INC	DE
  D1CA  0C            		INC	C
  D1CB  10F5          		DJNZ	SETFCB1
  D1CD                	SETFCB2:
  D1CD  79            		LD	A,C
  D1CE  328000        		LD	(DTA1),A
  D1D1  04            		INC	B
  D1D2  AF            		XOR	A
  D1D3                	SETFCB3:
  D1D3  12            		LD	(DE),A
  D1D4  13            		INC	DE
  D1D5  10FC          		DJNZ	SETFCB3
  D1D7  C9            		RET
                      	
  D1D8                	C_COPY:
  D1D8  CD93D1        		CALL	SETFCB
  D1DB  118100        		LD	DE,DTA1+1
  D1DE  0E2F          		LD	C,'/'
  D1E0  CDB7CF        		CALL	SWITCH
  D1E3  CD65E0        		CALL	CAP
  D1E6  326ED2        		LD	(SW+1),A
                      	
  D1E9  1161DD        		LD	DE,BEEPD
  D1EC  CD74DD        		CALL	FILEC2
  D1EF  216C00        		LD	HL,FCB2
  D1F2  CD2ED6        		CALL	S29X1
                      	
  D1F5  3E10          		LD	A,010H
  D1F7  326900        		LD	(FCB1+13),A
  D1FA  216D00        		LD	HL,FCB2+1
  D1FD  CD37D3        		CALL	CWILD1
  D200                	COPY0:
  D200  CD34D3        		CALL	CWILD
  D203  215C00        		LD	HL,FCB1
  D206  CDA2CE        		CALL	OPEN
  D209  37            		SCF
  D20A                	COPY1:
  D20A  C0            		RET	NZ
  D20B  CDB6CE        		CALL	DEFCB
                      	
  D20E  3A5EFF        		LD	A,(DTA+13)
  D211  CB67          		BIT	4,A
  D213  2824          		JR	Z,COPY1A
                      	
  D215  215D00        		LD	HL,FCB1+1
  D218  CD8EE1        		CALL	CHKWILD
  D21B  3817          		JR	C,COPY9
                      	
  D21D  3E20          		LD	A,020H
  D21F  325D00        		LD	(FCB1+1),A
  D222  2A6BFF        		LD	HL,(DTA+26)
  D225  23            		INC	HL
  D226  226A00        		LD	(FCB1+14),HL
  D229  18D5          		JR	COPY0
                      	
  D22B                	COPYS:
  D22B  1165CD        		LD	DE,SKIP
  D22E                	COPY8:
  D22E  CD8AD3        		CALL	_SYS09
  D231  CD83D0        		CALL	LTNL
  D234                	COPY9:
  D234  CDB2CE        		CALL	OPEN2
  D237  18D1          		JR	COPY1
                      	
  D239                	COPY1A:
  D239  216C00        		LD	HL,FCB2
  D23C  11DB00        		LD	DE,FDRV
  D23F  0153FF        		LD	BC,DTA+2
  D242  EDA0          		LDI
  D244  3E0B          		LD	A,11
  D246                	COPY2:
  D246  F5            		PUSH	AF
  D247  7E            		LD	A,(HL)
  D248  FE3F          		CP	'?'
  D24A  2001          		JR	NZ,COPY3
  D24C  0A            		LD	A,(BC)
  D24D                	COPY3:
  D24D  12            		LD	(DE),A
  D24E  03            		INC	BC
  D24F  13            		INC	DE
  D250  23            		INC	HL
  D251  F1            		POP	AF
  D252  3D            		DEC	A
  D253  20F1          		JR	NZ,COPY2
  D255  010500        		LD	BC,16-11
  D258  EDB0          		LDIR
  D25A                	PUTNAME:
  D25A  215D00        		LD	HL,FCB1+1
  D25D  CD8EE1        		CALL	CHKWILD
  D260  300B          		JR	NC,PUTN1
  D262  21DC00        		LD	HL,FDRV+1
  D265  CD00D1        		CALL	FPRNT
  D268  3E20          		LD	A,020H
  D26A  CDA5D7        		CALL	MSG_
  D26D                	PUTN1:
  D26D  3E00          	SW:	LD	A,000H
  D26F  FE54          		CP	'T'
  D271  2005          		JR	NZ,CSW1
  D273  218DD2        		LD	HL,SWNE
  D276  1807          		JR	SWT1
  D278                	CSW1:
  D278  FE4E          		CP	'N'
  D27A  2011          		JR	NZ,SWNE
  D27C  212BD2        		LD	HL,COPYS
  D27F                	SWT1:
  D27F  11DB00        		LD	DE,FDRV
  D282  CDD0CE        		CALL	SYSC0F
  D285  2801          		JR	Z,SWN1
  D287  E9            		JP	(HL)
  D288                	SWN1:
  D288  CDE6D2        		CALL	CTIME
  D28B  309E          		JR	NC,COPYS
  D28D                	SWNE:
  D28D  11DB00        		LD	DE,FDRV
  D290  0E16          		LD	C,016H
  D292  CDD2CE        		CALL	SYSTEM0
  D295  204D          		JR	NZ,COPYE2
  D297  67            		LD	H,A		;A=0
  D298  6F            		LD	L,A
  D299  22FC00        		LD	(FDRV+33),HL
  D29C  22FE00        		LD	(FDRV+35),HL
  D29F                	COPY6:
  D29F  CD46D3        		CALL	BUFSIZ
  D2A2  CDE2CE        		CALL	S27DTA
  D2A5  47            		LD	B,A
  D2A6  3C            		INC	A
  D2A7  2833          		JR	Z,COPYE
  D2A9  7C            		LD	A,H
  D2AA  B5            		OR	L
  D2AB  280E          		JR	Z,COPY7
  D2AD  11DB00        		LD	DE,FDRV
  D2B0  0E26          		LD	C,026H
  D2B2  CD0500        		CALL	SYSTEM
  D2B5  B7            		OR	A
  D2B6  2024          		JR	NZ,COPYE
  D2B8  05            		DEC	B
  D2B9  20E4          		JR	NZ,COPY6
  D2BB                	COPY7:
  D2BB  3A5EFF        		LD	A,(DTA+13)
  D2BE  32E800        		LD	(FDRV+13),A
  D2C1  2165FF        		LD	HL,DTA+20
  D2C4  11EF00        		LD	DE,FDRV+20
  D2C7  010400        		LD	BC,4
  D2CA  EDB0          		LDIR
                      	
  D2CC  11DB00        		LD	DE,FDRV
  D2CF  0E10          		LD	C,010H
  D2D1  CDD2CE        		CALL	SYSTEM0
  D2D4  2006          		JR	NZ,COPYE
                      	
  D2D6  1162CD        		LD	DE,OK
  D2D9  C32ED2        		JP	COPY8
                      	
  D2DC                	COPYE:
  D2DC  11DB00        		LD	DE,FDRV
  D2DF  0E13          		LD	C,013H
  D2E1  CD0500        		CALL	SYSTEM
  D2E4                	COPYE2:
  D2E4  37            		SCF
  D2E5  C9            		RET
                      	
  D2E6                	CTIME:
  D2E6  ED5B65FF      		LD	DE,(DTA+20)
  D2EA  2AEF00        		LD	HL,(FDRV+20)
  D2ED  A7            		AND	A
  D2EE  ED52          		SBC	HL,DE
  D2F0  C0            		RET	NZ
  D2F1  ED5B67FF      		LD	DE,(DTA+22)
  D2F5  2AF100        		LD	HL,(FDRV+22)
  D2F8  ED52          		SBC	HL,DE
  D2FA  C9            		RET
                      	
  D2FB                	C_TYPE:
  D2FB  CD93D1        		CALL	SETFCB
  D2FE  215C00        		LD	HL,FCB1
  D301  CDA2CE        		CALL	OPEN
  D304  37            		SCF
  D305                	TYPE1:
  D305  C0            		RET	NZ
  D306  CDB6CE        		CALL	DEFCB
  D309  1E1A          		LD	E,01AH
  D30B  CDCDEC        		CALL	_PRINT
  D30E                	TYPE2:
  D30E  CD46D3        		CALL	BUFSIZ
  D311  CDE2CE        		CALL	S27DTA
  D314  C6FE          		ADD	A,0FEH
  D316  D8            		RET	C
  D317  7C            		LD	A,H
  D318  B5            		OR	L
  D319  2814          		JR	Z,TYPEE
  D31B  010001        		LD	BC,00100H
  D31E                	TYPE3:
  D31E  0A            		LD	A,(BC)
  D31F  03            		INC	BC
  D320  FE1A          		CP	01AH
  D322  280B          		JR	Z,TYPEE
  D324  5F            		LD	E,A
  D325  CDAED7        		CALL	_SYS02
  D328  2B            		DEC	HL
  D329  7C            		LD	A,H
  D32A  B5            		OR	L
  D32B  20F1          		JR	NZ,TYPE3
  D32D  18DF          		JR	TYPE2
  D32F                	TYPEE:
  D32F  CDB2CE        		CALL	OPEN2
  D332  18D1          		JR	TYPE1
                      	
  D334                	CWILD:
  D334  215D00        		LD	HL,FCB1+1
  D337                	CWILD1:
  D337  7E            		LD	A,(HL)
  D338  FE20          		CP	020H
  D33A  C0            		RET	NZ
  D33B                	CWILD2:
  D33B  54            		LD	D,H
  D33C  5D            		LD	E,L
  D33D  13            		INC	DE
  D33E  010A00        		LD	BC,10
  D341  363F          		LD	(HL),'?'
  D343  EDB0          		LDIR
  D345  C9            		RET
                      	
  D346                	BUFSIZ:
  D346  3A0700        		LD	A,(SYSTEM+2)
  D349  D603          		SUB	3
  D34B  E6FC          		AND	0FCH
  D34D  67            		LD	H,A
  D34E  2E00          		LD	L,0
  D350  C9            		RET
                      	
                      	
                      	;LDOS.ASM
                      	
                      	;	LSX-Dodgers OS
                      	
  D351                	BDOS0:
  D351  ED7369D3      		LD	(BDSP2),SP
  D355  3A6AD3        		LD	A,(BDSP2+1)
  D358  3C            		INC	A		;EXTSP = 0FFD4H
  D359  2810          		JR	Z,BDOS1
  D35B  ED7366D3      		LD	(BDSP+1),SP
  D35F  31D4FF        		LD	SP,EXTSP
  D362  CD6BD3        		CALL	BDOS1
  D365  310000        	BDSP:	LD	SP,0
  D368  C9            		RET
  D369  0000          	BDSP2:	DW	0
  D36B                	BDOS1:
  D36B  79            		LD	A,C
  D36C  FE31          		CP	031H
  D36E  3012          		JR	NC,_ERROR
  D370  ED437FD3      		LD	(BDBC+1),BC
  D374  E5            		PUSH	HL
  D375  87            		ADD	A,A
  D376  6F            		LD	L,A
  D377  26EC          		LD	H,STABLE/256
  D379  4E            		LD	C,(HL)
  D37A  23            		INC	HL
  D37B  46            		LD	B,(HL)
  D37C  E1            		POP	HL
  D37D  C5            		PUSH	BC	;ジャンプアドレス
  D37E  010000        	BDBC:	LD	BC,0
  D381  C9            		RET
                      	
  D382                	_ERROR:
  D382  013201        		LD	BC,00132H
  D385  112901        		LD	DE,VER
  D388                	_SYS1C:		;(BDOS)ディスクの書き込み禁止化
  D388                	_SYS1E:		;(BDOS)ファイル属性の設定
  D388                	_SYS20:		;(BDOS)利用者番号の設定と読み出し
  D388                	_SYS2E:		;(BDOS)ベリファイ・フラグの設定
  D388  AF            		XOR	A
  D389  C9            		RET
                      	
  D38A                	_SYS09:		;文字列出力
  D38A  D5            		PUSH	DE
  D38B                	_SX09:
  D38B  1A            		LD	A,(DE)
  D38C  13            		INC	DE
  D38D  FE24          		CP	'$'
  D38F  282C          		JR	Z,SX0E2
  D391  D5            		PUSH	DE
  D392  5F            		LD	E,A
  D393  CDAED7        		CALL	_SYS02
  D396  D1            		POP	DE
  D397  18F2          		JR	_SX09
                      	
  D399                	_SYS0C:		;(BDOS)バージョン番号の獲得
  D399  212200        		LD	HL,00022H
  D39C  AF            		XOR	A
  D39D  7D            		LD	A,L
  D39E  C9            		RET
                      	
  D39F                	_SYS0D:		;(BDOS)ディスク・リセット
  D39F  CDDFEC        		CALL	_FFLUSH
  D3A2  E5            		PUSH	HL
  D3A3  218000        		LD	HL,00080H
  D3A6  228AEC        		LD	(_DTA),HL
  D3A9  E1            		POP	HL
  D3AA  D5            		PUSH	DE
  D3AB  1E00          		LD	E,0
  D3AD  3E            		DB	03EH
                      	
  D3AE                	_SYS0E:		;(BDOS)カレント・ドライブの設定
  D3AE  D5            		PUSH	DE
  D3AF  7B            		LD	A,E
  D3B0  DDE5          		PUSH	IX
  D3B2  CDDCEC        		CALL	_GETDPB
  D3B5  DDE1          		POP	IX
  D3B7  3804          		JR	C,SX0E2
  D3B9  7B            		LD	A,E
  D3BA  3287EC        		LD	(_DVSW),A
  D3BD                	SX0E2:
  D3BD  3E08          		LD	A,8
  D3BF  D1            		POP	DE
  D3C0  C9            		RET
                      	
  D3C1                	_SYS0F:		;(BDOS)ファイルのオープン
  D3C1  CD68DE        		CALL	SETDRV
  D3C4  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D3C7  C602          		ADD	A,002H		;Write
  D3C9  2868          		JR	Z,FEND0F
  D3CB  CD8AE1        		CALL	CHKWILDX
                      	
  D3CE  D488DE        		CALL	NC,SOPENX
  D3D1                	_S16XX:
  D3D1  3860          		JR	C,FEND0F
                      					;Directory location
  D3D3  3A9FEC        		LD	A,(_FILEN)
  D3D6  FD7719        		LD	(IY+25),A	;(FCB)ディレクトリ・ロケーション
                      	;				_DIRF
  D3D9  3AA0EC        		LD	A,(_DIRF)
  D3DC  FD771D        		LD	(IY+29),A	;(FCB)ディレクトリ・モード
                      	;				_FBPS
  D3DF  FD731E        		LD	(IY+30),E	;(FCB)ディレクトリ・ポジション
  D3E2  FD721F        		LD	(IY+31),D
                      	;				Open(Read)
  D3E5  FD361CFF      		LD	(IY+28),0FFH	;(FCB)オープン・モード
                      	;				FILENAME
  D3E9  FDE5          		PUSH	IY
  D3EB  D1            		POP	DE
  D3EC  13            		INC	DE
  D3ED  010B00        		LD	BC,11
  D3F0  EDB0          		LDIR
                      	;				Attribute
  D3F2  7E            		LD	A,(HL)
  D3F3  FD770D        		LD	(IY+13),A	;(FCB)属性(アトリビュート)
                      	;				TIME
  D3F6  110B00        		LD	DE,11
  D3F9  19            		ADD	HL,DE
  D3FA  7E            		LD	A,(HL)
  D3FB  23            		INC	HL
  D3FC  FD7716        		LD	(IY+22),A	;(FCB)ファイルを最後に変更した時刻
  D3FF  7E            		LD	A,(HL)
  D400  23            		INC	HL
  D401  FD7717        		LD	(IY+23),A
                      	;				DATE
  D404  7E            		LD	A,(HL)
  D405  23            		INC	HL
  D406  FD7714        		LD	(IY+20),A	;(FCB)ファイルを最後に変更した日付
  D409  7E            		LD	A,(HL)
  D40A  23            		INC	HL
  D40B  FD7715        		LD	(IY+21),A
                      	;				First cluster
  D40E  7E            		LD	A,(HL)
  D40F  23            		INC	HL
  D410  FD771A        		LD	(IY+26),A	;(FCB)ファイルの先頭クラスタ
  D413  7E            		LD	A,(HL)
  D414  23            		INC	HL
  D415  FD771B        		LD	(IY+27),A
                      	;				SIZE
  D418  7E            		LD	A,(HL)
  D419  23            		INC	HL
  D41A  FD7710        		LD	(IY+16),A	;(FCB)ファイルのサイズ
  D41D  7E            		LD	A,(HL)
  D41E  23            		INC	HL
  D41F  FD7711        		LD	(IY+17),A
  D422  7E            		LD	A,(HL)
  D423  23            		INC	HL
  D424  FD7712        		LD	(IY+18),A
  D427  7E            		LD	A,(HL)
  D428  FD7713        		LD	(IY+19),A
  D42B  AF            		XOR	A
  D42C  FD770C        		LD	(IY+12),A	;(FCB)カレント・ブロック
  D42F  FD22F1D4      		LD	(OFCB+1),IY
  D433                	FEND0F:
  D433  C3D8D4        		JP	FEND
                      	
  D436                	_SYS10:		;(BDOS)ファイルのクローズ
  D436  CD68DE        		CALL	SETDRV
  D439  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D43C  D6FE          		SUB	0FEH
  D43E  37            		SCF
  D43F  3F            		CCF
  D440  2032          		JR	NZ,FEND10
  D442                	_S10A:				;Write
  D442  FD770E        		LD	(IY+14),A	;(FCB)レコード・サイズ/アクセスするディレクトリのクラスタ番号+1
  D445  FD770F        		LD	(IY+15),A
                      	
  D448  FD341C        		INC	(IY+28)		;0FEH->0FFH ;オープン・モード
  D44B  CD7BE2        		CALL	SETTMS
                      	
  D44E  FD7E1D        		LD	A,(IY+29)	;(FCB)ディレクトリ・モード
  D451  32A0EC        		LD	(_DIRF),A
  D454  FD5E1E        		LD	E,(IY+30)	;(FCB)ディレクトリ・ポジション
  D457  FD561F        		LD	D,(IY+31)
  D45A  CDAADF        		CALL	DC
  D45D  3879          		JR	C,FEND
                      	
  D45F  FD7E19        		LD	A,(IY+25)	;(FCB)ディレクトリ・ロケーション
  D462  87            		ADD	A,A
  D463  87            		ADD	A,A
  D464  87            		ADD	A,A
  D465  E6FF          	IBM2:	AND	0FFH		;自己書き換え 1024=0FFH / 512=07FH
  D467  6F            		LD	L,A
  D468  2600          		LD	H,0
  D46A  29            		ADD	HL,HL
  D46B  29            		ADD	HL,HL
  D46C  ED4B7EEC      		LD	BC,(_DTBUF)
  D470  09            		ADD	HL,BC
                      	
  D471  CD9AE1        		CALL	SDIRENT
  D474                	FEND10:
  D474  1862          		JR	FEND
                      	
  D476                	OPENDD:
  D476  FD361CFD      		LD	(IY+28),0FDH	;(FCB)オープン・モード
  D47A  FD360D20      		LD	(IY+13),020H	;(FCB)属性(アトリビュート)
  D47E  CD80E2        		CALL	SETTMSX
  D481  1855          		JR	FEND
                      	
  D483                	_SYS11:		;(BDOS)最初のファイルの検索
  D483  CD68DE        		CALL	SETDRV
  D486  CDF1DF        		CALL	CHKDDX
  D489  3818          		JR	C,_S11A
  D48B  FDE5          		PUSH	IY
  D48D  E1            		POP	HL
  D48E  ED5B8AEC      		LD	DE,(_DTA)
  D492  010C00        		LD	BC,12
  D495  EDB0          		LDIR
  D497  3E20          		LD	A,020H
  D499  12            		LD	(DE),A
  D49A  13            		INC	DE
  D49B  62            		LD	H,D
  D49C  6B            		LD	L,E
  D49D  13            		INC	DE
  D49E  0E13          		LD	C,19
  D4A0  70            		LD	(HL),B
  D4A1  1833          		JR	_S11B
  D4A3                	_S11A:
  D4A3  CDBCDE        		CALL	SOPEN
  D4A6                	_S12X1:
  D4A6  3830          		JR	C,FEND
  D4A8  CD65DF        		CALL	SOPENE2
  D4AB  ED5B8AEC      		LD	DE,(_DTA)
  D4AF  3A88EC        		LD	A,(_DRV)
  D4B2  3C            		INC	A
  D4B3  12            		LD	(DE),A
  D4B4  D5            		PUSH	DE
  D4B5  13            		INC	DE
  D4B6  012000        		LD	BC,32
  D4B9  EDB0          		LDIR
  D4BB  FD6E0E        		LD	L,(IY+14)	;(FCB)レコード・サイズ/アクセスするディレクトリのクラスタ番号+1
  D4BE  FD660F        		LD	H,(IY+15)
  D4C1  2228E3        		LD	(SCDIR),HL
  D4C4  2A9AEC        		LD	HL,(_FBPS)
  D4C7  222AE3        		LD	(SFBPS),HL
  D4CA  2A9FEC        		LD	HL,(_FILEN)
  D4CD  222CE3        		LD	(SFNDF),HL	;Directory position and Flags
  D4D0  E1            		POP	HL
  D4D1  112EE3        		LD	DE,SFILE
  D4D4  0E21          		LD	C,33
  D4D6                	_S11B:
  D4D6  EDB0          		LDIR
  D4D8                	FEND:
  D4D8  9F            		SBC	A,A		;CF=0 A=0 : CF=1 A=0FFH
  D4D9                	FENDE:
  D4D9  FDE1          		POP	IY
  D4DB  C1            		POP	BC
  D4DC  D1            		POP	DE
  D4DD  E1            		POP	HL
  D4DE  C9            		RET
                      	
  D4DF                	_SYS12:		;(BDOS)次のファイルの検索
  D4DF  E5            		PUSH	HL
  D4E0  D5            		PUSH	DE
  D4E1  C5            		PUSH	BC
  D4E2  FDE5          		PUSH	IY
  D4E4  CD21DF        		CALL	NOPEN
  D4E7  18BD          		JR	_S12X1
                      	
  D4E9                	_S16K:
  D4E9  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D4EC  FEFD          		CP	0FDH		;Device(0FDH)
  D4EE  37            		SCF
  D4EF  C8            		RET	Z
                      	
  D4F0  110000        	OFCB:	LD	DE,0
  D4F3  D5            		PUSH	DE
  D4F4  061A          		LD	B,26		;First cluster
  D4F6                	S16K1:
  D4F6  13            		INC	DE
  D4F7  23            		INC	HL
  D4F8  10FC          		DJNZ	S16K1
                      	
  D4FA  1A            		LD	A,(DE)
  D4FB  BE            		CP	(HL)
  D4FC  2013          		JR	NZ,S16K2
  D4FE  13            		INC	DE
  D4FF  23            		INC	HL
  D500  1A            		LD	A,(DE)
  D501  BE            		CP	(HL)
  D502  200D          		JR	NZ,S16K2
                      	
  D504  E1            		POP	HL
  D505  FDE5          		PUSH	IY
  D507  D1            		POP	DE
  D508  1A            		LD	A,(DE)		;Drive
  D509  BE            		CP	(HL)
  D50A  2005          		JR	NZ,S16K2
                      	
  D50C  ED52          		SBC	HL,DE		;CP HL,DE
  D50E  37            		SCF
  D50F  C0            		RET	NZ
  D510  E5            		PUSH	HL
  D511                	S16K2:
  D511  E1            		POP	HL
  D512  FDE5          		PUSH	IY
  D514  D1            		POP	DE
  D515                	_SYS13:		;(BDOS)ファイルの削除
  D515  CD68DE        		CALL	SETDRV
  D518  CDB4E0        		CALL	KILL
  D51B                	FEND13:
  D51B  18BB          		JR	FEND
                      	
  D51D                	_SYS14:		;(BDOS)シーケンシャルな読み出し
  D51D  CD68DE        		CALL	SETDRV
  D520  CDAFE2        		CALL	PUSHRR
  D523  CDF0E2        		CALL	GETSEQ
                      	
  D526  CD04E3        		CALL	RB_READ
  D529  E5            		PUSH	HL
  D52A  CDC3E2        		CALL	SETSEQ
  D52D                	SREAD:
  D52D  E1            		POP	HL
                      	
  D52E  C601          		ADD	A,001H
  D530  38A6          		JR	C,FEND
                      	
  D532  7D            		LD	A,L
  D533  D601          		SUB	001H
  D535                	FENDX:
  D535  9F            		SBC	A,A
  D536  E603          		AND	3
  D538  1F            		RRA
  D539  189E          		JR	FENDE
                      	
  D53B                	_SYS15:		;(BDOS)シーケンシャルな書き込み
  D53B  CD68DE        		CALL	SETDRV
  D53E  CDAFE2        		CALL	PUSHRR
  D541  CDF0E2        		CALL	GETSEQ
                      	
  D544  CDFDE2        		CALL	RB_WRITE
  D547  E5            		PUSH	HL
  D548  CDC3E2        		CALL	SETSEQ
  D54B                	SWRITE:
  D54B  E1            		POP	HL
                      	
  D54C  C6FF          		ADD	A,0FFH
  D54E  18E5          		JR	FENDX
                      	
  D550                	_SYS17:		;(BDOS)ファイル名の変更
  D550  CD68DE        		CALL	SETDRV
  D553  CD10E1        		CALL	NAME
  D556  18C3          		JR	FEND13
                      	
  D558                	_SYS16:		;(BDOS)ファイルの作成
  D558  CD68DE        		CALL	SETDRV
                      	
  D55B  CD8AE1        		CALL	CHKWILDX
  D55E  38BB          		JR	C,FEND13
  D560  FD7E01        		LD	A,(IY+1)	;(FCB)主ファイル名
  D563  FE05          		CP	5
  D565  2805          		JR	Z,_S16X2
  D567  FE21          		CP	021H
  D569  DA1BD5        		JP	C,FEND13
  D56C                	_S16X2:
                      	;				Clear FCB
  D56C  FDE5          		PUSH	IY
  D56E  E1            		POP	HL
  D56F  011000        		LD	BC,16
  D572  09            		ADD	HL,BC
  D573                	_S16X1:
  D573  70            		LD	(HL),B
  D574  23            		INC	HL
  D575  0D            		DEC	C
  D576  20FB          		JR	NZ,_S16X1
                      	
  D578  CD80E2        		CALL	SETTMSX
  D57B  FD360DFF      		LD	(IY+13),0FFH	;(FCB)Attribute
  D57F  CD88DE        		CALL	SOPENX
  D582  3F            		CCF
  D583  CCE9D4        		CALL	Z,_S16K
  D586  D476DF        		CALL	NC,COPEN
  D589  D49AE1        		CALL	NC,SDIRENT
  D58C  C3D1D3        		JP	_S16XX
                      	
  D58F                	_SYS21:		;(BDOS)ランダムな読み出し
                      	
  D58F  CD68DE        		CALL	SETDRV
  D592  CDAFE2        		CALL	PUSHRR
  D595  FD6E21        		LD	L,(IY+33)	;(FCB)Random record
  D598  FD6622        		LD	H,(IY+34)
                      	
  D59B  CD04E3        		CALL	RB_READ
  D59E  E5            		PUSH	HL
  D59F  CDDAE2        		CALL	POPRR
  D5A2  1889          		JR	SREAD
                      	
  D5A4                	_SYS22:		;(BDOS)ランダムな書き込み
  D5A4                	_SYS28:		;(BDOS)ランダムな書き込み・その2
  D5A4  CD68DE        		CALL	SETDRV
  D5A7  CDAFE2        		CALL	PUSHRR
  D5AA  FD6E21        		LD	L,(IY+33)	;(FCB)Random record
  D5AD  FD6622        		LD	H,(IY+34)
                      	
  D5B0  CDFDE2        		CALL	RB_WRITE
  D5B3  E5            		PUSH	HL
  D5B4  CDDAE2        		CALL	POPRR
  D5B7  1892          		JR	SWRITE
                      	
  D5B9                	_SYS18:		;(BDOS)ログイン・ベクトルの獲得
  D5B9  21FF00        		LD	HL,000FFH
  D5BC  AF            		XOR	A
  D5BD  C9            		RET
                      	
  D5BE                	_SYS19:		;(BDOS)カレント・ドライブ番号の獲得
  D5BE  3A87EC        		LD	A,(_DVSW)
  D5C1  A7            		AND	A
  D5C2  C9            		RET
                      	
  D5C3                	_SYS1A:		;(BDOS)DTAの設定
  D5C3  ED538AEC      		LD	(_DTA),DE
  D5C7  AF            		XOR	A
  D5C8  C9            		RET
                      	
  D5C9                	_SYS1B:		;(BDOS)ディスク情報の獲得
  D5C9  7B            		LD	A,E
  D5CA  CD7BDE        		CALL	GETDRV
  D5CD  CDDCEC        		CALL	_GETDPB
  D5D0  D4E2EC        		CALL	NC,_RDFATX
  D5D3  210000        		LD	HL,0
  D5D6  D460E2        		CALL	NC,DSKF
                      	
  D5D9  ED5B61E2      		LD	DE,(MAXCLP+1)	;DPB_08_MAXCL-1
  D5DD  1B            		DEC	DE
  D5DE  FD2A7CEC      		LD	IY,(_FATBF)
  D5E2  9F            		SBC	A,A
  D5E3  D8            		RET	C
  D5E4  3A55E0        		LD	A,(DBLPAT)	;DPB_07_DBLCL
  D5E7  B7            		OR	A
  D5E8  010002        		LD	BC,00200H
  D5EB  78            		LD	A,B		;A=2
  D5EC  C0            		RET	NZ
  D5ED  3D            		DEC	A		;A=1
  D5EE  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  D5F2  C0            		RET	NZ
  D5F3  0604          		LD	B,004H
  D5F5  C9            		RET
                      	
  D5F6                	_SYS1D:		;(BDOS)書き込みが禁止されているディスクの調査
  D5F6  AF            		XOR	A
  D5F7  67            		LD	H,A
  D5F8  6F            		LD	L,A
  D5F9  C9            		RET
                      	
  D5FA                	_SYS1F:		;(BDOS)ディスク装置のパラメータの読み出し
  D5FA  2100ED        		LD	HL,DEVICE
  D5FD  AF            		XOR	A
  D5FE  C9            		RET
                      	
  D5FF                	_SYS23:		;(BDOS)ファイル・サイズの獲得
  D5FF  E5            		PUSH	HL
  D600  2A1EEC        		LD	HL,(STABLE+2*00FH)	;ファイルのオープン
  D603  CD0F00        		CALL	JP_HL
  D606  3814          		JR	C,_S23X1
                      	
  D608  D5            		PUSH	DE		;EX DE,IY
  D609  FDE3          		EX	(SP),IY		;
                      	;	POP	DE		;
                      	;	PUSH	DE		;DEを破壊しないように注意vv
  D60B  CDE0E2        		CALL	GETSIZE
  D60E                	_S24X1:
  D60E  FD7521        		LD	(IY+33),L	;(FCB)Random record
  D611  FD7422        		LD	(IY+34),H
  D614  FD362300      		LD	(IY+35),0
                      	;	POP	DE		;^^^^^^^^^^^^^^^^^^^^^^^^
                      	;	PUSH	DE		;EX DE,IY
  D618  FDE3          		EX	(SP),IY		;
  D61A  D1            		POP	DE		;
                      	
  D61B  AF            		XOR	A
  D61C                	_S23X1:
  D61C  E1            		POP	HL
  D61D  C9            		RET
                      	
  D61E                	_SYS24:		;(BDOS)ランダム・レコード・フィールドの設定
  D61E  E5            		PUSH	HL
  D61F  D5            		PUSH	DE		;EX DE,IY
  D620  FDE3          		EX	(SP),IY		;
                      	;	POP	DE		;
                      	;	PUSH	DE		;DEを破壊しないように注意vv
  D622  CDF0E2        		CALL	GETSEQ
  D625  18E7          		JR	_S24X1		;^^^^^^^^^^^^^^^^^^^^^^^^
                      	
  D627                	_SYS29:		;(BDOS)ファイル名の解析
  D627  C5            		PUSH	BC
  D628  E5            		PUSH	HL
  D629  CD7CDD        		CALL	FILE
  D62C  E1            		POP	HL
  D62D  C1            		POP	BC
  D62E                	S29X1:
  D62E  C5            		PUSH	BC
  D62F  D5            		PUSH	DE
  D630  E5            		PUSH	HL
  D631  EB            		EX	DE,HL
  D632  21DB00        		LD	HL,FDRV
  D635  010D00        		LD	BC,13
  D638  EDB0          		LDIR
  D63A  70            		LD	(HL),B
  D63B  0E03          		LD	C,3
  D63D  EDB0          		LDIR
  D63F  E1            		POP	HL
  D640  D1            		POP	DE
  D641  C1            		POP	BC
  D642  AF            		XOR	A
  D643  C9            		RET
                      	
  D644                	_SYS30:		;(BDOS)論理セクタを用いた書き込み
  D644  C5            		PUSH	BC
  D645  0184E8        		LD	BC,DWT_DPB
  D648  1804          		JR	S2FX
  D64A                	_SYS2F:
  D64A  C5            		PUSH	BC
  D64B  0128E8        		LD	BC,DRD_DPB
  D64E                	S2FX:
  D64E  ED4363D6      		LD	(S2FPAT+1),BC
  D652  CDCCE9        		CALL	FFLUSH
                      	
  D655  D5            		PUSH	DE
  D656  E5            		PUSH	HL
  D657  7D            		LD	A,L		;Drive
  D658  CDD9EC        		CALL	_CHGDRV
  D65B  380D          		JR	C,S30X2
  D65D  44            		LD	B,H		;Number of clusters
  D65E  2A8AEC        		LD	HL,(_DTA)
  D661                	S30X:
  D661  C5            		PUSH	BC
  D662  CD28E8        	S2FPAT:	CALL	DRD_DPB
  D665  C1            		POP	BC
  D666  3802          		JR	C,S30X2
  D668  10F7          		DJNZ	S30X
  D66A                	S30X2:
  D66A  E1            		POP	HL
  D66B  D1            		POP	DE
  D66C  C1            		POP	BC
  D66D  9F            		SBC	A,A
  D66E  C9            		RET
                      	
                      	;LDIO.ASM
                      	
                      	;	LSX-Dodgers IO
                      	
                      	
  D66F                	BIOS:
  D66F  ED7389D6      		LD	(SPPAT+1),SP
  D673  F5            		PUSH	AF
  D674  3A8AD6        		LD	A,(SPPAT+2)
  D677  3C            		INC	A
  D678  2806          		JR	Z,BIOS2
  D67A  F1            		POP	AF
  D67B  31D4FF        		LD	SP,EXTSP
  D67E  1801          		JR	BIOS3
  D680                	BIOS2:
  D680  F1            		POP	AF
  D681                	BIOS3:
  D681  CD8CD6        		CALL	BIOS1
  D684  061E          		LD	B,01EH
  D686  ED79          		OUT	(C),A
  D688  310000        	SPPAT:	LD	SP,0
  D68B  C9            		RET
  D68C                	BIOS1:
  D68C  C5            		PUSH	BC
  D68D  061D          		LD	B,01DH
  D68F  ED79          		OUT	(C),A
  D691  C9            		RET
                      	
  D692                	INT:
  D692  F5            		PUSH	AF
  D693  E5            		PUSH	HL
  D694  C5            		PUSH	BC
  D695  210001        		LD	HL,00100H
  D698  39            		ADD	HL,SP
  D699  3807          		JR	C,INTP1
  D69B  ED73CDD6      		LD	(INTSP+1),SP
  D69F  31D4FF        		LD	SP,EXTSP
  D6A2                	INTP1:
  D6A2  CD38DB        		CALL	IN49SB
  D6A5  67            		LD	H,A
  D6A6  CD38DB        		CALL	IN49SB
  D6A9  6F            		LD	L,A
                      	
  D6AA  CB64          		BIT	4,H		;[GRAPH]
  D6AC  2010          		JR	NZ,SCEXE
  D6AE  7D            		LD	A,L
  D6AF  EE09          		XOR	9
  D6B1  2839          		JR	Z,DIAN
  D6B3  7C            		LD	A,H
  D6B4  0F            		RRCA			;[CTRL]
  D6B5  301E          		JR	NC,SCL
  D6B7  0F            		RRCA			;[SHIFT]
  D6B8  3804          		JR	C,SCEXE
  D6BA  3E80          		LD	A,080H
  D6BC  181E          		JR	SCG1
  D6BE                	SCEXE:
  D6BE  2292EC        		LD	(_KEYD),HL
  D6C1  CD21D7        		CALL	KEYSET1
                      	
  D6C4  21D4FF        		LD	HL,EXTSP
  D6C7  A7            		AND	A
  D6C8  ED72          		SBC	HL,SP
  D6CA  2003          		JR	NZ,INTPE1
                      	
  D6CC  310000        	INTSP:	LD	SP,0
  D6CF                	INTPE1:
  D6CF  C1            		POP	BC
  D6D0                	INTPE:
  D6D0  E1            		POP	HL
  D6D1                	INTPE2:
  D6D1  F1            		POP	AF
  D6D2                	INTCTCE:
  D6D2  FB            		EI
  D6D3  ED4D          		RETI
                      	
  D6D5                	SCL:
  D6D5  7D            		LD	A,L
  D6D6  FE08          		CP	008H
  D6D8  280D          		JR	Z,RESET
                      	
  D6DA  3E02          		LD	A,002H
  D6DC                	SCG1:
  D6DC  E5            		PUSH	HL
  D6DD  21BFEC        		LD	HL,WK1FD0
  D6E0  AE            		XOR	(HL)
  D6E1  CD4DCC        		CALL	S1FD0
  D6E4  E1            		POP	HL
  D6E5  18D7          		JR	SCEXE
                      	
  D6E7                	RESET:
  D6E7  3E1D          		LD	A,01DH
  D6E9  D300          		OUT	(0),A
  D6EB  C7            		RST	0
                      	
  D6EC                	DIAN:
  D6EC  6F            		LD	L,A
  D6ED  C5            		PUSH	BC
  D6EE  01B01F        		LD	BC,01FB0H
  D6F1  ED78          		IN	A,(C)
  D6F3  EE80          		XOR	080H
  D6F5  ED79          		OUT	(C),A
  D6F7  C1            		POP	BC
  D6F8  18C4          		JR	SCEXE
                      	
  D6FA                	INTCTC2:
  D6FA  F5            		PUSH	AF
  D6FB  3E00          	INTCPAT:LD	A,000H
  D6FD  3D            		DEC	A
  D6FE  32FCD6        		LD	(INTCPAT+1),A
  D701  20CE          		JR	NZ,INTPE2
                      	
  D703  3A92EC        		LD	A,(_KEYD)
  D706  B7            		OR	A
  D707  28C8          		JR	Z,INTPE2
  D709                	KEYSET0:
  D709  E5            		PUSH	HL
  D70A  2A90EC        		LD	HL,(_KEYPS)
  D70D  7C            		LD	A,H
  D70E  AD            		XOR	L
  D70F  2006          		JR	NZ,INTC2A
                      	
  D711  2A92EC        		LD	HL,(_KEYD)
  D714  CD4BD7        		CALL	KEYSET
  D717                	INTC2A:
  D717  3A94EC        		LD	A,(_KEYSP)
  D71A  E60F          		AND	00FH
  D71C  32FCD6        		LD	(INTCPAT+1),A
                      	
  D71F  18AF          		JR	INTPE
                      	
  D721                	KEYSET1:
  D721  CB6C          		BIT	5,H
  D723  F5            		PUSH	AF
  D724  ED4B8CEC      		LD	BC,(_CTC)
  D728  78            		LD	A,B
  D729  B1            		OR	C
  D72A  2006          		JR	NZ,KEYS10E
                      	
  D72C  F1            		POP	AF
  D72D  201C          		JR	NZ,KEYSET
  D72F  F5            		PUSH	AF
  D730  18D7          		JR	KEYSET0
  D732                	KEYS10E:
  D732  F1            		POP	AF
  D733  C8            		RET	Z
  D734  F5            		PUSH	AF
  D735  3E03          		LD	A,3		;CTC STOP
  D737  ED79          		OUT	(C),A
  D739  F1            		POP	AF
                      	
  D73A  B7            		OR	A
  D73B  C8            		RET	Z
                      	
  D73C  E5            		PUSH	HL
  D73D  2A94EC        		LD	HL,(_KEYSP)
  D740  3EA7          		LD	A,0A7H
  D742  ED79          		OUT	(C),A
  D744  ED69          		OUT	(C),L
  D746  7C            		LD	A,H
  D747  32FCD6        		LD	(INTCPAT+1),A
  D74A  E1            		POP	HL
                      	
  D74B                	KEYSET:
  D74B  7D            		LD	A,L
  D74C  CB7C          		BIT	7,H
  D74E  CC7BD7        		CALL	Z,FKEY
  D751  CB74          		BIT	6,H
  D753  C0            		RET	NZ
  D754                	KEYBS:
  D754  B7            		OR	A
  D755  C8            		RET	Z
  D756                	KEYBS1:
  D756  FE03          		CP	3
  D758  CC6ED7        		CALL	Z,KEYBC
  D75B  E5            		PUSH	HL
  D75C  F5            		PUSH	AF
  D75D  2A90EC        		LD	HL,(_KEYPS)
  D760  2C            		INC	L
  D761  7D            		LD	A,L
  D762  BC            		CP	H
  D763  2812          		JR	Z,KEYBE
  D765  3290EC        		LD	(_KEYPS),A
  D768  26FE          		LD	H,KEYBF/256
  D76A  F1            		POP	AF
  D76B  77            		LD	(HL),A
  D76C  E1            		POP	HL
  D76D  C9            		RET
                      	
  D76E                	KEYBC:
  D76E  E5            		PUSH	HL
  D76F  210000        		LD	HL,0
  D772  2290EC        		LD	(_KEYPS),HL
  D775  E1            		POP	HL
  D776  C9            		RET
                      	
  D777                	KEYBE:
  D777  F1            		POP	AF
  D778  E1            		POP	HL
  D779  37            		SCF
  D77A  C9            		RET
                      	
  D77B                	FKEY:
  D77B  CB75          		BIT	6,L
  D77D  C8            		RET	Z
  D77E  3E1B          		LD	A,01BH
  D780  CD56D7        		CALL	KEYBS1
  D783  7D            		LD	A,L
  D784  C6AF          		ADD	A,020H-'q'
  D786  CB7D          		BIT	7,L
  D788  C8            		RET	Z
  D789  2E50          		LD	L,'P'
  D78B  D690          		SUB	0E1H+020H-'q'
  D78D  2810          		JR	Z,KEYBSL
  D78F  2C            		INC	L
  D790  3D            		DEC	A
  D791  280C          		JR	Z,KEYBSL
  D793  2C            		INC	L
  D794  D609          		SUB	0EBH-0E2H
  D796  2807          		JR	Z,KEYBSL
  D798  2E43          		LD	L,'C'
  D79A  3D            		DEC	A
  D79B  2802          		JR	Z,KEYBSL
  D79D  2E58          		LD	L,'X'
  D79F                	KEYBSL:
  D79F  7D            		LD	A,L
  D7A0  18B4          		JR	KEYBS1
                      	
  D7A2                	_SYS01:		;(BDOS)コンソール入力
  D7A2  CDF4DA        		CALL	_SYS07
  D7A5                	MSG_:
  D7A5  F5            		PUSH	AF
  D7A6  D5            		PUSH	DE
  D7A7  5F            		LD	E,A
  D7A8  CDAED7        		CALL	_SYS02
  D7AB  D1            		POP	DE
  D7AC  F1            		POP	AF
  D7AD  C9            		RET
                      	
  D7AE                	_SYS02:		;(BDOS)コンソール出力
  D7AE  CD27D8        		CALL	BREAK
  D7B1  186C          		JR	PRINTX
                      	
  D7B3                	_SYS03:		;(BDOS)外部入力
  D7B3  F3            		DI
  D7B4  C5            		PUSH	BC
  D7B5  01911F        	SIOAD:	LD	BC,01F91H
  D7B8  3E05          		LD	A,5
  D7BA  ED79          		OUT	(C),A
  D7BC  3EEA          		LD	A,0EAH		;RTS ON
  D7BE  ED79          		OUT	(C),A
  D7C0                	REC1:
  D7C0  CDD7D7        		CALL	BREAK2
  D7C3  ED78          		IN	A,(C)
  D7C5  0F            		RRCA			;Arrival
  D7C6  30F8          		JR	NC,REC1
  D7C8                	BREAK2X:
  D7C8  3F            		CCF
  D7C9  3E05          		LD	A,5
  D7CB  ED79          		OUT	(C),A
  D7CD  3EE8          		LD	A,0E8H		;RTS OFF
  D7CF  ED79          		OUT	(C),A
                      	
  D7D1  0D            		DEC	C
  D7D2  ED78          		IN	A,(C)		;Read data
  D7D4  C1            		POP	BC
  D7D5  FB            		EI
  D7D6  C9            		RET
                      	
  D7D7                	BREAK2:
  D7D7  3E1A          		LD	A,01AH
  D7D9  DB01          		IN	A,(1)
  D7DB  0F            		RRCA
  D7DC  D8            		RET	C
  D7DD  C1            		POP	BC		;PC
  D7DE  01911F        	SIOAD0:	LD	BC,01F91H
  D7E1  18E5          		JR	BREAK2X
                      	
  D7E3                	_SYS04:		;(BDOS)外部出力
  D7E3  C5            		PUSH	BC
  D7E4  01911F        	SIOAD1:	LD	BC,01F91H
  D7E7                	XMIT1:
  D7E7  CDD7D7        		CALL	BREAK2
  D7EA  3E10          		LD	A,010H		;Reset status
  D7EC  ED79          		OUT	(C),A
  D7EE  ED78          		IN	A,(C)
  D7F0  2F            		CPL
  D7F1  E624          		AND	024H		;CTS Send Empty
  D7F3  20F2          		JR	NZ,XMIT1
  D7F5  0D            		DEC	C
  D7F6  ED59          		OUT	(C),E
  D7F8  C1            		POP	BC
  D7F9  C9            		RET
                      	
  D7FA                	_SYS05:		;(BDOS)プリンタ出力
  D7FA  C5            		PUSH	BC
  D7FB  01011A        		LD	BC,01A01H
  D7FE                	_S05X1:
  D7FE  CDD7D7        		CALL	BREAK2
  D801  ED78          		IN	A,(C)
  D803  E608          		AND	8
  D805  20F7          		JR	NZ,_S05X1
  D807  F3            		DI
  D808  0D            		DEC	C
  D809  ED59          		OUT	(C),E
  D80B  0E03          		LD	C,3
  D80D  3E0E          		LD	A,00EH
  D80F  ED79          		OUT	(C),A
  D811  3C            		INC	A
  D812  03            		INC	BC
  D813  0B            		DEC	BC
  D814  ED79          		OUT	(C),A
  D816  FB            		EI
  D817  C1            		POP	BC
  D818  AF            		XOR	A
  D819  C9            		RET
                      	
  D81A                	_SYS06:		;(BDOS)コンソール直接入出力
  D81A  7B            		LD	A,E
  D81B  3C            		INC	A
  D81C  CACAEC        		JP	Z,_INKEY
  D81F                	PRINTX:
  D81F  C3CDEC        		JP	_PRINT
                      	
  D822                	_SYS08:		;(BDOS)エコーなしコンソール入力
  D822  CDF4DA        		CALL	_SYS07
  D825  1804          		JR	BREAK1
  D827                	BREAK:
  D827  FB            		EI
  D828  3A92EC        		LD	A,(_KEYD)
  D82B                	BREAK1:
  D82B  FE03          		CP	3
  D82D  CA0000        		JP	Z,0
  D830  FE13          		CP	013H
  D832  C0            		RET	NZ
                      	
  D833                	PAUSE:
  D833  CD6ED7        		CALL	KEYBC
                      	
  D836                	FLGET:
  D836  CDDFEC        		CALL	_FFLUSH
  D839  C5            		PUSH	BC
  D83A  E5            		PUSH	HL
  D83B  ED4B8EEC      		LD	BC,(_TXADR)
  D83F  CBE8          		SET	5,B
  D841  ED60          		IN	H,(C)
  D843                	FLGET1:
  D843  3A93EC        		LD	A,(_KEYD+1)
  D846  0F            		RRCA
  D847  0F            		RRCA
  D848  E610          		AND	010H
  D84A  F608          		OR	8
  D84C  ED68          		IN	L,(C)
  D84E  B5            		OR	L
  D84F  ED79          		OUT	(C),A
  D851  CDCAEC        		CALL	_INKEY
  D854  28ED          		JR	Z,FLGET1
  D856  ED61          		OUT	(C),H
  D858  E1            		POP	HL
  D859  C1            		POP	BC
  D85A  C9            		RET
                      	
  D85B                	_SYS0A:		;(BDOS)文字列入力
  D85B  C5            		PUSH	BC
  D85C  E5            		PUSH	HL
  D85D  D5            		PUSH	DE
  D85E  CD93DC        		CALL	GETL
  D861  1100FF        		LD	DE,KBUF
  D864  E1            		POP	HL
  D865  E5            		PUSH	HL
  D866  0E00          		LD	C,0
  D868  3004          		JR	NC,SAX0
  D86A  23            		INC	HL
  D86B  23            		INC	HL
  D86C  1808          		JR	SAX4
  D86E                	SAX0:
  D86E  46            		LD	B,(HL)
  D86F  23            		INC	HL
  D870                	SAX1:
  D870  23            		INC	HL
  D871  1A            		LD	A,(DE)
  D872  13            		INC	DE
  D873  B7            		OR	A
  D874  2004          		JR	NZ,SAX2
  D876                	SAX4:
  D876  360D          		LD	(HL),00DH
  D878  1804          		JR	SAX3
  D87A                	SAX2:
  D87A  77            		LD	(HL),A
  D87B  0C            		INC	C
  D87C  10F2          		DJNZ	SAX1
  D87E                	SAX3:
  D87E  D1            		POP	DE
  D87F  79            		LD	A,C
  D880  13            		INC	DE
  D881  12            		LD	(DE),A
  D882  1B            		DEC	DE
  D883  E1            		POP	HL
  D884  C1            		POP	BC
  D885  A7            		AND	A
  D886  C9            		RET
                      	
  D887                	_SYS0B:		;(BDOS)コンソール状態のチェック
  D887  CD27D8        		CALL	BREAK
  D88A  3A92EC        		LD	A,(_KEYD)
  D88D  B7            		OR	A
  D88E  C8            		RET	Z
  D88F                	CONSTX:
  D88F  CDDFEC        		CALL	_FFLUSH
  D892  E5            		PUSH	HL
  D893  2A90EC        		LD	HL,(_KEYPS)
  D896  7C            		LD	A,H
  D897  AD            		XOR	L
  D898  E1            		POP	HL
  D899  C6FF          		ADD	A,0FFH
  D89B  9F            		SBC	A,A
  D89C  C9            		RET
                      	
  D89D                	_SYS2A:		;(BDOS)日付の獲得
  D89D  C5            		PUSH	BC
  D89E  3EED          		LD	A,0EDH		;Read calendar
  D8A0  CD53DB        		CALL	COMOUT
  D8A3  CDC6D8        		CALL	IN49SB_BCD		;YY
  D8A6  6F            		LD	L,A
  D8A7  2600          		LD	H,0
  D8A9  116C07        		LD	DE,1900		;0076CH
  D8AC  FE5A          		CP	90
  D8AE  3002          		JR	NC,RDDATE1
  D8B0  1ED0          		LD	E,0D0H		;2000 & 0FFH D=007H
  D8B2                	RDDATE1:
  D8B2  19            		ADD	HL,DE
  D8B3  CD38DB        		CALL	IN49SB		;MM
  D8B6  57            		LD	D,A
  D8B7  CDC6D8        		CALL	IN49SB_BCD	;DD
  D8BA  5F            		LD	E,A
  D8BB  7A            		LD	A,D
  D8BC  E607          		AND	7
  D8BE  0604          		LD	B,4
  D8C0                	RDDATE2:
  D8C0  CB3A          		SRL	D
  D8C2  10FC          		DJNZ	RDDATE2
  D8C4  C1            		POP	BC
  D8C5  C9            		RET
  D8C6                	IN49SB_BCD:
  D8C6  CD38DB        		CALL	IN49SB
  D8C9                	BCD:
  D8C9  4F            		LD	C,A
  D8CA  E6F0          		AND	0F0H
  D8CC  0F            		RRCA
  D8CD  47            		LD	B,A
  D8CE  0F            		RRCA
  D8CF  0F            		RRCA
  D8D0  80            		ADD	A,B
  D8D1  47            		LD	B,A
  D8D2  79            		LD	A,C
  D8D3  E60F          		AND	00FH
  D8D5  80            		ADD	A,B
  D8D6  C9            		RET
                      	
  D8D7                	_SYS2C:		;(BDOS)時刻の獲得
  D8D7  C5            		PUSH	BC
  D8D8  3EEF          		LD	A,0EFH		;Read time
  D8DA  CD53DB        		CALL	COMOUT
  D8DD  CDC6D8        		CALL	IN49SB_BCD	;TT
  D8E0  67            		LD	H,A
  D8E1  CDC6D8        		CALL	IN49SB_BCD	;MM
  D8E4  6F            		LD	L,A
  D8E5  CDC6D8        		CALL	IN49SB_BCD	;SS
  D8E8  57            		LD	D,A
  D8E9  C1            		POP	BC
  D8EA  AF            		XOR	A
  D8EB  C9            		RET
                      	
  D8EC                	MSX1:
  D8EC  5F            		LD	E,A
  D8ED  CDCDEC        		CALL	_PRINT
  D8F0                	MSX:
  D8F0  7E            		LD	A,(HL)
  D8F1  23            		INC	HL
  D8F2  B7            		OR	A
  D8F3  20F7          		JR	NZ,MSX1
  D8F5  C9            		RET
                      	
  D8F6                	ESC1:
  D8F6  7B            		LD	A,E
  D8F7  FE41          		CP	'A'
  D8F9  CA37DA        		JP	Z,CTRL1E
  D8FC  FE42          		CP	'B'
  D8FE  CABEDB        		JP	Z,CTRL1F
  D901  FE43          		CP	'C'
  D903  CA44DA        		JP	Z,CTRL1C
  D906  FE44          		CP	'D'
  D908  CA2DDA        		JP	Z,CTRL1D
  D90B  FE45          		CP	'E'
  D90D  2802          		JR	Z,CT0CX
  D90F  FE6A          		CP	'j'
  D911                	CT0CX:
  D911  CA91DB        		JP	Z,CTRL0C
  D914  FE48          		CP	'H'
  D916  CAC2DA        		JP	Z,CTRL0B
  D919  FE4A          		CP	'J'
  D91B  CA94DB        		JP	Z,CTRL1A
  D91E  FE4B          		CP	'K'
  D920  CA84DA        		JP	Z,CTRL05
  D923  FE4C          		CP	'L'
  D925  CAD3DB        		JP	Z,CTRL0E
  D928  FE78          		CP	'x'
  D92A  2804          		JR	Z,ESC1X
  D92C  FE79          		CP	'y'
  D92E  2002          		JR	NZ,ESC1Y
  D930                	ESC1X:
  D930  3601          		LD	(HL),1
  D932                	ESC1Y:
  D932  FE3D          		CP	'='
  D934  2804          		JR	Z,ESC1W
  D936  FE59          		CP	'Y'
  D938  2002          		JR	NZ,ESC1Z
  D93A                	ESC1W:
  D93A  3602          		LD	(HL),2
  D93C                	ESC1Z:
  D93C  FE20          		CP	020H
  D93E  3802          		JR	C,ESC1C
  D940  87            		ADD	A,A
  D941  D0            		RET	NC
  D942                	ESC1C:
  D942  E1            		POP	HL
  D943  184A          		JR	ANK
                      	
  D945                	ESC:
  D945  21A0D9        		LD	HL,PRINTE5
  D948  E5            		PUSH	HL
  D949  216BD9        		LD	HL,ESCFLG+1
  D94C  3600          		LD	(HL),0
  D94E  3D            		DEC	A
  D94F  28A5          		JR	Z,ESC1
  D951  3D            		DEC	A
  D952  2009          		JR	NZ,ESC2
  D954  3603          		LD	(HL),3
  D956  7B            		LD	A,E
  D957  D620          		SUB	020H
  D959  3260D9        		LD	(ESCYP+1),A
  D95C  C9            		RET
  D95D                	ESC2:
  D95D  3D            		DEC	A
  D95E  C0            		RET	NZ
  D95F  2600          	ESCYP:	LD	H,0
  D961  7B            		LD	A,E
  D962  D620          		SUB	020H
  D964  6F            		LD	L,A
  D965  C3D6EC        		JP	_LOC
                      	
  D968                	PRINT:
  D968  C5            		PUSH	BC
  D969  E5            		PUSH	HL
  D96A  3E00          	ESCFLG:	LD	A,000H
  D96C  B7            		OR	A
  D96D  20D6          		JR	NZ,ESC
                      	
  D96F  3E1F          		LD	A,01FH
  D971  BB            		CP	E
  D972  3030          		JR	NC,CTRL
  D974                	PRINTC:
  D974  A7            	INSFLG:	AND	A
  D975  DC5CDB        		CALL	C,CTRL12
                      	
  D978  3E00          	KANFLG:	LD	A,000H
  D97A  B7            		OR	A
  D97B  2041          		JR	NZ,KANJI2
  D97D  7B            	X1KPAT:	LD	A,E
  D97E  FE80          		CP	080H
  D980  380D          		JR	C,ANK
  D982  FEA0          		CP	0A0H
  D984  3804          		JR	C,KANJI1
  D986  FEE0          		CP	0E0H
  D988  3805          		JR	C,ANK
  D98A                	KANJI1:
  D98A  3279D9        		LD	(KANFLG+1),A
  D98D  1811          		JR	PRINTE5
  D98F                	ANK:
  D98F  ED4B8EEC      		LD	BC,(_TXADR)
  D993  78            		LD	A,B
  D994  F638          		OR	038H
  D996  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  D997  ED71          		DB	0EDH,071H		;Kanji
  D999  CB98          		RES	3,B
  D99B  ED59          		OUT	(C),E		;Text
  D99D                	KANJIE:
  D99D  CD09DA        		CALL	PRINTE7
  D9A0                	PRINTE5:
  D9A0  E1            		POP	HL
  D9A1  C1            		POP	BC
  D9A2  AF            		XOR	A
  D9A3  C9            		RET
                      	
  D9A4                	CTRL:
  D9A4  CDF0D9        		CALL	KANCLR
  D9A7  3EA7          		LD	A,0A7H		;AND	A
  D9A9  3274D9        		LD	(INSFLG),A
  D9AC  7B            		LD	A,E
  D9AD  87            		ADD	A,A
  D9AE  4F            		LD	C,A
  D9AF  0600          		LD	B,0
  D9B1  2121DD        		LD	HL,CTRLTB
  D9B4  09            		ADD	HL,BC
  D9B5  7E            		LD	A,(HL)
  D9B6  23            		INC	HL
  D9B7  66            		LD	H,(HL)
  D9B8  6F            		LD	L,A
  D9B9  CD0F00        		CALL	JP_HL
  D9BC  18E2          		JR	PRINTE5
                      	
  D9BE                	KANJI2:
  D9BE  D5            		PUSH	DE
  D9BF  57            		LD	D,A
  D9C0  01812F        		LD	BC,02F81H	;SFTJIS
  D9C3  DF            		RST	018H
  D9C4  01C32F        		LD	BC,02FC3H	;Instead or JISVRM
  D9C7  DF            		RST	018H
                      	
  D9C8  ED4B8EEC      		LD	BC,(_TXADR)
  D9CC  78            		LD	A,B
  D9CD  F638          		OR	038H
  D9CF  47            		LD	B,A
  D9D0  ED51          		OUT	(C),D		;kanji
  D9D2  CB98          		RES	3,B
  D9D4  ED59          		OUT	(C),E		;Text
  D9D6  CD09DA        		CALL	PRINTE7
  D9D9  ED4B8EEC      		LD	BC,(_TXADR)
  D9DD  78            		LD	A,B
  D9DE  F638          		OR	038H
  D9E0  47            		LD	B,A
  D9E1  CBF2          		SET	6,D
  D9E3  ED51          		OUT	(C),D		;Kanji
  D9E5  CB98          		RES	3,B
  D9E7  ED59          		OUT	(C),E		;Text
  D9E9  D1            		POP	DE
  D9EA  AF            		XOR	A
  D9EB  3279D9        		LD	(KANFLG+1),A
  D9EE  18AD          		JR	KANJIE
                      	
  D9F0                	KANCLR:
  D9F0  3A79D9        		LD	A,(KANFLG+1)
  D9F3  B7            		OR	A
  D9F4  C8            		RET	Z
  D9F5  ED4B8EEC      		LD	BC,(_TXADR)
  D9F9  78            		LD	A,B
  D9FA  F638          		OR	038H
  D9FC  47            		LD	B,A
  D9FD  AF            		XOR	A
  D9FE  3279D9        		LD	(KANFLG+1),A
  DA01  ED79          		OUT	(C),A		;Kanji
  DA03  CB98          		RES	3,B
  DA05  3E20          		LD	A,020H
  DA07  ED79          		OUT	(C),A		;Text
  DA09                	PRINTE7:
  DA09  CBA0          		RES	4,B
  DA0B                	PRINTE6:
  DA0B  3A96EC        		LD	A,(_COLORF)
  DA0E                	PRINTE4:
  DA0E  ED79          		OUT	(C),A		;Color
  DA10  78            		LD	A,B
  DA11  E607          		AND	7
  DA13  47            		LD	B,A
  DA14                	PRINTE2:
  DA14  03            		INC	BC
  DA15                	PRINTE3:
  DA15  2ABAEC        		LD	HL,(CRTCD+10)
  DA18  A7            		AND	A
  DA19  ED4A          		ADC	HL,BC
  DA1B                	PRINTE8:
  DA1B  2805          		JR	Z,PRINT2
  DA1D                	PRINTE1:
  DA1D  ED438EEC      		LD	(_TXADR),BC
  DA21                	PRINTE:
  DA21  C9            		RET
                      	
  DA22                	PRINT2:
  DA22  CDD9DB        		CALL	SCR
  DA25  2ABCEC        		LD	HL,(CRTCD+12)
  DA28  09            		ADD	HL,BC
  DA29  228EEC        		LD	(_TXADR),HL
  DA2C  C9            		RET
                      	
  DA2D                	CTRL08:
  DA2D                	CTRL1D:
  DA2D  ED4B8EEC      		LD	BC,(_TXADR)
  DA31  78            		LD	A,B
  DA32  B1            		OR	C
  DA33  C8            		RET	Z
  DA34  0B            		DEC	BC
  DA35  18E6          		JR	PRINTE1
                      	
  DA37                	CTRL1E:
  DA37  ED4B8EEC      		LD	BC,(_TXADR)
  DA3B  2ABCEC        		LD	HL,(CRTCD+12)
  DA3E  09            		ADD	HL,BC
  DA3F  D0            		RET	NC
  DA40  44            		LD	B,H
  DA41  4D            		LD	C,L
  DA42  18D9          		JR	PRINTE1
                      	
  DA44                	CTRL1C:
  DA44  ED4B8EEC      		LD	BC,(_TXADR)
  DA48  18CA          		JR	PRINTE2
                      	
  DA4A                	CTRL09:
  DA4A  ED4B8EEC      		LD	BC,(_TXADR)
  DA4E  79            		LD	A,C
  DA4F  E6F8          		AND	0F8H
  DA51  C608          		ADD	A,8
  DA53  4F            		LD	C,A
  DA54  88            		ADC	A,B
  DA55  91            		SUB	C
  DA56  47            		LD	B,A
  DA57  18BC          		JR	PRINTE3
                      	
  DA59                	CTRL02:
  DA59  2A8EEC        		LD	HL,(_TXADR)
  DA5C  7C            		LD	A,H
  DA5D  B5            		OR	L
  DA5E  C8            		RET	Z
  DA5F  2B            		DEC	HL
  DA60  228EEC        		LD	(_TXADR),HL
  DA63  D5            		PUSH	DE
  DA64  CDD3EC        		CALL	_POS
  DA67  3AB1EC        		LD	A,(CRTCD+1)
  DA6A  95            		SUB	L
  DA6B  6F            		LD	L,A
  DA6C  2D            		DEC	L
  DA6D  2638          		LD	H,038H
  DA6F  ED4B8EEC      		LD	BC,(_TXADR)
  DA73  09            		ADD	HL,BC
  DA74  44            		LD	B,H
  DA75  4D            		LD	C,L
  DA76  110020        		LD	DE,02000H	;D:Text E:kanji
  DA79  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DA7C                	C8X1:
  DA7C  CD78DB        		CALL	C12S
  DA7F  0B            		DEC	BC
  DA80  20FA          		JR	NZ,C8X1
  DA82  D1            		POP	DE
  DA83  C9            		RET
                      	
  DA84                	CTRL05:
  DA84  CDD3EC        		CALL	_POS
  DA87  3AB1EC        		LD	A,(CRTCD+1)
  DA8A  95            		SUB	L
  DA8B  6F            		LD	L,A
  DA8C  2620          		LD	H,020H
  DA8E  ED4B8EEC      		LD	BC,(_TXADR)
  DA92                	C05X1:
  DA92  78            		LD	A,B
  DA93  F638          		OR	038H
  DA95  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  DA96  ED71          		DB	0EDH,071H		;kanji
  DA98  CB98          		RES	3,B
  DA9A  ED61          		OUT	(C),H		;Text
  DA9C  CBA0          		RES	4,B
  DA9E  3A96EC        		LD	A,(_COLORF)
  DAA1  ED79          		OUT	(C),A		;Color
  DAA3  03            		INC	BC
  DAA4  2D            		DEC	L
  DAA5  20EB          		JR	NZ,C05X1
  DAA7  C9            		RET
                      	
  DAA8                	CTRL0D:
  DAA8  CDD3EC        		CALL	_POS
  DAAB  2E00          		LD	L,0
  DAAD                	LOC:
  DAAD  C5            		PUSH	BC
  DAAE  E5            		PUSH	HL
  DAAF  CDF0D9        		CALL	KANCLR
  DAB2  CDD5DA        		CALL	LOC1
  DAB5  ED438EEC      		LD	(_TXADR),BC
  DAB9  E1            		POP	HL
  DABA  C1            		POP	BC
  DABB  C9            		RET
                      	
  DABC                	CTRL01:
  DABC  3E37          		LD	A,037H		;SCF
  DABE  3274D9        		LD	(INSFLG),A
  DAC1  C9            		RET
                      	
  DAC2                	CTRL0B:
  DAC2  210000        		LD	HL,0
  DAC5  228EEC        		LD	(_TXADR),HL
  DAC8  C9            		RET
                      	
  DAC9                	PRINTS:
  DAC9  CD27D8        		CALL	BREAK
  DACC  C3CDEC        		JP	_PRINT
                      	
  DACF                	CTRL1B:
  DACF  3E01          		LD	A,1
  DAD1  326BD9        		LD	(ESCFLG+1),A
  DAD4  C9            		RET
                      	
  DAD5                	LOC1:
  DAD5  44            		LD	B,H
  DAD6  4D            		LD	C,L
  DAD7  04            		INC	B
  DAD8  05            		DEC	B
  DAD9  C8            		RET	Z
  DADA  D5            		PUSH	DE
  DADB  ED5BB1EC      		LD	DE,(CRTCD+1)
  DADF  210000        		LD	HL,0
  DAE2  55            		LD	D,L
  DAE3                	LOC2:
  DAE3  19            		ADD	HL,DE
  DAE4  10FD          		DJNZ	LOC2
  DAE6  09            		ADD	HL,BC
  DAE7  D1            		POP	DE
  DAE8                	LOC3:
  DAE8  44            		LD	B,H
  DAE9  4D            		LD	C,L
  DAEA  C9            		RET
                      	
  DAEB                	BOOT:
  DAEB  C30000        		JP	0
  DAEE                	_SYS00:		;(BDOS)プログラム終了
  DAEE                	WBOOT:
  DAEE  C3BFCD        		JP	WBOOT1
  DAF1                	CONST_:
  DAF1  C38FD8        		JP	CONSTX
  DAF4                	_SYS07:		;(BDOS)コンソール直接入力
  DAF4                	CONIN:
  DAF4  C336D8        		JP	FLGET
  DAF7                	CONOUT0:
  DAF7  C3FADA        		JP	CONOUT
  DAFA                	CONOUT:
  DAFA  CD0CDB        		CALL	CURSOR
  DAFD  59            		LD	E,C
  DAFE  CDCDEC        		CALL	_PRINT
  DB01  7B            		LD	A,E
  DB02  FE0A          		CP	00AH
  DB04  2006          		JR	NZ,CURSOR
  DB06  CDA8DA        		CALL	CTRL0D
  DB09  CD84DA        		CALL	CTRL05
  DB0C                	CURSOR:
  DB0C  C5            		PUSH	BC
  DB0D  ED4B8EEC      		LD	BC,(_TXADR)
  DB11  CBE8          		SET	5,B
  DB13  ED78          		IN	A,(C)
  DB15  EE18          		XOR	018H
  DB17  ED79          		OUT	(C),A
  DB19  C1            		POP	BC
  DB1A  C9            		RET
                      	
  DB1B                	CTRL07:
  DB1B  2161DD        		LD	HL,BEEPD
  DB1E                	BEEP1:
  DB1E  7E            		LD	A,(HL)
  DB1F  23            		INC	HL
  DB20  FEFF          		CP	0FFH
  DB22  C8            		RET	Z
  DB23  F3            		DI
  DB24  061C          		LD	B,01CH
  DB26  ED79          		OUT	(C),A
  DB28  EDA3          		OUTI
  DB2A  FB            		EI
  DB2B  18F1          		JR	BEEP1
                      	
  DB2D                	OT49SB:
  DB2D  C5            		PUSH	BC
  DB2E  CD49DB        		CALL	CANW
  DB31  010019        		LD	BC,01900H
  DB34  ED79          		OUT	(C),A
  DB36  C1            		POP	BC
  DB37  C9            		RET
                      	
  DB38                	IN49SB:
  DB38  C5            		PUSH	BC
  DB39  01011A        		LD	BC,01A01H
  DB3C                	CANR:
  DB3C  ED78          		IN	A,(C)
  DB3E  E620          		AND	020H
  DB40  20FA          		JR	NZ,CANR
  DB42  010019        		LD	BC,01900H
  DB45  ED78          		IN	A,(C)
  DB47  C1            		POP	BC
  DB48  C9            		RET
                      	
  DB49                	CANW:
  DB49  01011A        		LD	BC,01A01H
  DB4C  ED48          		IN	C,(C)
  DB4E  CB71          		BIT	6,C
  DB50  20F7          		JR	NZ,CANW
  DB52  C9            		RET
                      	
  DB53                	COMOUT:
  DB53  FB            		EI
  DB54  CD2DDB        		CALL	OT49SB
  DB57  CD49DB        		CALL	CANW
  DB5A  F3            		DI
  DB5B  C9            		RET
                      	
  DB5C                	CTRL12:
  DB5C  D5            		PUSH	DE
  DB5D  CDD3EC        		CALL	_POS
  DB60  3AB1EC        		LD	A,(CRTCD+1)
  DB63  95            		SUB	L
  DB64  ED4B8EEC      		LD	BC,(_TXADR)
  DB68  110020        		LD	DE,02000H	;D:Text E:Kanji
  DB6B  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DB6E  CBE8          		SET	5,B
  DB70                	C12X1:
  DB70  CD78DB        		CALL	C12S
  DB73  03            		INC	BC
  DB74  20FA          		JR	NZ,C12X1
  DB76  D1            		POP	DE
  DB77  C9            		RET
                      	
  DB78                	C12S:
  DB78  CBE0          		SET	4,B
  DB7A  CBD8          		SET	3,B
  DB7C  ED60          		IN	H,(C)
  DB7E  ED59          	X1PAT:	OUT	(C),E
  DB80  5C            		LD	E,H
  DB81  CB98          		RES	3,B
  DB83  ED60          		IN	H,(C)
  DB85  ED51          		OUT	(C),D
  DB87  54            		LD	D,H
  DB88  CBA0          		RES	4,B
  DB8A  ED60          		IN	H,(C)
  DB8C  ED69          		OUT	(C),L
  DB8E  6C            		LD	L,H
  DB8F  3D            		DEC	A
  DB90  C9            		RET
                      	
  DB91                	CTRL0C:
  DB91  CDC2DA        		CALL	CTRL0B
  DB94                	CTRL1A:
  DB94  ED4B8EEC      		LD	BC,(_TXADR)
  DB98                	C1AX1:
  DB98  78            		LD	A,B
  DB99  F638          		OR	038H
  DB9B  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  DB9C  ED71          		DB	0EDH,071H		;kanji
  DB9E  CB98          		RES	3,B
  DBA0  3E20          		LD	A,020H
  DBA2  ED79          		OUT	(C),A		;Text
  DBA4  CBA0          		RES	4,B
  DBA6  3A96EC        		LD	A,(_COLORF)
  DBA9  ED79          		OUT	(C),A		;Color
  DBAB  03            		INC	BC
  DBAC  CBA8          		RES	5,B
  DBAE  2ABAEC        		LD	HL,(CRTCD+10)
  DBB1  09            		ADD	HL,BC
  DBB2  30E4          		JR	NC,C1AX1
  DBB4  C9            		RET
                      	
  DBB5                	CTRL04:
  DBB5  CDD3EC        		CALL	_POS
  DBB8  7D            		LD	A,L
  DBB9  B7            		OR	A
  DBBA  C8            		RET	Z
  DBBB                	CTRL03:
  DBBB  CDA8DA        		CALL	CTRL0D
  DBBE                	CTRL0A:
  DBBE                	CTRL1F:
  DBBE  ED4B8EEC      		LD	BC,(_TXADR)
  DBC2  2AB1EC        		LD	HL,(CRTCD+1)
  DBC5  2600          		LD	H,0
  DBC7  09            		ADD	HL,BC
  DBC8  44            		LD	B,H
  DBC9  4D            		LD	C,L
  DBCA  2ABAEC        		LD	HL,(CRTCD+10)
  DBCD  09            		ADD	HL,BC
  DBCE  3F            		CCF
  DBCF  9F            		SBC	A,A
  DBD0  C31BDA        		JP	PRINTE8
                      	
  DBD3                	CTRL0E:
  DBD3  CDD3EC        		CALL	_POS
  DBD6  7C            		LD	A,H
  DBD7  1804          		JR	SCR1
  DBD9                	SCR:
  DBD9  3A97EC        		LD	A,(_LINE)
  DBDC  3D            		DEC	A
  DBDD                	SCR1:
  DBDD  C5            		PUSH	BC
  DBDE  D5            		PUSH	DE
  DBDF  01801F        		LD	BC,01F80H	;DMA
  DBE2  1EC3          		LD	E,0C3H
  DBE4  ED59          		OUT	(C),E
  DBE6  119A65        		LD	DE,0659AH
  DBE9  ED59          		OUT	(C),E
  DBEB  ED51          		OUT	(C),D
  DBED  114F00        		LD	DE,79
  DBF0  ED59          		OUT	(C),E
  DBF2  ED51          		OUT	(C),D
                      	
  DBF4  210038        		LD	HL,03800H
  DBF7  11181C        		LD	DE,01C18H
  DBFA  ED51          		OUT	(C),D
  DBFC  ED59          		OUT	(C),E
                      	
  DBFE                	SCRUP1:
  DBFE  B7            		OR	A
  DBFF  2839          		JR	Z,SCRCL
  DC01  F5            		PUSH	AF
  DC02  CD1BDC        		CALL	UPSUB		;kanji
  DC05  ED5BBCEC      		LD	DE,(CRTCD+12)
  DC09  16F7          		LD	D,0F7H
  DC0B  19            		ADD	HL,DE
  DC0C  D5            		PUSH	DE
  DC0D  CD1BDC        		CALL	UPSUB		;Text
  DC10  D1            		POP	DE
  DC11  19            		ADD	HL,DE
  DC12  CD1BDC        		CALL	UPSUB		;Color
  DC15  CBE4          		SET	4,H
  DC17  F1            		POP	AF
  DC18  3D            		DEC	A
  DC19  18E3          		JR	SCRUP1
                      	
  DC1B                	UPSUB:
  DC1B  ED5BB1EC      		LD	DE,(CRTCD+1)
  DC1F  1600          		LD	D,0
  DC21  3ECD          		LD	A,0CDH
  DC23  ED79          		OUT	(C),A
  DC25  ED69          		OUT	(C),L		;SOURCE
  DC27  ED61          		OUT	(C),H
  DC29  19            		ADD	HL,DE
  DC2A  3E1D          		LD	A,01DH
  DC2C  ED79          		OUT	(C),A		;DEST
  DC2E  ED69          		OUT	(C),L
  DC30  ED61          		OUT	(C),H
  DC32  1187CF        		LD	DE,0CF87H
  DC35  ED51          		OUT	(C),D
  DC37  ED59          		OUT	(C),E
  DC39  C9            		RET
                      	
  DC3A                	SCRCL:
  DC3A  44            		LD	B,H
  DC3B  4D            		LD	C,L
  DC3C  215020        		LD	HL,02000H+80
  DC3F  3A96EC        		LD	A,(_COLORF)
  DC42                	SCRCL1:
                      	;	OUT	(C),0		;未定義命令ニーモニック
  DC42  ED71          		DB	0EDH,071H
  DC44  CB98          		RES	3,B
  DC46  ED61          		OUT	(C),H
  DC48  CBA0          		RES	4,B
  DC4A  ED79          		OUT	(C),A
  DC4C  CBD8          		SET	3,B
  DC4E  CBE0          		SET	4,B
  DC50  03            		INC	BC
  DC51  2D            		DEC	L
  DC52  20EE          		JR	NZ,SCRCL1
  DC54  D1            		POP	DE
  DC55  C1            		POP	BC
  DC56  C9            		RET
                      	
  DC57                	SCRN:
  DC57  D5            		PUSH	DE
  DC58  ED58          		IN	E,(C)		;Text
  DC5A  CBD8          		SET	3,B
  DC5C  ED50          		IN	D,(C)		;Kanji
  DC5E  2819          		JR	Z,SCRNE
  DC60  AF            		XOR	A
  DC61  C5            		PUSH	BC
  DC62  013730        		LD	BC,03037H	;VRMJIS
  DC65  DF            		RST	018H
  DC66  01522F        		LD	BC,02F52H	;JISSFT
  DC69  DF            		RST	018H
  DC6A  C1            		POP	BC
  DC6B  ED78          		IN	A,(C)
  DC6D  CB98          		RES	3,B
  DC6F  E640          		AND	040H
  DC71  2003          		JR	NZ,SCRN1
  DC73  7A            		LD	A,D
  DC74  D1            		POP	DE
  DC75  C9            		RET
  DC76                	SCRN1:
  DC76  7B            		LD	A,E
  DC77  D1            		POP	DE
  DC78  C9            		RET
                      	
  DC79                	SCRNE:
  DC79  D1            		POP	DE
  DC7A  CB98          		RES	3,B
  DC7C                	SCRNX:
  DC7C  ED78          		IN	A,(C)
  DC7E  C9            		RET
                      	
  DC7F                	POS:
  DC7F  2A8EEC        		LD	HL,(_TXADR)
  DC82  C5            		PUSH	BC
  DC83  ED4BBCEC      		LD	BC,(CRTCD+12)
  DC87  AF            		XOR	A
  DC88                	POS1:
  DC88  09            		ADD	HL,BC
  DC89  3C            		INC	A
  DC8A  38FC          		JR	C,POS1
  DC8C  ED42          		SBC	HL,BC
  DC8E  3D            		DEC	A
  DC8F  67            		LD	H,A
  DC90  C1            		POP	BC
  DC91  A7            		AND	A
  DC92  C9            		RET
                      	
  DC93                	GETL:
  DC93  CDD3EC        		CALL	_POS
  DC96  E5            		PUSH	HL
  DC97                	GETL1:
  DC97  CDD3EC        		CALL	_POS
  DC9A  C1            		POP	BC
  DC9B  C5            		PUSH	BC
  DC9C  7D            		LD	A,L
  DC9D  91            		SUB	C
  DC9E  69            		LD	L,C
  DC9F  4F            		LD	C,A
  DCA0  DCD6EC        		CALL	C,_LOC
  DCA3                	GET1W:
  DCA3  CD22D8        		CALL	_SYS08
  DCA6  FE08          		CP	8
  DCA8  2007          		JR	NZ,GETL1X
  DCAA  0D            		DEC	C
  DCAB  CB79          		BIT	7,C
  DCAD  2002          		JR	NZ,GETL1X
  DCAF  3E02          		LD	A,2
  DCB1                	GETL1X:
  DCB1  FE1B          		CP	01BH
  DCB3  2016          		JR	NZ,GETL1V
  DCB5  CD22D8        		CALL	_SYS08
  DCB8  FE22          		CP	022H
  DCBA  2008          		JR	NZ,GETL1Y
  DCBC  2100FF        		LD	HL,KBUF
  DCBF  CDF0D8        		CALL	MSX
  DCC2  180E          		JR	GETL1Z
  DCC4                	GETL1Y:
  DCC4  F5            		PUSH	AF
  DCC5  1E1B          		LD	E,01BH
  DCC7  CDCDEC        		CALL	_PRINT
  DCCA  F1            		POP	AF
  DCCB                	GETL1V:
  DCCB  5F            		LD	E,A
  DCCC  CDBCDA        		CALL	CTRL01
  DCCF  CDCDEC        		CALL	_PRINT
  DCD2                	GETL1Z:
  DCD2  7B            		LD	A,E
  DCD3  FE0D          		CP	00DH
  DCD5  20C0          		JR	NZ,GETL1
                      	
  DCD7  2100FF        		LD	HL,KBUF
  DCDA  AF            		XOR	A
  DCDB  ED4BB0EC      		LD	BC,(CRTCD)
  DCDF                	GETL0:
  DCDF  77            		LD	(HL),A
  DCE0  23            		INC	HL
  DCE1  10FC          		DJNZ	GETL0
                      	
  DCE3  D1            		POP	DE
  DCE4  CDD3EC        		CALL	_POS
  DCE7  6B            		LD	L,E
  DCE8  3AB1EC        		LD	A,(CRTCD+1)
  DCEB  95            		SUB	L
  DCEC  57            		LD	D,A
  DCED  CDD5DA        		CALL	LOC1
  DCF0  78            		LD	A,B
  DCF1  F630          		OR	030H
  DCF3  47            		LD	B,A
  DCF4  5A            		LD	E,D
  DCF5  2100FF        		LD	HL,KBUF
  DCF8                	GETL2:
  DCF8  CDD0EC        		CALL	_SCRN
  DCFB  03            		INC	BC
  DCFC  77            		LD	(HL),A
  DCFD  23            		INC	HL
  DCFE  1D            		DEC	E
  DCFF  20F7          		JR	NZ,GETL2
  DD01                	GETL3:
  DD01  2B            		DEC	HL
  DD02  7E            		LD	A,(HL)
  DD03  FE21          		CP	021H
  DD05  D0            		RET	NC
  DD06  3600          		LD	(HL),0
  DD08  15            		DEC	D
  DD09  20F6          		JR	NZ,GETL3
  DD0B  C9            		RET
                      	
  DD0C                	INKEY:
  DD0C  FB            		EI
  DD0D  E5            		PUSH	HL
  DD0E  2A90EC        		LD	HL,(_KEYPS)
  DD11  7C            		LD	A,H
  DD12  AD            		XOR	L
  DD13  2809          		JR	Z,INKEY1
  DD15  7C            		LD	A,H
  DD16  3C            		INC	A
  DD17  3291EC        		LD	(_KEYPS+1),A
  DD1A  6F            		LD	L,A
  DD1B  26FE          		LD	H,KEYBF/256
  DD1D  7E            		LD	A,(HL)
  DD1E                	INKEY1:
  DD1E  E1            		POP	HL
  DD1F  B7            		OR	A
  DD20  C9            		RET
                      	
  DD21                	CTRLTB:
  DD21  21DABCDA59DABB		DW	PRINTE,CTRL01,CTRL02,CTRL03
  DD29  B5DB84DA94DB1B		DW	CTRL04,CTRL05,CTRL1A,CTRL07
  DD31  2DDA4ADABEDBC2		DW	CTRL08,CTRL09,CTRL0A,CTRL0B
  DD39  91DBA8DAD3DB21		DW	CTRL0C,CTRL0D,CTRL0E,PRINTE
  DD41  21DA21DABCDA21		DW	PRINTE,PRINTE,CTRL01,PRINTE
  DD49  21DA21DA21DA21		DW	PRINTE,PRINTE,PRINTE,PRINTE
  DD51  21DA21DA94DBCF		DW	PRINTE,PRINTE,CTRL1A,CTRL1B
  DD59  44DA2DDA37DABE		DW	CTRL1C,CTRL1D,CTRL1E,CTRL1F
                      	
  DD61                	BEEPD:
  DD61  008E01000B000C		DB	0,08EH,1,0,00BH,0,00CH,010H
  DD69  073E08100D00FF		DB	007H,03EH,008H,010H,00DH,0,0FFH
                      	
  DD70  00            	REDDATA:DB	0
                      	
  11C9                	AT_RS	EQU	SCR1-AT_SCR1
                      	;LDFILE.ASM
                      	
                      	;	LSX-Dodgers FILE
                      	
  DD71                	FILEC:
  DD71  CD7CDD        		CALL	FILE
  DD74                	FILEC2:
  DD74  3ADC00        		LD	A,(FDRV+1)
  DD77  FE20          		CP	020H
  DD79  C8            		RET	Z
  DD7A  183B          		JR	SETDIR1
                      	
  DD7C                	FILE:
  DD7C  AF            		XOR	A
  DD7D  32DB00        		LD	(FDRV),A
  DD80  67            		LD	H,A
  DD81  6F            		LD	L,A
  DD82  22E900        		LD	(FDRV+14),HL
  DD85  CD56DE        		CALL	SPCUT
  DD88  CD3BDE        		CALL	CCHK3
  DD8B  2812          		JR	Z,DEVI1
  DD8D  13            		INC	DE
  DD8E  1A            		LD	A,(DE)
  DD8F  1B            		DEC	DE
  DD90  FE3A          		CP	':'
  DD92  200B          		JR	NZ,DEVI1
  DD94  1A            		LD	A,(DE)		;DRIVE
  DD95  CD65E0        		CALL	CAP
  DD98  D640          		SUB	'@'
  DD9A  13            		INC	DE
  DD9B  13            		INC	DE
  DD9C  32DB00        		LD	(FDRV),A
  DD9F                	DEVI1:
  DD9F  1A            		LD	A,(DE)
  DDA0  D65C          		SUB	05CH
  DDA2  200B          		JR	NZ,NOROOT
  DDA4  210000        		LD	HL,0
  DDA7  22F500        		LD	(FDRV+26),HL
  DDAA  2C            		INC	L
  DDAB  22E900        		LD	(FDRV+14),HL
  DDAE  13            		INC	DE
  DDAF                	NOROOT:
                      	
  DDAF                	SETDIR:
  DDAF  CDDBDD        		CALL	FILED
  DDB2  1A            		LD	A,(DE)
  DDB3  FE5C          		CP	05CH
  DDB5  C0            		RET	NZ
  DDB6  13            		INC	DE
  DDB7                	SETDIR1:
  DDB7  3E10          		LD	A,010H		;Directory
  DDB9  32E800        		LD	(FDRV+13),A
  DDBC  D5            		PUSH	DE
  DDBD  11DB00        		LD	DE,FDRV
  DDC0  2A1EEC        		LD	HL,(STABLE+2*00FH)
  DDC3  CD0F00        		CALL	JP_HL
  DDC6  D1            		POP	DE
  DDC7  B7            		OR	A
  DDC8  C0            		RET	NZ
                      	
  DDC9  3AE800        		LD	A,(FDRV+13)
  DDCC  CB67          		BIT	4,A
  DDCE  C8            		RET	Z
                      	
  DDCF  CD22DE        		CALL	FILEI
  DDD2  2AF500        		LD	HL,(FDRV+26)
  DDD5  23            		INC	HL
  DDD6  22E900        		LD	(FDRV+14),HL
  DDD9  18D4          		JR	SETDIR
                      	
  DDDB                	FILED:
  DDDB  CD22DE        		CALL	FILEI
                      	
  DDDE  0608          		LD	B,8
  DDE0                	FILE2:
  DDE0  CD30DE        		CALL	CCHKF
  DDE3  C8            		RET	Z
  DDE4  FE2A          		CP	'*'
  DDE6  282E          		JR	Z,FILE9
  DDE8  FE2E          		CP	'.'
  DDEA  280C          		JR	Z,FILE4
  DDEC  77            		LD	(HL),A
  DDED  23            		INC	HL
  DDEE  10F0          		DJNZ	FILE2
                      	
  DDF0                	FILE3:
  DDF0  CD30DE        		CALL	CCHKF
  DDF3  C8            		RET	Z
  DDF4  FE2E          		CP	'.'
  DDF6  20F8          		JR	NZ,FILE3
                      	
  DDF8                	FILE4:
  DDF8  21E400        		LD	HL,FNAME+8
  DDFB  0603          		LD	B,3
                      	
  DDFD                	FILE4L:
  DDFD  CD30DE        		CALL	CCHKF
  DE00  C8            		RET	Z
  DE01  FE2E          		CP	'.'
  DE03  2008          		JR	NZ,FILE12
  DE05  32DC00        		LD	(FNAME),A	;Parent directory(..)
  DE08  32DD00        		LD	(FNAME+1),A
  DE0B  3E20          		LD	A,020H
  DE0D                	FILE12:
  DE0D  FE2A          		CP	'*'
  DE0F  280A          		JR	Z,FILE10
  DE11  77            		LD	(HL),A
  DE12  23            		INC	HL
  DE13  10E8          		DJNZ	FILE4L
  DE15  C9            		RET
                      	
  DE16                	FILE9:
  DE16  CD1BDE        		CALL	FILE10
  DE19  18D5          		JR	FILE3
                      	
  DE1B                	FILE10:
  DE1B  3E3F          		LD	A,'?'
                      	
  DE1D                	FILE7:
  DE1D  77            		LD	(HL),A
  DE1E  23            		INC	HL
  DE1F  10FC          		DJNZ	FILE7
  DE21  C9            		RET
                      	
  DE22                	FILEI:
  DE22  3E20          		LD	A,020H
  DE24  01000B        		LD	BC,11*256
  DE27  21DC00        		LD	HL,FNAME
  DE2A  E5            		PUSH	HL
  DE2B  CD1DDE        		CALL	FILE7
  DE2E  E1            		POP	HL
  DE2F  C9            		RET
                      	
  DE30                	CCHKF:
  DE30  1A            		LD	A,(DE)
  DE31  CD38DE        		CALL	CCHK2
  DE34  C8            		RET	Z
  DE35  C377E1        		JP	FKAN
                      	
  DE38                	CCHK2:
  DE38  0C            		INC	C
  DE39  0D            		DEC	C
  DE3A  C0            		RET	NZ
  DE3B                	CCHK3:
  DE3B  FE2B          		CP	'+'
  DE3D  C8            		RET	Z
  DE3E  FE2C          		CP	','
  DE40  C8            		RET	Z
  DE41  FE2F          		CP	'/'
  DE43  C8            		RET	Z
  DE44  FE3A          		CP	':'
  DE46  C8            		RET	Z
  DE47  FE3B          		CP	';'
  DE49  C8            		RET	Z
  DE4A  FE3D          		CP	'='
  DE4C  C8            		RET	Z
  DE4D  FE5C          		CP	05CH
  DE4F  C8            		RET	Z
  DE50  FE20          		CP	020H
  DE52  D0            		RET	NC
  DE53  BF            		CP	A		;Z=1
  DE54  C9            		RET
                      	
  DE55                	SS1:
  DE55  13            		INC	DE
  DE56                	SPCUT:
  DE56  1A            		LD	A,(DE)
  DE57  FE20          		CP	020H
  DE59  28FA          		JR	Z,SS1
  DE5B  C9            		RET
                      	
  DE5C                	SETDRVF:
  DE5C  11DB00        		LD	DE,FDRV
  DE5F                	SETDRV0:
  DE5F  CD68DE        		CALL	SETDRV
  DE62  FDE1          		POP	IY
  DE64  C1            		POP	BC
  DE65  D1            		POP	DE
  DE66  E1            		POP	HL
  DE67  C9            		RET
                      	
  DE68                	SETDRV:
  DE68  E3            		EX	(SP),HL		;HL=RETRN ADDRESS
  DE69  D5            		PUSH	DE		;PUSH HL/DE/BC/IY
  DE6A  C5            		PUSH	BC
  DE6B  1A            		LD	A,(DE)
  DE6C  D5            		PUSH	DE
  DE6D  FDE3          		EX	(SP),IY
                      	
  DE6F  CD7BDE        		CALL	GETDRV
  DE72  3C            		INC	A
  DE73  FD7700        		LD	(IY+0),A
  DE76  3D            		DEC	A
  DE77  CDD9EC        		CALL	_CHGDRV
                      	
  DE7A  E9            		JP	(HL)
                      	
  DE7B                	GETDRV:
  DE7B  E67F          		AND	07FH
  DE7D  D601          		SUB	001H
  DE7F  3003          		JR	NC,GETDRV1
  DE81  3A87EC        		LD	A,(_DVSW)	;Current Drive
  DE84                	GETDRV1:
  DE84  3288EC        		LD	(_DRV),A
  DE87  C9            		RET
                      	
  DE88                	SOPENX:
  DE88  CDF1DF        		CALL	CHKDDX
  DE8B  3802          		JR	C,SOPENX1
  DE8D  C1            		POP	BC
  DE8E  E9            		JP	(HL)
  DE8F                	SOPENX1:
  DE8F  112EE3        		LD	DE,SFILE
  DE92  1A            		LD	A,(DE)
  DE93  FDBE00        		CP	(IY+0)
  DE96  2024          		JR	NZ,SOPEN
  DE98  13            		INC	DE
  DE99  FDE5          		PUSH	IY
  DE9B  E1            		POP	HL
  DE9C  23            		INC	HL
  DE9D  CD21E0        		CALL	CPFILE
  DEA0  201A          		JR	NZ,SOPEN
                      	
  DEA2  2A28E3        		LD	HL,(SCDIR)
  DEA5  FD750E        		LD	(IY+14),L
  DEA8  FD740F        		LD	(IY+15),H
                      	
  DEAB  2A2CE3        		LD	HL,(SFNDF)	;Direcroty location and Flags
  DEAE  229FEC        		LD	(_FILEN),HL
                      	
  DEB1  ED5B2AE3      		LD	DE,(SFBPS)
  DEB5  212EE3        		LD	HL,SFILE
  DEB8  36FF          		LD	(HL),0FFH
  DEBA  23            		INC	HL
  DEBB  C9            		RET
  DEBC                	SOPEN:
  DEBC  21B9DF        		LD	HL,FILESE
  DEBF                	SOPENC:
  DEBF  22F9DE        		LD	(OPENPAT+1),HL
                      	
  DEC2  CDE2EC        		CALL	_RDFATX		;Detect Media
  DEC5  3857          		JR	C,RDDERR
                      	
  DEC7  AF            		XOR	A
  DEC8  329FEC        		LD	(_FILEN),A
  DECB                	SOPEN0:
  DECB  CDA1E0        		CALL	LDDIRX
  DECE  2819          		JR	Z,SDIRX1
                      	
  DED0  CDAADF        		CALL	DC		;Sub Directory
  DED3  3808          		JR	C,SDIRX0
  DED5  2A7EEC        		LD	HL,(_DTBUF)
  DED8  7E            		LD	A,(HL)
  DED9  FE2E          		CP	'.'
  DEDB  2810          		JR	Z,SOPEN1
  DEDD                	SDIRX0:
  DEDD  AF            		XOR	A
  DEDE  32A0EC        		LD	(_DIRF),A
  DEE1  FD360E01      		LD	(IY+14),1
  DEE5  FD360F00      		LD	(IY+15),0
  DEE9                	SDIRX1:
  DEE9  ED5B54E3      		LD	DE,(_DIRPS)	;Root Directory
                      	
  DEED                	SOPEN1:
  DEED  0E20          	IBM1:	LD	C,32		;自己書き換え 1クラスタ辺りのディレクトリエントリ数  1024=32 / 512=16
  DEEF                	SOPEN1X:
  DEEF  CDAADF        		CALL	DC		;FILE SEARCH
  DEF2  382A          		JR	C,RDDERR
  DEF4  2A7EEC        		LD	HL,(_DTBUF)
  DEF7                	SOPEN2:
  DEF7  D5            		PUSH	DE
  DEF8  CDB9DF        	OPENPAT:CALL	FILESE		;(Self-rewriting)
  DEFB  D1            		POP	DE
  DEFC  3876          		JR	C,SOPENE
  DEFE  281B          		JR	Z,NOTSE
  DF00                	SOPEN3:
  DF00  3AA0EC        		LD	A,(_DIRF)
  DF03  B7            		OR	A
  DF04  200C          		JR	NZ,SOPEN5
                      	
  DF06  CD57DF        		CALL	ENDRDI
  DF09  280E          		JR	Z,SOPEN6
  DF0B  3C            		INC	A
  DF0C  200B          		JR	NZ,SOPEN6
  DF0E  0E10          		LD	C,16
  DF10  18DD          		JR	SOPEN1X
  DF12                	SOPEN5:
  DF12  CDF7EC        		CALL	_GNCL	;END DIR
  DF15  D8            		RET	C
  DF16  CD5DE0        		CALL	ENDCL
  DF19                	SOPEN6:
  DF19  38D2          		JR	C,SOPEN1
                      	
  DF1B                	_SYS2B:
  DF1B                	_SYS2D:
  DF1B                	NOTSE:
  DF1B  37            		SCF			;CF=1
  DF1C  9F            		SBC	A,A		;A=0FFH
  DF1D  C9            		RET
                      	
  DF1E                	RDDERR:
  DF1E  BF            		CP	A		;READ ERR CF=1 ZF=1
  DF1F  37            		SCF
  DF20  C9            		RET
                      	
  DF21                	NOPEN:
  DF21  21B9DF        		LD	HL,FILESE
  DF24  22F9DE        		LD	(OPENPAT+1),HL
  DF27  FD2A98EC      		LD	IY,(_FCB)
  DF2B  CD8AE1        		CALL	CHKWILDX
  DF2E  30EB          		JR	NC,NOTSE
  DF30  FD7E00        		LD	A,(IY+0)
  DF33  3D            		DEC	A
  DF34  3288EC        		LD	(_DRV),A
  DF37  CDD9EC        		CALL	_CHGDRV
  DF3A  D8            		RET	C
                      	
  DF3B  CDA1E0        		CALL	LDDIRX
  DF3E  ED5B9AEC      		LD	DE,(_FBPS)
  DF42  CDAADF        		CALL	DC
  DF45  38D7          		JR	C,RDDERR
  DF47  3A9EEC        		LD	A,(_FBCNT)
  DF4A  3D            		DEC	A
  DF4B  28B3          		JR	Z,SOPEN3
  DF4D                	NOPEN2:
  DF4D  2A9CEC        		LD	HL,(_FBAD)
  DF50  012000        		LD	BC,020H
  DF53  09            		ADD	HL,BC
  DF54  4F            		LD	C,A
  DF55  18A0          		JR	SOPEN2
                      	
  DF57                	ENDRDI:
  DF57  3A55E0        		LD	A,(DBLPAT)	;A=029H or 0
  DF5A  E601          		AND	1
  DF5C  4F            		LD	C,A
  DF5D  3C            		INC	A
  DF5E  83            		ADD	A,E
  DF5F  5F            		LD	E,A
  DF60  D60C          	RTEPAT:	SUB	12		;(Self-rewriting)
  DF62  CB41          		BIT	0,C
  DF64  C9            		RET
                      	
  DF65                	SOPENE2:
  DF65  229CEC        		LD	(_FBAD),HL
  DF68  79            		LD	A,C
  DF69  329EEC        		LD	(_FBCNT),A
  DF6C  ED539AEC      		LD	(_FBPS),DE
  DF70  FD2298EC      		LD	(_FCB),IY
  DF74                	SOPENE:
  DF74  AF            		XOR	A
  DF75  C9            		RET
                      	
  DF76                	COPEN:
  DF76  FD360D20      		LD	(IY+13),020H		;Attribute
                      	
  DF7A  21D6DF        		LD	HL,NEXTSE
  DF7D  CDBFDE        		CALL	SOPENC
  DF80  D0            		RET	NC
  DF81  C8            		RET	Z
  DF82  3AA0EC        		LD	A,(_DIRF)
  DF85  D601          		SUB	001H
  DF87  D8            		RET	C
  DF88  0601          		LD	B,1
  DF8A  CDFCE1        		CALL	WRDF
  DF8D  D8            		RET	C
  DF8E  ED5B56E3      		LD	DE,(_CLPS)
  DF92  D5            		PUSH	DE
  DF93  CD4AE0        		CALL	DCPAT
  DF96  CD25E6        		CALL	DRDNX
  DF99  2A7EEC        		LD	HL,(_DTBUF)
  DF9C  5D            		LD	E,L
  DF9D  54            		LD	D,H
  DF9E  13            		INC	DE		;DE,DTBUF+1
  DF9F  01FF03        		LD	BC,1023
  DFA2  AF            		XOR	A
  DFA3  77            		LD	(HL),A
  DFA4  E5            		PUSH	HL
  DFA5  EDB0          		LDIR
  DFA7  E1            		POP	HL
  DFA8  D1            		POP	DE
  DFA9  C9            		RET
                      	
  DFAA                	DC:
  DFAA  ED5356E3      		LD	(_CLPS),DE
  DFAE  C5            		PUSH	BC
  DFAF  D5            		PUSH	DE
  DFB0  CD4AE0        		CALL	DCPAT
  DFB3  CD09E6        		CALL	DRDX
  DFB6  D1            		POP	DE
  DFB7  C1            		POP	BC
  DFB8  C9            		RET
                      	
  DFB9                	FILESE:
  DFB9  7E            		LD	A,(HL)
  DFBA  B7            		OR	A
  DFBB  C8            		RET	Z		;END:ZF=1 CF=0
  DFBC  FEE5          		CP	0E5H
  DFBE  280E          		JR	Z,FILESE1
  DFC0  FDE5          		PUSH	IY
  DFC2  D1            		POP	DE
  DFC3  13            		INC	DE
  DFC4  E5            		PUSH	HL
  DFC5  CD21E0        		CALL	CPFILE
  DFC8  CC42E0        		CALL	Z,CPFILE2
  DFCB  E1            		POP	HL
  DFCC  37            		SCF
  DFCD  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DFCE                	FILESE1:
  DFCE  CDE5DF        		CALL	FNEXT
  DFD1  20E6          		JR	NZ,FILESE
  DFD3                	ZFCF0:
  DFD3  F6FF          		OR	0FFH		;ZF=0 CF=0
  DFD5  C9            		RET
                      	
  DFD6                	NEXTSE:
  DFD6  7E            		LD	A,(HL)
  DFD7  B7            		OR	A
  DFD8  37            		SCF
  DFD9  C8            		RET	Z		;!!!:ZF=1 CF=1
  DFDA  FEE5          		CP	0E5H
  DFDC  37            		SCF
  DFDD  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DFDE  CDE5DF        		CALL	FNEXT
  DFE1  20F3          		JR	NZ,NEXTSE
  DFE3  18EE          		JR	ZFCF0
                      	
  DFE5                	FNEXT:
  DFE5  E5            		PUSH	HL
  DFE6  219FEC        		LD	HL,_FILEN
  DFE9  34            		INC	(HL)
  DFEA  E1            		POP	HL
  DFEB  112000        		LD	DE,020H
  DFEE  19            		ADD	HL,DE
  DFEF  0D            		DEC	C
  DFF0  C9            		RET
                      	
  DFF1                	CHKDDX:
  DFF1  CD8AE1        		CALL	CHKWILDX
  DFF4  D8            		RET	C
  DFF5  FDE5          		PUSH	IY
  DFF7  D1            		POP	DE
  DFF8  13            		INC	DE
  DFF9  2162EC        		LD	HL,DDTB
  DFFC  0604          		LD	B,DDS
  DFFE                	CPNAME:
  DFFE  C5            		PUSH	BC
  DFFF  D5            		PUSH	DE
  E000  11FEE5        		LD	DE,CPBUF
  E003  010400        		LD	BC,4
  E006  EDB0          		LDIR
  E008  D1            		POP	DE
  E009  D5            		PUSH	DE
  E00A  E5            		PUSH	HL
  E00B  21FEE5        		LD	HL,CPBUF
  E00E  CD21E0        		CALL	CPFILE
  E011  E1            		POP	HL
  E012  D1            		POP	DE
  E013  C1            		POP	BC
  E014  2005          		JR	NZ,CPNAME1
  E016  7E            		LD	A,(HL)
  E017  23            		INC	HL
  E018  66            		LD	H,(HL)
  E019  6F            		LD	L,A
  E01A  C9            		RET
  E01B                	CPNAME1:
  E01B  23            		INC	HL
  E01C  23            		INC	HL
  E01D  10DF          		DJNZ	CPNAME
  E01F  37            		SCF
  E020  C9            		RET
                      	
  E021                	CPFILE:
  E021  C5            		PUSH	BC
  E022  01000B        		LD	BC,00B00H
  E025                	CPSTR1:
  E025  1A            		LD	A,(DE)
  E026  FE3F          		CP	'?'		;Wild card
  E028  2812          		JR	Z,CPSTR2
  E02A  7E            		LD	A,(HL)
  E02B  CD70E1        		CALL	FKANC
  E02E  E5            		PUSH	HL
  E02F  67            		LD	H,A
  E030  1A            		LD	A,(DE)
  E031  CB01          		RLC	C
  E033  CD70E1        		CALL	FKANC
  E036  CB09          		RRC	C
  E038  BC            		CP	H		;CP (HL),(DE)
  E039  E1            		POP	HL
  E03A  2004          		JR	NZ,CPSTR3
  E03C                	CPSTR2:
  E03C  13            		INC	DE
  E03D  23            		INC	HL
  E03E  10E5          		DJNZ	CPSTR1
  E040                	CPSTR3:
  E040  C1            		POP	BC
  E041  C9            		RET
                      	
  E042                	CPFILE2:
  E042  FD7E0D        		LD	A,(IY+13)
  E045  F6E1          		OR	0E1H
  E047  2F            		CPL
  E048  A6            		AND	(HL)
  E049  C9            		RET
                      	
  E04A                	DCPAT:
  E04A  2A7EEC        		LD	HL,(_DTBUF)
  E04D  3AA0EC        		LD	A,(_DIRF)
  E050  B7            		OR	A
  E051  C8            		RET	Z
                      	
  E052                	CLUST:
  E052  EB            		EX	DE,HL
  E053  3E08          	CLSPAT:	LD	A,8	;DE=DE+8 (2D)  !ADDCL (Self-rewriting)
  E055  29            	DBLPAT:	ADD	HL,HL	;DE=DE*2 (512) !DBLCL (Self-rewriting)
  E056  EB            		EX	DE,HL
  E057  83            		ADD	A,E
  E058  5F            		LD	E,A
  E059  8A            		ADC	A,D
  E05A  93            		SUB	E
  E05B  57            		LD	D,A
  E05C  C9            		RET
                      	
  E05D                	ENDCL:
  E05D  7A            		LD	A,D	;END CLUSTER
  E05E  FE01          	CLPAT1:	CP	1	;164=356	(Self-rewriting)
  E060  C0            		RET	NZ
  E061  7B            		LD	A,E
  E062  FE64          	CLPAT2:	CP	064H	;		(Self-rewriting)
  E064  C9            		RET
                      	
  E065                	CAP:
  E065  FE61          		CP	'a'
  E067  D8            		RET	C
  E068  FE7B          		CP	'z'+1
  E06A  D0            		RET	NC
  E06B  D620          		SUB	020H
  E06D  C9            		RET
  E06E                	CAP2:
  E06E  CD65E0        		CALL	CAP
  E071                	CAP3:
  E071  CD7AE0        		CALL	CAP4
  E074  FE21          		CP	021H
  E076  D0            		RET	NC
  E077  3EA0          		LD	A,0A0H
  E079  C9            		RET
  E07A                	CAP4:
  E07A  FE05          		CP	5
  E07C  C0            		RET	NZ
  E07D  3EE5          		LD	A,0E5H
  E07F  C9            		RET
                      	
  E080                	CHDIR:
  E080  CDA5E9        		CALL	GETDPBD
  E083  3806          		JR	C,CHDIR2
  E085  DD751A        		LD	(IX+01AH),L		;_SDIR_
  E088  DD741B        		LD	(IX+01BH),H		;_SDIR_+1
  E08B                	CHDIR2:
  E08B  DDE1          		POP	IX
  E08D  C9            		RET
                      	
  E08E                	LDDIR:
  E08E  CDA5E9        		CALL	GETDPBD
  E091  DD5E1A        		LD	E,(IX+01AH)		;_SDIR_
  E094  DD561B        		LD	D,(IX+01BH)		;_SDIR_+1
  E097  13            		INC	DE
  E098  FD730E        		LD	(IY+14),E
  E09B  FD720F        		LD	(IY+15),D
  E09E  1B            		DEC	DE
  E09F  18EA          		JR	CHDIR2
                      	
  E0A1                	LDDIRX:
  E0A1  FD5E0E        		LD	E,(IY+14)
  E0A4  FD560F        		LD	D,(IY+15)
  E0A7  1B            		DEC	DE
  E0A8  CD5DE0        		CALL	ENDCL
  E0AB  D48EE0        		CALL	NC,LDDIR
  E0AE                	LDDIRS:
  E0AE  7A            		LD	A,D
  E0AF  B3            		OR	E
  E0B0  32A0EC        		LD	(_DIRF),A
  E0B3  C9            		RET
                      	
  E0B4                	KILL:
  E0B4  CD8AE1        		CALL	CHKWILDX
  E0B7  383A          		JR	C,KILLW
  E0B9  CDF1DF        		CALL	CHKDDX
  E0BC  3F            		CCF
  E0BD  D48FDE        		CALL	NC,SOPENX1
  E0C0                	KILLS:
  E0C0  3E1F          		LD	A,01FH
  E0C2  D406E1        		CALL	NC,CHKATT
  E0C5  D8            		RET	C
  E0C6                	KILLSX:
  E0C6  36E5          		LD	(HL),0E5H	;DIR
  E0C8  CD64E1        		CALL	WTDB
  E0CB  111A00        		LD	DE,01AH
  E0CE  19            		ADD	HL,DE
  E0CF  5E            		LD	E,(HL)
  E0D0  23            		INC	HL
  E0D1  56            		LD	D,(HL)
  E0D2  1804          		JR	KILLS2
  E0D4                	KILLS1:
  E0D4  ED5B56E3      		LD	DE,(_CLPS)	;FAT
  E0D8                	KILLS2:
  E0D8  CD5DE0        		CALL	ENDCL
  E0DB  D0            		RET	NC		;CF=0
  E0DC  21FEFF        		LD	HL,0-2
  E0DF  19            		ADD	HL,DE
  E0E0  D0            		RET	NC		;DE= 0 or 1
  E0E1  D5            		PUSH	DE
  E0E2  CDF7EC        		CALL	_GNCL
  E0E5  ED5356E3      		LD	(_CLPS),DE
  E0E9  D1            		POP	DE
  E0EA  210000        		LD	HL,0
  E0ED  D4FAEC        		CALL	NC,_SNCL
  E0F0  30E2          		JR	NC,KILLS1
  E0F2  C9            		RET
                      	
  E0F3                	KILLW:
  E0F3  CDBCDE        		CALL	SOPEN
  E0F6                	KILLW1:
  E0F6  380B          		JR	C,KILLW2
  E0F8  CD65DF        		CALL	SOPENE2
  E0FB  CDC0E0        		CALL	KILLS
  E0FE  CD21DF        		CALL	NOPEN
  E101  18F3          		JR	KILLW1
  E103                	KILLW2:
  E103  C8            		RET	Z
  E104  3F            		CCF
  E105  C9            		RET
                      	
  E106                	CHKATT:
  E106  E5            		PUSH	HL
  E107  110B00        		LD	DE,00BH
  E10A  19            		ADD	HL,DE
  E10B  A6            		AND	(HL)
  E10C  E1            		POP	HL
  E10D  C8            		RET	Z
  E10E  37            		SCF
  E10F  C9            		RET
                      	
  E110                	NAME:
  E110  CD8AE1        		CALL	CHKWILDX
  E113  D8            		RET	C
  E114  110400        		LD	DE,4
  E117  19            		ADD	HL,DE
  E118  2230E1        		LD	(NAMEP+2),HL
  E11B  23            		INC	HL
  E11C  CD8EE1        		CALL	CHKWILD
  E11F  D8            		RET	C
                      	
  E120  CD8FDE        		CALL	SOPENX1
  E123  3E0F          		LD	A,00FH
  E125  D406E1        		CALL	NC,CHKATT
  E128  D8            		RET	C
                      	
  E129  FD7E00        		LD	A,(IY+0)
  E12C  FDE5          		PUSH	IY
  E12E  FD210000      	NAMEP:	LD	IY,0
  E132  FD7700        		LD	(IY+0),A
  E135  CD8FDE        		CALL	SOPENX1
  E138  FDE3          		EX	(SP),IY
  E13A  3F            		CCF
  E13B  D4BCDE        		CALL	NC,SOPEN
  E13E  EB            		EX	DE,HL
  E13F  E1            		POP	HL
  E140  D8            		RET	C
                      	
  E141                	SETNAME:
  E141  01000B        		LD	BC,11*256
  E144  23            		INC	HL
  E145  7E            		LD	A,(HL)
  E146  FEE5          		CP	0E5H
  E148  2004          		JR	NZ,SNAME1
  E14A  3E05          		LD	A,5
  E14C  180E          		JR	SNAME3
  E14E                	SNAME1:
  E14E  7E            		LD	A,(HL)
  E14F  0C            		INC	C
  E150  0D            		DEC	C
  E151  2009          		JR	NZ,SNAME3
  E153  CD65E0        		CALL	CAP
  E156  FEA0          		CP	0A0H
  E158  2002          		JR	NZ,SNAME3
  E15A  3E20          		LD	A,020H
  E15C                	SNAME3:
  E15C  12            		LD	(DE),A
  E15D  7E            		LD	A,(HL)
  E15E  23            		INC	HL
  E15F  CD77E1        		CALL	FKAN
  E162  10EA          		DJNZ	SNAME1
  E164                	WTDB:
  E164  3EFF          		LD	A,0FFH
  E166  322EE3        		LD	(SFILE),A
  E169                	SWTDBF:
  E169  3E01          		LD	A,1
  E16B  32A4EC        		LD	(_WTDBF),A
  E16E  AF            		XOR	A
  E16F  C9            		RET
                      	
  E170                	FKANC:
  E170  CB41          		BIT	0,C
  E172  CC6EE0        		CALL	Z,CAP2
  E175  1801          		JR	FKANX
  E177                	FKAN:
  E177  13            		INC	DE
  E178                	FKANX:
  E178  CB41          		BIT	0,C
  E17A  CB81          		RES	0,C
  E17C  C0            		RET	NZ
  E17D  FE80          		CP	080H
  E17F  D8            		RET	C
  E180  FEA0          		CP	0A0H
  E182  3803          		JR	C,FKAN1
  E184  FEE0          		CP	0E0H
  E186  D8            		RET	C
  E187                	FKAN1:
  E187  0C            		INC	C
  E188  A7            		AND	A
  E189  C9            		RET
                      	
  E18A                	CHKWILDX:
  E18A  FDE5          		PUSH	IY
  E18C  E1            		POP	HL
  E18D  23            		INC	HL
  E18E                	CHKWILD:
  E18E  060B          		LD	B,11
  E190  3E3F          		LD	A,'?'
  E192                	CHKWIL1:
  E192  BE            		CP	(HL)
  E193  23            		INC	HL
  E194  37            		SCF
  E195  C8            		RET	Z
  E196  10FA          		DJNZ	CHKWIL1
  E198  AF            		XOR	A
  E199  C9            		RET
                      	
  E19A                	SDIRENT:		;IY=FCB HL=DIR
  E19A  D5            		PUSH	DE
  E19B  E5            		PUSH	HL
  E19C  FDE5          		PUSH	IY
  E19E  D1            		POP	DE
  E19F  EB            		EX	DE,HL
  E1A0  CD41E1        		CALL	SETNAME
                      	;				Attribute
  E1A3  FD7E0D        		LD	A,(IY+13)
  E1A6  12            		LD	(DE),A
  E1A7  13            		INC	DE
                      	;				Reserved
  E1A8  AF            		XOR	A
  E1A9  060A          		LD	B,10
  E1AB                	SDE1:
  E1AB  12            		LD	(DE),A
  E1AC  13            		INC	DE
  E1AD  10FC          		DJNZ	SDE1
                      	;				TIME
  E1AF  FD7E16        		LD	A,(IY+22)
  E1B2  12            		LD	(DE),A
  E1B3  13            		INC	DE
  E1B4  FD7E17        		LD	A,(IY+23)
  E1B7  12            		LD	(DE),A
  E1B8  13            		INC	DE
                      	;				DATE
  E1B9  FD7E14        		LD	A,(IY+20)
  E1BC  12            		LD	(DE),A
  E1BD  13            		INC	DE
  E1BE  FD7E15        		LD	A,(IY+21)
  E1C1  12            		LD	(DE),A
  E1C2  13            		INC	DE
                      	;				First cluster
  E1C3  FD7E1A        		LD	A,(IY+26)
  E1C6  12            		LD	(DE),A
  E1C7  13            		INC	DE
  E1C8  FD7E1B        		LD	A,(IY+27)
  E1CB  12            		LD	(DE),A
  E1CC  13            		INC	DE
                      	;				SIZE
  E1CD  FD7E10        		LD	A,(IY+16)
  E1D0  12            		LD	(DE),A
  E1D1  13            		INC	DE
  E1D2  FD7E11        		LD	A,(IY+17)
  E1D5  12            		LD	(DE),A
  E1D6  13            		INC	DE
  E1D7  FD7E12        		LD	A,(IY+18)
  E1DA  12            		LD	(DE),A
  E1DB  13            		INC	DE
  E1DC  FD7E13        		LD	A,(IY+19)
  E1DF  12            		LD	(DE),A
                      	
  E1E0  AF            		XOR	A
  E1E1  E1            		POP	HL
  E1E2  D1            		POP	DE
  E1E3  C9            		RET
                      	
  E1E4                	WOPEN:
  E1E4  FD7E0D        		LD	A,(IY+13)
  E1E7  E61F          		AND	01FH
  E1E9  37            		SCF
  E1EA  C0            		RET	NZ
  E1EB  FD361CFE      		LD	(IY+28),0FEH	;Open
  E1EF                	TOPEN2:
  E1EF  AF            		XOR	A
  E1F0                	TOPEN:
  E1F0  FD3617FF      		LD	(IY+23),0FFH	;Initializes the time stamp
  E1F4  C9            		RET
                      	
  E1F5                	WRDFX:
  E1F5  41            		LD	B,C
  E1F6  04            		INC	B
  E1F7  3E37          		LD	A,037H
  E1F9  3222E6        		LD	(DRDN1),A
                      	
  E1FC                	WRDF:
  E1FC  110200        		LD	DE,2
  E1FF                	WRDF1:
  E1FF  C5            		PUSH	BC
  E200  D5            		PUSH	DE
  E201  CDF7EC        		CALL	_GNCL
  E204  381C          		JR	C,WRDF3
  E206  7A            		LD	A,D
  E207  B3            		OR	E
  E208  2027          		JR	NZ,WRDF4
  E20A  E1            		POP	HL
  E20B  E5            		PUSH	HL
  E20C  ED5B56E3      		LD	DE,(_CLPS)
  E210  2256E3        		LD	(_CLPS),HL
  E213  7A            		LD	A,D
  E214  B3            		OR	E
  E215  2008          		JR	NZ,WRDF2
  E217  FD751A        		LD	(IY+26),L	;Start cluster
  E21A  FD741B        		LD	(IY+27),H
  E21D  1803          		JR	WRDF3
  E21F                	WRDF2:
  E21F  CDFAEC        		CALL	_SNCL
  E222                	WRDF3:
  E222  D1            		POP	DE
  E223  C1            		POP	BC
  E224  D8            		RET	C
  E225  100C          		DJNZ	WRDF5
  E227  ED5B56E3      		LD	DE,(_CLPS)
  E22B  21FFFF        		LD	HL,0FFFFH
  E22E  C3FAEC        		JP	_SNCL
                      	
  E231                	WRDF4:
  E231  D1            		POP	DE
  E232  C1            		POP	BC
  E233                	WRDF5:
  E233  13            		INC	DE
  E234  CD5DE0        		CALL	ENDCL
  E237  38C6          		JR	C,WRDF1
  E239  37            		SCF
  E23A  C9            		RET
                      	
  E23B                	RWXR:
  E23B  CB38          		SRL	B
  E23D  CB19          		RR	C
  E23F  CB38          	IBM4:	SRL	B	;自己書き換え 1024=SRL B / 512=JR +2(直後のRR Cを飛ばす)
  E241  CB19          		RR	C
                      	
  E243  FD5E1A        		LD	E,(IY+26)	;Cluster
  E246  FD561B        		LD	D,(IY+27)
  E249                	RWX1:
  E249  ED5356E3      		LD	(_CLPS),DE
  E24D  7A            		LD	A,D
  E24E  B3            		OR	E
  E24F  37            		SCF
  E250  C8            		RET	Z
                      	
  E251  78            		LD	A,B
  E252  B1            		OR	C
  E253  C8            		RET	Z
                      	
  E254  CDF7EC        		CALL	_GNCL
  E257  D8            		RET	C
  E258  0B            		DEC	BC
  E259  CD5DE0        		CALL	ENDCL
  E25C  38EB          		JR	C,RWX1
  E25E  37            		SCF
  E25F  C9            		RET
                      	
  E260                	DSKF:
  E260  110000        	MAXCLP:	LD	DE,0
  E263  210000        		LD	HL,0
  E266                	DSKF1:
  E266  D5            		PUSH	DE
  E267  CDF7EC        		CALL	_GNCL
  E26A  380C          		JR	C,POPSCF
  E26C  7A            		LD	A,D
  E26D  B3            		OR	E
  E26E  2001          		JR	NZ,DSKF2
  E270  23            		INC	HL
  E271                	DSKF2:
  E271  D1            		POP	DE
  E272  1B            		DEC	DE
  E273  7A            		LD	A,D
  E274  B3            		OR	E
  E275  20EF          		JR	NZ,DSKF1
  E277  C9            		RET
                      	
  E278                	POPSCF:
  E278  F1            		POP	AF
  E279  37            		SCF
  E27A  C9            		RET
                      	
  E27B                	SETTMS:
  E27B  FD7E17        		LD	A,(IY+23)
  E27E  3C            		INC	A
  E27F  C0            		RET	NZ
  E280                	SETTMSX:
  E280  CDD7D8        		CALL	_SYS2C
                      	
  E283  CB25          		SLA	L
  E285  CB25          		SLA	L
  E287  29            		ADD	HL,HL
  E288  29            		ADD	HL,HL
  E289  29            		ADD	HL,HL
  E28A  7A            		LD	A,D
  E28B  0F            		RRCA
  E28C  E61F          		AND	01FH
  E28E  B5            		OR	L
  E28F  6F            		LD	L,A
  E290  FD7516        		LD	(IY+22),L
  E293  FD7417        		LD	(IY+23),H
                      	
  E296  CD9DD8        		CALL	_SYS2A
                      	
  E299  0144F8        		LD	BC,0-1980
  E29C  09            		ADD	HL,BC
  E29D  65            		LD	H,L
                      	
  E29E  7A            		LD	A,D
  E29F  87            		ADD	A,A
  E2A0  87            		ADD	A,A
  E2A1  87            		ADD	A,A
  E2A2  87            		ADD	A,A
  E2A3  6F            		LD	L,A
  E2A4  29            		ADD	HL,HL
  E2A5  7D            		LD	A,L
  E2A6  B3            		OR	E
  E2A7  6F            		LD	L,A
  E2A8  FD7514        		LD	(IY+20),L
  E2AB  FD7415        		LD	(IY+21),H
  E2AE  C9            		RET
                      	
  E2AF                	PUSHRR:
  E2AF  CDB5E2        		CALL	SUBRR
  E2B2                	POPRR1:
  E2B2  EDB0          		LDIR
  E2B4  C9            		RET
                      	
  E2B5                	SUBRR:
  E2B5  FDE5          		PUSH	IY
  E2B7  E1            		POP	HL
  E2B8  112100        		LD	DE,33
  E2BB  19            		ADD	HL,DE
  E2BC  114FE3        		LD	DE,HLBUF
  E2BF  010300        		LD	BC,3
  E2C2  C9            		RET
                      	
  E2C3                	SETSEQ:
  E2C3  F5            		PUSH	AF
  E2C4  FD7E21        		LD	A,(IY+33)
  E2C7  FD6E22        		LD	L,(IY+34)
  E2CA  FD6623        		LD	H,(IY+35)
                      	
  E2CD  CDE9E2        		CALL	SSQ1
                      	
  E2D0  29            		ADD	HL,HL
  E2D1  CB3D          		SRL	L
  E2D3  FD7520        		LD	(IY+32),L
  E2D6  FD740C        		LD	(IY+12),H
  E2D9  F1            		POP	AF
                      	
  E2DA                	POPRR:
  E2DA  CDB5E2        		CALL	SUBRR
  E2DD  EB            		EX	DE,HL
  E2DE  18D2          		JR	POPRR1
                      	
  E2E0                	GETSIZE:
  E2E0  FD7E10        		LD	A,(IY+16)
  E2E3  FD6E11        		LD	L,(IY+17)
  E2E6  FD6612        		LD	H,(IY+18)
  E2E9                	SSQ1:
  E2E9  87            		ADD	A,A
  E2EA  ED6A          		ADC	HL,HL
  E2EC  B7            		OR	A
  E2ED  C8            		RET	Z
  E2EE  23            		INC	HL
  E2EF  C9            		RET
                      	
  E2F0                	GETSEQ:
  E2F0  FD6E20        		LD	L,(IY+32)
  E2F3  FD660C        		LD	H,(IY+12)
                      	
  E2F6  CB25          		SLA	L
                      	
  E2F8  CB3C          		SRL	H
  E2FA  CB1D          		RR	L
  E2FC  C9            		RET
                      	
  E2FD                	RB_WRITE:
  E2FD  C5            		PUSH	BC
  E2FE  ED4B4CEC      		LD	BC,(STABLE+2*026H)
  E302  1805          		JR	RBRW
  E304                	RB_READ:
  E304  C5            		PUSH	BC
  E305  ED4B4EEC      		LD	BC,(STABLE+2*027H)
  E309                	RBRW:
  E309  AF            		XOR	A	;HLA = HL*128
  E30A  CB3C          		SRL	H
  E30C  CB1D          		RR	L
  E30E  1F            		RRA
  E30F  FD7721        		LD	(IY+33),A
  E312  FD7522        		LD	(IY+34),L
  E315  FD7423        		LD	(IY+35),H
  E318  218000        		LD	HL,128
                      	
  E31B  FDE5          		PUSH	IY
  E31D  D1            		POP	DE
  E31E  D5            		PUSH	DE
  E31F  CD26E3        		CALL	JP_BC
  E322  FDE1          		POP	IY
  E324  C1            		POP	BC
  E325  C9            		RET
  E326                	JP_BC:
  E326  C5            		PUSH	BC
  E327  C9            		RET
                      	
  E328                	SCDIR:	DS	2		;+14 +15
  E32A                	SFBPS:	DS	2		;FBPS
  E32C                	SFNDF:	DS	2		;FILEN DIRF
  E32E                	SFILE:	DS	33		;DRV FILENAME
  E34F                	HLBUF:	DS	3		;Random record buffer
                      	
  E352  0000          	_FATPS:	DW	0
  E354  0000          	_DIRPS:	DW	0
  E356  0000          	_CLPS:	DW	0
                      	
                      	;LDFILE2.ASM
                      	
                      	;	LSX-Dodgers FILE2
                      	
  E358                	RBWDD:
  E358  E5            		PUSH	HL
  E359  C1            		POP	BC
  E35A  2132E4        		LD	HL,NUL
  E35D  CD66E4        		CALL	DDX
  E360  2003          		JR	NZ,RBWDD2
  E362  2A08EC        		LD	HL,(STABLE+2*4)
  E365                	RBWDD2:
  E365  FE43          		CP	'C'
  E367  2003          		JR	NZ,RBWDD3
  E369  21C9DA        		LD	HL,PRINTS
  E36C                	RBWDD3:
  E36C  FE50          		CP	'P'
  E36E  2003          		JR	NZ,RBWDD4
  E370  2A0AEC        		LD	HL,(STABLE+2*5)
  E373                	RBWDD4:
  E373  2281E3        		LD	(RBWDDP+1),HL
  E376  2A8AEC        		LD	HL,(_DTA)
  E379                	RBWDD1:
  E379  78            		LD	A,B
  E37A  B1            		OR	C
  E37B                	RBWDD5:
  E37B  CA2DE4        		JP	Z,RBW1
  E37E  5E            		LD	E,(HL)
  E37F  23            		INC	HL
  E380  CDAED7        	RBWDDP:	CALL	_SYS02
  E383  DA49E4        		JP	C,RBRERR
  E386  3E1A          		LD	A,01AH
  E388  BB            		CP	E
  E389  28F0          		JR	Z,RBWDD5
  E38B  0B            		DEC	BC
  E38C  18EB          		JR	RBWDD1
                      	
                      					;Write random block
  E38E                	_SYS26:		;(BDOS)ランダム・ブロック・ライト
  E38E  AF            		XOR	A
  E38F  3222E6        		LD	(DRDN1),A
  E392  22DCE5        		LD	(LEFT+1),HL	;Write record byte
  E395  22FEE5        		LD	(LEFTX),HL
  E398  CD68DE        		CALL	SETDRV
                      	
  E39B  CD50E5        		CALL	RBX0
  E39E  DA34E4        		JP	C,RBWERR
  E3A1  28B5          		JR	Z,RBWDD
  E3A3  CDE4E1        		CALL	WOPEN
  E3A6  DA34E4        		JP	C,RBWERR
  E3A9  7C            		LD	A,H
  E3AA  B5            		OR	L
  E3AB  CA2DE4        		JP	Z,RBW1
                      	
  E3AE  2B            		DEC	HL
                      	
  E3AF  CDF4E5        		CALL	CDERR		;CDE=Random record
                      	
  E3B2  AF            		XOR	A
  E3B3  19            		ADD	HL,DE
  E3B4  89            		ADC	A,C
  E3B5  47            		LD	B,A
  E3B6  4C            		LD	C,H
  E3B7  CD3BE2        		CALL	RWXR
  E3BA  DCF5E1        		CALL	C,WRDFX
  E3BD  DA34E4        		JP	C,RBWERR
                      	
  E3C0  CD79E5        		CALL	RBX2
  E3C3  281A          		JR	Z,RBWB
  E3C5  CD8CE5        		CALL	RBXA
  E3C8  386A          		JR	C,RBWERR
  E3CA  EB            		EX	DE,HL
  E3CB  C5            		PUSH	BC
  E3CC  EDB0          		LDIR
  E3CE  2200E6        		LD	(DTAX),HL
                      	
  E3D1  CD69E1        		CALL	SWTDBF
                      	
  E3D4  2AFEE5        		LD	HL,(LEFTX)
  E3D7  D1            		POP	DE
  E3D8  ED52          		SBC	HL,DE
  E3DA  22FEE5        		LD	(LEFTX),HL
  E3DD  282E          		JR	Z,RBWEND
                      	
  E3DF                	RBWB:
  E3DF  CDC0E5        		CALL	RBXB
  E3E2  2813          		JR	Z,RBWC
  E3E4                	RBWB1:
  E3E4  C5            		PUSH	BC
  E3E5  D5            		PUSH	DE
  E3E6  CD52E0        		CALL	CLUST
  E3E9  CD7CE8        		CALL	DWTC
  E3EC  D1            		POP	DE
  E3ED  C1            		POP	BC
  E3EE  3844          		JR	C,RBWERR
  E3F0  CDF7EC        		CALL	_GNCL
  E3F3  383F          		JR	C,RBWERR
  E3F5  10ED          		DJNZ	RBWB1
  E3F7                	RBWC:
  E3F7  CDD0E5        		CALL	RBXC
  E3FA  2811          		JR	Z,RBWEND
                      	
  E3FC  CD52E0        		CALL	CLUST
  E3FF  CD21E6        		CALL	DRDN
  E402  3830          		JR	C,RBWERR
  E404  ED5B7EEC      		LD	DE,(_DTBUF)
  E408  EDB0          		LDIR
  E40A  CD69E1        		CALL	SWTDBF
  E40D                	RBWEND:
  E40D  CDDBE5        		CALL	RBXEND
                      	
  E410  CD5FE5        		CALL	RBX1
  E413  3018          		JR	NC,RBW1
  E415  2ADCE5        		LD	HL,(LEFT+1)
  E418  FD5E10        		LD	E,(IY+16)	;CDE=File size
  E41B  FD5611        		LD	D,(IY+17)
  E41E  FD4E12        		LD	C,(IY+18)
  E421  AF            		XOR	A
  E422  19            		ADD	HL,DE
  E423  89            		ADC	A,C
  E424  FD7510        		LD	(IY+16),L
  E427  FD7411        		LD	(IY+17),H
  E42A  FD7712        		LD	(IY+18),A
  E42D                	RBW1:
  E42D  FDE1          		POP	IY
  E42F  C1            		POP	BC
  E430  D1            		POP	DE
  E431  E1            		POP	HL
  E432                	NUL:
  E432  AF            		XOR	A
  E433  C9            		RET
                      	
  E434                	RBWERR:
  E434  FDE5          		PUSH	IY
  E436  D1            		POP	DE
  E437  2A20EC        		LD	HL,(STABLE+2*010H)
  E43A  CD0F00        		CALL	JP_HL
  E43D                	RBRERR1:
  E43D  3E01          		LD	A,001H
  E43F                	RBRERR2:
  E43F  FDE1          		POP	IY
  E441  C1            		POP	BC
  E442  D1            		POP	DE
  E443  E1            		POP	HL
  E444  37            		SCF
  E445  210000        		LD	HL,0
  E448  C9            		RET
                      	
  E449                	RBRERR:
  E449  3EFF          		LD	A,0FFH
  E44B  18F2          		JR	RBRERR2
                      	
  E44D                	RBRFL:
  E44D  3E00          	RBRFLP:	LD	A,000H
  E44F  FE0D          		CP	00DH
  E451  2005          		JR	NZ,RBRFL1
  E453  D5            		PUSH	DE
  E454  1E0A          		LD	E,00AH
  E456  1805          		JR	RBRFL2
  E458                	RBRFL1:
  E458  D5            		PUSH	DE
  E459  CDF4DA        		CALL	_SYS07
  E45C  5F            		LD	E,A
  E45D                	RBRFL2:
  E45D  CDCDEC        		CALL	_PRINT
  E460  7B            		LD	A,E
  E461  D1            		POP	DE
  E462  324EE4        		LD	(RBRFLP+1),A
  E465  C9            		RET
  E466                	DDX:
  E466  FD7E01        		LD	A,(IY+1)
  E469  CD65E0        		CALL	CAP
  E46C  FE41          		CP	'A'
  E46E  C9            		RET
                      	
  E46F                	RBRDD:
  E46F  E5            		PUSH	HL
  E470  C1            		POP	BC
  E471  214DE4        		LD	HL,RBRFL
  E474  CD66E4        		CALL	DDX
  E477  2005          		JR	NZ,RBRDD2
  E479  2A06EC        		LD	HL,(STABLE+2*3)
  E47C  1804          		JR	RBRDD3
  E47E                	RBRDD2:
  E47E  FE43          		CP	'C'
  E480  202C          		JR	NZ,RBRDERR
  E482                	RBRDD3:
  E482  2292E4        		LD	(RBRDDP+1),HL
                      	
  E485  ED5B8AEC      		LD	DE,(_DTA)
  E489  210000        		LD	HL,0
  E48C                	RBRDD1:
  E48C  78            		LD	A,B
  E48D  B1            		OR	C
  E48E  2818          		JR	Z,RBRDDE1
  E490  23            		INC	HL
  E491  CD4DE4        	RBRDDP:	CALL	RBRFL
  E494  380D          		JR	C,RBRDDE
  E496  FE1A          		CP	01AH
  E498  2809          		JR	Z,RBRDDE
  E49A  FE03          		CP	3
  E49C  2805          		JR	Z,RBRDDE
  E49E  12            		LD	(DE),A
  E49F  13            		INC	DE
  E4A0  0B            		DEC	BC
  E4A1  18E9          		JR	RBRDD1
                      	
  E4A3                	RBRDDE:
  E4A3  3E1A          		LD	A,01AH
  E4A5  12            		LD	(DE),A
  E4A6                	RBRDDE2:
  E4A6  AF            		XOR	A
  E4A7  3C            		INC	A
  E4A8                	RBRDDE1:
  E4A8  323CE5        		LD	(RBRAP+1),A
  E4AB  C335E5        		JP	RBREND0
  E4AE                	RBRDERR:
  E4AE  210000        		LD	HL,0
  E4B1  18F3          		JR	RBRDDE2
                      	
                      					;Read random block
  E4B3                	_SYS27:		;(BDOS)ランダム・ブロック・リード	
  E4B3  22FEE5        		LD	(LEFTX),HL
  E4B6  CD68DE        		CALL	SETDRV
                      	
  E4B9  FDCB0D66      		BIT	4,(IY+13)
  E4BD  C23EE5        		JP	NZ,RBRDIR
  E4C0  CD50E5        		CALL	RBX0
  E4C3  DA49E4        		JP	C,RBRERR
  E4C6  28A7          		JR	Z,RBRDD
  E4C8  CD5FE5        		CALL	RBX1
  E4CB  DA3DE4        		JP	C,RBRERR1
  E4CE  79            		LD	A,C
  E4CF  EB            		EX	DE,HL
  E4D0  ED52          		SBC	HL,DE		;CP 0HL,CDE
  E4D2  19            		ADD	HL,DE
  E4D3  DE00          		SBC	A,000H
  E4D5  3801          		JR	C,RBR1
  E4D7  EB            		EX	DE,HL
  E4D8                	RBR1:
  E4D8  9F            		SBC	A,A
  E4D9  E601          		AND	1
  E4DB  323CE5        		LD	(RBRAP+1),A
                      	
  E4DE  7C            		LD	A,H
  E4DF  B5            		OR	L
  E4E0  CA35E5        		JP	Z,RBREND0
                      	
  E4E3  22DCE5        		LD	(LEFT+1),HL	;Read record byte
  E4E6  22FEE5        		LD	(LEFTX),HL
                      	
  E4E9  CD79E5        		CALL	RBX2
  E4EC  2819          		JR	Z,RBRB
  E4EE  CD8CE5        		CALL	RBXA
  E4F1  DA49E4        		JP	C,RBRERR
  E4F4  C5            		PUSH	BC
  E4F5  EDB0          		LDIR
  E4F7  ED5300E6      		LD	(DTAX),DE
  E4FB  2AFEE5        		LD	HL,(LEFTX)
  E4FE  D1            		POP	DE
  E4FF  A7            		AND	A
  E500  ED52          		SBC	HL,DE
  E502  22FEE5        		LD	(LEFTX),HL
  E505  282B          		JR	Z,RBREND
                      	
  E507                	RBRB:
  E507  CDC0E5        		CALL	RBXB
  E50A  2812          		JR	Z,RBRC
  E50C                	RBRB1:
  E50C  C5            		PUSH	BC
  E50D  D5            		PUSH	DE
  E50E  CD52E0        		CALL	CLUST
  E511  CD20E8        		CALL	DRDC
  E514  D1            		POP	DE
  E515  C1            		POP	BC
  E516  D4F7EC        		CALL	NC,_GNCL
  E519  DA49E4        		JP	C,RBRERR
  E51C  10EE          		DJNZ	RBRB1
  E51E                	RBRC:
  E51E  CDD0E5        		CALL	RBXC
  E521  280F          		JR	Z,RBREND
                      	
  E523  CD52E0        		CALL	CLUST
  E526  CD09E6        		CALL	DRDX
  E529  DA49E4        		JP	C,RBRERR
  E52C  EB            		EX	DE,HL
  E52D  2A7EEC        		LD	HL,(_DTBUF)
  E530  EDB0          		LDIR
  E532                	RBREND:
  E532  CDDBE5        		CALL	RBXEND
  E535                	RBREND0:
  E535  FDE1          		POP	IY
  E537  C1            		POP	BC
  E538  D1            		POP	DE
  E539  F1            		POP	AF	;(HL)
  E53A  AF            		XOR	A
  E53B  3E00          	RBRAP:	LD	A,000H
  E53D  C9            		RET
                      	
  E53E                	RBRDIR:
  E53E  FD6E1A        		LD	L,(IY+26)
  E541  FD661B        		LD	H,(IY+27)
  E544  CD80E0        		CALL	CHDIR
  E547  AF            		XOR	A
  E548  67            		LD	H,A
  E549  6F            		LD	L,A
  E54A  3C            		INC	A
  E54B  323CE5        		LD	(RBRAP+1),A
  E54E  18E5          		JR	RBREND0
                      	
  E550                	RBX0:
  E550  2A8AEC        		LD	HL,(_DTA)
  E553  2200E6        		LD	(DTAX),HL
  E556  2AFEE5        		LD	HL,(LEFTX)
  E559  FD7E1C        		LD	A,(IY+28)	;Open
  E55C  D6FD          		SUB	0FDH
  E55E  C9            		RET
                      	
  E55F                	RBX1:
  E55F  E5            		PUSH	HL		;Record byte
                      	
  E560  FD6E10        		LD	L,(IY+16)	;AHL=File size
  E563  FD6611        		LD	H,(IY+17)
  E566  FD7E12        		LD	A,(IY+18)
                      	
  E569  CDF4E5        		CALL	CDERR		;CDE=Random record
                      	
  E56C  A7            		AND	A
  E56D  ED52          		SBC	HL,DE
  E56F  99            		SBC	A,C
  E570  D1            		POP	DE
                      	
  E571  D8            		RET	C
  E572  4F            		LD	C,A
  E573  EB            		EX	DE,HL	;CDE=File byte	HL=Record byte
  E574  B2            		OR	D
  E575  B3            		OR	E
  E576  C0            		RET	NZ
  E577  37            		SCF
  E578  C9            		RET
                      	
  E579                	RBX2:
  E579  FD4E22        		LD	C,(IY+34)	;Cluster settings
  E57C  FD4623        		LD	B,(IY+35)
  E57F  CD3BE2        		CALL	RWXR
  E582  3AA1E5        		LD	A,(IBM5+1)	;1024=3 / 512=1
  E585  FDA622        		AND	(IY+34)
  E588  FDB621        		OR	(IY+33)
  E58B  C9            		RET
                      	
  E58C                	RBXA:
  E58C  D5            		PUSH	DE
  E58D  CD52E0        		CALL	CLUST
  E590  CD09E6        		CALL	DRDX
  E593  D1            		POP	DE
  E594  D8            		RET	C
  E595  CDF7EC        		CALL	_GNCL
  E598  D8            		RET	C
  E599  ED5356E3      		LD	(_CLPS),DE
                      	
  E59D  FD4E21        		LD	C,(IY+33)
  E5A0  3E03          	IBM5:	LD	A,3		;自己書き換え 1024=3 / 512=1
  E5A2  FDA622        		AND	(IY+34)
  E5A5  47            		LD	B,A
  E5A6  210004        	IBM7:	LD	HL,1024		;自己書き換え 1024=0400H / 512=0200H ここに1クラスタのサイズが格納される
  E5A9  ED42          		SBC	HL,BC		;remaining cluster
                      	
  E5AB  ED5BFEE5      		LD	DE,(LEFTX)
  E5AF  ED52          		SBC	HL,DE		;CP HL,DE
  E5B1  19            		ADD	HL,DE
  E5B2  3801          		JR	C,RBXA1
  E5B4  EB            		EX	DE,HL
  E5B5                	RBXA1:
  E5B5  E5            		PUSH	HL
  E5B6  2A7EEC        		LD	HL,(_DTBUF)
  E5B9  09            		ADD	HL,BC
  E5BA  ED5B00E6      		LD	DE,(DTAX)
  E5BE  C1            		POP	BC
  E5BF  C9            		RET
                      	
  E5C0                	RBXB:
  E5C0  2A00E6        		LD	HL,(DTAX)
  E5C3  ED5B56E3      		LD	DE,(_CLPS)
  E5C7  3AFFE5        		LD	A,(LEFTX+1)
  E5CA  CB3F          		SRL	A
  E5CC  CB3F          	IBM8:	SRL	A		;自己書き換え 1024=SRL A / 512=NOP NOP
  E5CE  47            		LD	B,A
  E5CF  C9            		RET
                      	
  E5D0                	RBXC:
  E5D0  ED4BFEE5      		LD	BC,(LEFTX)
  E5D4  3AA1E5        		LD	A,(IBM5+1)	;1024=3 / 512=1
  E5D7  A0            		AND	B
  E5D8  47            		LD	B,A
  E5D9  B1            		OR	C
  E5DA  C9            		RET
                      	
  E5DB                	RBXEND:
  E5DB  110000        	LEFT:	LD	DE,0
  E5DE  AF            		XOR	A
  E5DF  FD6E21        		LD	L,(IY+33)
  E5E2  FD6622        		LD	H,(IY+34)
  E5E5  19            		ADD	HL,DE
  E5E6  FD8E23        		ADC	A,(IY+35)
  E5E9  FD7521        		LD	(IY+33),L
  E5EC  FD7422        		LD	(IY+34),H
  E5EF  FD7723        		LD	(IY+35),A
  E5F2  EB            		EX	DE,HL		;HL=Read byte
  E5F3  C9            		RET
                      	
  E5F4                	CDERR:
  E5F4  FD5E21        		LD	E,(IY+33)	;CDE=Random record
  E5F7  FD5622        		LD	D,(IY+34)
  E5FA  FD4E23        		LD	C,(IY+35)
  E5FD  C9            		RET
                      	
  E5FE                	CPBUF:
  E5FE  0000          	LEFTX:	DW	0
  E600  0000          	DTAX:	DW	0
  E602  20            		DB	020H	;DS 7,20h
  E603  20            		DB	020H
  E604  20            		DB	020H
  E605  20            		DB	020H
  E606  20            		DB	020H
  E607  20            		DB	020H
  E608  20            		DB	020H
                      	;
                      	;LDDIO.ASM
                      	
                      	;	LSX-Dodgers DIO
                      	
  E609                	DRDX:
  E609  CD3FE6        		CALL	DRDY
  E60C  C8            		RET	Z
  E60D  CD29E6        		CALL	DRDX1
  E610  D8            		RET	C
  E611  E5            		PUSH	HL
  E612  C5            		PUSH	BC
  E613  D5            		PUSH	DE
  E614  2A7EEC        		LD	HL,(_DTBUF)
  E617  CD20E8        		CALL	DRDC
  E61A  DC3AE6        		CALL	C,DRDNE
  E61D                	POP_DE_BC_HL_RET:
  E61D  D1            		POP	DE
  E61E  C1            		POP	BC
  E61F  E1            		POP	HL
  E620  C9            		RET
                      	
  E621                	DRDN:
  E621  AF            		XOR	A
  E622  00            	DRDN1:	NOP
  E623  30E4          		JR	NC,DRDX
  E625                	DRDNX:
  E625  CD3FE6        		CALL	DRDY
  E628  C8            		RET	Z
  E629                	DRDX1:
  E629  CD50E6        		CALL	DWTX
  E62C  ED53A6EC      		LD	(_DCLPS),DE
  E630  3A88EC        		LD	A,(_DRV)
  E633  32A5EC        		LD	(_DBDRV),A
  E636  CDD9EC        		CALL	_CHGDRV
  E639  D0            		RET	NC
  E63A                	DRDNE:
  E63A  9F            		SBC	A,A
  E63B  32A5EC        		LD	(_DBDRV),A
  E63E  C9            		RET
                      	
  E63F                	DRDY:
  E63F  E5            		PUSH	HL
  E640  3A88EC        		LD	A,(_DRV)
  E643  21A5EC        		LD	HL,_DBDRV
  E646  AE            		XOR	(HL)
  E647  2005          		JR	NZ,POP_HL_RET
                      	
  E649  2AA6EC        		LD	HL,(_DCLPS)
  E64C  ED52          		SBC	HL,DE		;CF=0
  E64E                	POP_HL_RET:
  E64E  E1            		POP	HL
  E64F  C9            		RET
                      	
  E650                	DWTX:
  E650  3AA4EC        		LD	A,(_WTDBF)
  E653  B7            		OR	A
  E654  C8            		RET	Z
  E655  AF            		XOR	A
  E656  32A4EC        		LD	(_WTDBF),A
                      	
  E659  E5            		PUSH	HL
  E65A  C5            		PUSH	BC
  E65B  D5            		PUSH	DE
  E65C  3AA5EC        		LD	A,(_DBDRV)
  E65F  CDD9EC        		CALL	_CHGDRV
  E662  ED5BA6EC      		LD	DE,(_DCLPS)
  E666  2A7EEC        		LD	HL,(_DTBUF)
  E669  D47CE8        		CALL	NC,DWTC
  E66C  18AF          		JR	POP_DE_BC_HL_RET
                      	
  E66E                	RDFATX:
  E66E  E5            		PUSH	HL
  E66F  3A88EC        		LD	A,(_DRV)
  E672  21A3EC        		LD	HL,_FATDRV
  E675  AE            		XOR	(HL)
  E676  E67F          		AND	07FH
  E678  28D4          		JR	Z,POP_HL_RET
                      	
  E67A  C5            		PUSH	BC
  E67B  D5            		PUSH	DE
  E67C  DDE5          		PUSH	IX
  E67E  CD96E6        		CALL	WTFATX
  E681  380F          		JR	C,RDFATE1
                      	
  E683  3A88EC        		LD	A,(_DRV)
  E686  32A3EC        		LD	(_FATDRV),A
  E689  CDE5EC        		CALL	_RDFAT
  E68C                	RDFATE2:
  E68C  3004          		JR	NC,RDFATE1
  E68E  9F            		SBC	A,A
  E68F  32A3EC        		LD	(_FATDRV),A
  E692                	RDFATE1:
  E692  DDE1          		POP	IX
  E694  1887          		JR	POP_DE_BC_HL_RET
                      	
  E696                	WTFATX:
  E696  3AA2EC        		LD	A,(_WTFATF)
  E699  B7            		OR	A
  E69A  C8            		RET	Z
  E69B  E5            		PUSH	HL
  E69C  3AA3EC        		LD	A,(_FATDRV)
  E69F  21A5EC        		LD	HL,_DBDRV
  E6A2  AE            		XOR	(HL)
  E6A3  E67F          		AND	07FH
  E6A5  CC50E6        		CALL	Z,DWTX
  E6A8  38A4          		JR	C,POP_HL_RET
  E6AA  C5            		PUSH	BC
  E6AB  D5            		PUSH	DE
  E6AC  DDE5          		PUSH	IX
  E6AE  CD90E8        		CALL	WTFAT
  E6B1  AF            		XOR	A
  E6B2  32A2EC        		LD	(_WTFATF),A
  E6B5  18DB          		JR	RDFATE1
                      	
  E6B7                	NCL1:
  E6B7  7A            		LD	A,D
  E6B8  B3            		OR	E
  E6B9  37            		SCF
  E6BA  C8            		RET	Z
                      	
  E6BB  3A88EC        		LD	A,(_DRV)
  E6BE  CB5A          		BIT	3,D
  E6C0  2802          		JR	Z,NCL2
  E6C2  F680          		OR	080H
  E6C4                	NCL2:
  E6C4  E5            		PUSH	HL
  E6C5  21A3EC        		LD	HL,_FATDRV
  E6C8  BE            		CP	(HL)
  E6C9  2883          		JR	Z,POP_HL_RET
                      	
  E6CB  C5            		PUSH	BC
  E6CC  D5            		PUSH	DE
  E6CD  DDE5          		PUSH	IX
  E6CF  F5            		PUSH	AF
  E6D0  CD96E6        		CALL	WTFATX
  E6D3  C1            		POP	BC
  E6D4  38BC          		JR	C,RDFATE1
  E6D6  78            		LD	A,B
  E6D7  32A3EC        		LD	(_FATDRV),A
  E6DA  CD6BE8        		CALL	RDFATS
  E6DD  18AD          		JR	RDFATE2
                      	
  E6DF                	NCL3:
  E6DF  CB9A          		RES	3,D
  E6E1  6B            		LD	L,E
  E6E2  62            		LD	H,D
  E6E3  CB3C          		SRL	H
  E6E5  CB1D          		RR	L
  E6E7  1F            		RRA
  E6E8  ED4B7CEC      		LD	BC,(_FATBF)
  E6EC  19            		ADD	HL,DE
  E6ED  09            		ADD	HL,BC
  E6EE  17            		RLA
  E6EF  C9            		RET
                      	
  E6F0                	GNCL:
  E6F0  CDB7E6        		CALL	NCL1		;GET NEW CLUSTER
  E6F3  D8            		RET	C
  E6F4  C5            		PUSH	BC
  E6F5  E5            		PUSH	HL
  E6F6  CDDFE6        		CALL	NCL3
  E6F9  3809          		JR	C,GNC1
  E6FB  5E            		LD	E,(HL)
  E6FC  23            		INC	HL
  E6FD  7E            		LD	A,(HL)
  E6FE  E60F          		AND	00FH
  E700  57            		LD	D,A
  E701  E1            		POP	HL
  E702  C1            		POP	BC
  E703  C9            		RET
  E704                	GNC1:
  E704  7E            		LD	A,(HL)
  E705  23            		INC	HL
  E706  56            		LD	D,(HL)
  E707  0604          		LD	B,4
  E709                	GNC1L:
  E709  CB3A          		SRL	D
  E70B  1F            		RRA
  E70C  10FB          		DJNZ	GNC1L
                      	
  E70E  5F            		LD	E,A
  E70F  E1            		POP	HL
  E710  C1            		POP	BC
  E711  A7            		AND	A
  E712  C9            		RET
                      	
  E713                	SNCL:
  E713  CDB7E6        		CALL	NCL1
  E716  D8            		RET	C
  E717  3E01          		LD	A,1
  E719  32A2EC        		LD	(_WTFATF),A
                      	;				SET NEW CLUSTER
  E71C  E5            		PUSH	HL
  E71D  C5            		PUSH	BC
  E71E  D5            		PUSH	DE
  E71F  E5            		PUSH	HL
  E720  CDDFE6        		CALL	NCL3
  E723  D1            		POP	DE
                      	;CF=ODD
  E724  7E            		LD	A,(HL)
  E725  73            		LD	(HL),E
  E726  3806          		JR	C,SNC1
                      	;EVEN
                      	;M[0] = E
                      	;M[1] = (M[1] & 0xF0) | (D & 0x0F)
  E728  23            		INC	HL
  E729  ED67          		RRD		;M={A[3:0],E[3:0]}
  E72B  7A            		LD	A,D
  E72C  1804          		JR	SNC11
  E72E                	SNC1:
                      	;ODD
                      	;HL[0] = (HL[0]&0x0F) | (E<<4)
                      	;HL[1] = DE>>4
  E72E  ED6F          		RLD		;M={D[3:0],E[7:4]}
  E730  23            		INC	HL
  E731  72            		LD	(HL),D	;M={D[3:0],E[7:4]}
  E732                	SNC11:
  E732  ED6F          		RLD		;M={M[7:4],D[3:0]}
  E734  B7            		OR	A
  E735  D1            		POP	DE
  E736  C1            		POP	BC
  E737  E1            		POP	HL
  E738  C9            		RET
                      	
  E739                	RDFAT0X:
  E739  CD6BE8        		CALL	RDFATS
  E73C  D8            		RET	C
  E73D  DDBE01        		CP	(IX+1)		;DPB_01_FATID
  E740  C8            		RET	Z
  E741  37            		SCF
  E742  C9            		RET
                      	
  E743                	RDFAT:
  E743  3A88EC        		LD	A,(_DRV)
  E746  CDAEE9        		CALL	CHGDRVR
  E749  D8            		RET	C
  E74A  DD7E12        		LD	A,(IX+012H)	;DPB_12_DEVNO
  E74D  FE87          		CP	087H
  E74F  20E8          		JR	NZ,RDFAT0X
                      	
  E751  3E7F          		LD	A,07FH
  E753  3254EA        		LD	(CHECK),A	;A=07FH
  E756  DDCB0A46      		BIT	0,(IX+00AH)	;DPB_0A_FDMODE
  E75A  284D          		JR	Z,X2HX
  E75C                	E2DX:
  E75C  21E4E9        		LD	HL,M2D
  E75F  CD34E8        		CALL	DRDF
  E762  383D          		JR	C,E2HX
  E764  FEFD          		CP	0FDH		;2D
  E766  C8            		RET	Z
  E767  FEF9          		CP	0F9H		;2DD9
  E769  CA13E8        		JP	Z,E2DD9
  E76C  FEFB          		CP	0FBH		;2DD8
  E76E  37            		SCF
  E76F  C0            		RET	NZ		;NOT 2DD
  E770  21F2E9        		LD	HL,M2DD8
  E773                	CHGTYPE:
  E773  D5            		PUSH	DE
  E774  CD86E7        		CALL	CHGDV
  E777  3A84EC        		LD	A,(_DRIVE)
  E77A  E603          		AND	3
  E77C  F680          		OR	080H
  E77E  6F            		LD	L,A
  E77F  26EC          		LD	H,_CYL0/256
  E781  3EFF          		LD	A,0FFH
  E783  77            		LD	(HL),A
  E784  D1            		POP	DE
  E785  C9            		RET
                      	
  E786                	CHGDV:
  E786  DDE5          		PUSH	IX
  E788  D1            		POP	DE
  E789  EDA0          		LDI
  E78B  EDA0          		LDI
  E78D  13            		INC	DE
  E78E  13            		INC	DE
  E78F  13            		INC	DE
  E790  13            		INC	DE
  E791  010C00        		LD	BC,12
  E794  EDB0          		LDIR
  E796                	CHGDV2:
  E796  3EFF          		LD	A,0FFH
  E798  3289EC        		LD	(_DSK),A
  E79B  3A88EC        		LD	A,(_DRV)
  E79E  C3D9EC        		JP	_CHGDRV
                      	
  E7A1                	E2HX:
  E7A1  3C            		INC	A
  E7A2  C8            		RET	Z
  E7A3  2154EA        		LD	HL,CHECK
  E7A6  CB06          		RLC	(HL)
  E7A8  D8            		RET	C
  E7A9                	X2HX:
  E7A9  211CEA        		LD	HL,M2HD
  E7AC  110000        		LD	DE,0
  E7AF  CD38E8        		CALL	DRDD
  E7B2  300A          		JR	NC,X2HX1
  E7B4  3C            		INC	A
  E7B5  C8            		RET	Z
  E7B6  2154EA        		LD	HL,CHECK
  E7B9  CB06          		RLC	(HL)
  E7BB  D8            		RET	C
  E7BC  189E          		JR	E2DX
  E7BE                	X2HX1:
  E7BE  23            		INC	HL
  E7BF  7E            		LD	A,(HL)
  E7C0  06FE          		LD	B,0FEH
  E7C2  FE0C          		CP	00CH
  E7C4  2838          		JR	Z,X2HDE
  E7C6  06F8          		LD	B,0F8H
  E7C8  D620          		SUB	020H		;020H
  E7CA  2832          		JR	Z,X2HDE
  E7CC  3C            		INC	A		;01FH
  E7CD  282F          		JR	Z,X2HDE
  E7CF  3C            		INC	A		;01EH
  E7D0  2074          		JR	NZ,C2HX		;2HD/2HC/2HQ
  E7D2                	X2HS:
  E7D2  2146EA        		LD	HL,M2HS
  E7D5  CD04E8        		CALL	X2HSS
  E7D8  D8            		RET	C
  E7D9  2A7CEC        		LD	HL,(_FATBF)
  E7DC  23            		INC	HL
  E7DD  7E            		LD	A,(HL)		;FATBF+1
  E7DE  FE50          		CP	80
  E7E0  3F            		CCF
  E7E1  D0            		RET	NC
  E7E2  FE5A          		CP	90
  E7E4  D0            		RET	NC
  E7E5  DD770C        		LD	(IX+00CH),A	;DPB_0C_MAXCYL
  E7E8  D650          		SUB	80
  E7EA  87            		ADD	A,A	;*2
  E7EB  4F            		LD	C,A
  E7EC  87            		ADD	A,A	;*4
  E7ED  87            		ADD	A,A	;*8
  E7EE  87            		ADD	A,A	;*16
  E7EF  81            		ADD	A,C	;*18
  E7F0  C698          		ADD	A,098H
  E7F2  DD7708        		LD	(IX+8),A	;DPB_08_MAXCL_LOW
  E7F5  3E05          		LD	A,5
  E7F7  CE00          		ADC	A,0
  E7F9  DD7709        		LD	(IX+9),A	;DPB_08_MAXCL_HIGH
  E7FC  1898          		JR	CHGDV2
  E7FE                	X2HDE:
  E7FE  2138EA        		LD	HL,M2HDE
  E801  23            		INC	HL
  E802  70            		LD	(HL),B
  E803  2B            		DEC	HL
  E804                	X2HSS:
  E804  CD34E8        		CALL	DRDF
  E807  D8            		RET	C
  E808  DDBE01        		CP	(IX+1)		;DPB_01_FATID
  E80B  37            		SCF
  E80C  C0            		RET	NZ
  E80D  CD1CE8        		CALL	INCDRD
  E810  300E          		JR	NC,DRDC
  E812  C9            		RET
                      	
  E813                	E2DD9:
  E813  2100EA        		LD	HL,M2DD
  E816  CD73E7        		CALL	CHGTYPE
  E819  2A7CEC        		LD	HL,(_FATBF)
  E81C                	INCDRD:
  E81C  24            		INC	H
  E81D  24            		INC	H
  E81E  24            		INC	H
  E81F  24            		INC	H
  E820                	DRDC:
  E820  3A55E0        		LD	A,(DBLPAT)
  E823  B7            		OR	A
  E824  C428E8        		CALL	NZ, DRD_DPB
  E827  D8            		RET	C
  E828                	DRD_DPB:
  E828  DDE5          		PUSH	IX
  E82A  DD2AA8EC      		LD	IX,(_DPB)
  E82E  CD56EB        	DRDPAT:	CALL	FDRD		;自己書き換え（ディスク読み込み）
  E831  DDE1          		POP	IX
  E833  C9            		RET
                      	
  E834                	DRDF:
  E834  ED5B52E3      		LD	DE,(_FATPS)
  E838                	DRDD:
  E838  CD73E7        		CALL	CHGTYPE
  E83B  2A7CEC        		LD	HL,(_FATBF)
  E83E  E5            		PUSH	HL
  E83F  CD20E8        		CALL	DRDC
  E842  E1            		POP	HL
  E843  D8            		RET	C
  E844  7E            		LD	A,(HL)
  E845  C9            		RET
                      	
  E846                	C2HX:
  E846  CD6BE8        		CALL	RDFATS
  E849  D8            		RET	C
  E84A  FEFE          		CP	0FEH	;2HD
  E84C  C8            		RET	Z
  E84D  212AEA        		LD	HL,M2HQ
  E850  FEF0          		CP	0F0H
  E852  2807          		JR	Z,X2HQ
  E854  FEF9          		CP	0F9H
  E856  37            		SCF
  E857  C0            		RET	NZ
  E858  210EEA        		LD	HL,M2HC
  E85B                	X2HQ:
  E85B  CD73E7        		CALL	CHGTYPE
  E85E  CDB6E8        		CALL	FATS2
  E861  24            		INC	H	;前2クラスタはすでに読み込まれているのでスキップ
  E862  24            		INC	H
  E863  05            		DEC	B
  E864  13            		INC	DE
  E865  24            		INC	H	;
  E866  24            		INC	H
  E867  05            		DEC	B
  E868  13            		INC	DE
  E869  1804          		JR	RDFATL
  E86B                	RDFATS:
  E86B  CDAFE8        		CALL	FATS
  E86E  D8            		RET	C
  E86F                	RDFATL:
  E86F  C5            		PUSH	BC
  E870  CD28E8        		CALL	DRD_DPB
  E873  C1            		POP	BC
  E874  D8            		RET	C
  E875  10F8          		DJNZ	RDFATL
  E877  2A7CEC        		LD	HL,(_FATBF)
  E87A  7E            		LD	A,(HL)
  E87B  C9            		RET
                      	
  E87C                	DWTC:
  E87C  3A55E0        		LD	A,(DBLPAT)
  E87F  B7            		OR	A
  E880  C484E8        		CALL	NZ,DWT_DPB
  E883  D8            		RET	C
  E884                	DWT_DPB
  E884  DDE5          		PUSH	IX
  E886  DD2AA8EC      		LD	IX,(_DPB)
  E88A  CD4DEB        	DWTPAT:	CALL	FDWT		;自己書き換え（ディスク書き込み）
  E88D  DDE1          		POP	IX
  E88F  C9            		RET
                      	
  E890                	WTFAT:
  E890  CDAFE8        		CALL	FATS
  E893  D4A6E8        		CALL	NC,WTFATL
  E896  D8            		RET	C
  E897  DDCB0F4E      		BIT	1,(IX+00FH)	;DPB_0F_FATS
  E89B  C8            		RET	Z
  E89C  CDB6E8        		CALL	FATS2
  E89F  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E8A2                	WTFAT2:
  E8A2  13            		INC	DE
  E8A3  3D            		DEC	A
  E8A4  20FC          		JR	NZ,WTFAT2
  E8A6                	WTFATL:
  E8A6  C5            		PUSH	BC
  E8A7  CD84E8        		CALL	DWT_DPB
  E8AA  C1            		POP	BC
  E8AB  D8            		RET	C
  E8AC  10F8          		DJNZ	WTFATL
  E8AE  C9            		RET
                      	;------------------------
                      	;FATのセットアップ
                      	;out
                      	;	B  : FATセクタ数
                      	;	DE : FAT先頭セクタ番号
                      	;	HL : FATバッファポインタ
                      	;	CF : 1=ドライブ切り替えエラー
                      	;note
                      	;	FATサイズがFATバッファを超える場合は
                      	;	対象クラスタ領域==(_FATDRV).bit7によって
                      	;	FATの前半3KBと後半3KBを切り替える
                      	;------------------------
  E8AF                	FATS:
  E8AF  3AA3EC        		LD	A,(_FATDRV)
  E8B2  CDAEE9        		CALL	CHGDRVR		;ドライブ切り替え
  E8B5  D8            		RET	C
  E8B6                	FATS2:
  E8B6  ED5B52E3      		LD	DE,(_FATPS)	;fat sector pos
  E8BA  2A7CEC        		LD	HL,(_FATBF)
  E8BD  DD4600        		LD	B,(IX+0)	;DPB_00_FATLN
  E8C0  DD7E07        		LD	A,(IX+7)	;DPB_07_DBLCL $29=512 / 0=1024
  E8C3  B7            		OR	A
  E8C4  3E06          		LD	A,6		;3072 / 512 FATバッファに読み込めるセクタ数
  E8C6  2007          		JR	NZ,FATS512
  E8C8  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  E8CC  2001          		JR	NZ,FATS512
  E8CE  1F            		RRA			;A=3 (3072÷1024: 1セクタ1024バイトの場合)
  E8CF                	FATS512:
  E8CF  B8            		CP	B
  E8D0  D0            		RET	NC		;DPB_0F_FATS x sectorSize < fatBufSize
                      	;targetCluster
  E8D1  4F            		LD	C,A		;C = skipCount
  E8D2  3AA3EC        		LD	A,(_FATDRV)	;bit7 = (targetCluster >= 0x800)
  E8D5  87            		ADD	A,A		;CF=(_FATDRV).bit7
  E8D6  3006          		JR	NC,FATS3
                      	;(targerCluster>=0x800)
  E8D8                	FAT_SKP:
  E8D8  13            		INC	DE		;FATPS++
  E8D9  05            		DEC	B		;FATSIZE--
  E8DA  0D            		DEC	C		;skipCnt--
  E8DB  20FB          		JR	NZ,FAT_SKP
  E8DD  48            		LD	C,B
  E8DE                	FATS3:
  E8DE  41            		LD	B,C		;3 or 6
  E8DF  AF            		XOR	A
  E8E0  C9            		RET
                      	
  E8E1                	CHGDRV:
  E8E1  E67F          		AND	07FH
  E8E3  E5            		PUSH	HL
  E8E4  2189EC        		LD	HL,_DSK
  E8E7  BE            		CP	(HL)
  E8E8  280A          		JR	Z,CHGDRVE
  E8EA                	CHGDRV1:
  E8EA  DDE5          		PUSH	IX
  E8EC  CDF6E8        		CALL	CHGDRV0
  E8EF  3A89EC        		LD	A,(_DSK)
  E8F2  DDE1          		POP	IX
  E8F4                	CHGDRVE:
  E8F4  E1            		POP	HL
  E8F5  C9            		RET
                      	
  E8F6                	CHGDRV0:
  E8F6  6F            		LD	L,A
  E8F7  CDDCEC        		CALL	_GETDPB
  E8FA  D8            		RET	C
                      	
  E8FB  DD22A8EC      		LD	(_DPB),IX
  E8FF  7D            		LD	A,L
  E900  3289EC        		LD	(_DSK),A
                      	
  E903  F3            		DI
  E904  ED736BE9      		LD	(SPPAT2+1),SP
                      	
  E908  DDF9          		LD	SP,IX
                      	
  E90A  E1            		POP	HL		;L=DPB_00_FATLN H=DPB_01_FATID
  E90B  E1            		POP	HL		;DPB_02_DRDC
  E90C  222FE8        		LD	(DRDPAT+1),HL
                      	
  E90F  E1            		POP	HL
  E910  228BE8        		LD	(DWTPAT+1),HL	;DPB_04_DWTC
                      	
  E913  E1            		POP	HL		;L=DPB_06_ADDCL H=DPB_07_DBLCL
  E914  2254E0        		LD	(CLSPAT+1),HL	;ADDCL & CLSPAT
                      	
  E917  E1            		POP	HL		;DPB_08_MAXCL
  E918  7D            		LD	A,L
  E919  3263E0        		LD	(CLPAT2+1),A
  E91C  7C            		LD	A,H
  E91D  325FE0        		LD	(CLPAT1+1),A
  E920  2B            		DEC	HL
  E921  2261E2        		LD	(MAXCLP+1),HL
                      	
  E924  E1            		POP	HL		;L=DPB_0A_FDMODE H=DPB_0B_MAXDIR
  E925  7D            		LD	A,L
  E926  F6FE          		OR	0FEH
  E928  32CEEA        		LD	(FDMODE+1),A
  E92B  07            		RLCA
  E92C  E603          		AND	3
  E92E  32B6EA        		LD	(FSPAT+1),A
  E931  7C            		LD	A,H
  E932  3261DF        		LD	(RTEPAT+1),A
                      	
  E935  E1            		POP	HL		;L=DPB_0C_MAXCYL H=DPB_0D_MAXSEC
  E936  7D            		LD	A,L
  E937  32A1EC        		LD	(_MAXCYL),A
  E93A  7C            		LD	A,H
  E93B  325EEA        		LD	(MAXSEC+1),A
                      	
  E93E  E1            		POP	HL		;L=DPB_0E_FATPS H=DPB_0F_FATS
  E93F  2600          		LD	H,0
  E941  2252E3        		LD	(_FATPS),HL
                      	
  E944  E1            		POP	HL		;L=DPB_10_DIRPS H=DPB_11_MINSEC
  E945  7C            		LD	A,H
  E946  326BEA        		LD	(SECPAT+1),A
  E949  2600          		LD	H,0
  E94B  2254E3        		LD	(_DIRPS),HL
                      	
  E94E  E1            		POP	HL		;L=DPB_12_DEVNO H=DPB_13_UNITNO
  E94F  7C            		LD	A,H
  E950  3284EC        		LD	(_DRIVE),A
                      	
  E953  E1            		POP	HL		;DPB_14
  E954  E1            		POP	HL		;DPB_16_GNCL
  E955  7C            		LD	A,H
  E956  B5            		OR	L
  E957  2003          		JR	NZ,OGNCL
  E959  21F0E6        		LD	HL,GNCL		;FAT12(default)
  E95C                	OGNCL:
  E95C  22F8EC        		LD	(_GNCL+1),HL
                      	
  E95F  E1            		POP	HL		;DPB_18_SNCL
  E960  7C            		LD	A,H
  E961  B5            		OR	L
  E962  2003          		JR	NZ,OSNCL
  E964  2113E7        		LD	HL,SNCL		;FAT12(default)
  E967                	OSNCL:
  E967  22FBEC        		LD	(_SNCL+1),HL
                      	
  E96A  310000        	SPPAT2:	LD	SP,0		;元のSPを復元
  E96D  FB            		EI
  E96E  D5            		PUSH	DE
  E96F  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  E973  280A          		JR	Z,NEC
                      					;1クラスタ512 2HC/2HQ(2HD1.44MB)等
  E975  111802        		LD	DE,00218H	;JR +2(直後のRR Cを飛ばす)
  E978  210000        		LD	HL,0
                      	
  E97B  3E01          		LD	A,1
  E97D  1808          		JR	NEC1
  E97F                	NEC:
                      					;1クラスタ1024 2D/2DD/2HD/EMM/BRAM/GRAM等
  E97F  11            		DB	011H		;LD DE,SRL B
  E980  CB38          		SRL B			;
  E982  21            		DB	021H		;LD HL,SRL A
  E983  CB3F          		SRL A			;
                      	
  E985  3E03          		LD	A,3
  E987                	NEC1:				;1024	512
  E987  32A1E5        		LD	(IBM5+1),A	;3	1	1クラスタのサイズ-1したものの上位1バイト (0x3FF - 0x1FF)
  E98A  3C            		INC	A		;4	2
  E98B  32A8E5        		LD	(IBM7+2),A	;1クラスタのサイズの上位1バイト 0x400 - 0x200
  E98E  87            		ADD	A,A		;8	4
  E98F  87            		ADD	A,A		;010H	8
  E990  87            		ADD	A,A		;020H	010H
  E991  32EEDE        		LD	(IBM1+1),A	;1クラスタ辺りのディレクトリエントリ数
  E994  87            		ADD	A,A		;040H	020H
  E995  87            		ADD	A,A		;080H	040H
  E996  87            		ADD	A,A		;000H	080H
  E997  2F            		CPL			;0FFH	07FH
  E998  3266D4        		LD	(IBM2+1),A
  E99B  ED533FE2      		LD	(IBM4),DE
  E99F  22CCE5        		LD	(IBM8),HL
  E9A2  D1            		POP	DE
  E9A3  AF            		XOR	A
  E9A4  C9            		RET
                      	
  E9A5                	GETDPBD:
  E9A5  DDE3          		EX	(SP),IX
  E9A7  DDE5          		PUSH	IX
  E9A9  3A88EC        		LD	A,(_DRV)
  E9AC  1807          		JR	GETDPB1
                      	
  E9AE                	CHGDRVR:
  E9AE  CDD9EC        		CALL	_CHGDRV
  E9B1  D8            		RET	C
  E9B2  3A89EC        		LD	A,(_DSK)
  E9B5                	GETDPB1:
  E9B5  C3DCEC        		JP	_GETDPB
                      	
  E9B8                	GETDPB:
  E9B8  FE08          		CP	8
  E9BA  3F            		CCF
  E9BB  D8            		RET	C
  E9BC  87            		ADD	A,A	;*2
  E9BD  87            		ADD	A,A	;*4
  E9BE  87            		ADD	A,A	;*8
  E9BF  87            		ADD	A,A	;*16
  E9C0  87            		ADD	A,A	;*32
                      	;	LD	IXL,A		;OHM-Z80固有マクロ
  E9C1  DD            		DB	0DDH		;Z80未定義命令
  E9C2  6F            		LD	L,A		;
                      	;	LD	IXH,DEVICE/256	;OHM-Z80固有マクロ
  E9C3  DD            		DB	0DDH		;Z80未定義命令
  E9C4  26ED          		LD	H,DEVICE/256	;
  E9C6  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E9C9  FE01          		CP	001H		;A=0 THEN CF=1
  E9CB  C9            		RET
                      	
  E9CC                	FFLUSH:
  E9CC  F5            		PUSH	AF
  E9CD  3EFF          		LD	A,0FFH
  E9CF  322EE3        		LD	(SFILE),A
  E9D2  CD50E6        		CALL	DWTX
  E9D5  3EFF          		LD	A,0FFH
  E9D7  32A5EC        		LD	(_DBDRV),A
  E9DA  CD96E6        		CALL	WTFATX
  E9DD  3EFF          		LD	A,0FFH
  E9DF  32A3EC        		LD	(_FATDRV),A
  E9E2  F1            		POP	AF
  E9E3  C9            		RET
                      	
  E9E4                	M2D:
  E9E4  02FD0829      		DB	2,0FDH,8,029H
  E9E8  6401          		DW	356
  E9EA  FF0C2809010205		DB	0FFH,12,40,9,1,2,5,1
                      	
  E9F2                	M2DD8:
  E9F2  02FB0829      		DB	2,0FBH,8,029H
  E9F6  7C02          		DW	636
  E9F8  FF0C5008010205		DB	0FFH,12,80,8,1,2,5,1
                      	
  EA00                	M2DD:
  EA00  03F90A29      		DB	3,0F9H,0AH,029H
  EA04  CB02          		DW	715
  EA06  FF0E5009010207		DB	0FFH,14,80,9,1,2,7,1
                      	
  EA0E                	M2HC:
  EA0E  07F91B00      		DB	7,0F9H,27,0
  EA12  4509          		DW	2373
  EA14  FE1D500F01820F		DB	0FEH,29,80,15,1,082H,15,1
                      	
  EA1C                	M2HD:
  EA1C  02FE0900      		DB	2,0FEH,9,0
  EA20  C704          		DW	1223
  EA22  FE0B4D08010205		DB	0FEH,11,77,8,1,2,5,1
                      	
  EA2A                	M2HQ:
  EA2A  09F01F00      		DB	9,0F0H,31,0
  EA2E  210B          		DW	2849
  EA30  FE215012018213		DB	0FEH,33,80,18,1,082H,19,1
                      	
  EA38                	M2HDE:
  EA38  03FE0B00      		DB	3,0FEH,11,0
  EA3C  9505          		DW	1429
  EA3E  FE0D5009010207		DB	0FEH,13,80,9,1,2,7,1
                      	
  EA46                	M2HS:
  EA46  03FB0800      		DB	3,0FBH,8,0
  EA4A  9805          		DW	1432
  EA4C  FE0A5009010104		DB	0FEH,10,80,9,1,1,4,10
                      	
  EA54  00            	CHECK:	DB	0
                      	
                      	
                      	;LDDISK.ASM
                      	
                      	;	LSX-Dodgers DISK
                      	
                      	
  EA55                	SEEK:
  EA55  7A            		LD	A,D
  EA56  B3            		OR	E
  EA57  3E01          		LD	A,001H
  EA59  2812          		JR	Z,DIV3
                      	
  EA5B  0610          		LD	B,16
  EA5D  0E00          	MAXSEC:	LD	C,000H
  EA5F  AF            		XOR	A
  EA60  EB            		EX	DE,HL
  EA61                	DIV1:
  EA61  29            		ADD	HL,HL
  EA62  8F            		ADC	A,A
  EA63  B9            		CP	C
  EA64  3802          		JR	C,DIV2
  EA66  91            		SUB	C
  EA67  2C            		INC	L
  EA68                	DIV2:
  EA68  10F7          		DJNZ	DIV1
                      	
  EA6A  C601          	SECPAT:	ADD	A,001H		;(Self-rewriting)
  EA6C  55            		LD	D,L	;Quotient(TRACK)
  EA6D                	DIV3:
  EA6D  5F            		LD	E,A	;Remainder
  EA6E  CB3A          		SRL	D	;CYLINDER
  EA70  9F            		SBC	A,A
  EA71  E610          		AND	010H	;SIDE
  EA73  4F            		LD	C,A
                      	
  EA74  3A84EC        		LD	A,(_DRIVE)
  EA77  FE04          		CP	4
  EA79  3F            		CCF
  EA7A  D8            		RET	C
  EA7B  B1            		OR	C
  EA7C  32FAEA        		LD	(MOPAT+1),A	;Motor off data
  EA7F  01FC0F        		LD	BC,00FFCH
  EA82  F680          		OR	080H		;Mortor on
  EA84  ED79          		OUT	(C),A
                      	
  EA86  CDCCEA        		CALL	SETMODE
  EA89  D8            		RET	C
                      	
  EA8A  CD0FEB        		CALL	DRIVE
  EA8D  FEFF          		CP	0FFH		;A=0FFH Unknown CYLINDER
  EA8F  CCEEEA        		CALL	Z,FDCRES	;Restore
  EA92  0EF9          		LD	C,0F9H
  EA94  ED79          		OUT	(C),A		;Currrent CYLINDER
  EA96  92            		SUB	D
  EA97  C8            		RET	Z		;No seek
                      	
  EA98  3A86EC        		LD	A,(_ISEEK)
  EA9B  4F            		LD	C,A
                      	
  EA9C  3AA1EC        		LD	A,(_MAXCYL)	;Max CYLINDER
  EA9F  3D            		DEC	A
  EAA0  BA            		CP	D		;Over CYLINDER
  EAA1  D8            		RET	C
                      	
  EAA2  B9            		CP	C		;for Built-in 2DD
  EAA3  3803          		JR	C,SETM2
  EAA5  78            		LD	A,B		;B=00FH
  EAA6  DBFE          		IN	A,(0FEH)		;2HD mode for 2DD seek
  EAA8                	SETM2:
  EAA8  78            		LD	A,B
  EAA9  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  EAAB  0EFB          		LD	C,0FBH
  EAAD  ED51          		OUT	(C),D
  EAAF  72            		LD	(HL),D
  EAB0  0E18          		LD	C,018H		;Seek
  EAB2                	FDCCMD2:
  EAB2  3A85EC        		LD	A,(_SEEKSP)
  EAB5  E6FF          	FSPAT:	AND	0FFH
  EAB7  B1            		OR	C
                      	
  EAB8                	FDCCMD:
  EAB8  CD05EB        		CALL	COMSET
                      		
  EABB  3E80          	FDCPAT:	LD	A,080H		;FDC COMMAND(Self-rewriting)
  EABD  E620          		AND	020H		;Write data Write track
  EABF  3C            		INC	A
                      	
  EAC0                	SST:
  EAC0  0E00          		LD	C,0
  EAC2                	SST1:
  EAC2  0D            		DEC	C		; 4
  EAC3  20FD          		JR	NZ,SST1		;12 * 256 / 4 = About 1ms
  EAC5  3D            		DEC	A
  EAC6  20FA          		JR	NZ,SST1
                      	
  EAC8  3C            		INC	A		;A=1
  EAC9  CDD7EA        		CALL	READY
  EACC                	SETMODE:
  EACC  78            		LD	A,B		;B=00FH
  EACD  DBFF          	FDMODE:	IN	A,(0FFH)		;Floppy mode(2D/2HD) (Self-rewriting)
                      	
  EACF  78            		LD	A,B
  EAD0  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  EAD2  CD09EB        		CALL	DELAY0		;Head select time
  EAD5  3E81          		LD	A,081H
  EAD7                	READY:
  EAD7  32E1EA        		LD	(WAITA+1),A
  EADA  E5            		PUSH	HL
  EADB  0EF8          		LD	C,0F8H
  EADD  61            		LD	H,C
  EADE                	READY2:
  EADE  ED78          		IN	A,(C)
  EAE0  E681          	WAITA:	AND	081H		;NOT READY,BUSY
  EAE2  2808          		JR	Z,READYE
  EAE4  E3            		EX	(SP),HL		;wait
  EAE5  E3            		EX	(SP),HL		; //
  EAE6  2B            		DEC	HL
  EAE7  7C            		LD	A,H
  EAE8  B5            		OR	L
  EAE9  20F3          		JR	NZ,READY2
  EAEB  37            		SCF
  EAEC                	READYE:
  EAEC  E1            		POP	HL
  EAED  C9            		RET
                      	
  EAEE                	FDCRES:
  EAEE  3600          		LD	(HL),0
  EAF0  0E08          		LD	C,8
  EAF2  18BE          		JR	FDCCMD2
                      	
  EAF4                	FDMOFF:
  EAF4  F5            		PUSH	AF
  EAF5  C5            		PUSH	BC
  EAF6  01FC0F        		LD	BC,00FFCH	;Motor off
  EAF9  3E00          	MOPAT:	LD	A,000H		;(Self-rewriting)
  EAFB  ED79          		OUT	(C),A
  EAFD  C1            		POP	BC
  EAFE  F1            		POP	AF
  EAFF  C9            		RET
                      	
  EB00                	SECSET:
  EB00  01FA0F        		LD	BC,00FFAH
  EB03  ED59          		OUT	(C),E
  EB05                	COMSET:
  EB05  0EF8          		LD	C,0F8H
  EB07  ED79          		OUT	(C),A
  EB09                	DELAY0:
  EB09  3E1A          		LD	A,26
  EB0B                	DELAY:
  EB0B  3D            		DEC	A
  EB0C  20FD          		JR	NZ,DELAY
  EB0E  C9            		RET
                      	
  EB0F                	DRIVE:
  EB0F  2A84EC        		LD	HL,(_DRIVE)
  EB12  26EC          		LD	H,_CYL0/256
  EB14  CBFD          		SET	7,L
  EB16  7E            		LD	A,(HL)
  EB17  C9            		RET
                      	
  EB18                	RNF:
  EB18  CD0FEB        		CALL	DRIVE
  EB1B  36FF          		LD	(HL),0FFH
  EB1D  C9            		RET
                      	
  EB1E  0307          	DEMES:	DB	3,7
  EB20  44657669636520		DB	"Device I/O Error",5,3
  EB32  41626F72742052		DB	"Abort Retry Ignore?",5,3,0
                      	
  EB48  02            	RETRY:	DB	2
                      	
                      	
                      	;	FLOPPY DISK DRIVER(DMA)
                      	
                      	
  EB49                	WTTRK:
  EB49  3EF4          		LD	A,0F4H
  EB4B  1802          		JR	WTTRK1
  EB4D                	FDWT:
  EB4D  3EA0          		LD	A,0A0H
  EB4F                	WTTRK1:
  EB4F  32BCEA        		LD	(FDCPAT+1),A
  EB52  3E10          		LD	A,16
  EB54  1807          		JR	DISK
                      	
  EB56                	FDRD:
  EB56  3E80          		LD	A,080H
  EB58  32BCEA        		LD	(FDCPAT+1),A
  EB5B  3E0E          		LD	A,14
                      	
  EB5D                	DISK:
  EB5D  3270EB        		LD	(DMAPAT+1),A
                      	
  EB60  22FBEB        		LD	(DMAD+11),HL
  EB63                	DISKR:
  EB63  3E02          		LD	A,2		;Retry count
  EB65  3248EB        		LD	(RETRY),A
  EB68                	DISK2:
  EB68  D5            		PUSH	DE
  EB69  CD55EA        		CALL	SEEK
  EB6C  3842          		JR	C,ERRF
  EB6E  F3            		DI
                      	
  EB6F  3E0E          	DMAPAT:	LD	A,14		;自己書き換え
  EB71  21F0EB        		LD	HL,DMAD
  EB74  CDE6EB        		CALL	SETDMA
  EB77  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EB79  3ABCEA        		LD	A,(FDCPAT+1)
  EB7C  C5            		PUSH	BC
  EB7D  CD00EB        		CALL	SECSET
  EB80  2AFBEB        		LD	HL,(DMAD+11)
  EB83  23            		INC	HL
  EB84  1106BB        		LD	DE,0BB06H	;READ DMA
                      	
  EB87  3E03          		LD	A,3
  EB89  CDD7EA        		CALL	READY
  EB8C  ED78          		IN	A,(C)
                      	
  EB8E  C1            		POP	BC
  EB8F  ED51          		OUT	(C),D
  EB91  ED59          		OUT	(C),E
  EB93  ED58          		IN	E,(C)
  EB95  ED50          		IN	D,(C)
  EB97  19            		ADD	HL,DE
  EB98  D1            		POP	DE
  EB99  13            		INC	DE
  EB9A  FB            		EI
  EB9B  CDF4EA        		CALL	FDMOFF
  EB9E  B7            		OR	A
  EB9F  C8            		RET	Z
  EBA0  1B            		DEC	DE
  EBA1  CB67          		BIT	4,A
  EBA3  C418EB        		CALL	NZ,RNF
  EBA6                	DISKE2:
  EBA6  2148EB        		LD	HL,RETRY
  EBA9  35            		DEC	(HL)
  EBAA  20BC          		JR	NZ,DISK2
  EBAC  B7            		OR	A
  EBAD  2834          		JR	Z,ERR
  EBAF  D5            		PUSH	DE
  EBB0                	ERRF:
  EBB0  D1            		POP	DE
  EBB1                	DELP:
  EBB1  CD18EB        		CALL	RNF
  EBB4  CDF4EA        		CALL	FDMOFF
  EBB7  3A85EC        		LD	A,(_SEEKSP)
  EBBA  87            		ADD	A,A
  EBBB  9F            		SBC	A,A
  EBBC  3825          		JR	C,ERR
  EBBE                	DELP1:
  EBBE  D5            		PUSH	DE
  EBBF  211EEB        		LD	HL,DEMES
  EBC2  CDF0D8        		CALL	MSX
  EBC5  CD6ED7        		CALL	KEYBC
  EBC8                	DELP2:
  EBC8  CDCAEC        		CALL	_INKEY
  EBCB  28FB          		JR	Z,DELP2
                      	
  EBCD  D1            		POP	DE
  EBCE  CD65E0        		CALL	CAP
  EBD1  FE52          		CP	'R'
  EBD3  CA63EB        		JP	Z,DISKR
  EBD6  FE49          		CP	'I'
  EBD8  2807          		JR	Z,IGNORE
  EBDA  FE41          		CP	'A'
  EBDC  20E0          		JR	NZ,DELP1
  EBDE  C3EBDA        		JP	BOOT
  EBE1                	IGNORE:
  EBE1  3EFF          		LD	A,0FFH
  EBE3                	ERR:
  EBE3  BF            		CP	A
  EBE4  37            		SCF
  EBE5  C9            		RET
                      	
  EBE6                	SETDMA:
  EBE6  01871F        		LD	BC,01F87H
  EBE9                	SDMA:
  EBE9  04            		INC	B
  EBEA  EDA3          		OUTI
  EBEC  3D            		DEC	A
  EBED  20FA          		JR	NZ,SDMA
  EBEF  C9            		RET
                      	
  EBF0  C37DFB0FFFFF2C	DMAD:	DB	0C3H,07DH,0FBH,00FH,0FFH,0FFH,02CH,010H		;X1turbo
  EBF8  80928D0000CF01		DB	080H,092H,08DH,000H,000H,0CFH,001H,0CFH		;DISK DMA
  EC00                	DMAE:
                      	
  2096                	AT_R	EQU	WTTRK-AT_WTTRK
                      	
  EC00                	_PE:
                      	
                      	;LDCALL.ASM
                      	
                      	;	LSX-Dodgers SYSTEM CALL
                      	
  EC00                		ORG	0EC00H
                      	
  EC00                	STABLE:
                      	;0
  EC00  0000A2D7AED7B3		DW	 00000H,_SYS01,_SYS02,_SYS03
  EC08  E3D7FAD71AD8F4		DW	_SYS04,_SYS05,_SYS06,_SYS07
  EC10  22D88AD35BD887		DW	_SYS08,_SYS09,_SYS0A,_SYS0B
  EC18  99D39FD3AED3C1		DW	_SYS0C,_SYS0D,_SYS0E,_SYS0F
                      	;1
  EC20  36D483D4DFD415		DW	_SYS10,_SYS11,_SYS12,_SYS13
  EC28  1DD53BD558D550		DW	_SYS14,_SYS15,_SYS16,_SYS17
  EC30  B9D5BED5C3D5C9		DW	_SYS18,_SYS19,_SYS1A,_SYS1B
  EC38  88D3F6D588D3FA		DW	_SYS1C,_SYS1D,_SYS1E,_SYS1F
                      	;2
  EC40  88D38FD5A4D5FF		DW	_SYS20,_SYS21,_SYS22,_SYS23
  EC48  1ED682D38EE3B3		DW	_SYS24,_ERROR,_SYS26,_SYS27
  EC50  A4D527D69DD81B		DW	_SYS28,_SYS29,_SYS2A,_SYS2B
  EC58  D7D81BDF88D34A		DW	_SYS2C,_SYS2D,_SYS2E,_SYS2F
                      	;3
  EC60  44D6          		DW	_SYS30
                      	
                      	;LDWORK.ASM
                      	
                      	;	LSX-Dodgers WORK
                      	
  0004                	DDS	EQU	4
  EC62                	DDTB:
  EC62  434F4E20      		DB	"CON "
  EC66  76D4          		DW	OPENDD
  EC68  41555820      		DB	"AUX "
  EC6C  76D4          		DW	OPENDD
  EC6E  50524E20      		DB	"PRN "
  EC72  76D4          		DW	OPENDD
  EC74  4E554C20      		DB	"NUL "
  EC78  76D4          		DW	OPENDD
                      	
  EC7A                		DS	2
  EC7C  00EE          	_FATBF:	DW	FATBF
  EC7E  00FA          	_DTBUF:	DW	DTBUF
                      	
  EC80  FF            	_CYL0:	DB	0FFH	;Cylinder
  EC81  FF            	_CYL1:	DB	0FFH	;Cylinder
  EC82  FF            	_CYL2:	DB	0FFH	;Cylinder
  EC83  FF            	_CYL3:	DB	0FFH	;Cylinder
  EC84  00            	_DRIVE:	DB	0	;unit number
  EC85  00            	_SEEKSP:DB	0	;Seek speed
  EC86  FF            	_ISEEK:	DB	0FFH	;
  EC87  00            	_DVSW:	DB	0
  EC88  00            	_DRV:	DB	0
  EC89  FF            	_DSK:	DB	0FFH
  EC8A  8000          	_DTA:	DW	00080H
  EC8C  0000          	_CTC:	DW	0
  EC8E  0000          	_TXADR:	DW	0
  EC90  0000          	_KEYPS	DW	0
  EC92  00FF          	_KEYD	DW	0FF00H
  EC94  C210          	_KEYSP:	DW	010C2H
  EC96  07            	_COLORF:DB	7
  EC97  18            	_LINE:	DB	LINE
                      	
  EC98  0000          	_FCB:	DW	0
  EC9A  0000          	_FBPS:	DW	0	;SEARCH FILES
  EC9C  0000          	_FBAD:	DW	0	;    //
  EC9E  00            	_FBCNT:	DB	0	;    //
  EC9F  00            	_FILEN:	DB	0
  ECA0  00            	_DIRF:	DB	0
  ECA1  00            	_MAXCYL:DB	0
  ECA2  00            	_WTFATF:DB	0
  ECA3  FF            	_FATDRV:DB	0FFH
  ECA4  00            	_WTDBF:	DB	0
  ECA5  FF            	_DBDRV:	DB	0FFH
  ECA6  0000          	_DCLPS:	DW	0
  ECA8  0000          	_DPB:	DW	0
                      	
  ECAA                		DS	6
                      	
  ECB0  6F5059381F0219	CRTCD:	DB	06FH,050H,059H,038H,01FH,002H,019H,01CH
  ECB8  0007          		DB	000H,007H
  ECBA  80F8B0FF      		DW	0-80*LINE,0-80
  ECBE  0C            		DB	00CH
  ECBF  A0            	WK1FD0:	DB	0A0H
                      	
  ECC0  D2D6          	CTC0:	DW	INTCTCE
  ECC2  D2D6          	CTC1:	DW	INTCTCE
  ECC4  FAD6          	CTC2:	DW	INTCTC2
  ECC6  D2D6          	CTC3:	DW	INTCTCE
  ECC8  92D6          	INTVEC:	DW	INT
                      	
                      	;	JUMP
                      	
  ECCA  C30CDD        	_INKEY:	JP	INKEY
  ECCD  C368D9        	_PRINT:	JP	PRINT
  ECD0  C357DC        	_SCRN:	JP	SCRN
  ECD3  C37FDC        	_POS:	JP	POS
  ECD6  C3ADDA        	_LOC:	JP	LOC
  ECD9  C3E1E8        	_CHGDRV:JP	CHGDRV
  ECDC  C3B8E9        	_GETDPB:JP	GETDPB
  ECDF  C3CCE9        	_FFLUSH:JP	FFLUSH
  ECE2  C36EE6        	_RDFATX:JP	RDFATX
  ECE5  C343E7        	_RDFAT:	JP	RDFAT
  ECE8  C349EB        	_WTTRK:	JP	WTTRK
  ECEB  C356EB        	_FDRD:	JP	FDRD
  ECEE  C34DEB        	_FDWT:	JP	FDWT
  ECF1  C328E8        	_DRD:	JP	DRD_DPB
  ECF4  C384E8        	_DWT:	JP	DWT_DPB
  ECF7  C3F0E6        	_GNCL:	JP	GNCL	;(Self-rewriting)
  ECFA  C313E7        	_SNCL:	JP	SNCL	;(Self-rewriting)
  ECFD  C341CE        	_COMANL:JP	COMANL
                      	
  ED00                	WE:
                      	
                      	;LDDPB.ASM
                      	
                      	;	LSX-Dodgers DPB
                      	
  ED00                	DEVICE:
                      	
                      	;	A:
                      	
  ED00  02            	DPB_00_FATLN:	DB	2
  ED01  FD            	DPB_01_FATID:	DB	0FDH
  ED02  EBEC          	DPB_02_DRD:	DW	_FDRD
  ED04  EEEC          	DPB_04_DWT:	DW	_FDWT
  ED06  08            	DPB_06_ADDCL:	DB	8
  ED07  29            	DPB_07_DBLCL:	DB	029H	;029H=1 sector:512 / 0=1 sector:1024
  ED08  6401          	DPB_08_MAXCL:	DW	356
  ED0A  FF            	DPB_0A_FDMODE:	DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED0B  0C            	DPB_0B_MAXDIR:	DB	12
  ED0C  28            	DPB_0C_MAXCYL:	DB	40
  ED0D  09            	DPB_0D_MAXSEC:	DB	9	;Number of sectors
  ED0E  01            	DPB_0E_FATPS:	DB	1
  ED0F  02            	DPB_0F_FATS:	DB	2	;bit7.0:1 cluster=1024 / bit7.1:1 cluster=512 | bit1.1=2FATS(use reserve)
  ED10  05            	DPB_10_DIRPS:	DB	5
  ED11  01            	DPB_11_MINSEC:	DB	1	;Minimum sector
  ED12  87            	DPB_12_DEVNO:	DB	087H	;Device Number
  ED13  00            	DPB_13_UNITNO:	DB	0
  ED14  0000          	DPB_14		DW	0
  ED16  0000          	DPB_16_GNCL:	DW	0
  ED18  0000          	DPB_18_SNCL:	DW	0
  ED1A  0000          	DPB_1A_SDIR:	DW	0
  ED1C  46444430      	DPB_1C_NAME:	DB	"FDD0"
                      	
                      	;	B:
                      	
  ED20  02            		DB	2
  ED21  FD            		DB	0FDH
  ED22  EBEC          		DW	_FDRD
  ED24  EEEC          		DW	_FDWT
  ED26  08            		DB	8
  ED27  29            		DB	029H	;029H=512 / 0=1024
  ED28  6401          		DW	356
  ED2A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED2B  0C            		DB	12
  ED2C  28            		DB	40
  ED2D  09            		DB	9
  ED2E  01            		DB	1
  ED2F  02            		DB	2
  ED30  05            		DB	5
  ED31  01            		DB	1
  ED32  87            		DB	087H	;Device Number
  ED33  01            		DB	1
  ED34  0000          		DW	0
  ED36  0000          		DW	0
  ED38  0000          		DW	0
  ED3A  0000          		DW	0
  ED3C  46444431      		DB	"FDD1"
                      	
                      	;	C:
                      	
  ED40  02            		DB	2
  ED41  FD            		DB	0FDH
  ED42  EBEC          		DW	_FDRD
  ED44  EEEC          		DW	_FDWT
  ED46  08            		DB	8
  ED47  29            		DB	029H	;029H=512 / 0=1024
  ED48  6401          		DW	356
  ED4A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED4B  0C            		DB	12
  ED4C  28            		DB	40
  ED4D  09            		DB	9
  ED4E  01            		DB	1
  ED4F  02            		DB	2
  ED50  05            		DB	5
  ED51  01            		DB	1
  ED52  87            		DB	087H	;Device Number
  ED53  02            		DB	2
  ED54  0000          		DW	0
  ED56  0000          		DW	0
  ED58  0000          		DW	0
  ED5A  0000          		DW	0
  ED5C  46444432      		DB	"FDD2"
                      	
                      	;	D:
                      	
  ED60  02            		DB	2
  ED61  FD            		DB	0FDH
  ED62  EBEC          		DW	_FDRD
  ED64  EEEC          		DW	_FDWT
  ED66  08            		DB	8
  ED67  29            		DB	029H	;029H=512 / 0=1024
  ED68  6401          		DW	356
  ED6A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED6B  0C            		DB	12
  ED6C  28            		DB	40
  ED6D  09            		DB	9
  ED6E  01            		DB	1
  ED6F  02            		DB	2
  ED70  05            		DB	5
  ED71  01            		DB	1
  ED72  87            		DB	087H	;Device Number
  ED73  03            		DB	3
  ED74  0000          		DW	0
  ED76  0000          		DW	0
  ED78  0000          		DW	0
  ED7A  0000          		DW	0
  ED7C  46444433      		DB	"FDD3"
                      	
                      	;	E:
                      	
  ED80  00            	EMMFL:	DB	0
  ED81  FE            		DB	0FEH
  ED82  DDCC          	EMMRD:	DW	EDRDC
  ED84  DACC          	EMMWR:	DW	EDWTC
  ED86  09            		DB	9
  ED87  00            		DB	0
  ED88  0000          	EMMCL:	DW	0
  ED8A  00            		DB	0
  ED8B  0B            		DB	11
  ED8C  00            	EMMBL:	DB	0
  ED8D  01            		DB	1
  ED8E  01            		DB	1
  ED8F  01            		DB	1
  ED90  05            		DB	5
  ED91  01            		DB	1
  ED92  06            		DB	6	;Device Number
  ED93  00            	EMMDV:	DB	0
  ED94  0000          		DW	0
  ED96  0000          		DW	0
  ED98  0000          		DW	0
  ED9A  0000          		DW	0
  ED9C  454D4D30      		DB	"EMM0"
                      	
                      	;	F:
                      	
  EDA0  00            	BANKFL:	DB	0
  EDA1  F9            		DB	0F9H
  EDA2  58CC          		DW	BDRDC
  EDA4  7BCC          		DW	BDWTC
  EDA6  03            		DB	3
  EDA7  00            		DB	0
  EDA8  0000          	BANKCL:	DW	0
  EDAA  00            		DB	0
  EDAB  05            		DB	5
  EDAC  00            		DB	0
  EDAD  01            		DB	1
  EDAE  00            		DB	0
  EDAF  01            		DB	1
  EDB0  01            		DB	1
  EDB1  01            		DB	1
  EDB2  0B            		DB	00BH	;Device Number
  EDB3  00            		DB	0
  EDB4  0000          		DW	0
  EDB6  0000          		DW	0
  EDB8  0000          		DW	0
  EDBA  0000          		DW	0
  EDBC  4252414D      		DB	"BRAM"
                      	
                      	;	G:
                      	
  EDC0  01            		DB	1
  EDC1  F9            		DB	0F9H
  EDC2  16CC          		DW	GDRDC
  EDC4  2CCC          		DW	GDWTC
  EDC6  00            		DB	0
  EDC7  00            		DB	0
  EDC8  3000          		DW	48
  EDCA  00            		DB	0
  EDCB  02            		DB	2
  EDCC  00            		DB	0
  EDCD  01            		DB	1
  EDCE  00            		DB	0
  EDCF  01            		DB	1
  EDD0  01            		DB	1
  EDD1  01            		DB	1
  EDD2  05            		DB	5	;Device Number
  EDD3  01            		DB	1
  EDD4  0000          		DW	0
  EDD6  0000          		DW	0
  EDD8  0000          		DW	0
  EDDA  0000          		DW	0
  EDDC  4752414D      		DB	"GRAM"
                      	
                      	
                      	
  EDE0  00            	LDEND:	DB	0
                      	
  EDE1                		END
