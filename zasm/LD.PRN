			  Z80 ASSEMBLER - ZASM VER 1.6
                      	;	LSX-Dodgers for X1/turbo/Z
                      	;	Programmed by
                      	;	Gaku (Lovers/Tablacus)
                      	
  C600                	RUN	EQU	0C600h
                      	
  C5F9                		ORG	RUN-7
                      	
                      	;	MSX BINARY HEADER
  C5F9  FE            		DB	0FEH
                      	;	MSX BINARY START ADDRESS
  C5FA  00C6          		DW	RUN
                      	;	MSX BINARY END ADDRESS
  C5FC  E0ED          		DW	LDEND
                      	;	MSX BINARY EXEC ADDRESS
  C5FE  00C6          		DW	RUN
                      	;LDDEF.ASM
                      	
                      	;	LSX-Dodgers DEF
                      	
  1D80                	MAC	EQU	01D80H		;X1
  0001                	VER_1   EQU 1
  0002                	VER_2   EQU 2
  0007                	VER_3   EQU 7
  0127                	VER	EQU	VER_1 * 256 + VER_2 * 16 + VER_3
                      	
  0000                	STACK	EQU	00000H
  0005                	SYSTEM	EQU	00005H
  000F                	K_HL	EQU	0000FH
  005C                	FCB1	EQU	0005CH
  006C                	FCB2	EQU	0006CH
  0080                	DTA1	EQU	00080H
  00DB                	FDRV	EQU	00100H-37
  00DC                	FNAME	EQU	FDRV+1
  00D6                	DECBF	EQU	FDRV-5
  EE00                	FATBF	EQU	0EE00H
  FA00                	DTBUF	EQU	0FA00H
  FE00                	KEYBF	EQU	0FE00H
  FF00                	KBUF	EQU	0FF00H
  FF51                	DTA	EQU	KBUF+81
  FFD4                	EXTSP	EQU	0FFD4H
  0018                	LINE	EQU	24
                      	
                      	;LDINIT.ASM
                      	
                      	;	LSX-Dodgers INIT
                      	
  C600  C307C6        		JP	START
  C603  801D          	MACHINE:DW	MAC
  C605  2701          	VERSION:DW	VER
                      	
  C607                	START:
  C607  F3            		DI
  C608  ED5E          		IM	2
  C60A  310000        		LD	SP,STACK
  C60D  3E1E          		LD	A,01EH
  C60F  D300          		OUT	(0),A
                      	
  C611  010000        		LD	BC,0
  C614  ED438CEC      		LD	(_CTC),BC
  C618  01040A        		LD	BC,00A04H
  C61B  CD48C9        		CALL	CHKCTC
  C61E  010407        		LD	BC,00704H
  C621  CD48C9        		CALL	CHKCTC
  C624  01A81F        		LD	BC,01FA8H
  C627  CD48C9        		CALL	CHKCTC
  C62A  01A01F        		LD	BC,01FA0H
  C62D  CD48C9        		CALL	CHKCTC
                      	;
  C630                	INISIO:
  C630  01911F        		LD	BC,01F91H	;INIT SIO
  C633  1601          		LD	D,1
  C635  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C637  ED71          		DB	0EDH,071H
  C639  0E93          		LD	C,093H
  C63B  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C63D  ED71          		DB	0EDH,071H
  C63F  0E99          		LD	C,099H		;INIT SIO
  C641  1601          		LD	D,1
  C643  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C645  ED71          		DB	0EDH,071H
  C647  0E9B          		LD	C,09BH
  C649  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C64B  ED71          		DB	0EDH,071H
                      	
  C64D  0E80          		LD	C,080H		;INIT DMA
  C64F  2106C3        		LD	HL,0C306H
  C652                	INIDMA:
  C652  ED61          		OUT	(C),H
  C654  2D            		DEC	L
  C655  20FB          		JR	NZ,INIDMA
                      	
  C657  3EE4          		LD	A,0E4H
  C659  CD5DDA        		CALL	COMOUT
  C65C  AF            		XOR	A
  C65D  CD37DA        		CALL	OT49SB
                      	
  C660  3EEC          		LD	A,INTVEC/256
  C662  ED47          		LD	I,A
                      	
  C664  ED4B8CEC      		LD	BC,(_CTC)
  C668  0B            		DEC	BC
  C669  0B            		DEC	BC
                      	
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C66A  ED71          		DB	0EDH,071H
  C66C  3EC0          		LD	A,CTC0
  C66E  ED79          		OUT	(C),A
                      	
  C670  0C            		INC	C
  C671  3E47          		LD	A,047H
  C673  ED79          		OUT	(C),A
  C675  3E0D          		LD	A,13		;Baudrate 9600-13
  C677  ED79          		OUT	(C),A
                      	
  C679  79            		LD	A,C
  C67A  D610          		SUB	010H
  C67C  4F            		LD	C,A
  C67D  ED43C0D6      		LD	(SIOAD+1),BC
  C681  ED43E9D6      		LD	(SIOAD0+1),BC
  C685  ED43EFD6      		LD	(SIOAD1+1),BC
                      	
  C689  21F1C9        		LD	HL,SIODATA
  C68C                	SINIT1:
  C68C  7E            		LD	A,(HL)
  C68D  23            		INC	HL
  C68E  FEFF          		CP	0FFH
  C690  2804          		JR	Z,SINIT2
  C692  ED79          		OUT	(C),A
  C694  18F6          		JR	SINIT1
  C696                	SINIT2:
  C696  3EE4          		LD	A,0E4H
  C698  CD5DDA        		CALL	COMOUT
  C69B  3EC8          		LD	A,INTVEC
  C69D  CD37DA        		CALL	OT49SB
                      	;
  C6A0  01C41F        		LD	BC,01FC4H
  C6A3  3E0C          		LD	A,00CH
  C6A5  ED79          		OUT	(C),A
                      	
  C6A7  0EC0          		LD	C,0C0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6A9  ED71          		DB	0EDH,071H
                      	
  C6AB  0C            		INC	C
  C6AC  3E28          		LD	A,40
  C6AE  ED79          		OUT	(C),A
                      	
  C6B0  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B1  ED71          		DB	0EDH,071H
                      	
  C6B3  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B4  ED71          		DB	0EDH,071H
                      	
  C6B6  0EC5          		LD	C,0C5H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B8  ED71          		DB	0EDH,071H
                      	
  C6BA                	TEXT:
  C6BA  0EB0          		LD	C,0B0H
  C6BC  3E80          		LD	A,080H
  C6BE  ED79          		OUT	(C),A
  C6C0  1607          		LD	D,7
  C6C2  0EB9          		LD	C,0B9H
  C6C4  21EAC9        		LD	HL,TEXTDT
  C6C7                	TEXT1:
  C6C7  04            		INC	B
  C6C8  EDA3          		OUTI
  C6CA  0C            		INC	C
  C6CB  15            		DEC	D
  C6CC  20F9          		JR	NZ,TEXT1
  C6CE  01B01F        		LD	BC,01FB0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D1  ED71          		DB	0EDH,071H
                      	
  C6D3  0EC4          		LD	C,0C4H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D5  ED71          		DB	0EDH,071H
                      	
  C6D7  01011A        		LD	BC,01A01H
  C6DA  ED78          		IN	A,(C)
  C6DC  E608          		AND	8
  C6DE  2809          		JR	Z,PRN
  C6E0  0E03          		LD	C,003H
  C6E2  3E0F          		LD	A,00FH
  C6E4  ED79          		OUT	(C),A
  C6E6  01040A        		LD	BC,00A04H
  C6E9                	PRN:
  C6E9  110100        		LD	DE,1
  C6EC  62            		LD	H,D
  C6ED  6A            		LD	L,D
  C6EE  017F00        		LD	BC,07FH
  C6F1  36FF          		LD	(HL),0FFH
  C6F3  EDB0          		LDIR
  C6F5  017F00        		LD	BC,07FH
  C6F8  3600          		LD	(HL),0
  C6FA  EDB0          		LDIR
                      	
  C6FC  3EC3          		LD	A,0C3H		;JP
  C6FE  21F8D9        		LD	HL,WBOOT
  C701  320000        		LD	(00000H),A
  C704  220100        		LD	(00001H),HL	;IPL
                      	
  C707  2A03C6        		LD	HL,(MACHINE)	;3 bit7  DPB Original(1)
  C70A  220300        		LD	(00003H),HL	;  bit6-0 Machine X1(0)
                      	;				;4 LSX-Dodgers(01DH)
  C70D  2106CC        		LD	HL,BDOS
  C710  320500        		LD	(00005H),A
  C713  220600        		LD	(00006H),HL	;BDOS
                      	
  C716  2178D5        		LD	HL,BIOS
  C719  321800        		LD	(00018H),A	;BIOS-ROM
  C71C  221900        		LD	(00019H),HL
                      	
  C71F  210000        		LD	HL,0
  C722  323800        		LD	(00038H),A	;RST038H
  C725  223900        		LD	(00039H),HL
                      	
  C728  3EEC          		LD	A,STABLE/256
  C72A  320B00        		LD	(0000BH),A
                      	
  C72D  3EE9          		LD	A,0E9H		;JP (HL)
  C72F  320F00        		LD	(0000FH),A
                      	
  C732  3A7DEC        		LD	A,(_FATBF+1)
  C735  321300        		LD	(00013H),A
                      	
  C738  3A7FEC        		LD	A,(_DTBUF+1)
  C73B  321700        		LD	(00017H),A
                      	
  C73E  3EFE          		LD	A,KEYBF/256
  C740  321B00        		LD	(0001BH),A
                      	
  C743  3EFF          		LD	A,KBUF/256
  C745  321F00        		LD	(0001FH),A
                      	
  C748  2A05C6        		LD	HL,(VERSION)
  C74B  225A00        		LD	(0005AH),HL
                      	
  C74E  3EE6          		LD	A,0E6H
  C750  CD5DDA        		CALL	COMOUT
  C753  CD42DA        		CALL	IN49SB
  C756  F5            		PUSH	AF
  C757  CD42DA        		CALL	IN49SB
  C75A  F1            		POP	AF
  C75B  F5            		PUSH	AF
  C75C  E612          		AND	012H
  C75E  2005          		JR	NZ,KEYR
  C760  3E01          		LD	A,1
  C762  329DC8        		LD	(KEYREP+1),A
  C765                	KEYR:
  C765  F1            		POP	AF
  C766  E603          		AND	3
  C768  280E          		JR	Z,NON
                      	
  C76A  01D03F        		LD	BC,03FD0H
  C76D  ED49          		OUT	(C),C
  C76F  3E37          		LD	A,037H
  C771  D3D0          		OUT	(0D0H),A
  C773  ED78          		IN	A,(C)
  C775  B9            		CP	C
  C776  285C          		JR	Z,TURBO
  C778                	NON:
  C778  3D            		DEC	A		;A=0FFH
  C779  321800        		LD	(00018H),A	;BIOS-ROM
                      	
  C77C  21FDC9        		LD	HL,AT_SCR1
  C77F  11E6DA        		LD	DE,SCR1
  C782  015E00        		LD	BC,AT_SCRE-AT_SCR1
  C785  EDB0          		LDIR
                      	
  C787  215BCA        		LD	HL,AT_WTTRK
  C78A  113FEA        		LD	DE,WTTRK
  C78D  017501        		LD	BC,AT_CPUE-AT_WTTRK
  C790  EDB0          		LDIR
                      	
  C792  2192EA        		LD	HL,AT_DRD+AT_R
  C795  22ECEC        		LD	(_FDRD+1),HL
  C798  2143EA        		LD	HL,AT_DWT+AT_R
  C79B  22EFEC        		LD	(_FDWT+1),HL
  C79E  212AEB        		LD	HL,AT_EDRDC+AT_R
  C7A1  2282ED        		LD	(EMMRD),HL
  C7A4  213EEB        		LD	HL,AT_EDWTC+AT_R
  C7A7  2284ED        		LD	(EMMWR),HL
                      	
  C7AA  2159EA        		LD	HL,DWTPAT+AT_R
  C7AD  22AFE9        		LD	(AT_FDCPAT+1),HL
                      	
  C7B0  210000        		LD	HL,0
  C7B3  2288DA        		LD	(X1PAT),HL
                      	
  C7B6  3EAF          		LD	A,0AFH		;XOR	A
  C7B8  3287D8        		LD	(X1KPAT),A
                      	
  C7BB  2185DB        		LD	HL,SCRNX
  C7BE  22D1EC        		LD	(_SCRN+1),HL
                      	
  C7C1  CD6FC9        		CALL	SETCRTC
  C7C4  0610          		LD	B,010H		;PALET
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7C6  ED71          		DB	0EDH,071H
  C7C8  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7C9  ED71          		DB	0EDH,071H
  C7CB  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CC  ED71          		DB	0EDH,071H
  C7CE  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CF  ED71          		DB	0EDH,071H
  C7D1  C359C8        		JP	NOBANK
                      	
  C7D4                	TURBO:
  C7D4  3E1F          		LD	A,01FH
  C7D6  DBF0          		IN	A,(0F0H)
  C7D8  0F            		RRCA
  C7D9  380B          		JR	C,CRT1
  C7DB  21DAC9        		LD	HL,_C8025H
  C7DE  11B0EC        		LD	DE,CRTCD
  C7E1  011000        		LD	BC,16
  C7E4  EDB0          		LDIR
  C7E6                	CRT1:
  C7E6  CD6FC9        		CALL	SETCRTC
  C7E9  01AA10        		LD	BC,010AAH	;PALET
  C7EC  ED49          		OUT	(C),C
  C7EE  01CC11        		LD	BC,011CCH
  C7F1  ED49          		OUT	(C),C
  C7F3  01F012        		LD	BC,012F0H
  C7F6  ED49          		OUT	(C),C
  C7F8  04            		INC	B
  C7F9  ED71          		DB	0EDH,071H
                      	
  C7FB  3E1F          		LD	A,01FH
  C7FD  DBF0          		IN	A,(0F0H)
  C7FF  CB57          		BIT	2,A
  C801  2825          		JR	Z,BANK
                      	
  C803  AF            		XOR	A
  C804                	TZ1:
  C804  F5            		PUSH	AF
  C805  CDDCEC        		CALL	_GETDPB
  C808  DD7E12        		LD	A,(IX+012H)
  C80B  FE87          		CP	087H
  C80D  2013          		JR	NZ,TZ2
  C80F  DDE5          		PUSH	IX
  C811  D1            		POP	DE
  C812  210FE9        		LD	HL,M2HD
  C815  EDA0          		LDI
  C817  EDA0          		LDI
  C819  13            		INC	DE
  C81A  13            		INC	DE
  C81B  13            		INC	DE
  C81C  13            		INC	DE
  C81D  010C00        		LD	BC,12
  C820  EDB0          		LDIR
  C822                	TZ2:
  C822  F1            		POP	AF
  C823  3C            		INC	A
  C824  FE08          		CP	8
  C826  38DC          		JR	C,TZ1
                      	
  C828                	BANK:
  C828  01000B        		LD	BC,00B00H
  C82B  21007F        		LD	HL,07F00H
  C82E  F3            		DI
  C82F                	BANK1:
  C82F  ED69          		OUT	(C),L
  C831  5E            		LD	E,(HL)
  C832  7B            		LD	A,E
  C833  C6A5          		ADD	A,0A5H
  C835  77            		LD	(HL),A
  C836  BE            		CP	(HL)
  C837  73            		LD	(HL),E
  C838  2005          		JR	NZ,BANK2
  C83A  2C            		INC	L
  C83B  CB65          		BIT	4,L
  C83D  28F0          		JR	Z,BANK1
  C83F                	BANK2:
  C83F  3E10          		LD	A,010H
  C841  ED79          		OUT	(C),A
  C843  7D            		LD	A,L
  C844  B7            		OR	A
  C845  2812          		JR	Z,NOBANK
  C847  2600          		LD	H,0
  C849  29            		ADD	HL,HL
  C84A  29            		ADD	HL,HL
  C84B  29            		ADD	HL,HL
  C84C  29            		ADD	HL,HL
  C84D  29            		ADD	HL,HL
  C84E  2B            		DEC	HL
  C84F  2B            		DEC	HL
  C850  2B            		DEC	HL
  C851  22A8ED        		LD	(BANKCL),HL
  C854  3E01          		LD	A,1
  C856  32A0ED        		LD	(BANKFL),A
  C859                	NOBANK:
  C859                	EMM:
  C859  CD38C9        		CALL	EADR0
  C85C  ED78          		IN	A,(C)
  C85E  F5            		PUSH	AF
                      	
  C85F  110000        		LD	DE,0
  C862                	ECHECK1:
  C862  13            		INC	DE
  C863  CD1BC9        		CALL	EADR2
  C866  ED60          		IN	H,(C)
  C868  CD1BC9        		CALL	EADR2
  C86B  7C            		LD	A,H
  C86C  C6E5          		ADD	A,0E5H
  C86E  ED79          		OUT	(C),A
  C870  3C            		INC	A
  C871  CD38C9        		CALL	EADR0
  C874  ED79          		OUT	(C),A
  C876  3D            		DEC	A
  C877  CD1BC9        		CALL	EADR2
  C87A  ED68          		IN	L,(C)
  C87C  CD1BC9        		CALL	EADR2
  C87F  ED61          		OUT	(C),H
  C881  BD            		CP	L
  C882  2004          		JR	NZ,ECHECK2
  C884  CB5A          		BIT	3,D
  C886  28DA          		JR	Z,ECHECK1
  C888                	ECHECK2:
  C888  CD38C9        		CALL	EADR0
  C88B  F1            		POP	AF
  C88C  ED79          		OUT	(C),A
                      	
  C88E  21F7FF        		LD	HL,0-9
  C891  19            		ADD	HL,DE
  C892  3008          		JR	NC,NOEMM
  C894  2288ED        		LD	(EMMCL),HL
  C897  3E03          		LD	A,3
  C899  3280ED        		LD	(EMMFL),A
  C89C                	NOEMM:
  C89C  3E00          	KEYREP:	LD	A,000H
  C89E  B7            		OR	A
  C89F  2807          		JR	Z,KEYR1
  C8A1  010000        		LD	BC,0
  C8A4  ED438CEC      		LD	(_CTC),BC
  C8A8                	KEYR1:
  C8A8  0130F8        		LD	BC,0-80*25
  C8AB  2ABAEC        		LD	HL,(CRTCD+10)
  C8AE  ED43BAEC      		LD	(CRTCD+10),BC
  C8B2  1E0C          		LD	E,00CH
  C8B4  CDCDEC        		CALL	_PRINT
  C8B7  22BAEC        		LD	(CRTCD+10),HL
                      	
  C8BA  219AC9        		LD	HL,INIMES
  C8BD                	INIMES1:
  C8BD  7E            		LD	A,(HL)
  C8BE  23            		INC	HL
  C8BF  B7            		OR	A
  C8C0  2806          		JR	Z,INIMES2
  C8C2  5F            		LD	E,A
  C8C3  CDCDEC        		CALL	_PRINT
  C8C6  18F5          		JR	INIMES1
  C8C8                	INIMES2:
  C8C8  3A87FF        		LD	A,(0FF87H)
  C8CB  FE08          		CP	8
  C8CD  301E          		JR	NC,INIT0
  C8CF  5F            		LD	E,A
  C8D0  C641          		ADD	A,'A'
  C8D2  3297C9        		LD	(AUTODV),A
  C8D5  0E0E          		LD	C,00EH
  C8D7  CD0500        		CALL	SYSTEM
  C8DA  1C            		INC	E
  C8DB  2185EC        		LD	HL,_SEEKSP	;Disk error Ignore
  C8DE  CBFE          		SET	7,(HL)
  C8E0  0E1B          		LD	C,01BH
  C8E2  CD0500        		CALL	SYSTEM
  C8E5  2185EC        		LD	HL,_SEEKSP
  C8E8  CBBE          		RES	7,(HL)
                      	
  C8EA  3C            		INC	A
  C8EB  2008          		JR	NZ,INIT1
  C8ED                	INIT0:
  C8ED  1E00          		LD	E,0
  C8EF  0E0E          		LD	C,00EH
  C8F1  CD0500        		CALL	SYSTEM
  C8F4  AF            		XOR	A
  C8F5                	INIT1:
  C8F5  2100FF        		LD	HL,0FF00H
  C8F8  1101FF        		LD	DE,0FF01H
  C8FB  01FF00        		LD	BC,000FFH
  C8FE  75            		LD	(HL),L
  C8FF  EDB0          		LDIR
                      	
  C901  210000        		LD	HL,0
  C904  E5            		PUSH	HL
  C905  B7            		OR	A
  C906  C8            		RET	Z
                      	
  C907  3EE6          		LD	A,0E6H
  C909  CD5DDA        		CALL	COMOUT
  C90C  CD42DA        		CALL	IN49SB
  C90F  CD42DA        		CALL	IN49SB
  C912  FE1B          		CP	01BH
  C914  C8            		RET	Z
  C915  118EC9        		LD	DE,AUTOD
  C918  C3FDEC        		JP	_COMANL
                      	
  C91B                	EADR2:
  C91B  D5            		PUSH	DE
  C91C  EB            		EX	DE,HL
  C91D  29            		ADD	HL,HL
  C91E  29            		ADD	HL,HL
  C91F  ED4B8BED      		LD	BC,(EMMBL-1)
  C923  0E00          		LD	C,0
  C925  09            		ADD	HL,BC
  C926  ED4B93ED      		LD	BC,(EMMDV)
  C92A  060D          		LD	B,00DH
  C92C  ED49          		OUT	(C),C
  C92E  0C            		INC	C
  C92F  ED69          		OUT	(C),L
  C931  0C            		INC	C
  C932  ED61          		OUT	(C),H
  C934  0C            		INC	C
  C935  EB            		EX	DE,HL
  C936  D1            		POP	DE
  C937  C9            		RET
                      	
  C938                	EADR0:
  C938  ED4B93ED      		LD	BC,(EMMDV)
  C93C  060D          		LD	B,00DH
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C93E  ED71          		DB	0EDH,071H
  C940  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C941  ED71          		DB	0EDH,071H
  C943  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C944  ED71          		DB	0EDH,071H
  C946  0C            		INC	C
  C947  C9            		RET
                      	
  C948                	CHKCTC:
  C948  C5            		PUSH	BC
  C949  110347        		LD	DE,04703H
  C94C                	INICTC1:
  C94C  0C            		INC	C
  C94D  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C94F  ED71          		DB	0EDH,071H
  C951  1D            		DEC	E
  C952  20F8          		JR	NZ,INICTC1
  C954  C1            		POP	BC
                      	
  C955  11FA07        		LD	DE,007FAH
  C958  ED51          		OUT	(C),D
  C95A  ED59          		OUT	(C),E
  C95C  ED78          		IN	A,(C)
  C95E  BB            		CP	E
  C95F  C0            		RET	NZ
  C960  ED51          		OUT	(C),D
  C962  ED51          		OUT	(C),D
  C964  ED78          		IN	A,(C)
  C966  BA            		CP	D
  C967  C0            		RET	NZ
  C968  03            		INC	BC
  C969  03            		INC	BC
  C96A  ED438CEC      		LD	(_CTC),BC
  C96E  C9            		RET
                      	
  C96F                	SETCRTC:
  C96F  21B0EC        		LD	HL,CRTCD
  C972  AF            		XOR	A
  C973                	SETCRT1:
  C973  010018        		LD	BC,01800H
  C976  ED79          		OUT	(C),A
  C978  0C            		INC	C
  C979  04            		INC	B
  C97A  EDA3          		OUTI
  C97C  3C            		INC	A
  C97D  FE0C          		CP	12
  C97F  20F2          		JR	NZ,SETCRT1
  C981  23            		INC	HL
  C982  23            		INC	HL
  C983  01031B        		LD	BC,01A03H+00100H
  C986  EDA3          		OUTI
  C988  01D020        		LD	BC,01FD0H+00100H
  C98B  EDA3          		OUTI
  C98D  C9            		RET
                      	
  C98E  4155544F455845	AUTOD:	DB	"AUTOEXEC "
  C997  413A00        	AUTODV:	DB	"A:",0
                      	
  C99A  A54C53582D446F	INIMES:	DB	0A5H, "LSX-Dodgers for X1/turbo version "
  C9BC  312E          		DB	030H + VER_1, '.'
  C9BE  3237          		DB	030H + VER_2 ,030H + VER_3
  C9C0  2047616B752028		DB	' Gaku (Lovers/Tablacus)',0DH,0AH
  C9D9  00            		DB	0
                      	
  C9DA                	_C8025H:
  C9DA  6B5059881B0119		DB	06BH,050H,059H,088H,01BH,001H,019H,01AH
  C9E2  000F          		DB	000H,00FH
  C9E4  80F8B0FF      		DW	0-80*LINE,0-80
  C9E8  0CA3          		DB	00CH,0A3H
                      	
  C9EA  030C0F30333C3F	TEXTDT:	DB	003H,00CH,00FH,030H,033H,03CH,03FH
                      	
  C9F1                	SIODATA:
  C9F1  18            		DB	018H
  C9F2  0100          		DB	1,0
  C9F4  0200          		DB	2,0
  C9F6  03C1          		DB	3,0C1H
  C9F8  0444          		DB	4,044H
  C9FA  05E8          		DB	5,0E8H
  C9FC  FF            		DB	0FFH
                      	
  C9FD                	AT_SCR1:
  C9FD  D9            		EXX
  C9FE  C5            		PUSH	BC
  C9FF  015020        		LD	BC,02000H+80
  CA02  D9            		EXX
  CA03  C5            		PUSH	BC
  CA04  010020        		LD	BC,02000H
                      	
  CA07  67            		LD	H,A
  CA08  B7            		OR	A
  CA09                	AT_SCRUP1:
  CA09  2815          		JR	Z,AT_SCRCL
  CA0B  C5            		PUSH	BC
  CA0C  CBE0          		SET	4,B
  CA0E  D9            		EXX
  CA0F  C5            		PUSH	BC
  CA10  CBE0          		SET	4,B
  CA12  D9            		EXX
  CA13  CD6DEB        		CALL	AT_UPSUB+AT_R
  CA16  D9            		EXX
  CA17  C1            		POP	BC
  CA18  D9            		EXX
  CA19  C1            		POP	BC
  CA1A  CD6DEB        		CALL	AT_UPSUB+AT_R
  CA1D  25            		DEC	H
  CA1E  18E9          		JR	AT_SCRUP1
                      	
  CA20                	AT_SCRCL:
  CA20  211020        		LD	HL,02000H+16
  CA23  3A96EC        		LD	A,(_COLORF)
  CA26                	AT_SCRCL1:
  CA26  CBE0          		SET	4,B
  CA28  ED61          		OUT	(C),H
  CA2A  CBA0          		RES	4,B
  CA2C  ED79          		OUT	(C),A
  CA2E  03            		INC	BC
  CA2F  CBE0          		SET	4,B
  CA31  ED61          		OUT	(C),H
  CA33  CBA0          		RES	4,B
  CA35  ED79          		OUT	(C),A
  CA37  03            		INC	BC
  CA38  CBE0          		SET	4,B
  CA3A  ED61          		OUT	(C),H
  CA3C  CBA0          		RES	4,B
  CA3E  ED79          		OUT	(C),A
  CA40  03            		INC	BC
  CA41  CBE0          		SET	4,B
  CA43  ED61          		OUT	(C),H
  CA45  CBA0          		RES	4,B
  CA47  ED79          		OUT	(C),A
  CA49  03            		INC	BC
  CA4A  CBE0          		SET	4,B
  CA4C  ED61          		OUT	(C),H
  CA4E  CBA0          		RES	4,B
  CA50  ED79          		OUT	(C),A
  CA52  03            		INC	BC
  CA53  2D            		DEC	L
  CA54  20D0          		JR	NZ,AT_SCRCL1
  CA56  C1            		POP	BC
  CA57  D9            		EXX
  CA58  C1            		POP	BC
  CA59  D9            		EXX
  CA5A  C9            		RET
                      	
  CA5B                	AT_SCRE:
                      	
                      	;	FLOPPY DISK DRIVER(CPU)
                      	
  CA5B                	AT_WTTRK:
  CA5B  3EF0          		LD	A,0F0H
  CA5D  1802          		JR	AT_WTTRK1
                      	
  CA5F                	AT_DWT:
  CA5F  3EA0          		LD	A,0A0H
  CA61                	AT_WTTRK1:
  CA61  325AEA        		LD	(DWTPAT+1+AT_R),A
                      	
  CA64  3E02          		LD	A,2		;Retry count
  CA66  323EEA        		LD	(RETRY),A
                      	
  CA69                	DWT0:
  CA69  D5            		PUSH	DE
  CA6A  E5            		PUSH	HL
  CA6B  2210EB        		LD	(DHLPAT+1+AT_R),HL
  CA6E  CD48E9        		CALL	SEEK		;Write disk
  CA71  E1            		POP	HL
  CA72  3830          		JR	C,ERRDW
  CA74  F3            		DI
  CA75  3EA0          	DWTPAT:	LD	A,0A0H
  CA77  CDF4E9        		CALL	SECSET
  CA7A  0EFB          		LD	C,0FBH
                      	
  CA7C                	DWT1:
  CA7C  56            		LD	D,(HL)
  CA7D                	DWT2:
  CA7D  78            		LD	A,B
  CA7E  DBF8          		IN	A,(0F8H)
  CA80  0F            		RRCA
  CA81  3008          		JR	NC,DWT4
  CA83  0F            		RRCA
  CA84  30F7          		JR	NC,DWT2
  CA86                	DWT3:
  CA86  ED51          		OUT	(C),D
  CA88  23            		INC	HL
  CA89  18F1          		JR	DWT1
                      	
  CA8B                	DWT4:
  CA8B  3D            		DEC	A
  CA8C  28F8          		JR	Z,DWT3
  CA8E  3C            		INC	A
  CA8F  FB            		EI
  CA90  D1            		POP	DE
  CA91  13            		INC	DE
  CA92  CDE8E9        		CALL	FDMOFF
  CA95  C8            		RET	Z
  CA96  CDDBEA        		CALL	DISKC+AT_R
  CA99  20CE          		JR	NZ,DWT0
  CA9B  B7            		OR	A
  CA9C  C8            		RET	Z
  CA9D                	ERRW:
  CA9D  3EFF          		LD	A,0FFH
  CA9F                	ERRZ:
  CA9F  BF            		CP	A
  CAA0  37            		SCF
  CAA1  C3E8E9        		JP	FDMOFF
                      	
  CAA4                	ERRDW:
  CAA4  D1            		POP	DE
  CAA5  CDECEA        		CALL	AT_DELP+AT_R
  CAA8  20BF          		JR	NZ,DWT0
  CAAA  B7            		OR	A
  CAAB  20F0          		JR	NZ,ERRW
  CAAD  C9            		RET
                      	
  CAAE                	AT_DRD:
  CAAE  3E80          		LD	A,080H
  CAB0  32ACEA        		LD	(DRDPAT+1+AT_R),A
  CAB3  325AEA        		LD	(DWTPAT+1+AT_R),A
                      	
  CAB6  3E02          		LD	A,2		;Retry count
  CAB8  323EEA        		LD	(RETRY),A
                      	
  CABB                	DRD0:
  CABB  D5            		PUSH	DE
  CABC  E5            		PUSH	HL
  CABD  2210EB        		LD	(DHLPAT+1+AT_R),HL
  CAC0  CD48E9        		CALL	SEEK		;Read disk
  CAC3  E1            		POP	HL
  CAC4  3827          		JR	C,ERRDR
  CAC6  F3            		DI
  CAC7                	DRDPAT:
  CAC7  3E80          		LD	A,080H
  CAC9  CDF4E9        		CALL	SECSET
  CACC  0EFB          		LD	C,0FBH
  CACE                	DRD1:
  CACE  78            		LD	A,B
  CACF  DBF8          		IN	A,(0F8H)
  CAD1  0F            		RRCA
  CAD2  3008          		JR	NC,DRD3
  CAD4  0F            		RRCA
  CAD5  30F7          		JR	NC,DRD1
  CAD7  EDA2          		INI
  CAD9  04            		INC	B
  CADA  18F2          		JR	DRD1
                      	
  CADC                	DRD3:
  CADC  B7            		OR	A
  CADD  FB            		EI
  CADE  D1            		POP	DE
  CADF  13            		INC	DE
  CAE0  CDE8E9        		CALL	FDMOFF
  CAE3  C8            		RET	Z
  CAE4  CDDBEA        		CALL	DISKC+AT_R
  CAE7  20D2          		JR	NZ,DRD0
  CAE9  B7            		OR	A
  CAEA  20B1          		JR	NZ,ERRW
  CAEC  C9            		RET
                      	
  CAED                	ERRDR:
  CAED  D1            		POP	DE
  CAEE  CDECEA        		CALL	AT_DELP+AT_R
  CAF1  20C8          		JR	NZ,DRD0
  CAF3  B7            		OR	A
  CAF4  20A7          		JR	NZ,ERRW
  CAF6  C9            		RET
                      	
  CAF7                	DISKC:
  CAF7  1B            		DEC	DE
  CAF8  CB5F          		BIT	3,A
  CAFA  C40CEA        		CALL	NZ,RNF
  CAFD                	DISKD:
  CAFD  E5            		PUSH	HL
  CAFE  213EEA        		LD	HL,RETRY
  CB01  35            		DEC	(HL)
  CB02  E1            		POP	HL
  CB03  203E          		JR	NZ,AT_ERR		;Retry
  CB05  B7            		OR	A
  CB06  283B          		JR	Z,AT_ERR		;Error
                      	
  CB08                	AT_DELP:
  CB08  CD0CEA        		CALL	RNF
  CB0B  CDE8E9        		CALL	FDMOFF
  CB0E  3A85EC        		LD	A,(_SEEKSP)
  CB11  87            		ADD	A,A
  CB12  382E          		JR	C,AT_ERRZ
  CB14                	AT_DELP1:
  CB14  D5            		PUSH	DE
  CB15  2112EA        		LD	HL,DEMES
  CB18  CDFAD7        		CALL	MSX
  CB1B  CD77D6        		CALL	KEYBC
  CB1E                	AT_DELP2:
  CB1E  CD12DC        		CALL	INKEY
  CB21  28FB          		JR	Z,AT_DELP2
                      	
  CB23  D1            		POP	DE
  CB24  CD6EDF        		CALL	CAP
  CB27  FE52          		CP	'R'
  CB29  200A          		JR	NZ,AT_DELP3
  CB2B  210000        	DHLPAT:	LD	HL,0
  CB2E  3E02          		LD	A,2
  CB30  323EEA        		LD	(RETRY),A
  CB33  B7            		OR	A
  CB34  C9            		RET
  CB35                	AT_DELP3:
  CB35  FE49          		CP	'I'
  CB37  2807          		JR	Z,AT_IGNORE
  CB39  FE41          		CP	'A'
  CB3B  20D7          		JR	NZ,AT_DELP1
  CB3D  C3F5D9        		JP	BOOT
  CB40                	AT_IGNORE:
  CB40  3EFF          		LD	A,0FFH
  CB42                	AT_ERRZ:
  CB42  BF            		CP	A
  CB43                	AT_ERR:
  CB43  3EFF          		LD	A,0FFH
  CB45  C9            		RET
                      	
                      	
                      	;	EMM DRIVER(CPU)
                      	
                      	
  CB46                	AT_EDRDC:
  CB46  CD52EB        		CALL	AT_EADR+AT_R
  CB49                	AT_EDRDC1:
  CB49  EDA2          		INI
  CB4B  04            		INC	B
  CB4C  EDA2          		INI
  CB4E  04            		INC	B
  CB4F  EDA2          		INI
  CB51  04            		INC	B
  CB52  EDA2          		INI
  CB54  04            		INC	B
  CB55  3D            		DEC	A
  CB56  20F1          		JR	NZ,AT_EDRDC1
  CB58  AF            		XOR	A
  CB59  C9            		RET
                      	
  CB5A                	AT_EDWTC:
  CB5A  CD52EB        		CALL	AT_EADR+AT_R
  CB5D                	AT_EDWTC1:
  CB5D  04            		INC	B
  CB5E  EDA3          		OUTI
  CB60  04            		INC	B
  CB61  EDA3          		OUTI
  CB63  04            		INC	B
  CB64  EDA3          		OUTI
  CB66  04            		INC	B
  CB67  EDA3          		OUTI
  CB69  3D            		DEC	A
  CB6A  20F1          		JR	NZ,AT_EDWTC1
  CB6C  AF            		XOR	A
  CB6D  C9            		RET
                      	
  CB6E                	AT_EADR:
  CB6E  D5            		PUSH	DE
  CB6F  EB            		EX	DE,HL
  CB70  29            		ADD	HL,HL
  CB71  29            		ADD	HL,HL
  CB72  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CB76  0E00          		LD	C,0
  CB78  09            		ADD	HL,BC
  CB79  060D          		LD	B,00DH
  CB7B  ED49          		OUT	(C),C
  CB7D  0C            		INC	C
  CB7E  ED69          		OUT	(C),L
  CB80  0C            		INC	C
  CB81  ED61          		OUT	(C),H
  CB83  0C            		INC	C
  CB84  EB            		EX	DE,HL
  CB85  D1            		POP	DE
  CB86  13            		INC	DE
  CB87  AF            		XOR	A
  CB88  C9            		RET
                      	
  CB89                	AT_UPSUB:
  CB89  2E0A          		LD	L,10
  CB8B                	AT_UPSUB1:
  CB8B  D9            		EXX
  CB8C  ED78          		IN	A,(C)
  CB8E  03            		INC	BC
  CB8F  D9            		EXX
  CB90  ED79          		OUT	(C),A
  CB92  03            		INC	BC
  CB93  D9            		EXX
  CB94  ED78          		IN	A,(C)
  CB96  03            		INC	BC
  CB97  D9            		EXX
  CB98  ED79          		OUT	(C),A
  CB9A  03            		INC	BC
  CB9B  D9            		EXX
  CB9C  ED78          		IN	A,(C)
  CB9E  03            		INC	BC
  CB9F  D9            		EXX
  CBA0  ED79          		OUT	(C),A
  CBA2  03            		INC	BC
  CBA3  D9            		EXX
  CBA4  ED78          		IN	A,(C)
  CBA6  03            		INC	BC
  CBA7  D9            		EXX
  CBA8  ED79          		OUT	(C),A
  CBAA  03            		INC	BC
  CBAB  D9            		EXX
  CBAC  ED78          		IN	A,(C)
  CBAE  03            		INC	BC
  CBAF  D9            		EXX
  CBB0  ED79          		OUT	(C),A
  CBB2  03            		INC	BC
  CBB3  D9            		EXX
  CBB4  ED78          		IN	A,(C)
  CBB6  03            		INC	BC
  CBB7  D9            		EXX
  CBB8  ED79          		OUT	(C),A
  CBBA  03            		INC	BC
  CBBB  D9            		EXX
  CBBC  ED78          		IN	A,(C)
  CBBE  03            		INC	BC
  CBBF  D9            		EXX
  CBC0  ED79          		OUT	(C),A
  CBC2  03            		INC	BC
  CBC3  D9            		EXX
  CBC4  ED78          		IN	A,(C)
  CBC6  03            		INC	BC
  CBC7  D9            		EXX
  CBC8  ED79          		OUT	(C),A
  CBCA  03            		INC	BC
  CBCB  2D            		DEC	L
  CBCC  C26FEB        		JP	NZ,AT_UPSUB1+AT_R
  CBCF  C9            		RET
                      	
  CBD0                	AT_CPUE:
  CBD0                	INITE:
  CBD0                		DS	0CC06H-INITE
                      	
                      	;LDCCP.ASM
                      	
                      	;	LSX-Dodgers CCP
                      	
  CC06                	BDOS:
  CC06  C343D2        		JP	BDOS0
                      	
  CC09  2020          		DB	020H,020H
  0040                	PATHX	EQU	64
  CC0B                	PATHD:	DS	PATHX
  CC4B  00            	PATHE:	DB	0
                      	
  CC4C  4F6B24        	OK:	DB	"Ok$"
  CC4F  536B697024    	SKIP:	DB	"Skip$"
  CC54  6B206279746573	KBFREE:	DB	"k bytes free",9,'$'
  CC62  20202020646972	DIRMES:	DB	"    dir $"
  CC6B  074572726F7221	COMERM:	DB	7,"Error!$"
                      	
  CC73  09            	COMS	DB	9
  CC74                	COMTB:
  CC74  44202020      		DB	"D   "	;1
  CC78  CBCE          		DW	C_DIR
  CC7A  44495220      		DB	"DIR "	;2
  CC7E  CBCE          		DW	C_DIR
  CC80  434F5059      		DB	"COPY"	;3
  CC84  CAD0          		DW	C_COPY
  CC86  43442020      		DB	"CD  "	;4
  CC8A  C3CD          		DW	C_CD
  CC8C  44454C20      		DB	"DEL "	;5
  CC90  B1CE          		DW	C_DEL
  CC92  50415448      		DB	"PATH"	;6
  CC96  7FCF          		DW	C_PATH
  CC98  52454E20      		DB	"REN "	;7
  CC9C  BDCE          		DW	C_REN
  CC9E  54595045      		DB	"TYPE"	;8
  CCA2  EDD1          		DW	C_TYPE
  CCA4  52454D20      		DB	"REM "	;9
  CCA8  AFCE          		DW	C_REM
                      	
  CCAA                	_SYS00:
  CCAA  F3            		DI
  CCAB  310000        		LD	SP,STACK
                      	
  CCAE  3EEC          		LD	A,INTVEC/256
  CCB0  ED47          		LD	I,A
                      	
  CCB2  3EE4          		LD	A,0E4H
  CCB4  CD5DDA        		CALL	COMOUT
  CCB7  3EC8          		LD	A,INTVEC
  CCB9  CD37DA        		CALL	OT49SB
                      	
  CCBC  3ABCEC        		LD	A,(CRTCD+12)
  CCBF  B7            		OR	A
  CCC0  200C          		JR	NZ,SETCRT0
  CCC2  2180F8        		LD	HL,0-80*LINE
  CCC5  22BAEC        		LD	(CRTCD+10),HL
  CCC8  21B0FF        		LD	HL,0-80
  CCCB  22BCEC        		LD	(CRTCD+12),HL
  CCCE                	SETCRT0:
  CCCE  21B0EC        		LD	HL,CRTCD
  CCD1  AF            		XOR	A
  CCD2                	SETCRT2:
  CCD2  010018        		LD	BC,01800H
  CCD5  ED79          		OUT	(C),A
  CCD7  0C            		INC	C
  CCD8  04            		INC	B
  CCD9  EDA3          		OUTI
  CCDB  3C            		INC	A
  CCDC  FE0C          		CP	12
  CCDE  20F2          		JR	NZ,SETCRT2
  CCE0  0D            		DEC	C
  CCE1  ED79          		OUT	(C),A
  CCE3  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CCE4  ED71          		DB	0EDH,071H
  CCE6  0D            		DEC	C
  CCE7  3C            		INC	A
  CCE8  ED79          		OUT	(C),A
  CCEA  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CCEB  ED71          		DB	0EDH,071H
  CCED  23            		INC	HL
  CCEE  23            		INC	HL
  CCEF  01031B        		LD	BC,01A03H+00100H
  CCF2  EDA3          		OUTI
  CCF4  01D020        		LD	BC,01FD0H+00100H
  CCF7  EDA3          		OUTI
  CCF9  CD75CF        		CALL	LTNL
  CCFC                	COMMAND:
  CCFC  CDB7CD        		CALL	SETDTA1
  CCFF  D5            		PUSH	DE
  CD00  3A87EC        		LD	A,(_DVSW)
  CD03  C641          		ADD	A,'A'
  CD05  5F            		LD	E,A
  CD06  CDCDEC        		CALL	_PRINT
  CD09  1E3E          		LD	E,'>'
  CD0B  CDCDEC        		CALL	_PRINT
  CD0E  D1            		POP	DE		;DE=DTA1
  CD0F  3E50          		LD	A,80
  CD11  12            		LD	(DE),A
  CD12  0E0A          		LD	C,00AH
  CD14  CD0500        		CALL	SYSTEM
  CD17  CD75CF        		CALL	LTNL
                      	
  CD1A  118200        		LD	DE,DTA1+2
  CD1D  CDFDEC        		CALL	_COMANL
  CD20  30DA          		JR	NC,COMMAND
  CD22  CD77D6        		CALL	KEYBC
  CD25  116BCC        		LD	DE,COMERM
  CD28  CD6ED2        		CALL	_SYS09
  CD2B  C7            		RST	0
                      	
  CD2C                	COMANL:
  CD2C  CD83DC        		CALL	FILE
  CD2F  D5            		PUSH	DE
  CD30  11DC00        		LD	DE,FNAME
  CD33  1A            		LD	A,(DE)
  CD34  FE20          		CP	020H
  CD36  2849          		JR	Z,SDVSW
  CD38  1B            		DEC	DE
  CD39  1A            		LD	A,(DE)
  CD3A  C6FF          		ADD	A,0FFH
  CD3C  380B          		JR	C,COMB
  CD3E  13            		INC	DE
                      	
  CD3F  2174CC        		LD	HL,COMTB
  CD42  3A73CC        		LD	A,(COMS)
  CD45  47            		LD	B,A
  CD46  CD07DF        		CALL	CPNAME
  CD49                	COMB:
  CD49  D1            		POP	DE
  CD4A  D20F00        		JP	NC,K_HL
  CD4D  EB            		EX	DE,HL
  CD4E  222DCE        		LD	(COMPAT+1),HL
  CD51  2287CE        		LD	(BATPAT+1),HL
  CD54  F5            		PUSH	AF
  CD55  CDD5CD        		CALL	CEXE4
  CD58  F1            		POP	AF
  CD59  21DC00        		LD	HL,FNAME
  CD5C  116D00        		LD	DE,FCB2+1	;COMMAND NAME
  CD5F  010B00        		LD	BC,11
  CD62  EDB0          		LDIR
  CD64  110BCC        		LD	DE,PATHD
  CD67                	CEX1:
  CD67  1A            		LD	A,(DE)
  CD68  FE20          		CP	020H
  CD6A  D8            		RET	C
  CD6B  CD78DC        		CALL	FILEC
  CD6E  D5            		PUSH	DE
  CD6F  216D00        		LD	HL,FCB2+1	;COMMAND NAME
  CD72  11DC00        		LD	DE,FNAME
  CD75  010B00        		LD	BC,11
  CD78  EDB0          		LDIR
  CD7A  CDD5CD        		CALL	CEXE4
  CD7D  D1            		POP	DE
  CD7E  13            		INC	DE
  CD7F  18E6          		JR	CEX1
                      	
  CD81                	SDVSW:
  CD81  F1            		POP	AF
  CD82  3ADB00        		LD	A,(FDRV)
  CD85  3D            		DEC	A
  CD86  5F            		LD	E,A
  CD87  0E0E          		LD	C,00EH
  CD89  1833          		JR	SYSTEM0
                      	
  CD8B                	OPEN1:
  CD8B  21DB00        		LD	HL,FDRV
  CD8E                	OPEN:
  CD8E  0E11          		LD	C,011H
  CD90                	OPEN3:
  CD90  D5            		PUSH	DE
  CD91  1151FF        		LD	DE,DTA
  CD94  CDB4CD        		CALL	SETDTA
  CD97  EB            		EX	DE,HL
  CD98  CD0500        		CALL	SYSTEM
  CD9B  D1            		POP	DE
  CD9C  B7            		OR	A
  CD9D  C9            		RET
                      	
  CD9E                	OPEN2:
  CD9E  0E12          		LD	C,012H
  CDA0  18EE          		JR	OPEN3
                      	
  CDA2                	DEFCB:				;Z=Ok NZ=Error
  CDA2  1151FF        		LD	DE,DTA
  CDA5  CDBCCD        		CALL	SYSC0F
                      	
  CDA8  210000        		LD	HL,0
  CDAB  2272FF        		LD	(DTA+33),HL
  CDAE  2274FF        		LD	(DTA+35),HL
  CDB1  110001        		LD	DE,00100H
  CDB4                	SETDTA:
  CDB4  C3B3D4        		JP	_SYS1A
                      	
  CDB7                	SETDTA1:
  CDB7  118000        		LD	DE,DTA1
  CDBA  18F8          		JR	SETDTA
                      	
  CDBC                	SYSC0F:
  CDBC  0E0F          		LD	C,00FH
  CDBE                	SYSTEM0:
  CDBE  CD0500        		CALL	SYSTEM
  CDC1  B7            		OR	A
  CDC2  C9            		RET
                      	
  CDC3                	C_CD:
  CDC3  CD78DC        		CALL	FILEC
  CDC6  210000        		LD	HL,0
  CDC9  11DB00        		LD	DE,FDRV
  CDCC  1803          		JR	S27
                      	
  CDCE                	S27DTA:
  CDCE  1151FF        		LD	DE,DTA
  CDD1                	S27:
  CDD1  0E27          		LD	C,027H
  CDD3  18E9          		JR	SYSTEM0
                      	
  CDD5                	CEXE4:
  CDD5  3ADB00        		LD	A,(FDRV)
  CDD8  325700        		LD	(00057H),A
  CDDB  2AE900        		LD	HL,(FDRV+14)
  CDDE  225800        		LD	(00058H),HL
                      	
  CDE1  21E400        		LD	HL,FNAME+8
  CDE4  7E            		LD	A,(HL)
  CDE5  FE20          		CP	020H
  CDE7  2007          		JR	NZ,CEXE7
  CDE9  3E3F          		LD	A,'?'
  CDEB  77            		LD	(HL),A
  CDEC  23            		INC	HL
  CDED  77            		LD	(HL),A
  CDEE  23            		INC	HL
  CDEF  77            		LD	(HL),A
  CDF0                	CEXE7:
  CDF0  CD8BCD        		CALL	OPEN1
  CDF3                	CEXE5:
  CDF3  C0            		RET	NZ
  CDF4  2A5BFF        		LD	HL,(DTA+1+9)
  CDF7  7C            		LD	A,H
  CDF8  CD6EDF        		CALL	CAP
  CDFB  67            		LD	H,A
  CDFC  7D            		LD	A,L
  CDFD  CD6EDF        		CALL	CAP
  CE00  6F            		LD	L,A
  CE01  3A5AFF        		LD	A,(DTA+1+8)
  CE04  CD6EDF        		CALL	CAP
  CE07  D642          		SUB	'B'
  CE09  2831          		JR	Z,C_BAT
  CE0B  3D            		DEC	A		;'C'
  CE0C  2805          		JR	Z,C_EXE
  CE0E                	CEXE6:
  CE0E  CD9ECD        		CALL	OPEN2
  CE11  18E0          		JR	CEXE5
                      	
  CE13                	C_EXE:
  CE13  7C            		LD	A,H
  CE14  FE4D          		CP	'M'
  CE16  20F6          		JR	NZ,CEXE6
                      	
  CE18  CDA2CD        		CALL	DEFCB
  CE1B  2A0600        		LD	HL,(SYSTEM+1)
  CE1E  25            		DEC	H
  CE1F  CDCECD        		CALL	S27DTA
  CE22  3D            		DEC	A
  CE23  37            		SCF
  CE24  C0            		RET	NZ
  CE25  7C            		LD	A,H
  CE26  B5            		OR	L
  CE27  37            		SCF
  CE28  C8            		RET	Z
  CE29  CDB7CD        		CALL	SETDTA1
  CE2C  110000        	COMPAT:	LD	DE,0
  CE2F  CD85D0        		CALL	SETFCB
  CE32  AF            		XOR	A
  CE33  67            		LD	H,A
  CE34  6F            		LD	L,A
  CE35  310000        		LD	SP,STACK
  CE38  E5            		PUSH	HL
  CE39  C30001        		JP	00100H
                      	
  CE3C                	C_BAT:
  CE3C  114154        		LD	DE,'A'+'T'*256
  CE3F  ED52          		SBC	HL,DE
  CE41  20CB          		JR	NZ,CEXE6
                      	
  CE43  F1            		POP	AF
  CE44  F1            		POP	AF
  CE45  CDA2CD        		CALL	DEFCB
  CE48  210002        		LD	HL,00200H
  CE4B  CDCECD        		CALL	S27DTA
  CE4E  C6FE          		ADD	A,0FEH
  CE50  D8            		RET	C
  CE51  7D            		LD	A,L
  CE52  B7            		OR	A
  CE53  37            		SCF
  CE54  C8            		RET	Z
  CE55  3C            		INC	A
  CE56  F5            		PUSH	AF
                      	
  CE57  CD77D6        		CALL	KEYBC
  CE5A  1E1A          		LD	E,01AH
  CE5C  CDCDEC        		CALL	_PRINT
  CE5F  C1            		POP	BC
  CE60  210001        		LD	HL,00100H
  CE63                	BAT1:
  CE63  A7            		AND	A
  CE64  05            		DEC	B
  CE65  C8            		RET	Z
  CE66  7E            		LD	A,(HL)
  CE67  FE25          		CP	'%'
  CE69  280C          		JR	Z,BAT2
  CE6B                	BAT1X:
  CE6B  7E            		LD	A,(HL)
  CE6C  23            		INC	HL
  CE6D  FE1A          		CP	01AH
  CE6F  C8            		RET	Z
  CE70  FE0A          		CP	00AH
  CE72  C45DD6        		CALL	NZ,KEYBS
  CE75  18EC          		JR	BAT1
                      	
  CE77                	BAT2:
  CE77  23            		INC	HL
  CE78  7E            		LD	A,(HL)
  CE79  2B            		DEC	HL
  CE7A  D631          		SUB	'1'
  CE7C  38ED          		JR	C,BAT1X
  CE7E  FE09          		CP	9
  CE80  30E9          		JR	NC,BAT1X
  CE82  23            		INC	HL
  CE83  23            		INC	HL
  CE84  3C            		INC	A
  CE85  4F            		LD	C,A
  CE86  110000        	BATPAT:	LD	DE,0
  CE89                	BAT3:
  CE89  1A            		LD	A,(DE)
  CE8A  B7            		OR	A
  CE8B  28D6          		JR	Z,BAT1
  CE8D  CD5DDD        		CALL	SPCUT
  CE90  0D            		DEC	C
  CE91  2808          		JR	Z,BAT5
  CE93                	BAT4:
  CE93  1A            		LD	A,(DE)
  CE94  FE21          		CP	021H
  CE96  38F1          		JR	C,BAT3
  CE98  13            		INC	DE
  CE99  18F8          		JR	BAT4
  CE9B                	BAT5:
  CE9B  1A            		LD	A,(DE)
  CE9C  FE21          		CP	021H
  CE9E  38C3          		JR	C,BAT1
  CEA0  13            		INC	DE
  CEA1  CD5DD6        		CALL	KEYBS
  CEA4  18F5          		JR	BAT5
                      	
  CEA6                	SWITCH:
  CEA6  1A            		LD	A,(DE)
  CEA7                	SW1:
  CEA7  13            		INC	DE
  CEA8  B9            		CP	C
  CEA9  1A            		LD	A,(DE)
  CEAA  C8            		RET	Z
  CEAB  FE20          		CP	020H
  CEAD  30F8          		JR	NC,SW1
  CEAF                	C_REM:
  CEAF  AF            		XOR	A
  CEB0  C9            		RET
                      	
  CEB1                	C_DEL:
  CEB1  CD85D0        		CALL	SETFCB
  CEB4  0E08          		LD	C,8
  CEB6  CD0500        		CALL	SYSTEM
                      	
  CEB9  0E13          		LD	C,013H
  CEBB  1805          		JR	CDEL1
                      	
  CEBD                	C_REN:
  CEBD  CD85D0        		CALL	SETFCB
  CEC0  0E17          		LD	C,017H
  CEC2                	CDEL1:
  CEC2  115C00        		LD	DE,FCB1
  CEC5  CD0500        		CALL	SYSTEM
  CEC8  C6FF          		ADD	A,0FFH
  CECA  C9            		RET
                      	
  CECB                	C_DIR:
  CECB  CD78DC        		CALL	FILEC
  CECE  21DC00        		LD	HL,FDRV+1
  CED1  CD29D2        		CALL	CWILD1
  CED4  3EF1          		LD	A,0F1H
  CED6  32E800        		LD	(FDRV+13),A
  CED9  CD8BCD        		CALL	OPEN1
  CEDC                	CDIR1:
  CEDC  B7            		OR	A
  CEDD  2008          		JR	NZ,PDSKF
  CEDF  CD26CF        		CALL	P_NAME
  CEE2  CD9ECD        		CALL	OPEN2
  CEE5  18F5          		JR	CDIR1
                      	
  CEE7                	PDSKF:
  CEE7  3ADB00        		LD	A,(FDRV)
  CEEA  5F            		LD	E,A
  CEEB  0E1B          		LD	C,01BH
  CEED  CD0500        		CALL	SYSTEM
  CEF0  4F            		LD	C,A
  CEF1  C601          		ADD	A,001H
  CEF3  D8            		RET	C
  CEF4  AF            		XOR	A
  CEF5                	PDS1:
  CEF5  0D            		DEC	C
  CEF6  2804          		JR	Z,PDS2
  CEF8  29            		ADD	HL,HL
  CEF9  8F            		ADC	A,A
  CEFA  18F9          		JR	PDS1
  CEFC                	PDS2:
  CEFC  CB50          		BIT	2,B
  CEFE  2006          		JR	NZ,PDSKF1
  CF00  CB3F          		SRL	A
  CF02  CB1C          		RR	H
  CF04  CB1D          		RR	L
  CF06                	PDSKF1:
  CF06  CDB1CF        		CALL	PRDEC
  CF09  1154CC        		LD	DE,KBFREE
  CF0C  CD6ED2        		CALL	_SYS09
  CF0F  CDA3CF        		CALL	PUTDRV
  CF12  3E5C          		LD	A,05CH
  CF14  CDAED6        		CALL	MSG_
  CF17  2AE900        		LD	HL,(FDRV+14)
  CF1A  7C            		LD	A,H
  CF1B  B5            		OR	L
  CF1C  2857          		JR	Z,LTNL
  CF1E  2B            		DEC	HL
  CF1F  7C            		LD	A,H
  CF20  B5            		OR	L
  CF21  C4B0CF        		CALL	NZ,PRDEC0
  CF24  184F          		JR	LTNL
                      	
  CF26                	P_NAME:
  CF26  3A52FF        		LD	A,(DTA+1)
  CF29  FE2E          		CP	'.'
  CF2B  C8            		RET	Z
  CF2C  3E20          		LD	A,020H
  CF2E  CDAED6        		CALL	MSG_
  CF31  CDAED6        		CALL	MSG_
  CF34  3E3A          		LD	A,':'
  CF36  CDAED6        		CALL	MSG_
  CF39  3A5DFF        		LD	A,(DTA+1+00BH)
  CF3C  F5            		PUSH	AF
  CF3D  0F            		RRCA
  CF3E  9F            		SBC	A,A
  CF3F  E60A          		AND	'*'-020H
  CF41  C620          		ADD	A,020H
  CF43  0607          		LD	B,7
  CF45                	MZX:
  CF45  C5            		PUSH	BC
  CF46  CDAED6        		CALL	MSG_
  CF49  C1            		POP	BC
  CF4A  3E20          		LD	A,020H
  CF4C  10F7          		DJNZ	MZX
                      	
  CF4E  CDA3CF        		CALL	PUTDRV
  CF51  2152FF        		LD	HL,DTA+1
  CF54  CDF2CF        		CALL	FPRNT
                      	
  CF57  F1            		POP	AF
  CF58  CB67          		BIT	4,A
  CF5A  2808          		JR	Z,DIR3
  CF5C  1162CC        		LD	DE,DIRMES
  CF5F  CD6ED2        		CALL	_SYS09
  CF62  1809          		JR	DIR6
  CF64                	DIR3:
  CF64  3A70FF        		LD	A,(DTA+1+01EH)
  CF67  2A6EFF        		LD	HL,(DTA+1+01CH)
  CF6A  CDB1CF        		CALL	PRDEC
  CF6D                	DIR6:
  CF6D  3AB1EC        		LD	A,(CRTCD+1)
  CF70  FE29          		CP	40+1
  CF72  D414D0        		CALL	NC,PRTTMS
                      	
  CF75                	LTNL:
  CF75  1E0D          		LD	E,00DH
  CF77  CD29D7        		CALL	PRINTX
  CF7A  1E0A          		LD	E,00AH
  CF7C  C329D7        		JP	PRINTX
                      	
  CF7F                	C_PATH:
  CF7F  CD5DDD        		CALL	SPCUT
  CF82  210BCC        		LD	HL,PATHD
  CF85  FE21          		CP	021H
  CF87  300E          		JR	NC,CPATH0
  CF89  2B            		DEC	HL
  CF8A  2B            		DEC	HL
  CF8B                	CPATHP:
  CF8B  7E            		LD	A,(HL)
  CF8C  23            		INC	HL
  CF8D  FE20          		CP	020H
  CF8F  3F            		CCF
  CF90  30E3          		JR	NC,LTNL
  CF92  CDAED6        		CALL	MSG_
  CF95  18F4          		JR	CPATHP
  CF97                	CPATH0:
  CF97  FE3B          		CP	';'
  CF99  2001          		JR	NZ,CPATH1
  CF9B  13            		INC	DE
  CF9C                	CPATH1:
  CF9C  EB            		EX	DE,HL
  CF9D  014000        		LD	BC,PATHX
  CFA0  EDB0          		LDIR
  CFA2  C9            		RET
                      	
  CFA3                	PUTDRV:
  CFA3  3ADB00        		LD	A,(FDRV)
  CFA6  C640          		ADD	A,'A'-1
  CFA8  CDAED6        		CALL	MSG_
  CFAB  3E3A          		LD	A,':'
  CFAD                	MSGR:
  CFAD  C3AED6        		JP	MSG_
                      	
  CFB0                	PRDEC0:
  CFB0  AF            		XOR	A
  CFB1                	PRDEC:
  CFB1  5F            		LD	E,A
  CFB2  010000        		LD	BC,0
  CFB5  ED43D600      		LD	(DECBF),BC
  CFB9  ED43D800      		LD	(DECBF+2),BC
                      	
  CFBD  0E18          		LD	C,24
  CFBF                	DEC1:
  CFBF  29            		ADD	HL,HL
  CFC0  7B            		LD	A,E
  CFC1  8F            		ADC	A,A
  CFC2  5F            		LD	E,A
  CFC3  E5            		PUSH	HL
  CFC4  21D900        		LD	HL,DECBF+3
  CFC7  0604          		LD	B,4
  CFC9                	DEC2:
  CFC9  7E            		LD	A,(HL)
  CFCA  8F            		ADC	A,A
  CFCB  27            		DAA
  CFCC  77            		LD	(HL),A
  CFCD  2B            		DEC	HL
  CFCE  10F9          		DJNZ	DEC2
  CFD0  E1            		POP	HL
  CFD1  0D            		DEC	C
  CFD2  20EB          		JR	NZ,DEC1
                      	
  CFD4  21D600        		LD	HL,DECBF
  CFD7  3E20          		LD	A,020H
  CFD9  0603          		LD	B,3
  CFDB                	DEC3:
  CFDB  CDE8CF        		CALL	DEC4
  CFDE  CDE8CF        		CALL	DEC4
  CFE1  23            		INC	HL
  CFE2  10F7          		DJNZ	DEC3
  CFE4                	DECX:
  CFE4  CDE8CF        		CALL	DEC4
  CFE7  AF            		XOR	A
  CFE8                	DEC4:
  CFE8  ED6F          		RLD
  CFEA  FE20          		CP	020H
  CFEC  2802          		JR	Z,DEC5
  CFEE  F630          		OR	030H
  CFF0                	DEC5:
  CFF0  18BB          		JR	MSGR
                      	
  CFF2                	FPRNT:
  CFF2  0608          		LD	B,8
  CFF4  CD05D0        		CALL	P_N1
  CFF7  7E            		LD	A,(HL)
  CFF8  C680          		ADD	A,0A0H-020H
  CFFA  FEA0          		CP	0A0H
  CFFC  2802          		JR	Z,FPR1
  CFFE  3E2E          		LD	A,'.'
  D000                	FPR1:
  D000  CDAED6        		CALL	MSG_
  D003  0603          		LD	B,3
                      	
  D005                	P_N1:
  D005  C5            		PUSH	BC
  D006  E5            		PUSH	HL
  D007  7E            		LD	A,(HL)
  D008  CD7ADF        		CALL	CAP3
  D00B  CDAED6        		CALL	MSG_
  D00E  E1            		POP	HL
  D00F  C1            		POP	BC
  D010  23            		INC	HL
  D011  10F2          		DJNZ	P_N1
  D013  C9            		RET
                      	
  D014                	PRTTMS:
  D014  3E20          		LD	A,020H
  D016  CDAED6        		CALL	MSG_
                      	
  D019  2A6AFF        		LD	HL,(DTA+1+24)
  D01C  7D            		LD	A,L
  D01D  B7            		OR	A
  D01E  C8            		RET	Z
  D01F  CB3C          		SRL	H
  D021  17            		RLA
  D022  17            		RLA
  D023  17            		RLA
  D024  17            		RLA
  D025  E60F          		AND	00FH
  D027  57            		LD	D,A
  D028  7C            		LD	A,H
  D029  C650          		ADD	A,80
  D02B  CD70D0        		CALL	PRTA
  D02E  3E2D          		LD	A,'-'
  D030  CDAED6        		CALL	MSG_
  D033  7A            		LD	A,D
  D034  CD70D0        		CALL	PRTA
  D037  3E2D          		LD	A,'-'
  D039  CDAED6        		CALL	MSG_
  D03C  7D            		LD	A,L
  D03D  E61F          		AND	01FH
  D03F  CD70D0        		CALL	PRTA
                      	
  D042  2A68FF        		LD	HL,(DTA+1+22)
                      	
  D045  3E20          		LD	A,020H
  D047  CDAED6        		CALL	MSG_
  D04A  7C            		LD	A,H
  D04B  65            		LD	H,L
  D04C  1F            		RRA
  D04D  CB1D          		RR	L
  D04F  1F            		RRA
  D050  CB1D          		RR	L
  D052  1F            		RRA
  D053  CB1D          		RR	L
  D055  E61F          		AND	01FH
  D057  CD70D0        		CALL	PRTA
  D05A  3E3A          		LD	A,':'
  D05C  CDAED6        		CALL	MSG_
  D05F  7D            		LD	A,L
  D060  0F            		RRCA
  D061  0F            		RRCA
  D062  E63F          		AND	03FH
  D064  CD70D0        		CALL	PRTA
  D067  3E3A          		LD	A,':'
  D069  CDAED6        		CALL	MSG_
  D06C  7C            		LD	A,H
  D06D  E61F          		AND	01FH
  D06F  87            		ADD	A,A
                      	
                      	;	PRINT10
                      	
  D070                	PRTA:
  D070  E5            		PUSH	HL
  D071  0608          		LD	B,8
  D073  4F            		LD	C,A
  D074  AF            		XOR	A
  D075                	PRTA1:
  D075  CB01          		RLC	C
  D077  8F            		ADC	A,A
  D078  27            		DAA
  D079  10FA          		DJNZ	PRTA1
  D07B  21D600        		LD	HL,DECBF
  D07E  77            		LD	(HL),A
  D07F  AF            		XOR	A
  D080  CDE4CF        		CALL	DECX
  D083  E1            		POP	HL
  D084  C9            		RET
                      	
  D085                	SETFCB:
  D085  CD5DDD        		CALL	SPCUT
  D088  1A            		LD	A,(DE)
  D089  FE20          		CP	020H
  D08B  3801          		JR	C,SETFCBA
  D08D  1B            		DEC	DE
  D08E                	SETFCBA:
  D08E  D5            		PUSH	DE
  D08F  215C00        		LD	HL,FCB1
  D092  115D00        		LD	DE,FCB1+1
  D095  012300        		LD	BC,00023H
  D098  70            		LD	(HL),B		;B=0
  D099  EDB0          		LDIR
  D09B  D1            		POP	DE
  D09C  D5            		PUSH	DE
  D09D  215C00        		LD	HL,FCB1
  D0A0  0E29          		LD	C,029H
  D0A2  CD0500        		CALL	SYSTEM
  D0A5  216C00        		LD	HL,FCB2
  D0A8  0E29          		LD	C,029H
  D0AA  CD0500        		CALL	SYSTEM
  D0AD  E1            		POP	HL
  D0AE  010050        		LD	BC,05000H
  D0B1  118100        		LD	DE,00081H
  D0B4                	SETFCB1:
  D0B4  7E            		LD	A,(HL)
  D0B5  23            		INC	HL
  D0B6  FE20          		CP	020H
  D0B8  3805          		JR	C,SETFCB2
  D0BA  12            		LD	(DE),A
  D0BB  13            		INC	DE
  D0BC  0C            		INC	C
  D0BD  10F5          		DJNZ	SETFCB1
  D0BF                	SETFCB2:
  D0BF  79            		LD	A,C
  D0C0  328000        		LD	(DTA1),A
  D0C3  04            		INC	B
  D0C4  AF            		XOR	A
  D0C5                	SETFCB3:
  D0C5  12            		LD	(DE),A
  D0C6  13            		INC	DE
  D0C7  10FC          		DJNZ	SETFCB3
  D0C9  C9            		RET
                      	
  D0CA                	C_COPY:
  D0CA  CD85D0        		CALL	SETFCB
  D0CD  118100        		LD	DE,DTA1+1
  D0D0  0E2F          		LD	C,'/'
  D0D2  CDA6CE        		CALL	SWITCH
  D0D5  CD6EDF        		CALL	CAP
  D0D8  3260D1        		LD	(SW+1),A
                      	
  D0DB  1167DC        		LD	DE,BEEPD
  D0DE  CD7BDC        		CALL	FILEC2
  D0E1  216C00        		LD	HL,FCB2
  D0E4  CD37D5        		CALL	S29X1
                      	
  D0E7  3E10          		LD	A,010H
  D0E9  326900        		LD	(FCB1+13),A
  D0EC  216D00        		LD	HL,FCB2+1
  D0EF  CD29D2        		CALL	CWILD1
  D0F2                	COPY0:
  D0F2  CD26D2        		CALL	CWILD
  D0F5  215C00        		LD	HL,FCB1
  D0F8  CD8ECD        		CALL	OPEN
  D0FB  37            		SCF
  D0FC                	COPY1:
  D0FC  C0            		RET	NZ
  D0FD  CDA2CD        		CALL	DEFCB
                      	
  D100  3A5EFF        		LD	A,(DTA+13)
  D103  CB67          		BIT	4,A
  D105  2824          		JR	Z,COPY1A
                      	
  D107  215D00        		LD	HL,FCB1+1
  D10A  CD95E0        		CALL	CHKWILD
  D10D  3817          		JR	C,COPY9
                      	
  D10F  3E20          		LD	A,020H
  D111  325D00        		LD	(FCB1+1),A
  D114  2A6BFF        		LD	HL,(DTA+26)
  D117  23            		INC	HL
  D118  226A00        		LD	(FCB1+14),HL
  D11B  18D5          		JR	COPY0
                      	
  D11D                	COPYS:
  D11D  114FCC        		LD	DE,SKIP
  D120                	COPY8:
  D120  CD6ED2        		CALL	_SYS09
  D123  CD75CF        		CALL	LTNL
  D126                	COPY9:
  D126  CD9ECD        		CALL	OPEN2
  D129  18D1          		JR	COPY1
                      	
  D12B                	COPY1A:
  D12B  216C00        		LD	HL,FCB2
  D12E  11DB00        		LD	DE,FDRV
  D131  0153FF        		LD	BC,DTA+2
  D134  EDA0          		LDI
  D136  3E0B          		LD	A,11
  D138                	COPY2:
  D138  F5            		PUSH	AF
  D139  7E            		LD	A,(HL)
  D13A  FE3F          		CP	'?'
  D13C  2001          		JR	NZ,COPY3
  D13E  0A            		LD	A,(BC)
  D13F                	COPY3:
  D13F  12            		LD	(DE),A
  D140  03            		INC	BC
  D141  13            		INC	DE
  D142  23            		INC	HL
  D143  F1            		POP	AF
  D144  3D            		DEC	A
  D145  20F1          		JR	NZ,COPY2
  D147  010500        		LD	BC,16-11
  D14A  EDB0          		LDIR
  D14C                	PUTNAME:
  D14C  215D00        		LD	HL,FCB1+1
  D14F  CD95E0        		CALL	CHKWILD
  D152  300B          		JR	NC,PUTN1
  D154  21DC00        		LD	HL,FDRV+1
  D157  CDF2CF        		CALL	FPRNT
  D15A  3E20          		LD	A,020H
  D15C  CDAED6        		CALL	MSG_
  D15F                	PUTN1:
  D15F  3E00          	SW:	LD	A,000H
  D161  FE54          		CP	'T'
  D163  2005          		JR	NZ,CSW1
  D165  217FD1        		LD	HL,SWNE
  D168  1807          		JR	SWT1
  D16A                	CSW1:
  D16A  FE4E          		CP	'N'
  D16C  2011          		JR	NZ,SWNE
  D16E  211DD1        		LD	HL,COPYS
  D171                	SWT1:
  D171  11DB00        		LD	DE,FDRV
  D174  CDBCCD        		CALL	SYSC0F
  D177  2801          		JR	Z,SWN1
  D179  E9            		JP	(HL)
  D17A                	SWN1:
  D17A  CDD8D1        		CALL	CTIME
  D17D  309E          		JR	NC,COPYS
  D17F                	SWNE:
  D17F  11DB00        		LD	DE,FDRV
  D182  0E16          		LD	C,016H
  D184  CDBECD        		CALL	SYSTEM0
  D187  204D          		JR	NZ,COPYE2
  D189  67            		LD	H,A		;A=0
  D18A  6F            		LD	L,A
  D18B  22FC00        		LD	(FDRV+33),HL
  D18E  22FE00        		LD	(FDRV+35),HL
  D191                	COPY6:
  D191  CD38D2        		CALL	BUFSIZ
  D194  CDCECD        		CALL	S27DTA
  D197  47            		LD	B,A
  D198  3C            		INC	A
  D199  2833          		JR	Z,COPYE
  D19B  7C            		LD	A,H
  D19C  B5            		OR	L
  D19D  280E          		JR	Z,COPY7
  D19F  11DB00        		LD	DE,FDRV
  D1A2  0E26          		LD	C,026H
  D1A4  CD0500        		CALL	SYSTEM
  D1A7  B7            		OR	A
  D1A8  2024          		JR	NZ,COPYE
  D1AA  05            		DEC	B
  D1AB  20E4          		JR	NZ,COPY6
  D1AD                	COPY7:
  D1AD  3A5EFF        		LD	A,(DTA+13)
  D1B0  32E800        		LD	(FDRV+13),A
  D1B3  2165FF        		LD	HL,DTA+20
  D1B6  11EF00        		LD	DE,FDRV+20
  D1B9  010400        		LD	BC,4
  D1BC  EDB0          		LDIR
                      	
  D1BE  11DB00        		LD	DE,FDRV
  D1C1  0E10          		LD	C,010H
  D1C3  CDBECD        		CALL	SYSTEM0
  D1C6  2006          		JR	NZ,COPYE
                      	
  D1C8  114CCC        		LD	DE,OK
  D1CB  C320D1        		JP	COPY8
                      	
  D1CE                	COPYE:
  D1CE  11DB00        		LD	DE,FDRV
  D1D1  0E13          		LD	C,013H
  D1D3  CD0500        		CALL	SYSTEM
  D1D6                	COPYE2:
  D1D6  37            		SCF
  D1D7  C9            		RET
                      	
  D1D8                	CTIME:
  D1D8  ED5B65FF      		LD	DE,(DTA+20)
  D1DC  2AEF00        		LD	HL,(FDRV+20)
  D1DF  A7            		AND	A
  D1E0  ED52          		SBC	HL,DE
  D1E2  C0            		RET	NZ
  D1E3  ED5B67FF      		LD	DE,(DTA+22)
  D1E7  2AF100        		LD	HL,(FDRV+22)
  D1EA  ED52          		SBC	HL,DE
  D1EC  C9            		RET
                      	
  D1ED                	C_TYPE:
  D1ED  CD85D0        		CALL	SETFCB
  D1F0  215C00        		LD	HL,FCB1
  D1F3  CD8ECD        		CALL	OPEN
  D1F6  37            		SCF
  D1F7                	TYPE1:
  D1F7  C0            		RET	NZ
  D1F8  CDA2CD        		CALL	DEFCB
  D1FB  1E1A          		LD	E,01AH
  D1FD  CDCDEC        		CALL	_PRINT
  D200                	TYPE2:
  D200  CD38D2        		CALL	BUFSIZ
  D203  CDCECD        		CALL	S27DTA
  D206  C6FE          		ADD	A,0FEH
  D208  D8            		RET	C
  D209  7C            		LD	A,H
  D20A  B5            		OR	L
  D20B  2814          		JR	Z,TYPEE
  D20D  010001        		LD	BC,00100H
  D210                	TYPE3:
  D210  0A            		LD	A,(BC)
  D211  03            		INC	BC
  D212  FE1A          		CP	01AH
  D214  280B          		JR	Z,TYPEE
  D216  5F            		LD	E,A
  D217  CDB7D6        		CALL	_SYS02
  D21A  2B            		DEC	HL
  D21B  7C            		LD	A,H
  D21C  B5            		OR	L
  D21D  20F1          		JR	NZ,TYPE3
  D21F  18DF          		JR	TYPE2
  D221                	TYPEE:
  D221  CD9ECD        		CALL	OPEN2
  D224  18D1          		JR	TYPE1
                      	
  D226                	CWILD:
  D226  215D00        		LD	HL,FCB1+1
  D229                	CWILD1:
  D229  7E            		LD	A,(HL)
  D22A  FE20          		CP	020H
  D22C  C0            		RET	NZ
  D22D                	CWILD2:
  D22D  54            		LD	D,H
  D22E  5D            		LD	E,L
  D22F  13            		INC	DE
  D230  010A00        		LD	BC,10
  D233  363F          		LD	(HL),'?'
  D235  EDB0          		LDIR
  D237  C9            		RET
                      	
  D238                	BUFSIZ:
  D238  3A0700        		LD	A,(SYSTEM+2)
  D23B  D603          		SUB	3
  D23D  E6FC          		AND	0FCH
  D23F  67            		LD	H,A
  D240  2E00          		LD	L,0
  D242  C9            		RET
                      	
                      	
                      	;LDOS.ASM
                      	
                      	;	LSX-Dodgers OS
                      	
  D243                	BDOS0:
  D243  79            		LD	A,C
  D244  FE31          		CP	031H
  D246  301E          		JR	NC,_ERROR
  D248  ED7363D2      		LD	(BDSP+1),SP
  D24C  31D4FF        		LD	SP,EXTSP
  D24F  E5            		PUSH	HL
  D250  C5            		PUSH	BC
  D251  CB21          		SLA	C
  D253  06EC          		LD	B,STABLE/256
  D255  0A            		LD	A,(BC)
  D256  6F            		LD	L,A
  D257  03            		INC	BC
  D258  0A            		LD	A,(BC)
  D259  67            		LD	H,A
  D25A  2260D2        		LD	(BDOS1+1),HL
  D25D  C1            		POP	BC
  D25E  E1            		POP	HL
  D25F  CD0000        	BDOS1:	CALL	0
                      	
  D262  310000        	BDSP:	LD	SP,0
  D265  C9            		RET
                      	
  D266                	_ERROR:
  D266  013201        		LD	BC,00132H
  D269  112701        		LD	DE,VER
  D26C                	_SYS1C:
  D26C                	_SYS1E:
  D26C                	_SYS20:
  D26C                	_SYS2E:
  D26C  AF            		XOR	A
  D26D  C9            		RET
                      	
  D26E                	_SYS09:
  D26E  D5            		PUSH	DE
  D26F                	_SX09:
  D26F  1A            		LD	A,(DE)
  D270  13            		INC	DE
  D271  FE24          		CP	'$'
  D273  282C          		JR	Z,SX0E2
  D275  D5            		PUSH	DE
  D276  5F            		LD	E,A
  D277  CDB7D6        		CALL	_SYS02
  D27A  D1            		POP	DE
  D27B  18F2          		JR	_SX09
                      	
  D27D                	_SYS0C:
  D27D  212200        		LD	HL,00022H
  D280  AF            		XOR	A
  D281  7D            		LD	A,L
  D282  C9            		RET
                      	
  D283                	_SYS0D:
  D283  CDDFEC        		CALL	_FFLUSH
  D286  E5            		PUSH	HL
  D287  218000        		LD	HL,00080H
  D28A  228AEC        		LD	(_DTA),HL
  D28D  E1            		POP	HL
  D28E  D5            		PUSH	DE
  D28F  1E00          		LD	E,0
  D291  3E            		DB	03EH
                      	
  D292                	_SYS0E:
  D292  D5            		PUSH	DE
  D293  7B            		LD	A,E
  D294  DDE5          		PUSH	IX
  D296  CDDCEC        		CALL	_GETDPB
  D299  DDE1          		POP	IX
  D29B  3804          		JR	C,SX0E2
  D29D  7B            		LD	A,E
  D29E  3287EC        		LD	(_DVSW),A
  D2A1                	SX0E2:
  D2A1  3E08          		LD	A,8
  D2A3  D1            		POP	DE
  D2A4  C9            		RET
                      	
  D2A5                	_SYS0F:
  D2A5  CD6FDD        		CALL	SETDRV
  D2A8  FD7E1C        		LD	A,(IY+28)	;Open
  D2AB  C602          		ADD	A,002H		;Write
  D2AD  2868          		JR	Z,FEND0F
  D2AF  CD91E0        		CALL	CHKWILDX
                      	
  D2B2  D491DD        		CALL	NC,SOPENX
  D2B5                	_S16XX:
  D2B5  3860          		JR	C,FEND0F
                      					;Directory location
  D2B7  3A9FEC        		LD	A,(_FILEN)
  D2BA  FD7719        		LD	(IY+25),A
                      	;				_DIRF
  D2BD  3AA0EC        		LD	A,(_DIRF)
  D2C0  FD771D        		LD	(IY+29),A
                      	;				_FBPS
  D2C3  FD731E        		LD	(IY+30),E
  D2C6  FD721F        		LD	(IY+31),D
                      	;				Open(Read)
  D2C9  FD361CFF      		LD	(IY+28),0FFH
                      	;				FILENAME
  D2CD  FDE5          		PUSH	IY
  D2CF  D1            		POP	DE
  D2D0  13            		INC	DE
  D2D1  010B00        		LD	BC,11
  D2D4  EDB0          		LDIR
                      	;				Attribute
  D2D6  7E            		LD	A,(HL)
  D2D7  FD770D        		LD	(IY+13),A
                      	;				TIME
  D2DA  110B00        		LD	DE,11
  D2DD  19            		ADD	HL,DE
  D2DE  7E            		LD	A,(HL)
  D2DF  23            		INC	HL
  D2E0  FD7716        		LD	(IY+22),A
  D2E3  7E            		LD	A,(HL)
  D2E4  23            		INC	HL
  D2E5  FD7717        		LD	(IY+23),A
                      	;				DATE
  D2E8  7E            		LD	A,(HL)
  D2E9  23            		INC	HL
  D2EA  FD7714        		LD	(IY+20),A
  D2ED  7E            		LD	A,(HL)
  D2EE  23            		INC	HL
  D2EF  FD7715        		LD	(IY+21),A
                      	;				First cluster
  D2F2  7E            		LD	A,(HL)
  D2F3  23            		INC	HL
  D2F4  FD771A        		LD	(IY+26),A
  D2F7  7E            		LD	A,(HL)
  D2F8  23            		INC	HL
  D2F9  FD771B        		LD	(IY+27),A
                      	;				SIZE
  D2FC  7E            		LD	A,(HL)
  D2FD  23            		INC	HL
  D2FE  FD7710        		LD	(IY+16),A
  D301  7E            		LD	A,(HL)
  D302  23            		INC	HL
  D303  FD7711        		LD	(IY+17),A
  D306  7E            		LD	A,(HL)
  D307  23            		INC	HL
  D308  FD7712        		LD	(IY+18),A
  D30B  7E            		LD	A,(HL)
  D30C  FD7713        		LD	(IY+19),A
  D30F  AF            		XOR	A
  D310  FD770C        		LD	(IY+12),A
  D313  FD22D5D3      		LD	(OFCB+1),IY
  D317                	FEND0F:
  D317  C3BCD3        		JP	FEND
                      	
  D31A                	_SYS10:
  D31A  CD6FDD        		CALL	SETDRV
  D31D  FD7E1C        		LD	A,(IY+28)	;Open
  D320  D6FE          		SUB	0FEH
  D322  37            		SCF
  D323  3F            		CCF
  D324  2032          		JR	NZ,FEND10
  D326                	_S10A:				;Write
  D326  FD770E        		LD	(IY+14),A
  D329  FD770F        		LD	(IY+15),A
                      	
  D32C  FD341C        		INC	(IY+28)		;0FEH->0FFH
  D32F  CD82E1        		CALL	SETTMS
                      	
  D332  FD7E1D        		LD	A,(IY+29)
  D335  32A0EC        		LD	(_DIRF),A
  D338  FD5E1E        		LD	E,(IY+30)
  D33B  FD561F        		LD	D,(IY+31)
  D33E  CDB3DE        		CALL	DC
  D341  3879          		JR	C,FEND
                      	
  D343  FD7E19        		LD	A,(IY+25)
  D346  87            		ADD	A,A
  D347  87            		ADD	A,A
  D348  87            		ADD	A,A
  D349  E6FF          	IBM2:	AND	0FFH		;自己書き換え 1024=0FFH / 512=07FH
  D34B  6F            		LD	L,A
  D34C  2600          		LD	H,0
  D34E  29            		ADD	HL,HL
  D34F  29            		ADD	HL,HL
  D350  ED4B7EEC      		LD	BC,(_DTBUF)
  D354  09            		ADD	HL,BC
                      	
  D355  CDA1E0        		CALL	SDIRENT
  D358                	FEND10:
  D358  1862          		JR	FEND
                      	
  D35A                	OPENDD:
  D35A  FD361CFD      		LD	(IY+28),0FDH
  D35E  FD360D20      		LD	(IY+13),020H
  D362  CD87E1        		CALL	SETTMSX
  D365  1855          		JR	FEND
                      	
  D367                	_SYS11:
  D367  CD6FDD        		CALL	SETDRV
  D36A  CDFADE        		CALL	CHKDDX
  D36D  3818          		JR	C,_S11A
  D36F  FDE5          		PUSH	IY
  D371  E1            		POP	HL
  D372  ED5B8AEC      		LD	DE,(_DTA)
  D376  010C00        		LD	BC,12
  D379  EDB0          		LDIR
  D37B  3E20          		LD	A,020H
  D37D  12            		LD	(DE),A
  D37E  13            		INC	DE
  D37F  62            		LD	H,D
  D380  6B            		LD	L,E
  D381  13            		INC	DE
  D382  0E13          		LD	C,19
  D384  70            		LD	(HL),B
  D385  1833          		JR	_S11B
  D387                	_S11A:
  D387  CDC5DD        		CALL	SOPEN
  D38A                	_S12X1:
  D38A  3830          		JR	C,FEND
  D38C  CD6EDE        		CALL	SOPENE2
  D38F  ED5B8AEC      		LD	DE,(_DTA)
  D393  3A88EC        		LD	A,(_DRV)
  D396  3C            		INC	A
  D397  12            		LD	(DE),A
  D398  D5            		PUSH	DE
  D399  13            		INC	DE
  D39A  012000        		LD	BC,32
  D39D  EDB0          		LDIR
  D39F  FD6E0E        		LD	L,(IY+14)
  D3A2  FD660F        		LD	H,(IY+15)
  D3A5  222FE2        		LD	(SCDIR),HL
  D3A8  2A9AEC        		LD	HL,(_FBPS)
  D3AB  2231E2        		LD	(SFBPS),HL
  D3AE  2A9FEC        		LD	HL,(_FILEN)
  D3B1  2233E2        		LD	(SFNDF),HL	;Directory position and Flags
  D3B4  E1            		POP	HL
  D3B5  1135E2        		LD	DE,SFILE
  D3B8  0E21          		LD	C,33
  D3BA                	_S11B:
  D3BA  EDB0          		LDIR
  D3BC                	FEND:
  D3BC  9F            		SBC	A,A		;CF=0 A=0 : CF=1 A=0FFH
  D3BD                	FENDE:
  D3BD  FDE1          		POP	IY
  D3BF  C1            		POP	BC
  D3C0  D1            		POP	DE
  D3C1  E1            		POP	HL
  D3C2  C9            		RET
                      	
  D3C3                	_SYS12:
  D3C3  E5            		PUSH	HL
  D3C4  D5            		PUSH	DE
  D3C5  C5            		PUSH	BC
  D3C6  FDE5          		PUSH	IY
  D3C8  CD2ADE        		CALL	NOPEN
  D3CB  18BD          		JR	_S12X1
                      	
  D3CD                	_S16K:
  D3CD  FD7E1C        		LD	A,(IY+28)	;Device
  D3D0  FEFD          		CP	0FDH
  D3D2  37            		SCF
  D3D3  C8            		RET	Z
                      	
  D3D4  110000        	OFCB:	LD	DE,0
  D3D7  D5            		PUSH	DE
  D3D8  061A          		LD	B,26		;First cluster
  D3DA                	S16K1:
  D3DA  13            		INC	DE
  D3DB  23            		INC	HL
  D3DC  10FC          		DJNZ	S16K1
                      	
  D3DE  1A            		LD	A,(DE)
  D3DF  BE            		CP	(HL)
  D3E0  2013          		JR	NZ,S16K2
  D3E2  13            		INC	DE
  D3E3  23            		INC	HL
  D3E4  1A            		LD	A,(DE)
  D3E5  BE            		CP	(HL)
  D3E6  200D          		JR	NZ,S16K2
                      	
  D3E8  E1            		POP	HL
  D3E9  FDE5          		PUSH	IY
  D3EB  D1            		POP	DE
  D3EC  1A            		LD	A,(DE)		;Drive
  D3ED  BE            		CP	(HL)
  D3EE  2005          		JR	NZ,S16K2
                      	
  D3F0  ED52          		SBC	HL,DE		;CP HL,DE
  D3F2  37            		SCF
  D3F3  C0            		RET	NZ
  D3F4  E5            		PUSH	HL
  D3F5                	S16K2:
  D3F5  E1            		POP	HL
  D3F6  FDE5          		PUSH	IY
  D3F8  D1            		POP	DE
  D3F9                	_SYS13:
  D3F9  CD6FDD        		CALL	SETDRV
  D3FC  CDBDDF        		CALL	KILL
  D3FF                	FEND13:
  D3FF  18BB          		JR	FEND
                      	
  D401                	_SYS14:
  D401  CD6FDD        		CALL	SETDRV
  D404  CDB6E1        		CALL	PUSHRR
  D407  CDF7E1        		CALL	GETSEQ
  D40A  CD04E2        		CALL	SETRBR
                      	
  D40D  CD1DE2        		CALL	K_DE27
                      	
  D410  E5            		PUSH	HL
  D411  CDCAE1        		CALL	SETSEQ
  D414                	SREAD:
  D414  E1            		POP	HL
                      	
  D415  C601          		ADD	A,001H
  D417  38A3          		JR	C,FEND
                      	
  D419  7D            		LD	A,L
  D41A  D601          		SUB	001H
  D41C                	FENDX:
  D41C  9F            		SBC	A,A
  D41D  E603          		AND	3
  D41F  1F            		RRA
  D420  189B          		JR	FENDE
                      	
  D422                	_SYS15:
  D422  CD6FDD        		CALL	SETDRV
  D425  CDB6E1        		CALL	PUSHRR
  D428  CDF7E1        		CALL	GETSEQ
  D42B  CD04E2        		CALL	SETRBR
                      	
  D42E  CD17E2        		CALL	K_DE26
  D431  E5            		PUSH	HL
  D432  CDCAE1        		CALL	SETSEQ
  D435                	SWRITE:
  D435  E1            		POP	HL
                      	
  D436  C6FF          		ADD	A,0FFH
  D438  18E2          		JR	FENDX
                      	
  D43A                	_SYS17:
  D43A  CD6FDD        		CALL	SETDRV
  D43D  CD19E0        		CALL	NAME
  D440  18BD          		JR	FEND13
                      	
  D442                	_SYS16:
  D442  CD6FDD        		CALL	SETDRV
                      	
  D445  CD91E0        		CALL	CHKWILDX
  D448  38B5          		JR	C,FEND13
  D44A  FD7E01        		LD	A,(IY+1)
  D44D  FE05          		CP	5
  D44F  2805          		JR	Z,_S16X2
  D451  FE21          		CP	021H
  D453  DAFFD3        		JP	C,FEND13
  D456                	_S16X2:
                      	;				Clear FCB
  D456  FDE5          		PUSH	IY
  D458  E1            		POP	HL
  D459  011000        		LD	BC,16
  D45C  09            		ADD	HL,BC
  D45D                	_S16X1:
  D45D  70            		LD	(HL),B
  D45E  23            		INC	HL
  D45F  0D            		DEC	C
  D460  20FB          		JR	NZ,_S16X1
                      	
  D462  CD87E1        		CALL	SETTMSX
  D465  FD360DFF      		LD	(IY+13),0FFH	;Attribute
  D469  CD91DD        		CALL	SOPENX
  D46C  3F            		CCF
  D46D  CCCDD3        		CALL	Z,_S16K
  D470  D47FDE        		CALL	NC,COPEN
  D473  D4A1E0        		CALL	NC,SDIRENT
  D476  C3B5D2        		JP	_S16XX
                      	
  D479                	_SYS21:
  D479  CD6FDD        		CALL	SETDRV
  D47C  CDB6E1        		CALL	PUSHRR
  D47F  FD6E21        		LD	L,(IY+33)	;Random record
  D482  FD6622        		LD	H,(IY+34)
  D485  CD04E2        		CALL	SETRBR
                      	
  D488  CD1DE2        		CALL	K_DE27
  D48B  E5            		PUSH	HL
  D48C  CDE1E1        		CALL	POPRR
  D48F  1883          		JR	SREAD
                      	
  D491                	_SYS22:
  D491                	_SYS28:
  D491  CD6FDD        		CALL	SETDRV
  D494  CDB6E1        		CALL	PUSHRR
  D497  FD6E21        		LD	L,(IY+33)	;Random record
  D49A  FD6622        		LD	H,(IY+34)
  D49D  CD04E2        		CALL	SETRBR
                      	
  D4A0  CD17E2        		CALL	K_DE26
  D4A3  E5            		PUSH	HL
  D4A4  CDE1E1        		CALL	POPRR
  D4A7  188C          		JR	SWRITE
                      	
  D4A9                	_SYS18:
  D4A9  21FF00        		LD	HL,000FFH
  D4AC  AF            		XOR	A
  D4AD  C9            		RET
                      	
  D4AE                	_SYS19:
  D4AE  3A87EC        		LD	A,(_DVSW)
  D4B1  A7            		AND	A
  D4B2  C9            		RET
                      	
  D4B3                	_SYS1A:
  D4B3  ED538AEC      		LD	(_DTA),DE
  D4B7  AF            		XOR	A
  D4B8  C9            		RET
                      	
  D4B9                	_SYS1B:
  D4B9  7B            		LD	A,E
  D4BA  CD84DD        		CALL	GETDRV
  D4BD  CDDCEC        		CALL	_GETDPB
  D4C0  D4E2EC        		CALL	NC,_RDFATX
  D4C3  210000        		LD	HL,0
  D4C6  D467E1        		CALL	NC,DSKF
                      	
  D4C9  DD5E08        		LD	E,(IX+8)	;DPB_08_MAXCL_LOW
  D4CC  DD5609        		LD	D,(IX+9)	;DPB_08_MAXCL_HIGH
  D4CF  1B            		DEC	DE
  D4D0  1B            		DEC	DE
  D4D1  FD2A7CEC      		LD	IY,(_FATBF)
  D4D5  9F            		SBC	A,A
  D4D6  D8            		RET	C
  D4D7  DD7E07        		LD	A,(IX+7)	;DPB_07_DBLCL
  D4DA  B7            		OR	A
  D4DB  010002        		LD	BC,00200H
  D4DE  78            		LD	A,B		;A=2
  D4DF  C0            		RET	NZ
  D4E0  3D            		DEC	A		;A=1
  D4E1  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  D4E5  C0            		RET	NZ
  D4E6  0604          		LD	B,004H
  D4E8  C9            		RET
                      	
  D4E9                	_SYS1D:
  D4E9  AF            		XOR	A
  D4EA  67            		LD	H,A
  D4EB  6F            		LD	L,A
  D4EC  C9            		RET
                      	
  D4ED                	_SYS1F:
  D4ED  2100ED        		LD	HL,DEVICE
  D4F0  3A89EC        		LD	A,(_DSK)
  D4F3  C3DCEC        		JP	_GETDPB
                      	
  D4F6                	_SYS23:
  D4F6  E5            		PUSH	HL
  D4F7  2A1EEC        		LD	HL,(STABLE+2*00FH)
  D4FA  CD0F00        		CALL	K_HL
  D4FD  3814          		JR	C,FSIZE1
                      	;	EX	DE,IY
  D4FF  D5            		PUSH	DE
  D500  FDE3          		EX	(SP),IY
  D502  D1            		POP	DE
                      	;
  D503  D5            		PUSH	DE
  D504  CDE7E1        		CALL	GETSIZE
  D507  FD7521        		LD	(IY+33),L	;Random record
  D50A  FD7422        		LD	(IY+34),H
  D50D  D1            		POP	DE
                      	;	EX	DE,IY
  D50E  D5            		PUSH	DE
  D50F  FDE3          		EX	(SP),IY
  D511  D1            		POP	DE
                      	;
  D512  AF            		XOR	A
  D513                	FSIZE1:
  D513  E1            		POP	HL
  D514  C9            		RET
                      	
  D515                	_SYS24:
  D515  C5            		PUSH	BC
                      	;	EX	DE,IY
  D516  D5            		PUSH	DE
  D517  FDE3          		EX	(SP),IY
  D519  D1            		POP	DE
                      	;
  D51A  D5            		PUSH	DE
  D51B  CDF7E1        		CALL	GETSEQ
  D51E  FD7521        		LD	(IY+33),L	;Random record
  D521  FD7422        		LD	(IY+34),H
  D524  FD362300      		LD	(IY+35),0
  D528  D1            		POP	DE
                      	;	EX	DE,IY
  D529  D5            		PUSH	DE
  D52A  FDE3          		EX	(SP),IY
  D52C  D1            		POP	DE
                      	;
  D52D  C1            		POP	BC
  D52E  AF            		XOR	A
  D52F  C9            		RET
                      	
  D530                	_SYS29:
  D530  C5            		PUSH	BC
  D531  E5            		PUSH	HL
  D532  CD83DC        		CALL	FILE
  D535  E1            		POP	HL
  D536  C1            		POP	BC
  D537                	S29X1:
  D537  C5            		PUSH	BC
  D538  D5            		PUSH	DE
  D539  E5            		PUSH	HL
  D53A  EB            		EX	DE,HL
  D53B  21DB00        		LD	HL,FDRV
  D53E  010D00        		LD	BC,13
  D541  EDB0          		LDIR
  D543  70            		LD	(HL),B
  D544  0E03          		LD	C,3
  D546  EDB0          		LDIR
  D548  E1            		POP	HL
  D549  D1            		POP	DE
  D54A  C1            		POP	BC
  D54B  AF            		XOR	A
  D54C  C9            		RET
                      	
  D54D                	_SYS30:
  D54D  C5            		PUSH	BC
  D54E  01F4EC        		LD	BC,_DWT
  D551  1804          		JR	S2FX
  D553                	_SYS2F:
  D553  C5            		PUSH	BC
  D554  01F1EC        		LD	BC,_DRD
  D557                	S2FX:
  D557  ED436CD5      		LD	(S2FPAT+1),BC
  D55B  CDBFE8        		CALL	FFLUSH
                      	
  D55E  D5            		PUSH	DE
  D55F  E5            		PUSH	HL
  D560  7D            		LD	A,L		;Drive
  D561  CDD9EC        		CALL	_CHGDRV
  D564  380D          		JR	C,S30X2
  D566  44            		LD	B,H		;Number of clusters
  D567  2A8AEC        		LD	HL,(_DTA)
  D56A                	S30X:
  D56A  C5            		PUSH	BC
  D56B  CDF1EC        	S2FPAT:	CALL	_DRD
  D56E  C1            		POP	BC
  D56F  3802          		JR	C,S30X2
  D571  10F7          		DJNZ	S30X
  D573                	S30X2:
  D573  E1            		POP	HL
  D574  D1            		POP	DE
  D575  C1            		POP	BC
  D576  9F            		SBC	A,A
  D577  C9            		RET
                      	
                      	;LDIO.ASM
                      	
                      	;	LSX-Dodgers IO
                      	
                      	
  D578                	BIOS:
  D578  ED7392D5      		LD	(SPPAT+1),SP
  D57C  F5            		PUSH	AF
  D57D  3A93D5        		LD	A,(SPPAT+2)
  D580  3C            		INC	A
  D581  2806          		JR	Z,BIOS2
  D583  F1            		POP	AF
  D584  31D4FF        		LD	SP,EXTSP
  D587  1801          		JR	BIOS3
  D589                	BIOS2:
  D589  F1            		POP	AF
  D58A                	BIOS3:
  D58A  CD95D5        		CALL	BIOS1
  D58D  061E          		LD	B,01EH
  D58F  ED79          		OUT	(C),A
  D591  310000        	SPPAT:	LD	SP,0
  D594  C9            		RET
  D595                	BIOS1:
  D595  C5            		PUSH	BC
  D596  061D          		LD	B,01DH
  D598  ED79          		OUT	(C),A
  D59A  C9            		RET
                      	
  D59B                	INT:
  D59B  F5            		PUSH	AF
  D59C  E5            		PUSH	HL
  D59D  C5            		PUSH	BC
  D59E  210001        		LD	HL,00100H
  D5A1  39            		ADD	HL,SP
  D5A2  3807          		JR	C,INTP1
  D5A4  ED73D6D5      		LD	(INTSP+1),SP
  D5A8  31D4FF        		LD	SP,EXTSP
  D5AB                	INTP1:
  D5AB  CD42DA        		CALL	IN49SB
  D5AE  67            		LD	H,A
  D5AF  CD42DA        		CALL	IN49SB
  D5B2  6F            		LD	L,A
                      	
  D5B3  CB64          		BIT	4,H		;[GRAPH]
  D5B5  2010          		JR	NZ,SCEXE
  D5B7  7D            		LD	A,L
  D5B8  EE09          		XOR	9
  D5BA  2839          		JR	Z,DIAN
  D5BC  7C            		LD	A,H
  D5BD  0F            		RRCA			;[CTRL]
  D5BE  301E          		JR	NC,SCL
  D5C0  0F            		RRCA			;[SHIFT]
  D5C1  3804          		JR	C,SCEXE
  D5C3  3E80          		LD	A,080H
  D5C5  181E          		JR	SCG1
  D5C7                	SCEXE:
  D5C7  2292EC        		LD	(_KEYD),HL
  D5CA  CD2AD6        		CALL	KEYSET1
                      	
  D5CD  21D4FF        		LD	HL,EXTSP
  D5D0  A7            		AND	A
  D5D1  ED72          		SBC	HL,SP
  D5D3  2003          		JR	NZ,INTPE1
                      	
  D5D5  310000        	INTSP:	LD	SP,0
  D5D8                	INTPE1:
  D5D8  C1            		POP	BC
  D5D9                	INTPE:
  D5D9  E1            		POP	HL
  D5DA                	INTPE2:
  D5DA  F1            		POP	AF
  D5DB                	INTCTCE:
  D5DB  FB            		EI
  D5DC  ED4D          		RETI
                      	
  D5DE                	SCL:
  D5DE  7D            		LD	A,L
  D5DF  FE08          		CP	008H
  D5E1  280D          		JR	Z,RESET
                      	
  D5E3  3E02          		LD	A,002H
  D5E5                	SCG1:
  D5E5  E5            		PUSH	HL
  D5E6  21BFEC        		LD	HL,WK1FD0
  D5E9  AE            		XOR	(HL)
  D5EA  CDF5EB        		CALL	S1FD0
  D5ED  E1            		POP	HL
  D5EE  18D7          		JR	SCEXE
                      	
  D5F0                	RESET:
  D5F0  3E1D          		LD	A,01DH
  D5F2  D300          		OUT	(0),A
  D5F4  C7            		RST	0
                      	
  D5F5                	DIAN:
  D5F5  6F            		LD	L,A
  D5F6  C5            		PUSH	BC
  D5F7  01B01F        		LD	BC,01FB0H
  D5FA  ED78          		IN	A,(C)
  D5FC  EE80          		XOR	080H
  D5FE  ED79          		OUT	(C),A
  D600  C1            		POP	BC
  D601  18C4          		JR	SCEXE
                      	
  D603                	INTCTC2:
  D603  F5            		PUSH	AF
  D604  3E00          	INTCPAT:LD	A,000H
  D606  3D            		DEC	A
  D607  3205D6        		LD	(INTCPAT+1),A
  D60A  20CE          		JR	NZ,INTPE2
                      	
  D60C  3A92EC        		LD	A,(_KEYD)
  D60F  B7            		OR	A
  D610  28C8          		JR	Z,INTPE2
  D612                	KEYSET0:
  D612  E5            		PUSH	HL
  D613  2A90EC        		LD	HL,(_KEYPS)
  D616  7C            		LD	A,H
  D617  AD            		XOR	L
  D618  2006          		JR	NZ,INTC2A
                      	
  D61A  2A92EC        		LD	HL,(_KEYD)
  D61D  CD54D6        		CALL	KEYSET
  D620                	INTC2A:
  D620  3A94EC        		LD	A,(_KEYSP)
  D623  E60F          		AND	00FH
  D625  3205D6        		LD	(INTCPAT+1),A
                      	
  D628  18AF          		JR	INTPE
                      	
  D62A                	KEYSET1:
  D62A  CB6C          		BIT	5,H
  D62C  F5            		PUSH	AF
  D62D  ED4B8CEC      		LD	BC,(_CTC)
  D631  78            		LD	A,B
  D632  B1            		OR	C
  D633  2006          		JR	NZ,KEYS10E
                      	
  D635  F1            		POP	AF
  D636  201C          		JR	NZ,KEYSET
  D638  F5            		PUSH	AF
  D639  18D7          		JR	KEYSET0
  D63B                	KEYS10E:
  D63B  F1            		POP	AF
  D63C  C8            		RET	Z
  D63D  F5            		PUSH	AF
  D63E  3E03          		LD	A,3		;CTC STOP
  D640  ED79          		OUT	(C),A
  D642  F1            		POP	AF
                      	
  D643  B7            		OR	A
  D644  C8            		RET	Z
                      	
  D645  E5            		PUSH	HL
  D646  2A94EC        		LD	HL,(_KEYSP)
  D649  3EA7          		LD	A,0A7H
  D64B  ED79          		OUT	(C),A
  D64D  ED69          		OUT	(C),L
  D64F  7C            		LD	A,H
  D650  3205D6        		LD	(INTCPAT+1),A
  D653  E1            		POP	HL
                      	
  D654                	KEYSET:
  D654  7D            		LD	A,L
  D655  CB7C          		BIT	7,H
  D657  CC84D6        		CALL	Z,FKEY
  D65A  CB74          		BIT	6,H
  D65C  C0            		RET	NZ
  D65D                	KEYBS:
  D65D  B7            		OR	A
  D65E  C8            		RET	Z
  D65F                	KEYBS1:
  D65F  FE03          		CP	3
  D661  CC77D6        		CALL	Z,KEYBC
  D664  E5            		PUSH	HL
  D665  F5            		PUSH	AF
  D666  2A90EC        		LD	HL,(_KEYPS)
  D669  2C            		INC	L
  D66A  7D            		LD	A,L
  D66B  BC            		CP	H
  D66C  2812          		JR	Z,KEYBE
  D66E  3290EC        		LD	(_KEYPS),A
  D671  26FE          		LD	H,KEYBF/256
  D673  F1            		POP	AF
  D674  77            		LD	(HL),A
  D675  E1            		POP	HL
  D676  C9            		RET
                      	
  D677                	KEYBC:
  D677  E5            		PUSH	HL
  D678  210000        		LD	HL,0
  D67B  2290EC        		LD	(_KEYPS),HL
  D67E  E1            		POP	HL
  D67F  C9            		RET
                      	
  D680                	KEYBE:
  D680  F1            		POP	AF
  D681  E1            		POP	HL
  D682  37            		SCF
  D683  C9            		RET
                      	
  D684                	FKEY:
  D684  CB75          		BIT	6,L
  D686  C8            		RET	Z
  D687  3E1B          		LD	A,01BH
  D689  CD5FD6        		CALL	KEYBS1
  D68C  7D            		LD	A,L
  D68D  C6AF          		ADD	A,020H-'q'
  D68F  CB7D          		BIT	7,L
  D691  C8            		RET	Z
  D692  2E50          		LD	L,'P'
  D694  D690          		SUB	0E1H+020H-'q'
  D696  2810          		JR	Z,KEYBSL
  D698  2C            		INC	L
  D699  3D            		DEC	A
  D69A  280C          		JR	Z,KEYBSL
  D69C  2C            		INC	L
  D69D  D609          		SUB	0EBH-0E2H
  D69F  2807          		JR	Z,KEYBSL
  D6A1  2E43          		LD	L,'C'
  D6A3  3D            		DEC	A
  D6A4  2802          		JR	Z,KEYBSL
  D6A6  2E58          		LD	L,'X'
  D6A8                	KEYBSL:
  D6A8  7D            		LD	A,L
  D6A9  18B4          		JR	KEYBS1
                      	
  D6AB                	_SYS01:
  D6AB  CDFED9        		CALL	_SYS07
  D6AE                	MSG_:
  D6AE  F5            		PUSH	AF
  D6AF  D5            		PUSH	DE
  D6B0  5F            		LD	E,A
  D6B1  CDB7D6        		CALL	_SYS02
  D6B4  D1            		POP	DE
  D6B5  F1            		POP	AF
  D6B6  C9            		RET
                      	
  D6B7                	_SYS02:
  D6B7  CD31D7        		CALL	BREAK
  D6BA  C329D7        		JP	PRINTX
                      	
  D6BD                	_SYS03:
  D6BD  F3            		DI
  D6BE  C5            		PUSH	BC
  D6BF  01911F        	SIOAD:	LD	BC,01F91H
  D6C2  3E05          		LD	A,5
  D6C4  ED79          		OUT	(C),A
  D6C6  3EEA          		LD	A,0EAH		;RTS ON
  D6C8  ED79          		OUT	(C),A
  D6CA                	REC1:
  D6CA  CDE1D6        		CALL	BREAK2
  D6CD  ED78          		IN	A,(C)
  D6CF  0F            		RRCA			;Arrival
  D6D0  30F8          		JR	NC,REC1
  D6D2                	BREAK2X:
  D6D2  3F            		CCF
  D6D3  3E05          		LD	A,5
  D6D5  ED79          		OUT	(C),A
  D6D7  3EE8          		LD	A,0E8H		;RTS OFF
  D6D9  ED79          		OUT	(C),A
                      	
  D6DB  0D            		DEC	C
  D6DC  ED78          		IN	A,(C)		;Read data
  D6DE  C1            		POP	BC
  D6DF  FB            		EI
  D6E0  C9            		RET
                      	
  D6E1                	BREAK2:
  D6E1  3E1A          		LD	A,01AH
  D6E3  DB01          		IN	A,(1)
  D6E5  0F            		RRCA
  D6E6  D8            		RET	C
  D6E7  C1            		POP	BC		;PC
  D6E8  01911F        	SIOAD0:	LD	BC,01F91H
  D6EB  18E5          		JR	BREAK2X
                      	
  D6ED                	_SYS04:
  D6ED  C5            		PUSH	BC
  D6EE  01911F        	SIOAD1:	LD	BC,01F91H
  D6F1                	XMIT1:
  D6F1  CDE1D6        		CALL	BREAK2
  D6F4  3E10          		LD	A,010H		;Reset status
  D6F6  ED79          		OUT	(C),A
  D6F8  ED78          		IN	A,(C)
  D6FA  2F            		CPL
  D6FB  E624          		AND	024H		;CTS Send Empty
  D6FD  20F2          		JR	NZ,XMIT1
  D6FF  0D            		DEC	C
  D700  ED59          		OUT	(C),E
  D702  C1            		POP	BC
  D703  C9            		RET
                      	
  D704                	_SYS05:
  D704  C5            		PUSH	BC
  D705  01011A        		LD	BC,01A01H
  D708                	_S05X1:
  D708  CDE1D6        		CALL	BREAK2
  D70B  ED78          		IN	A,(C)
  D70D  E608          		AND	8
  D70F  20F7          		JR	NZ,_S05X1
  D711  F3            		DI
  D712  0D            		DEC	C
  D713  ED59          		OUT	(C),E
  D715  0E03          		LD	C,3
  D717  3E0E          		LD	A,00EH
  D719  ED79          		OUT	(C),A
  D71B  3C            		INC	A
  D71C  03            		INC	BC
  D71D  0B            		DEC	BC
  D71E  ED79          		OUT	(C),A
  D720  FB            		EI
  D721  C1            		POP	BC
  D722  AF            		XOR	A
  D723  C9            		RET
                      	
  D724                	_SYS06:
  D724  7B            		LD	A,E
  D725  3C            		INC	A
  D726  CACAEC        		JP	Z,_INKEY
  D729                	PRINTX:
  D729  C3CDEC        		JP	_PRINT
                      	
  D72C                	_SYS08:
  D72C  CDFED9        		CALL	_SYS07
  D72F  1804          		JR	BREAK1
  D731                	BREAK:
  D731  FB            		EI
  D732  3A92EC        		LD	A,(_KEYD)
  D735                	BREAK1:
  D735  FE03          		CP	3
  D737  CA0000        		JP	Z,0
  D73A  FE13          		CP	013H
  D73C  C0            		RET	NZ
                      	
  D73D                	PAUSE:
  D73D  CD77D6        		CALL	KEYBC
                      	
  D740                	FLGET:
  D740  CDDFEC        		CALL	_FFLUSH
  D743  C5            		PUSH	BC
  D744  E5            		PUSH	HL
  D745  ED4B8EEC      		LD	BC,(_TXADR)
  D749  CBE8          		SET	5,B
  D74B  ED60          		IN	H,(C)
  D74D                	FLGET1:
  D74D  3A93EC        		LD	A,(_KEYD+1)
  D750  0F            		RRCA
  D751  0F            		RRCA
  D752  E610          		AND	010H
  D754  F608          		OR	8
  D756  ED68          		IN	L,(C)
  D758  B5            		OR	L
  D759  ED79          		OUT	(C),A
  D75B  CDCAEC        		CALL	_INKEY
  D75E  28ED          		JR	Z,FLGET1
  D760  ED61          		OUT	(C),H
  D762  E1            		POP	HL
  D763  C1            		POP	BC
  D764  C9            		RET
                      	
  D765                	_SYS0A:
  D765  C5            		PUSH	BC
  D766  E5            		PUSH	HL
  D767  D5            		PUSH	DE
  D768  CD9CDB        		CALL	GETL
  D76B  1100FF        		LD	DE,KBUF
  D76E  E1            		POP	HL
  D76F  E5            		PUSH	HL
  D770  0E00          		LD	C,0
  D772  3004          		JR	NC,SAX0
  D774  23            		INC	HL
  D775  23            		INC	HL
  D776  1808          		JR	SAX4
  D778                	SAX0:
  D778  46            		LD	B,(HL)
  D779  23            		INC	HL
  D77A                	SAX1:
  D77A  23            		INC	HL
  D77B  1A            		LD	A,(DE)
  D77C  13            		INC	DE
  D77D  B7            		OR	A
  D77E  2004          		JR	NZ,SAX2
  D780                	SAX4:
  D780  360D          		LD	(HL),00DH
  D782  1804          		JR	SAX3
  D784                	SAX2:
  D784  77            		LD	(HL),A
  D785  0C            		INC	C
  D786  10F2          		DJNZ	SAX1
  D788                	SAX3:
  D788  D1            		POP	DE
  D789  79            		LD	A,C
  D78A  13            		INC	DE
  D78B  12            		LD	(DE),A
  D78C  1B            		DEC	DE
  D78D  E1            		POP	HL
  D78E  C1            		POP	BC
  D78F  A7            		AND	A
  D790  C9            		RET
                      	
  D791                	_SYS0B:
  D791  CD31D7        		CALL	BREAK
  D794  3A92EC        		LD	A,(_KEYD)
  D797  B7            		OR	A
  D798  C8            		RET	Z
  D799                	CONSTX:
  D799  CDDFEC        		CALL	_FFLUSH
  D79C  E5            		PUSH	HL
  D79D  2A90EC        		LD	HL,(_KEYPS)
  D7A0  7C            		LD	A,H
  D7A1  AD            		XOR	L
  D7A2  E1            		POP	HL
  D7A3  C6FF          		ADD	A,0FFH
  D7A5  9F            		SBC	A,A
  D7A6  C9            		RET
                      	
  D7A7                	_SYS2A:
  D7A7  C5            		PUSH	BC
  D7A8  3EED          		LD	A,0EDH		;Read calendar
  D7AA  CD5DDA        		CALL	COMOUT
  D7AD  CDD0D7        		CALL	IN49SB_BCD		;YY
  D7B0  6F            		LD	L,A
  D7B1  2600          		LD	H,0
  D7B3  116C07        		LD	DE,1900		;0076CH
  D7B6  FE5A          		CP	90
  D7B8  3002          		JR	NC,RDDATE1
  D7BA  1ED0          		LD	E,0D0H		;2000 & 0FFH D=007H
  D7BC                	RDDATE1:
  D7BC  19            		ADD	HL,DE
  D7BD  CD42DA        		CALL	IN49SB		;MM
  D7C0  57            		LD	D,A
  D7C1  CDD0D7        		CALL	IN49SB_BCD	;DD
  D7C4  5F            		LD	E,A
  D7C5  7A            		LD	A,D
  D7C6  E607          		AND	7
  D7C8  0604          		LD	B,4
  D7CA                	RDDATE2:
  D7CA  CB3A          		SRL	D
  D7CC  10FC          		DJNZ	RDDATE2
  D7CE  C1            		POP	BC
  D7CF  C9            		RET
  D7D0                	IN49SB_BCD:
  D7D0  CD42DA        		CALL	IN49SB
  D7D3                	BCD:
  D7D3  4F            		LD	C,A
  D7D4  E6F0          		AND	0F0H
  D7D6  0F            		RRCA
  D7D7  47            		LD	B,A
  D7D8  0F            		RRCA
  D7D9  0F            		RRCA
  D7DA  80            		ADD	A,B
  D7DB  47            		LD	B,A
  D7DC  79            		LD	A,C
  D7DD  E60F          		AND	00FH
  D7DF  80            		ADD	A,B
  D7E0  C9            		RET
                      	
  D7E1                	_SYS2C:
  D7E1  C5            		PUSH	BC
  D7E2  3EEF          		LD	A,0EFH		;Read time
  D7E4  CD5DDA        		CALL	COMOUT
  D7E7  CDD0D7        		CALL	IN49SB_BCD	;TT
  D7EA  67            		LD	H,A
  D7EB  CDD0D7        		CALL	IN49SB_BCD	;MM
  D7EE  6F            		LD	L,A
  D7EF  CDD0D7        		CALL	IN49SB_BCD	;SS
  D7F2  57            		LD	D,A
  D7F3  C1            		POP	BC
  D7F4  AF            		XOR	A
  D7F5  C9            		RET
                      	
  D7F6                	MSX1:
  D7F6  5F            		LD	E,A
  D7F7  CDCDEC        		CALL	_PRINT
  D7FA                	MSX:
  D7FA  7E            		LD	A,(HL)
  D7FB  23            		INC	HL
  D7FC  B7            		OR	A
  D7FD  20F7          		JR	NZ,MSX1
  D7FF  C9            		RET
                      	
  D800                	ESC1:
  D800  7B            		LD	A,E
  D801  FE41          		CP	'A'
  D803  CA41D9        		JP	Z,CTRL1E
  D806  FE42          		CP	'B'
  D808  CAC8DA        		JP	Z,CTRL1F
  D80B  FE43          		CP	'C'
  D80D  CA4ED9        		JP	Z,CTRL1C
  D810  FE44          		CP	'D'
  D812  CA37D9        		JP	Z,CTRL1D
  D815  FE45          		CP	'E'
  D817  2802          		JR	Z,CT0CX
  D819  FE6A          		CP	'j'
  D81B                	CT0CX:
  D81B  CA9BDA        		JP	Z,CTRL0C
  D81E  FE48          		CP	'H'
  D820  CACCD9        		JP	Z,CTRL0B
  D823  FE4A          		CP	'J'
  D825  CA9EDA        		JP	Z,CTRL1A
  D828  FE4B          		CP	'K'
  D82A  CA8ED9        		JP	Z,CTRL05
  D82D  FE4C          		CP	'L'
  D82F  CADDDA        		JP	Z,CTRL0E
  D832  FE78          		CP	'x'
  D834  2804          		JR	Z,ESC1X
  D836  FE79          		CP	'y'
  D838  2002          		JR	NZ,ESC1Y
  D83A                	ESC1X:
  D83A  3601          		LD	(HL),1
  D83C                	ESC1Y:
  D83C  FE3D          		CP	'='
  D83E  2804          		JR	Z,ESC1W
  D840  FE59          		CP	'Y'
  D842  2002          		JR	NZ,ESC1Z
  D844                	ESC1W:
  D844  3602          		LD	(HL),2
  D846                	ESC1Z:
  D846  FE20          		CP	020H
  D848  3802          		JR	C,ESC1C
  D84A  87            		ADD	A,A
  D84B  D0            		RET	NC
  D84C                	ESC1C:
  D84C  E1            		POP	HL
  D84D  184A          		JR	ANK
                      	
  D84F                	ESC:
  D84F  21AAD8        		LD	HL,PRINTE5
  D852  E5            		PUSH	HL
  D853  2175D8        		LD	HL,ESCFLG+1
  D856  3600          		LD	(HL),0
  D858  3D            		DEC	A
  D859  28A5          		JR	Z,ESC1
  D85B  3D            		DEC	A
  D85C  2009          		JR	NZ,ESC2
  D85E  3603          		LD	(HL),3
  D860  7B            		LD	A,E
  D861  D620          		SUB	020H
  D863  326AD8        		LD	(ESCYP+1),A
  D866  C9            		RET
  D867                	ESC2:
  D867  3D            		DEC	A
  D868  C0            		RET	NZ
  D869  2600          	ESCYP:	LD	H,0
  D86B  7B            		LD	A,E
  D86C  D620          		SUB	020H
  D86E  6F            		LD	L,A
  D86F  C3D6EC        		JP	_LOC
                      	
  D872                	PRINT:
  D872  C5            		PUSH	BC
  D873  E5            		PUSH	HL
  D874  3E00          	ESCFLG:	LD	A,000H
  D876  B7            		OR	A
  D877  20D6          		JR	NZ,ESC
                      	
  D879  3E1F          		LD	A,01FH
  D87B  BB            		CP	E
  D87C  3030          		JR	NC,CTRL
  D87E                	PRINTC:
  D87E  A7            	INSFLG:	AND	A
  D87F  DC66DA        		CALL	C,CTRL12
                      	
  D882  3E00          	KANFLG:	LD	A,000H
  D884  B7            		OR	A
  D885  2041          		JR	NZ,KANJI2
  D887  7B            	X1KPAT:	LD	A,E
  D888  FE80          		CP	080H
  D88A  380D          		JR	C,ANK
  D88C  FEA0          		CP	0A0H
  D88E  3804          		JR	C,KANJI1
  D890  FEE0          		CP	0E0H
  D892  3805          		JR	C,ANK
  D894                	KANJI1:
  D894  3283D8        		LD	(KANFLG+1),A
  D897  1811          		JR	PRINTE5
  D899                	ANK:
  D899  ED4B8EEC      		LD	BC,(_TXADR)
  D89D  78            		LD	A,B
  D89E  F638          		OR	038H
  D8A0  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  D8A1  ED71          		DB	0EDH,071H		;Kanji
  D8A3  CB98          		RES	3,B
  D8A5  ED59          		OUT	(C),E		;Text
  D8A7                	KANJIE:
  D8A7  CD13D9        		CALL	PRINTE7
  D8AA                	PRINTE5:
  D8AA  E1            		POP	HL
  D8AB  C1            		POP	BC
  D8AC  AF            		XOR	A
  D8AD  C9            		RET
                      	
  D8AE                	CTRL:
  D8AE  CDFAD8        		CALL	KANCLR
  D8B1  3EA7          		LD	A,0A7H		;AND	A
  D8B3  327ED8        		LD	(INSFLG),A
  D8B6  7B            		LD	A,E
  D8B7  87            		ADD	A,A
  D8B8  4F            		LD	C,A
  D8B9  0600          		LD	B,0
  D8BB  2127DC        		LD	HL,CTRLTB
  D8BE  09            		ADD	HL,BC
  D8BF  7E            		LD	A,(HL)
  D8C0  23            		INC	HL
  D8C1  66            		LD	H,(HL)
  D8C2  6F            		LD	L,A
  D8C3  CD0F00        		CALL	K_HL
  D8C6  18E2          		JR	PRINTE5
                      	
  D8C8                	KANJI2:
  D8C8  D5            		PUSH	DE
  D8C9  57            		LD	D,A
  D8CA  01812F        		LD	BC,02F81H	;SFTJIS
  D8CD  DF            		RST	018H
  D8CE  01C32F        		LD	BC,02FC3H	;Instead or JISVRM
  D8D1  DF            		RST	018H
                      	
  D8D2  ED4B8EEC      		LD	BC,(_TXADR)
  D8D6  78            		LD	A,B
  D8D7  F638          		OR	038H
  D8D9  47            		LD	B,A
  D8DA  ED51          		OUT	(C),D		;kanji
  D8DC  CB98          		RES	3,B
  D8DE  ED59          		OUT	(C),E		;Text
  D8E0  CD13D9        		CALL	PRINTE7
  D8E3  ED4B8EEC      		LD	BC,(_TXADR)
  D8E7  78            		LD	A,B
  D8E8  F638          		OR	038H
  D8EA  47            		LD	B,A
  D8EB  CBF2          		SET	6,D
  D8ED  ED51          		OUT	(C),D		;Kanji
  D8EF  CB98          		RES	3,B
  D8F1  ED59          		OUT	(C),E		;Text
  D8F3  D1            		POP	DE
  D8F4  AF            		XOR	A
  D8F5  3283D8        		LD	(KANFLG+1),A
  D8F8  18AD          		JR	KANJIE
                      	
  D8FA                	KANCLR:
  D8FA  3A83D8        		LD	A,(KANFLG+1)
  D8FD  B7            		OR	A
  D8FE  C8            		RET	Z
  D8FF  ED4B8EEC      		LD	BC,(_TXADR)
  D903  78            		LD	A,B
  D904  F638          		OR	038H
  D906  47            		LD	B,A
  D907  AF            		XOR	A
  D908  3283D8        		LD	(KANFLG+1),A
  D90B  ED79          		OUT	(C),A		;Kanji
  D90D  CB98          		RES	3,B
  D90F  3E20          		LD	A,020H
  D911  ED79          		OUT	(C),A		;Text
  D913                	PRINTE7:
  D913  CBA0          		RES	4,B
  D915                	PRINTE6:
  D915  3A96EC        		LD	A,(_COLORF)
  D918                	PRINTE4:
  D918  ED79          		OUT	(C),A		;Color
  D91A  78            		LD	A,B
  D91B  E607          		AND	7
  D91D  47            		LD	B,A
  D91E                	PRINTE2:
  D91E  03            		INC	BC
  D91F                	PRINTE3:
  D91F  2ABAEC        		LD	HL,(CRTCD+10)
  D922  A7            		AND	A
  D923  ED4A          		ADC	HL,BC
  D925                	PRINTE8:
  D925  2805          		JR	Z,PRINT2
  D927                	PRINTE1:
  D927  ED438EEC      		LD	(_TXADR),BC
  D92B                	PRINTE:
  D92B  C9            		RET
                      	
  D92C                	PRINT2:
  D92C  CDE2DA        		CALL	SCR
  D92F  2ABCEC        		LD	HL,(CRTCD+12)
  D932  09            		ADD	HL,BC
  D933  228EEC        		LD	(_TXADR),HL
  D936  C9            		RET
                      	
  D937                	CTRL08:
  D937                	CTRL1D:
  D937  ED4B8EEC      		LD	BC,(_TXADR)
  D93B  78            		LD	A,B
  D93C  B1            		OR	C
  D93D  C8            		RET	Z
  D93E  0B            		DEC	BC
  D93F  18E6          		JR	PRINTE1
                      	
  D941                	CTRL1E:
  D941  ED4B8EEC      		LD	BC,(_TXADR)
  D945  2ABCEC        		LD	HL,(CRTCD+12)
  D948  09            		ADD	HL,BC
  D949  D0            		RET	NC
  D94A  44            		LD	B,H
  D94B  4D            		LD	C,L
  D94C  18D9          		JR	PRINTE1
                      	
  D94E                	CTRL1C:
  D94E  ED4B8EEC      		LD	BC,(_TXADR)
  D952  18CA          		JR	PRINTE2
                      	
  D954                	CTRL09:
  D954  ED4B8EEC      		LD	BC,(_TXADR)
  D958  79            		LD	A,C
  D959  E6F8          		AND	0F8H
  D95B  C608          		ADD	A,8
  D95D  4F            		LD	C,A
  D95E  88            		ADC	A,B
  D95F  91            		SUB	C
  D960  47            		LD	B,A
  D961  18BC          		JR	PRINTE3
                      	
  D963                	CTRL02:
  D963  2A8EEC        		LD	HL,(_TXADR)
  D966  7C            		LD	A,H
  D967  B5            		OR	L
  D968  C8            		RET	Z
  D969  2B            		DEC	HL
  D96A  228EEC        		LD	(_TXADR),HL
  D96D  D5            		PUSH	DE
  D96E  CDD3EC        		CALL	_POS
  D971  3AB1EC        		LD	A,(CRTCD+1)
  D974  95            		SUB	L
  D975  6F            		LD	L,A
  D976  2D            		DEC	L
  D977  2638          		LD	H,038H
  D979  ED4B8EEC      		LD	BC,(_TXADR)
  D97D  09            		ADD	HL,BC
  D97E  44            		LD	B,H
  D97F  4D            		LD	C,L
  D980  110020        		LD	DE,02000H	;D:Text E:kanji
  D983  2A96EC        		LD	HL,(_COLORF)	;L:Color
  D986                	C8X1:
  D986  CD82DA        		CALL	C12S
  D989  0B            		DEC	BC
  D98A  20FA          		JR	NZ,C8X1
  D98C  D1            		POP	DE
  D98D  C9            		RET
                      	
  D98E                	CTRL05:
  D98E  CDD3EC        		CALL	_POS
  D991  3AB1EC        		LD	A,(CRTCD+1)
  D994  95            		SUB	L
  D995  6F            		LD	L,A
  D996  2620          		LD	H,020H
  D998  ED4B8EEC      		LD	BC,(_TXADR)
  D99C                	C05X1:
  D99C  78            		LD	A,B
  D99D  F638          		OR	038H
  D99F  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  D9A0  ED71          		DB	0EDH,071H		;kanji
  D9A2  CB98          		RES	3,B
  D9A4  ED61          		OUT	(C),H		;Text
  D9A6  CBA0          		RES	4,B
  D9A8  3A96EC        		LD	A,(_COLORF)
  D9AB  ED79          		OUT	(C),A		;Color
  D9AD  03            		INC	BC
  D9AE  2D            		DEC	L
  D9AF  20EB          		JR	NZ,C05X1
  D9B1  C9            		RET
                      	
  D9B2                	CTRL0D:
  D9B2  CDD3EC        		CALL	_POS
  D9B5  2E00          		LD	L,0
  D9B7                	LOC:
  D9B7  C5            		PUSH	BC
  D9B8  E5            		PUSH	HL
  D9B9  CDFAD8        		CALL	KANCLR
  D9BC  CDDFD9        		CALL	LOC1
  D9BF  ED438EEC      		LD	(_TXADR),BC
  D9C3  E1            		POP	HL
  D9C4  C1            		POP	BC
  D9C5  C9            		RET
                      	
  D9C6                	CTRL01:
  D9C6  3E37          		LD	A,037H		;SCF
  D9C8  327ED8        		LD	(INSFLG),A
  D9CB  C9            		RET
                      	
  D9CC                	CTRL0B:
  D9CC  210000        		LD	HL,0
  D9CF  228EEC        		LD	(_TXADR),HL
  D9D2  C9            		RET
                      	
  D9D3                	PRINTS:
  D9D3  CD31D7        		CALL	BREAK
  D9D6  C3CDEC        		JP	_PRINT
                      	
  D9D9                	CTRL1B:
  D9D9  3E01          		LD	A,1
  D9DB  3275D8        		LD	(ESCFLG+1),A
  D9DE  C9            		RET
                      	
  D9DF                	LOC1:
  D9DF  44            		LD	B,H
  D9E0  4D            		LD	C,L
  D9E1  04            		INC	B
  D9E2  05            		DEC	B
  D9E3  C8            		RET	Z
  D9E4  D5            		PUSH	DE
  D9E5  ED5BB1EC      		LD	DE,(CRTCD+1)
  D9E9  210000        		LD	HL,0
  D9EC  55            		LD	D,L
  D9ED                	LOC2:
  D9ED  19            		ADD	HL,DE
  D9EE  10FD          		DJNZ	LOC2
  D9F0  09            		ADD	HL,BC
  D9F1  D1            		POP	DE
  D9F2                	LOC3:
  D9F2  44            		LD	B,H
  D9F3  4D            		LD	C,L
  D9F4  C9            		RET
                      	
  D9F5                	BOOT:
  D9F5  C30000        		JP	0
  D9F8                	WBOOT:
  D9F8  C3AACC        		JP	_SYS00
  D9FB                	CONST_:
  D9FB  C399D7        		JP	CONSTX
  D9FE                	_SYS07:
  D9FE                	CONIN:
  D9FE  C340D7        		JP	FLGET
  DA01                	CONOUT0:
  DA01  C304DA        		JP	CONOUT
  DA04                	CONOUT:
  DA04  CD16DA        		CALL	CURSOR
  DA07  59            		LD	E,C
  DA08  CDCDEC        		CALL	_PRINT
  DA0B  7B            		LD	A,E
  DA0C  FE0A          		CP	00AH
  DA0E  2006          		JR	NZ,CURSOR
  DA10  CDB2D9        		CALL	CTRL0D
  DA13  CD8ED9        		CALL	CTRL05
  DA16                	CURSOR:
  DA16  C5            		PUSH	BC
  DA17  ED4B8EEC      		LD	BC,(_TXADR)
  DA1B  CBE8          		SET	5,B
  DA1D  ED78          		IN	A,(C)
  DA1F  EE18          		XOR	018H
  DA21  ED79          		OUT	(C),A
  DA23  C1            		POP	BC
  DA24  C9            		RET
                      	
  DA25                	CTRL07:
  DA25  2167DC        		LD	HL,BEEPD
  DA28                	BEEP1:
  DA28  7E            		LD	A,(HL)
  DA29  23            		INC	HL
  DA2A  FEFF          		CP	0FFH
  DA2C  C8            		RET	Z
  DA2D  F3            		DI
  DA2E  061C          		LD	B,01CH
  DA30  ED79          		OUT	(C),A
  DA32  EDA3          		OUTI
  DA34  FB            		EI
  DA35  18F1          		JR	BEEP1
                      	
  DA37                	OT49SB:
  DA37  C5            		PUSH	BC
  DA38  CD53DA        		CALL	CANW
  DA3B  010019        		LD	BC,01900H
  DA3E  ED79          		OUT	(C),A
  DA40  C1            		POP	BC
  DA41  C9            		RET
                      	
  DA42                	IN49SB:
  DA42  C5            		PUSH	BC
  DA43  01011A        		LD	BC,01A01H
  DA46                	CANR:
  DA46  ED78          		IN	A,(C)
  DA48  E620          		AND	020H
  DA4A  20FA          		JR	NZ,CANR
  DA4C  010019        		LD	BC,01900H
  DA4F  ED78          		IN	A,(C)
  DA51  C1            		POP	BC
  DA52  C9            		RET
                      	
  DA53                	CANW:
  DA53  01011A        		LD	BC,01A01H
  DA56  ED48          		IN	C,(C)
  DA58  CB71          		BIT	6,C
  DA5A  20F7          		JR	NZ,CANW
  DA5C  C9            		RET
                      	
  DA5D                	COMOUT:
  DA5D  FB            		EI
  DA5E  CD37DA        		CALL	OT49SB
  DA61  CD53DA        		CALL	CANW
  DA64  F3            		DI
  DA65  C9            		RET
                      	
  DA66                	CTRL12:
  DA66  D5            		PUSH	DE
  DA67  CDD3EC        		CALL	_POS
  DA6A  3AB1EC        		LD	A,(CRTCD+1)
  DA6D  95            		SUB	L
  DA6E  ED4B8EEC      		LD	BC,(_TXADR)
  DA72  110020        		LD	DE,02000H	;D:Text E:Kanji
  DA75  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DA78  CBE8          		SET	5,B
  DA7A                	C12X1:
  DA7A  CD82DA        		CALL	C12S
  DA7D  03            		INC	BC
  DA7E  20FA          		JR	NZ,C12X1
  DA80  D1            		POP	DE
  DA81  C9            		RET
                      	
  DA82                	C12S:
  DA82  CBE0          		SET	4,B
  DA84  CBD8          		SET	3,B
  DA86  ED60          		IN	H,(C)
  DA88  ED59          	X1PAT:	OUT	(C),E
  DA8A  5C            		LD	E,H
  DA8B  CB98          		RES	3,B
  DA8D  ED60          		IN	H,(C)
  DA8F  ED51          		OUT	(C),D
  DA91  54            		LD	D,H
  DA92  CBA0          		RES	4,B
  DA94  ED60          		IN	H,(C)
  DA96  ED69          		OUT	(C),L
  DA98  6C            		LD	L,H
  DA99  3D            		DEC	A
  DA9A  C9            		RET
                      	
  DA9B                	CTRL0C:
  DA9B  CDCCD9        		CALL	CTRL0B
  DA9E                	CTRL1A:
  DA9E  ED4B8EEC      		LD	BC,(_TXADR)
  DAA2                	C1AX1:
  DAA2  78            		LD	A,B
  DAA3  F638          		OR	038H
  DAA5  47            		LD	B,A
                      	;	OUT	(C),0		;未定義命令ニーモニック
  DAA6  ED71          		DB	0EDH,071H		;kanji
  DAA8  CB98          		RES	3,B
  DAAA  3E20          		LD	A,020H
  DAAC  ED79          		OUT	(C),A		;Text
  DAAE  CBA0          		RES	4,B
  DAB0  3A96EC        		LD	A,(_COLORF)
  DAB3  ED79          		OUT	(C),A		;Color
  DAB5  03            		INC	BC
  DAB6  CBA8          		RES	5,B
  DAB8  2ABAEC        		LD	HL,(CRTCD+10)
  DABB  09            		ADD	HL,BC
  DABC  30E4          		JR	NC,C1AX1
  DABE  C9            		RET
                      	
  DABF                	CTRL04:
  DABF  CDD3EC        		CALL	_POS
  DAC2  7D            		LD	A,L
  DAC3  B7            		OR	A
  DAC4  C8            		RET	Z
  DAC5                	CTRL03:
  DAC5  CDB2D9        		CALL	CTRL0D
  DAC8                	CTRL0A:
  DAC8                	CTRL1F:
  DAC8  ED4B8EEC      		LD	BC,(_TXADR)
  DACC  2AB1EC        		LD	HL,(CRTCD+1)
  DACF  2600          		LD	H,0
  DAD1  09            		ADD	HL,BC
  DAD2  44            		LD	B,H
  DAD3  4D            		LD	C,L
  DAD4  2ABAEC        		LD	HL,(CRTCD+10)
  DAD7  09            		ADD	HL,BC
  DAD8  3F            		CCF
  DAD9  9F            		SBC	A,A
  DADA  C325D9        		JP	PRINTE8
                      	
  DADD                	CTRL0E:
  DADD  CDD3EC        		CALL	_POS
  DAE0  7C            		LD	A,H
  DAE1  01            		DB	001H
  DAE2                	SCR:
  DAE2  3A97EC        		LD	A,(_LINE)
  DAE5  3D            		DEC	A
  DAE6                	SCR1:
  DAE6  C5            		PUSH	BC
  DAE7  D5            		PUSH	DE
  DAE8  01801F        		LD	BC,01F80H	;DMA
  DAEB  1EC3          		LD	E,0C3H
  DAED  ED59          		OUT	(C),E
  DAEF  119A65        		LD	DE,0659AH
  DAF2  ED59          		OUT	(C),E
  DAF4  ED51          		OUT	(C),D
  DAF6  114F00        		LD	DE,79
  DAF9  ED59          		OUT	(C),E
  DAFB  ED51          		OUT	(C),D
                      	
  DAFD  210038        		LD	HL,03800H
  DB00  11181C        		LD	DE,01C18H
  DB03  ED51          		OUT	(C),D
  DB05  ED59          		OUT	(C),E
                      	
  DB07                	SCRUP1:
  DB07  B7            		OR	A
  DB08  2839          		JR	Z,SCRCL
  DB0A  F5            		PUSH	AF
  DB0B  CD24DB        		CALL	UPSUB		;kanji
  DB0E  ED5BBCEC      		LD	DE,(CRTCD+12)
  DB12  16F7          		LD	D,0F7H
  DB14  19            		ADD	HL,DE
  DB15  D5            		PUSH	DE
  DB16  CD24DB        		CALL	UPSUB		;Text
  DB19  D1            		POP	DE
  DB1A  19            		ADD	HL,DE
  DB1B  CD24DB        		CALL	UPSUB		;Color
  DB1E  CBE4          		SET	4,H
  DB20  F1            		POP	AF
  DB21  3D            		DEC	A
  DB22  18E3          		JR	SCRUP1
                      	
  DB24                	UPSUB:
  DB24  ED5BB1EC      		LD	DE,(CRTCD+1)
  DB28  1600          		LD	D,0
  DB2A  3ECD          		LD	A,0CDH
  DB2C  ED79          		OUT	(C),A
  DB2E  ED69          		OUT	(C),L		;SOURCE
  DB30  ED61          		OUT	(C),H
  DB32  19            		ADD	HL,DE
  DB33  3E1D          		LD	A,01DH
  DB35  ED79          		OUT	(C),A		;DIST
  DB37  ED69          		OUT	(C),L
  DB39  ED61          		OUT	(C),H
  DB3B  1187CF        		LD	DE,0CF87H
  DB3E  ED51          		OUT	(C),D
  DB40  ED59          		OUT	(C),E
  DB42  C9            		RET
                      	
  DB43                	SCRCL:
  DB43  44            		LD	B,H
  DB44  4D            		LD	C,L
  DB45  215020        		LD	HL,02000H+80
  DB48  3A96EC        		LD	A,(_COLORF)
  DB4B                	SCRCL1:
                      	;	OUT	(C),0		;未定義命令ニーモニック
  DB4B  ED71          		DB	0EDH,071H
  DB4D  CB98          		RES	3,B
  DB4F  ED61          		OUT	(C),H
  DB51  CBA0          		RES	4,B
  DB53  ED79          		OUT	(C),A
  DB55  CBD8          		SET	3,B
  DB57  CBE0          		SET	4,B
  DB59  03            		INC	BC
  DB5A  2D            		DEC	L
  DB5B  20EE          		JR	NZ,SCRCL1
  DB5D  D1            		POP	DE
  DB5E  C1            		POP	BC
  DB5F  C9            		RET
                      	
  DB60                	SCRN:
  DB60  D5            		PUSH	DE
  DB61  ED58          		IN	E,(C)		;Text
  DB63  CBD8          		SET	3,B
  DB65  ED50          		IN	D,(C)		;Kanji
  DB67  2819          		JR	Z,SCRNE
  DB69  AF            		XOR	A
  DB6A  C5            		PUSH	BC
  DB6B  013730        		LD	BC,03037H	;VRMJIS
  DB6E  DF            		RST	018H
  DB6F  01522F        		LD	BC,02F52H	;JISSFT
  DB72  DF            		RST	018H
  DB73  C1            		POP	BC
  DB74  ED78          		IN	A,(C)
  DB76  CB98          		RES	3,B
  DB78  E640          		AND	040H
  DB7A  2003          		JR	NZ,SCRN1
  DB7C  7A            		LD	A,D
  DB7D  D1            		POP	DE
  DB7E  C9            		RET
  DB7F                	SCRN1:
  DB7F  7B            		LD	A,E
  DB80  D1            		POP	DE
  DB81  C9            		RET
                      	
  DB82                	SCRNE:
  DB82  D1            		POP	DE
  DB83  CB98          		RES	3,B
  DB85                	SCRNX:
  DB85  ED78          		IN	A,(C)
  DB87  C9            		RET
                      	
  DB88                	POS:
  DB88  2A8EEC        		LD	HL,(_TXADR)
  DB8B  C5            		PUSH	BC
  DB8C  ED4BBCEC      		LD	BC,(CRTCD+12)
  DB90  AF            		XOR	A
  DB91                	POS1:
  DB91  09            		ADD	HL,BC
  DB92  3C            		INC	A
  DB93  38FC          		JR	C,POS1
  DB95  ED42          		SBC	HL,BC
  DB97  3D            		DEC	A
  DB98  67            		LD	H,A
  DB99  C1            		POP	BC
  DB9A  A7            		AND	A
  DB9B  C9            		RET
                      	
  DB9C                	GETL:
  DB9C  CDD3EC        		CALL	_POS
  DB9F  E5            		PUSH	HL
  DBA0                	GETL1:
  DBA0  CDD3EC        		CALL	_POS
  DBA3  C1            		POP	BC
  DBA4  C5            		PUSH	BC
  DBA5  7D            		LD	A,L
  DBA6  91            		SUB	C
  DBA7  69            		LD	L,C
  DBA8  4F            		LD	C,A
  DBA9  DCD6EC        		CALL	C,_LOC
  DBAC                	GET1W:
  DBAC  CD2CD7        		CALL	_SYS08
  DBAF  FE08          		CP	8
  DBB1  2007          		JR	NZ,GETL1X
  DBB3  0D            		DEC	C
  DBB4  CB79          		BIT	7,C
  DBB6  2002          		JR	NZ,GETL1X
  DBB8  3E02          		LD	A,2
  DBBA                	GETL1X:
  DBBA  FE1B          		CP	01BH
  DBBC  2016          		JR	NZ,GETL1V
  DBBE  CD2CD7        		CALL	_SYS08
  DBC1  FE22          		CP	022H
  DBC3  2008          		JR	NZ,GETL1Y
  DBC5  2100FF        		LD	HL,KBUF
  DBC8  CDFAD7        		CALL	MSX
  DBCB  180B          		JR	GETL1Z
  DBCD                	GETL1Y:
  DBCD  F5            		PUSH	AF
  DBCE  1E1B          		LD	E,01BH
  DBD0  CDCDEC        		CALL	_PRINT
  DBD3  F1            		POP	AF
  DBD4                	GETL1V:
  DBD4  5F            		LD	E,A
  DBD5  CDCDEC        		CALL	_PRINT
  DBD8                	GETL1Z:
  DBD8  7B            		LD	A,E
  DBD9  FE0D          		CP	00DH
  DBDB  20C3          		JR	NZ,GETL1
                      	
  DBDD  2100FF        		LD	HL,KBUF
  DBE0  AF            		XOR	A
  DBE1  ED4BB0EC      		LD	BC,(CRTCD)
  DBE5                	GETL0:
  DBE5  77            		LD	(HL),A
  DBE6  23            		INC	HL
  DBE7  10FC          		DJNZ	GETL0
                      	
  DBE9  D1            		POP	DE
  DBEA  CDD3EC        		CALL	_POS
  DBED  6B            		LD	L,E
  DBEE  3AB1EC        		LD	A,(CRTCD+1)
  DBF1  95            		SUB	L
  DBF2  57            		LD	D,A
  DBF3  CDDFD9        		CALL	LOC1
  DBF6  78            		LD	A,B
  DBF7  F630          		OR	030H
  DBF9  47            		LD	B,A
  DBFA  5A            		LD	E,D
  DBFB  2100FF        		LD	HL,KBUF
  DBFE                	GETL2:
  DBFE  CDD0EC        		CALL	_SCRN
  DC01  03            		INC	BC
  DC02  77            		LD	(HL),A
  DC03  23            		INC	HL
  DC04  1D            		DEC	E
  DC05  20F7          		JR	NZ,GETL2
  DC07                	GETL3:
  DC07  2B            		DEC	HL
  DC08  7E            		LD	A,(HL)
  DC09  FE21          		CP	021H
  DC0B  D0            		RET	NC
  DC0C  3600          		LD	(HL),0
  DC0E  15            		DEC	D
  DC0F  20F6          		JR	NZ,GETL3
  DC11  C9            		RET
                      	
  DC12                	INKEY:
  DC12  FB            		EI
  DC13  E5            		PUSH	HL
  DC14  2A90EC        		LD	HL,(_KEYPS)
  DC17  7C            		LD	A,H
  DC18  AD            		XOR	L
  DC19  2809          		JR	Z,INKEY1
  DC1B  7C            		LD	A,H
  DC1C  3C            		INC	A
  DC1D  3291EC        		LD	(_KEYPS+1),A
  DC20  6F            		LD	L,A
  DC21  26FE          		LD	H,KEYBF/256
  DC23  7E            		LD	A,(HL)
  DC24                	INKEY1:
  DC24  E1            		POP	HL
  DC25  B7            		OR	A
  DC26  C9            		RET
                      	
  DC27                	CTRLTB:
  DC27  2BD9C6D963D9C5		DW	PRINTE,CTRL01,CTRL02,CTRL03
  DC2F  BFDA8ED99EDA25		DW	CTRL04,CTRL05,CTRL1A,CTRL07
  DC37  37D954D9C8DACC		DW	CTRL08,CTRL09,CTRL0A,CTRL0B
  DC3F  9BDAB2D9DDDA2B		DW	CTRL0C,CTRL0D,CTRL0E,PRINTE
  DC47  2BD92BD9C6D92B		DW	PRINTE,PRINTE,CTRL01,PRINTE
  DC4F  2BD92BD92BD92B		DW	PRINTE,PRINTE,PRINTE,PRINTE
  DC57  2BD92BD99EDAD9		DW	PRINTE,PRINTE,CTRL1A,CTRL1B
  DC5F  4ED937D941D9C8		DW	CTRL1C,CTRL1D,CTRL1E,CTRL1F
                      	
  DC67                	BEEPD:
  DC67  008E01000B000C		DB	0,08EH,1,0,00BH,0,00CH,010H
  DC6F  073E08100D00FF		DB	007H,03EH,008H,010H,00DH,0,0FFH
                      	
  DC76  00            	REDDATA:DB	0
                      	
  DC77                		DS	1	;余りの数合わせ
                      	
                      	
                      	;LDFILE.ASM
                      	
                      	;	LSX-Dodgers FILE
                      	
  DC78                	FILEC:
  DC78  CD83DC        		CALL	FILE
  DC7B                	FILEC2:
  DC7B  3ADC00        		LD	A,(FDRV+1)
  DC7E  FE20          		CP	020H
  DC80  C8            		RET	Z
  DC81  183B          		JR	SETDIR1
                      	
  DC83                	FILE:
  DC83  AF            		XOR	A
  DC84  32DB00        		LD	(FDRV),A
  DC87  67            		LD	H,A
  DC88  6F            		LD	L,A
  DC89  22E900        		LD	(FDRV+14),HL
  DC8C  CD5DDD        		CALL	SPCUT
  DC8F  CD42DD        		CALL	CCHK3
  DC92  2812          		JR	Z,DEVI1
  DC94  13            		INC	DE
  DC95  1A            		LD	A,(DE)
  DC96  1B            		DEC	DE
  DC97  FE3A          		CP	':'
  DC99  200B          		JR	NZ,DEVI1
  DC9B  1A            		LD	A,(DE)		;DRIVE
  DC9C  CD6EDF        		CALL	CAP
  DC9F  D640          		SUB	'@'
  DCA1  13            		INC	DE
  DCA2  13            		INC	DE
  DCA3  32DB00        		LD	(FDRV),A
  DCA6                	DEVI1:
  DCA6  1A            		LD	A,(DE)
  DCA7  D65C          		SUB	05CH
  DCA9  200B          		JR	NZ,NOROOT
  DCAB  210000        		LD	HL,0
  DCAE  22F500        		LD	(FDRV+26),HL
  DCB1  2C            		INC	L
  DCB2  22E900        		LD	(FDRV+14),HL
  DCB5  13            		INC	DE
  DCB6                	NOROOT:
                      	
  DCB6                	SETDIR:
  DCB6  CDE2DC        		CALL	FILED
  DCB9  1A            		LD	A,(DE)
  DCBA  FE5C          		CP	05CH
  DCBC  C0            		RET	NZ
  DCBD  13            		INC	DE
  DCBE                	SETDIR1:
  DCBE  3E10          		LD	A,010H		;Directory
  DCC0  32E800        		LD	(FDRV+13),A
  DCC3  D5            		PUSH	DE
  DCC4  11DB00        		LD	DE,FDRV
  DCC7  2A1EEC        		LD	HL,(STABLE+2*00FH)
  DCCA  CD0F00        		CALL	K_HL
  DCCD  D1            		POP	DE
  DCCE  B7            		OR	A
  DCCF  C0            		RET	NZ
                      	
  DCD0  3AE800        		LD	A,(FDRV+13)
  DCD3  CB67          		BIT	4,A
  DCD5  C8            		RET	Z
                      	
  DCD6  CD29DD        		CALL	FILEI
  DCD9  2AF500        		LD	HL,(FDRV+26)
  DCDC  23            		INC	HL
  DCDD  22E900        		LD	(FDRV+14),HL
  DCE0  18D4          		JR	SETDIR
                      	
  DCE2                	FILED:
  DCE2  CD29DD        		CALL	FILEI
                      	
  DCE5  0608          		LD	B,8
  DCE7                	FILE2:
  DCE7  CD37DD        		CALL	CCHKF
  DCEA  C8            		RET	Z
  DCEB  FE2A          		CP	'*'
  DCED  282E          		JR	Z,FILE9
  DCEF  FE2E          		CP	'.'
  DCF1  280C          		JR	Z,FILE4
  DCF3  77            		LD	(HL),A
  DCF4  23            		INC	HL
  DCF5  10F0          		DJNZ	FILE2
                      	
  DCF7                	FILE3:
  DCF7  CD37DD        		CALL	CCHKF
  DCFA  C8            		RET	Z
  DCFB  FE2E          		CP	'.'
  DCFD  20F8          		JR	NZ,FILE3
                      	
  DCFF                	FILE4:
  DCFF  21E400        		LD	HL,FNAME+8
  DD02  0603          		LD	B,3
                      	
  DD04                	FILE4L:
  DD04  CD37DD        		CALL	CCHKF
  DD07  C8            		RET	Z
  DD08  FE2E          		CP	'.'
  DD0A  2008          		JR	NZ,FILE12
  DD0C  32DC00        		LD	(FNAME),A	;Parent directory(..)
  DD0F  32DD00        		LD	(FNAME+1),A
  DD12  3E20          		LD	A,020H
  DD14                	FILE12:
  DD14  FE2A          		CP	'*'
  DD16  280A          		JR	Z,FILE10
  DD18  77            		LD	(HL),A
  DD19  23            		INC	HL
  DD1A  10E8          		DJNZ	FILE4L
  DD1C  C9            		RET
                      	
  DD1D                	FILE9:
  DD1D  CD22DD        		CALL	FILE10
  DD20  18D5          		JR	FILE3
                      	
  DD22                	FILE10:
  DD22  3E3F          		LD	A,'?'
                      	
  DD24                	FILE7:
  DD24  77            		LD	(HL),A
  DD25  23            		INC	HL
  DD26  10FC          		DJNZ	FILE7
  DD28  C9            		RET
                      	
  DD29                	FILEI:
  DD29  3E20          		LD	A,020H
  DD2B  01000B        		LD	BC,11*256
  DD2E  21DC00        		LD	HL,FNAME
  DD31  E5            		PUSH	HL
  DD32  CD24DD        		CALL	FILE7
  DD35  E1            		POP	HL
  DD36  C9            		RET
                      	
  DD37                	CCHKF:
  DD37  1A            		LD	A,(DE)
  DD38  CD3FDD        		CALL	CCHK2
  DD3B  C8            		RET	Z
  DD3C  C37EE0        		JP	FKAN
                      	
  DD3F                	CCHK2:
  DD3F  0C            		INC	C
  DD40  0D            		DEC	C
  DD41  C0            		RET	NZ
  DD42                	CCHK3:
  DD42  FE2B          		CP	'+'
  DD44  C8            		RET	Z
  DD45  FE2C          		CP	','
  DD47  C8            		RET	Z
  DD48  FE2F          		CP	'/'
  DD4A  C8            		RET	Z
  DD4B  FE3A          		CP	':'
  DD4D  C8            		RET	Z
  DD4E  FE3B          		CP	';'
  DD50  C8            		RET	Z
  DD51  FE3D          		CP	'='
  DD53  C8            		RET	Z
  DD54  FE5C          		CP	05CH
  DD56  C8            		RET	Z
  DD57  FE20          		CP	020H
  DD59  D0            		RET	NC
  DD5A  BF            		CP	A		;Z=1
  DD5B  C9            		RET
                      	
  DD5C                	SS1:
  DD5C  13            		INC	DE
  DD5D                	SPCUT:
  DD5D  1A            		LD	A,(DE)
  DD5E  FE20          		CP	020H
  DD60  28FA          		JR	Z,SS1
  DD62  C9            		RET
                      	
  DD63                	SETDRVF:
  DD63  11DB00        		LD	DE,FDRV
  DD66                	SETDRV0:
  DD66  CD6FDD        		CALL	SETDRV
  DD69  FDE1          		POP	IY
  DD6B  C1            		POP	BC
  DD6C  D1            		POP	DE
  DD6D  E1            		POP	HL
  DD6E  C9            		RET
                      	
  DD6F                	SETDRV:
  DD6F  E3            		EX	(SP),HL		;HL=RETRN ADDRESS
  DD70  D5            		PUSH	DE		;PUSH HL/DE/BC/IY
  DD71  C5            		PUSH	BC
  DD72  1A            		LD	A,(DE)
                      	;	EX	DE,IY
  DD73  D5            		PUSH	DE
  DD74  FDE3          		EX	(SP),IY
  DD76  D1            		POP	DE
                      	;
  DD77  D5            		PUSH	DE
  DD78  CD84DD        		CALL	GETDRV
  DD7B  3C            		INC	A
  DD7C  FD7700        		LD	(IY+0),A
  DD7F  3D            		DEC	A
  DD80  CDD9EC        		CALL	_CHGDRV
                      	
  DD83  E9            		JP	(HL)
                      	
  DD84                	GETDRV:
  DD84  E67F          		AND	07FH
  DD86  D601          		SUB	001H
  DD88  3003          		JR	NC,GETDRV1
  DD8A  3A87EC        		LD	A,(_DVSW)	;Current Drive
  DD8D                	GETDRV1:
  DD8D  3288EC        		LD	(_DRV),A
  DD90  C9            		RET
                      	
  DD91                	SOPENX:
  DD91  CDFADE        		CALL	CHKDDX
  DD94  3802          		JR	C,SOPENX1
  DD96  C1            		POP	BC
  DD97  E9            		JP	(HL)
  DD98                	SOPENX1:
  DD98  1135E2        		LD	DE,SFILE
  DD9B  1A            		LD	A,(DE)
  DD9C  FDBE00        		CP	(IY+0)
  DD9F  2024          		JR	NZ,SOPEN
  DDA1  13            		INC	DE
  DDA2  FDE5          		PUSH	IY
  DDA4  E1            		POP	HL
  DDA5  23            		INC	HL
  DDA6  CD2ADF        		CALL	CPFILE
  DDA9  201A          		JR	NZ,SOPEN
                      	
  DDAB  2A2FE2        		LD	HL,(SCDIR)
  DDAE  FD750E        		LD	(IY+14),L
  DDB1  FD740F        		LD	(IY+15),H
                      	
  DDB4  2A33E2        		LD	HL,(SFNDF)	;Direcroty location and Flags
  DDB7  229FEC        		LD	(_FILEN),HL
                      	
  DDBA  ED5B31E2      		LD	DE,(SFBPS)
  DDBE  2135E2        		LD	HL,SFILE
  DDC1  36FF          		LD	(HL),0FFH
  DDC3  23            		INC	HL
  DDC4  C9            		RET
  DDC5                	SOPEN:
  DDC5  21C2DE        		LD	HL,FILESE
  DDC8                	SOPENC:
  DDC8  2202DE        		LD	(OPENPAT+1),HL
                      	
  DDCB  CDE2EC        		CALL	_RDFATX		;Detect Media
  DDCE  3857          		JR	C,RDDERR
                      	
  DDD0  AF            		XOR	A
  DDD1  329FEC        		LD	(_FILEN),A
  DDD4                	SOPEN0:
  DDD4  CDAADF        		CALL	LDDIRX
  DDD7  2819          		JR	Z,SDIRX1
                      	
  DDD9  CDB3DE        		CALL	DC		;Sub Directory
  DDDC  3808          		JR	C,SDIRX0
  DDDE  2A7EEC        		LD	HL,(_DTBUF)
  DDE1  7E            		LD	A,(HL)
  DDE2  FE2E          		CP	'.'
  DDE4  2810          		JR	Z,SOPEN1
  DDE6                	SDIRX0:
  DDE6  AF            		XOR	A
  DDE7  32A0EC        		LD	(_DIRF),A
  DDEA  FD360E01      		LD	(IY+14),1
  DDEE  FD360F00      		LD	(IY+15),0
  DDF2                	SDIRX1:
  DDF2  ED5B5BE2      		LD	DE,(_DIRPS)	;Root Directory
                      	
  DDF6                	SOPEN1:
  DDF6  0E20          	IBM1:	LD	C,32		;自己書き換え 1024=32 / 512=16
  DDF8                	SOPEN1X:
  DDF8  CDB3DE        		CALL	DC		;FILE SEARCH
  DDFB  382A          		JR	C,RDDERR
  DDFD  2A7EEC        		LD	HL,(_DTBUF)
  DE00                	SOPEN2:
  DE00  D5            		PUSH	DE
  DE01  CDC2DE        	OPENPAT:CALL	FILESE		;(Self-rewriting)
  DE04  D1            		POP	DE
  DE05  3876          		JR	C,SOPENE
  DE07  281B          		JR	Z,NOTSE
  DE09                	SOPEN3:
  DE09  3AA0EC        		LD	A,(_DIRF)
  DE0C  B7            		OR	A
  DE0D  200C          		JR	NZ,SOPEN5
                      	
  DE0F  CD60DE        		CALL	ENDRDI
  DE12  280E          		JR	Z,SOPEN6
  DE14  3C            		INC	A
  DE15  200B          		JR	NZ,SOPEN6
  DE17  0E10          		LD	C,16
  DE19  18DD          		JR	SOPEN1X
  DE1B                	SOPEN5:
  DE1B  CDF7EC        		CALL	_GNCL	;END DIR
  DE1E  D8            		RET	C
  DE1F  CD66DF        		CALL	ENDCL
  DE22                	SOPEN6:
  DE22  38D2          		JR	C,SOPEN1
                      	
  DE24                	_SYS2B:
  DE24                	_SYS2D:
  DE24                	NOTSE:
  DE24  37            		SCF			;CF=1
  DE25  9F            		SBC	A,A		;A=0FFH
  DE26  C9            		RET
                      	
  DE27                	RDDERR:
  DE27  BF            		CP	A		;READ ERR CF=1 ZF=1
  DE28  37            		SCF
  DE29  C9            		RET
                      	
  DE2A                	NOPEN:
  DE2A  21C2DE        		LD	HL,FILESE
  DE2D  2202DE        		LD	(OPENPAT+1),HL
  DE30  FD2A98EC      		LD	IY,(_FCB)
  DE34  CD91E0        		CALL	CHKWILDX
  DE37  30EB          		JR	NC,NOTSE
  DE39  FD7E00        		LD	A,(IY+0)
  DE3C  3D            		DEC	A
  DE3D  3288EC        		LD	(_DRV),A
  DE40  CDD9EC        		CALL	_CHGDRV
  DE43  D8            		RET	C
                      	
  DE44  CDAADF        		CALL	LDDIRX
  DE47  ED5B9AEC      		LD	DE,(_FBPS)
  DE4B  CDB3DE        		CALL	DC
  DE4E  38D7          		JR	C,RDDERR
  DE50  3A9EEC        		LD	A,(_FBCNT)
  DE53  3D            		DEC	A
  DE54  28B3          		JR	Z,SOPEN3
  DE56                	NOPEN2:
  DE56  2A9CEC        		LD	HL,(_FBAD)
  DE59  012000        		LD	BC,020H
  DE5C  09            		ADD	HL,BC
  DE5D  4F            		LD	C,A
  DE5E  18A0          		JR	SOPEN2
                      	
  DE60                	ENDRDI:
  DE60  3A5EDF        		LD	A,(DBLPAT)	;A=029H or 0
  DE63  E601          		AND	1
  DE65  4F            		LD	C,A
  DE66  3C            		INC	A
  DE67  83            		ADD	A,E
  DE68  5F            		LD	E,A
  DE69  D60C          	RTEPAT:	SUB	12		;(Self-rewriting)
  DE6B  CB41          		BIT	0,C
  DE6D  C9            		RET
                      	
  DE6E                	SOPENE2:
  DE6E  229CEC        		LD	(_FBAD),HL
  DE71  79            		LD	A,C
  DE72  329EEC        		LD	(_FBCNT),A
  DE75  ED539AEC      		LD	(_FBPS),DE
  DE79  FD2298EC      		LD	(_FCB),IY
  DE7D                	SOPENE:
  DE7D  AF            		XOR	A
  DE7E  C9            		RET
                      	
  DE7F                	COPEN:
  DE7F  FD360D20      		LD	(IY+13),020H		;Attribute
                      	
  DE83  21DFDE        		LD	HL,NEXTSE
  DE86  CDC8DD        		CALL	SOPENC
  DE89  D0            		RET	NC
  DE8A  C8            		RET	Z
  DE8B  3AA0EC        		LD	A,(_DIRF)
  DE8E  D601          		SUB	001H
  DE90  D8            		RET	C
  DE91  0601          		LD	B,1
  DE93  CD03E1        		CALL	WRDF
  DE96  D8            		RET	C
  DE97  ED5B5DE2      		LD	DE,(_CLPS)
  DE9B  D5            		PUSH	DE
  DE9C  CD53DF        		CALL	DCPAT
  DE9F  CD2CE5        		CALL	DRDNX
  DEA2  2A7EEC        		LD	HL,(_DTBUF)
  DEA5  5D            		LD	E,L
  DEA6  54            		LD	D,H
  DEA7  13            		INC	DE		;DE,DTBUF+1
  DEA8  01FF03        		LD	BC,1023
  DEAB  AF            		XOR	A
  DEAC  77            		LD	(HL),A
  DEAD  E5            		PUSH	HL
  DEAE  EDB0          		LDIR
  DEB0  E1            		POP	HL
  DEB1  D1            		POP	DE
  DEB2  C9            		RET
                      	
  DEB3                	DC:
  DEB3  ED535DE2      		LD	(_CLPS),DE
  DEB7  C5            		PUSH	BC
  DEB8  D5            		PUSH	DE
  DEB9  CD53DF        		CALL	DCPAT
  DEBC  CD10E5        		CALL	DRDX
  DEBF  D1            		POP	DE
  DEC0  C1            		POP	BC
  DEC1  C9            		RET
                      	
  DEC2                	FILESE:
  DEC2  7E            		LD	A,(HL)
  DEC3  B7            		OR	A
  DEC4  C8            		RET	Z		;END:ZF=1 CF=0
  DEC5  FEE5          		CP	0E5H
  DEC7  280E          		JR	Z,FILESE1
  DEC9  FDE5          		PUSH	IY
  DECB  D1            		POP	DE
  DECC  13            		INC	DE
  DECD  E5            		PUSH	HL
  DECE  CD2ADF        		CALL	CPFILE
  DED1  CC4BDF        		CALL	Z,CPFILE2
  DED4  E1            		POP	HL
  DED5  37            		SCF
  DED6  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DED7                	FILESE1:
  DED7  CDEEDE        		CALL	FNEXT
  DEDA  20E6          		JR	NZ,FILESE
  DEDC                	ZFCF0:
  DEDC  F6FF          		OR	0FFH		;ZF=0 CF=0
  DEDE  C9            		RET
                      	
  DEDF                	NEXTSE:
  DEDF  7E            		LD	A,(HL)
  DEE0  B7            		OR	A
  DEE1  37            		SCF
  DEE2  C8            		RET	Z		;!!!:ZF=1 CF=1
  DEE3  FEE5          		CP	0E5H
  DEE5  37            		SCF
  DEE6  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DEE7  CDEEDE        		CALL	FNEXT
  DEEA  20F3          		JR	NZ,NEXTSE
  DEEC  18EE          		JR	ZFCF0
                      	
  DEEE                	FNEXT:
  DEEE  E5            		PUSH	HL
  DEEF  219FEC        		LD	HL,_FILEN
  DEF2  34            		INC	(HL)
  DEF3  E1            		POP	HL
  DEF4  112000        		LD	DE,020H
  DEF7  19            		ADD	HL,DE
  DEF8  0D            		DEC	C
  DEF9  C9            		RET
                      	
  DEFA                	CHKDDX:
  DEFA  CD91E0        		CALL	CHKWILDX
  DEFD  D8            		RET	C
  DEFE  FDE5          		PUSH	IY
  DF00  D1            		POP	DE
  DF01  13            		INC	DE
  DF02  2162EC        		LD	HL,DDTB
  DF05  0604          		LD	B,DDS
  DF07                	CPNAME:
  DF07  C5            		PUSH	BC
  DF08  D5            		PUSH	DE
  DF09  1105E5        		LD	DE,CPBUF
  DF0C  010400        		LD	BC,4
  DF0F  EDB0          		LDIR
  DF11  D1            		POP	DE
  DF12  D5            		PUSH	DE
  DF13  E5            		PUSH	HL
  DF14  2105E5        		LD	HL,CPBUF
  DF17  CD2ADF        		CALL	CPFILE
  DF1A  E1            		POP	HL
  DF1B  D1            		POP	DE
  DF1C  C1            		POP	BC
  DF1D  2005          		JR	NZ,CPNAME1
  DF1F  7E            		LD	A,(HL)
  DF20  23            		INC	HL
  DF21  66            		LD	H,(HL)
  DF22  6F            		LD	L,A
  DF23  C9            		RET
  DF24                	CPNAME1:
  DF24  23            		INC	HL
  DF25  23            		INC	HL
  DF26  10DF          		DJNZ	CPNAME
  DF28  37            		SCF
  DF29  C9            		RET
                      	
  DF2A                	CPFILE:
  DF2A  C5            		PUSH	BC
  DF2B  01000B        		LD	BC,00B00H
  DF2E                	CPSTR1:
  DF2E  1A            		LD	A,(DE)
  DF2F  FE3F          		CP	'?'		;Wild card
  DF31  2812          		JR	Z,CPSTR2
  DF33  7E            		LD	A,(HL)
  DF34  CD77E0        		CALL	FKANC
  DF37  E5            		PUSH	HL
  DF38  67            		LD	H,A
  DF39  1A            		LD	A,(DE)
  DF3A  CB01          		RLC	C
  DF3C  CD77E0        		CALL	FKANC
  DF3F  CB09          		RRC	C
  DF41  BC            		CP	H		;CP (HL),(DE)
  DF42  E1            		POP	HL
  DF43  2004          		JR	NZ,CPSTR3
  DF45                	CPSTR2:
  DF45  13            		INC	DE
  DF46  23            		INC	HL
  DF47  10E5          		DJNZ	CPSTR1
  DF49                	CPSTR3:
  DF49  C1            		POP	BC
  DF4A  C9            		RET
                      	
  DF4B                	CPFILE2:
  DF4B  FD7E0D        		LD	A,(IY+13)
  DF4E  F6E1          		OR	0E1H
  DF50  2F            		CPL
  DF51  A6            		AND	(HL)
  DF52  C9            		RET
                      	
  DF53                	DCPAT:
  DF53  2A7EEC        		LD	HL,(_DTBUF)
  DF56  3AA0EC        		LD	A,(_DIRF)
  DF59  B7            		OR	A
  DF5A  C8            		RET	Z
                      	
  DF5B                	CLUST:
  DF5B  EB            		EX	DE,HL
  DF5C  3E08          	CLSPAT:	LD	A,8	;DE=DE+8 (2D)  !ADDCL (Self-rewriting)
  DF5E  29            	DBLPAT:	ADD	HL,HL	;DE=DE*2 (512) !DBLCL (Self-rewriting)
  DF5F  EB            		EX	DE,HL
  DF60  83            		ADD	A,E
  DF61  5F            		LD	E,A
  DF62  8A            		ADC	A,D
  DF63  93            		SUB	E
  DF64  57            		LD	D,A
  DF65  C9            		RET
                      	
  DF66                	ENDCL:
  DF66  7A            		LD	A,D	;END CLUSTER
  DF67  FE01          	CLPAT1:	CP	1	;164=356	(Self-rewriting)
  DF69  C0            		RET	NZ
  DF6A  7B            		LD	A,E
  DF6B  FE64          	CLPAT2:	CP	064H	;		(Self-rewriting)
  DF6D  C9            		RET
                      	
  DF6E                	CAP:
  DF6E  FE61          		CP	'a'
  DF70  D8            		RET	C
  DF71  FE7B          		CP	'z'+1
  DF73  D0            		RET	NC
  DF74  D620          		SUB	020H
  DF76  C9            		RET
  DF77                	CAP2:
  DF77  CD6EDF        		CALL	CAP
  DF7A                	CAP3:
  DF7A  CD83DF        		CALL	CAP4
  DF7D  FE21          		CP	021H
  DF7F  D0            		RET	NC
  DF80  3EA0          		LD	A,0A0H
  DF82  C9            		RET
  DF83                	CAP4:
  DF83  FE05          		CP	5
  DF85  C0            		RET	NZ
  DF86  3EE5          		LD	A,0E5H
  DF88  C9            		RET
                      	
  DF89                	CHDIR:
  DF89  CD98E8        		CALL	GETDPBD
  DF8C  3806          		JR	C,CHDIR2
  DF8E  DD751A        		LD	(IX+01AH),L		;_SDIR_
  DF91  DD741B        		LD	(IX+01BH),H		;_SDIR_+1
  DF94                	CHDIR2:
  DF94  DDE1          		POP	IX
  DF96  C9            		RET
                      	
  DF97                	LDDIR:
  DF97  CD98E8        		CALL	GETDPBD
  DF9A  DD5E1A        		LD	E,(IX+01AH)		;_SDIR_
  DF9D  DD561B        		LD	D,(IX+01BH)		;_SDIR_+1
  DFA0  13            		INC	DE
  DFA1  FD730E        		LD	(IY+14),E
  DFA4  FD720F        		LD	(IY+15),D
  DFA7  1B            		DEC	DE
  DFA8  18EA          		JR	CHDIR2
                      	
  DFAA                	LDDIRX:
  DFAA  FD5E0E        		LD	E,(IY+14)
  DFAD  FD560F        		LD	D,(IY+15)
  DFB0  1B            		DEC	DE
  DFB1  CD66DF        		CALL	ENDCL
  DFB4  D497DF        		CALL	NC,LDDIR
  DFB7                	LDDIRS:
  DFB7  7A            		LD	A,D
  DFB8  B3            		OR	E
  DFB9  32A0EC        		LD	(_DIRF),A
  DFBC  C9            		RET
                      	
  DFBD                	KILL:
  DFBD  CD91E0        		CALL	CHKWILDX
  DFC0  3838          		JR	C,KILLW
  DFC2  CDFADE        		CALL	CHKDDX
  DFC5  3F            		CCF
  DFC6  D498DD        		CALL	NC,SOPENX1
  DFC9                	KILLS:
  DFC9  D40DE0        		CALL	NC,CHKATT
  DFCC  D8            		RET	C
  DFCD                	KILLSX:
  DFCD  36E5          		LD	(HL),0E5H	;DIR
  DFCF  CD6BE0        		CALL	WTDB
  DFD2  111A00        		LD	DE,01AH
  DFD5  19            		ADD	HL,DE
  DFD6  5E            		LD	E,(HL)
  DFD7  23            		INC	HL
  DFD8  56            		LD	D,(HL)
  DFD9  1804          		JR	KILLS2
  DFDB                	KILLS1:
  DFDB  ED5B5DE2      		LD	DE,(_CLPS)	;FAT
  DFDF                	KILLS2:
  DFDF  CD66DF        		CALL	ENDCL
  DFE2  D0            		RET	NC		;CF=0
  DFE3  21FEFF        		LD	HL,0-2
  DFE6  19            		ADD	HL,DE
  DFE7  D0            		RET	NC		;DE= 0 or 1
  DFE8  D5            		PUSH	DE
  DFE9  CDF7EC        		CALL	_GNCL
  DFEC  ED535DE2      		LD	(_CLPS),DE
  DFF0  D1            		POP	DE
  DFF1  210000        		LD	HL,0
  DFF4  D4FAEC        		CALL	NC,_SNCL
  DFF7  30E2          		JR	NC,KILLS1
  DFF9  C9            		RET
                      	
  DFFA                	KILLW:
  DFFA  CDC5DD        		CALL	SOPEN
  DFFD                	KILLW1:
  DFFD  380B          		JR	C,KILLW2
  DFFF  CD6EDE        		CALL	SOPENE2
  E002  CDC9DF        		CALL	KILLS
  E005  CD2ADE        		CALL	NOPEN
  E008  18F3          		JR	KILLW1
  E00A                	KILLW2:
  E00A  C8            		RET	Z
  E00B  3F            		CCF
  E00C  C9            		RET
                      	
  E00D                	CHKATT:
  E00D  E5            		PUSH	HL
  E00E  110B00        		LD	DE,00BH
  E011  19            		ADD	HL,DE
  E012  7E            		LD	A,(HL)
  E013  E1            		POP	HL
  E014  E61F          		AND	01FH
  E016  C8            		RET	Z
  E017  37            		SCF
  E018  C9            		RET
                      	
  E019                	NAME:
  E019  CD91E0        		CALL	CHKWILDX
  E01C  D8            		RET	C
  E01D  110400        		LD	DE,4
  E020  19            		ADD	HL,DE
  E021  2237E0        		LD	(NAMEP+2),HL
  E024  23            		INC	HL
  E025  CD95E0        		CALL	CHKWILD
  E028  D8            		RET	C
                      	
  E029  CD98DD        		CALL	SOPENX1
  E02C  D40DE0        		CALL	NC,CHKATT
  E02F  D8            		RET	C
                      	
  E030  FD7E00        		LD	A,(IY+0)
  E033  FDE5          		PUSH	IY
  E035  FD210000      	NAMEP:	LD	IY,0
  E039  FD7700        		LD	(IY+0),A
  E03C  CD98DD        		CALL	SOPENX1
  E03F  FDE3          		EX	(SP),IY
  E041  3F            		CCF
  E042  D4C5DD        		CALL	NC,SOPEN
  E045  EB            		EX	DE,HL
  E046  E1            		POP	HL
  E047  D8            		RET	C
                      	
  E048                	SETNAME:
  E048  01000B        		LD	BC,11*256
  E04B  23            		INC	HL
  E04C  7E            		LD	A,(HL)
  E04D  FEE5          		CP	0E5H
  E04F  2004          		JR	NZ,SNAME1
  E051  3E05          		LD	A,5
  E053  180E          		JR	SNAME3
  E055                	SNAME1:
  E055  7E            		LD	A,(HL)
  E056  0C            		INC	C
  E057  0D            		DEC	C
  E058  2009          		JR	NZ,SNAME3
  E05A  CD6EDF        		CALL	CAP
  E05D  FEA0          		CP	0A0H
  E05F  2002          		JR	NZ,SNAME3
  E061  3E20          		LD	A,020H
  E063                	SNAME3:
  E063  12            		LD	(DE),A
  E064  7E            		LD	A,(HL)
  E065  23            		INC	HL
  E066  CD7EE0        		CALL	FKAN
  E069  10EA          		DJNZ	SNAME1
  E06B                	WTDB:
  E06B  3EFF          		LD	A,0FFH
  E06D  3235E2        		LD	(SFILE),A
  E070                	SWTDBF:
  E070  3E01          		LD	A,1
  E072  32A4EC        		LD	(_WTDBF),A
  E075  AF            		XOR	A
  E076  C9            		RET
                      	
  E077                	FKANC:
  E077  CB41          		BIT	0,C
  E079  CC77DF        		CALL	Z,CAP2
  E07C  1801          		JR	FKANX
  E07E                	FKAN:
  E07E  13            		INC	DE
  E07F                	FKANX:
  E07F  CB41          		BIT	0,C
  E081  CB81          		RES	0,C
  E083  C0            		RET	NZ
  E084  FE80          		CP	080H
  E086  D8            		RET	C
  E087  FEA0          		CP	0A0H
  E089  3803          		JR	C,FKAN1
  E08B  FEE0          		CP	0E0H
  E08D  D8            		RET	C
  E08E                	FKAN1:
  E08E  0C            		INC	C
  E08F  A7            		AND	A
  E090  C9            		RET
                      	
  E091                	CHKWILDX:
  E091  FDE5          		PUSH	IY
  E093  E1            		POP	HL
  E094  23            		INC	HL
  E095                	CHKWILD:
  E095  060B          		LD	B,11
  E097  3E3F          		LD	A,'?'
  E099                	CHKWIL1:
  E099  BE            		CP	(HL)
  E09A  23            		INC	HL
  E09B  37            		SCF
  E09C  C8            		RET	Z
  E09D  10FA          		DJNZ	CHKWIL1
  E09F  AF            		XOR	A
  E0A0  C9            		RET
                      	
  E0A1                	SDIRENT:		;IY=FCB HL=DIR
  E0A1  D5            		PUSH	DE
  E0A2  E5            		PUSH	HL
  E0A3  FDE5          		PUSH	IY
  E0A5  D1            		POP	DE
  E0A6  EB            		EX	DE,HL
  E0A7  CD48E0        		CALL	SETNAME
                      	;				Attribute
  E0AA  FD7E0D        		LD	A,(IY+13)
  E0AD  12            		LD	(DE),A
  E0AE  13            		INC	DE
                      	;				Reserved
  E0AF  AF            		XOR	A
  E0B0  060A          		LD	B,10
  E0B2                	SDE1:
  E0B2  12            		LD	(DE),A
  E0B3  13            		INC	DE
  E0B4  10FC          		DJNZ	SDE1
                      	;				TIME
  E0B6  FD7E16        		LD	A,(IY+22)
  E0B9  12            		LD	(DE),A
  E0BA  13            		INC	DE
  E0BB  FD7E17        		LD	A,(IY+23)
  E0BE  12            		LD	(DE),A
  E0BF  13            		INC	DE
                      	;				DATE
  E0C0  FD7E14        		LD	A,(IY+20)
  E0C3  12            		LD	(DE),A
  E0C4  13            		INC	DE
  E0C5  FD7E15        		LD	A,(IY+21)
  E0C8  12            		LD	(DE),A
  E0C9  13            		INC	DE
                      	;				First cluster
  E0CA  FD7E1A        		LD	A,(IY+26)
  E0CD  12            		LD	(DE),A
  E0CE  13            		INC	DE
  E0CF  FD7E1B        		LD	A,(IY+27)
  E0D2  12            		LD	(DE),A
  E0D3  13            		INC	DE
                      	;				SIZE
  E0D4  FD7E10        		LD	A,(IY+16)
  E0D7  12            		LD	(DE),A
  E0D8  13            		INC	DE
  E0D9  FD7E11        		LD	A,(IY+17)
  E0DC  12            		LD	(DE),A
  E0DD  13            		INC	DE
  E0DE  FD7E12        		LD	A,(IY+18)
  E0E1  12            		LD	(DE),A
  E0E2  13            		INC	DE
  E0E3  FD7E13        		LD	A,(IY+19)
  E0E6  12            		LD	(DE),A
                      	
  E0E7  AF            		XOR	A
  E0E8  E1            		POP	HL
  E0E9  D1            		POP	DE
  E0EA  C9            		RET
                      	
  E0EB                	WOPEN:
  E0EB  FD7E0D        		LD	A,(IY+13)
  E0EE  E61F          		AND	01FH
  E0F0  37            		SCF
  E0F1  C0            		RET	NZ
  E0F2  FD361CFE      		LD	(IY+28),0FEH	;Open
  E0F6                	TOPEN2:
  E0F6  AF            		XOR	A
  E0F7                	TOPEN:
  E0F7  FD3617FF      		LD	(IY+23),0FFH	;Initializes the time stamp
  E0FB  C9            		RET
                      	
  E0FC                	WRDFX:
  E0FC  41            		LD	B,C
  E0FD  04            		INC	B
  E0FE  3E37          		LD	A,037H
  E100  3229E5        		LD	(DRDN1),A
                      	
  E103                	WRDF:
  E103  110200        		LD	DE,2
  E106                	WRDF1:
  E106  C5            		PUSH	BC
  E107  D5            		PUSH	DE
  E108  CDF7EC        		CALL	_GNCL
  E10B  381C          		JR	C,WRDF3
  E10D  7A            		LD	A,D
  E10E  B3            		OR	E
  E10F  2027          		JR	NZ,WRDF4
  E111  E1            		POP	HL
  E112  E5            		PUSH	HL
  E113  ED5B5DE2      		LD	DE,(_CLPS)
  E117  225DE2        		LD	(_CLPS),HL
  E11A  7A            		LD	A,D
  E11B  B3            		OR	E
  E11C  2008          		JR	NZ,WRDF2
  E11E  FD751A        		LD	(IY+26),L	;Start cluster
  E121  FD741B        		LD	(IY+27),H
  E124  1803          		JR	WRDF3
  E126                	WRDF2:
  E126  CDFAEC        		CALL	_SNCL
  E129                	WRDF3:
  E129  D1            		POP	DE
  E12A  C1            		POP	BC
  E12B  D8            		RET	C
  E12C  100C          		DJNZ	WRDF5
  E12E  ED5B5DE2      		LD	DE,(_CLPS)
  E132  21FFFF        		LD	HL,0FFFFH
  E135  C3FAEC        		JP	_SNCL
                      	
  E138                	WRDF4:
  E138  D1            		POP	DE
  E139  C1            		POP	BC
  E13A                	WRDF5:
  E13A  13            		INC	DE
  E13B  CD66DF        		CALL	ENDCL
  E13E  38C6          		JR	C,WRDF1
  E140  37            		SCF
  E141  C9            		RET
                      	
  E142                	RWXR:
  E142  CB38          		SRL	B
  E144  CB19          		RR	C
  E146  CB38          	IBM4:	SRL	B	;自己書き換え 1024=SRL B / 512=JR +2(直後のRR Cを飛ばす)
  E148  CB19          		RR	C
                      	
  E14A  FD5E1A        		LD	E,(IY+26)	;Cluster
  E14D  FD561B        		LD	D,(IY+27)
  E150                	RWX1:
  E150  ED535DE2      		LD	(_CLPS),DE
  E154  7A            		LD	A,D
  E155  B3            		OR	E
  E156  37            		SCF
  E157  C8            		RET	Z
                      	
  E158  78            		LD	A,B
  E159  B1            		OR	C
  E15A  C8            		RET	Z
                      	
  E15B  CDF7EC        		CALL	_GNCL
  E15E  D8            		RET	C
  E15F  0B            		DEC	BC
  E160  CD66DF        		CALL	ENDCL
  E163  38EB          		JR	C,RWX1
  E165  37            		SCF
  E166  C9            		RET
                      	
  E167                	DSKF:
  E167  110000        	MAXCLP:	LD	DE,0
  E16A  210000        		LD	HL,0
  E16D                	DSKF1:
  E16D  D5            		PUSH	DE
  E16E  CDF7EC        		CALL	_GNCL
  E171  380C          		JR	C,POPSCF
  E173  7A            		LD	A,D
  E174  B3            		OR	E
  E175  2001          		JR	NZ,DSKF2
  E177  23            		INC	HL
  E178                	DSKF2:
  E178  D1            		POP	DE
  E179  1B            		DEC	DE
  E17A  7A            		LD	A,D
  E17B  B3            		OR	E
  E17C  20EF          		JR	NZ,DSKF1
  E17E  C9            		RET
                      	
  E17F                	POPSCF:
  E17F  F1            		POP	AF
  E180  37            		SCF
  E181  C9            		RET
                      	
  E182                	SETTMS:
  E182  FD7E17        		LD	A,(IY+23)
  E185  3C            		INC	A
  E186  C0            		RET	NZ
  E187                	SETTMSX:
  E187  CDE1D7        		CALL	_SYS2C
                      	
  E18A  CB25          		SLA	L
  E18C  CB25          		SLA	L
  E18E  29            		ADD	HL,HL
  E18F  29            		ADD	HL,HL
  E190  29            		ADD	HL,HL
  E191  7A            		LD	A,D
  E192  0F            		RRCA
  E193  E61F          		AND	01FH
  E195  B5            		OR	L
  E196  6F            		LD	L,A
  E197  FD7516        		LD	(IY+22),L
  E19A  FD7417        		LD	(IY+23),H
                      	
  E19D  CDA7D7        		CALL	_SYS2A
                      	
  E1A0  0144F8        		LD	BC,0-1980
  E1A3  09            		ADD	HL,BC
  E1A4  65            		LD	H,L
                      	
  E1A5  7A            		LD	A,D
  E1A6  87            		ADD	A,A
  E1A7  87            		ADD	A,A
  E1A8  87            		ADD	A,A
  E1A9  87            		ADD	A,A
  E1AA  6F            		LD	L,A
  E1AB  29            		ADD	HL,HL
  E1AC  7D            		LD	A,L
  E1AD  B3            		OR	E
  E1AE  6F            		LD	L,A
  E1AF  FD7514        		LD	(IY+20),L
  E1B2  FD7415        		LD	(IY+21),H
  E1B5  C9            		RET
                      	
  E1B6                	PUSHRR:
  E1B6  CDBCE1        		CALL	SUBRR
  E1B9                	POPRR1:
  E1B9  EDB0          		LDIR
  E1BB  C9            		RET
                      	
  E1BC                	SUBRR:
  E1BC  FDE5          		PUSH	IY
  E1BE  E1            		POP	HL
  E1BF  112100        		LD	DE,33
  E1C2  19            		ADD	HL,DE
  E1C3  1156E2        		LD	DE,HLBUF
  E1C6  010300        		LD	BC,3
  E1C9  C9            		RET
                      	
  E1CA                	SETSEQ:
  E1CA  F5            		PUSH	AF
  E1CB  FD7E21        		LD	A,(IY+33)
  E1CE  FD6E22        		LD	L,(IY+34)
  E1D1  FD6623        		LD	H,(IY+35)
                      	
  E1D4  CDF0E1        		CALL	SSQ1
                      	
  E1D7  29            		ADD	HL,HL
  E1D8  CB3D          		SRL	L
  E1DA  FD7520        		LD	(IY+32),L
  E1DD  FD740C        		LD	(IY+12),H
  E1E0  F1            		POP	AF
                      	
  E1E1                	POPRR:
  E1E1  CDBCE1        		CALL	SUBRR
  E1E4  EB            		EX	DE,HL
  E1E5  18D2          		JR	POPRR1
                      	
  E1E7                	GETSIZE:
  E1E7  FD7E10        		LD	A,(IY+16)
  E1EA  FD6E11        		LD	L,(IY+17)
  E1ED  FD6612        		LD	H,(IY+18)
  E1F0                	SSQ1:
  E1F0  87            		ADD	A,A
  E1F1  ED6A          		ADC	HL,HL
  E1F3  B7            		OR	A
  E1F4  C8            		RET	Z
  E1F5  23            		INC	HL
  E1F6  C9            		RET
                      	
  E1F7                	GETSEQ:
  E1F7  FD6E20        		LD	L,(IY+32)
  E1FA  FD660C        		LD	H,(IY+12)
                      	
  E1FD  CB25          		SLA	L
                      	
  E1FF  CB3C          		SRL	H
  E201  CB1D          		RR	L
  E203  C9            		RET
                      	
  E204                	SETRBR:
  E204  AF            		XOR	A	;HLA = HL*128
  E205  CB3C          		SRL	H
  E207  CB1D          		RR	L
  E209  1F            		RRA
  E20A  FD7721        		LD	(IY+33),A
  E20D  FD7522        		LD	(IY+34),L
  E210  FD7423        		LD	(IY+35),H
  E213  218000        		LD	HL,128
  E216  C9            		RET
                      	
  E217                	K_DE26:
  E217  ED5B4CEC      		LD	DE,(STABLE+2*026H)
  E21B  1804          		JR	K_DE1
  E21D                	K_DE27:
  E21D  ED5B4EEC      		LD	DE,(STABLE+2*027H)
  E221                	K_DE1:
  E221  CD29E2        		CALL	K_DE
                      	;	EX	DE,IY
  E224  D5            		PUSH	DE
  E225  FDE3          		EX	(SP),IY
  E227  D1            		POP	DE
                      	;
  E228  C9            		RET
  E229                	K_DE:
                      	;	EX	DE,IY
  E229  D5            		PUSH	DE
  E22A  FDE3          		EX	(SP),IY
  E22C  D1            		POP	DE
  E22D  FDE9          		JP	(IY)
                      	
  E22F                	SCDIR:	DS	2		;+14 +15
  E231                	SFBPS:	DS	2		;FBPS
  E233                	SFNDF:	DS	2		;FILEN DIRF
  E235                	SFILE:	DS	33		;DRV FILENAME
  E256                	HLBUF:	DS	3		;Random record buffer
                      	
  E259  0000          	_FATPS:	DW	0
  E25B  0000          	_DIRPS:	DW	0
  E25D  0000          	_CLPS:	DW	0
                      	
                      	;LDFILE2.ASM
                      	
                      	;	LSX-Dodgers FILE2
                      	
  E25F                	RBWDD:
  E25F  E5            		PUSH	HL
  E260  C1            		POP	BC
  E261  2139E3        		LD	HL,NUL
  E264  CD6DE3        		CALL	DDX
  E267  2003          		JR	NZ,RBWDD2
  E269  2A08EC        		LD	HL,(STABLE+2*4)
  E26C                	RBWDD2:
  E26C  FE43          		CP	'C'
  E26E  2003          		JR	NZ,RBWDD3
  E270  21D3D9        		LD	HL,PRINTS
  E273                	RBWDD3:
  E273  FE50          		CP	'P'
  E275  2003          		JR	NZ,RBWDD4
  E277  2A0AEC        		LD	HL,(STABLE+2*5)
  E27A                	RBWDD4:
  E27A  2288E2        		LD	(RBWDDP+1),HL
  E27D  2A8AEC        		LD	HL,(_DTA)
  E280                	RBWDD1:
  E280  78            		LD	A,B
  E281  B1            		OR	C
  E282                	RBWDD5:
  E282  CA34E3        		JP	Z,RBW1
  E285  5E            		LD	E,(HL)
  E286  23            		INC	HL
  E287  CDB7D6        	RBWDDP:	CALL	_SYS02
  E28A  DA50E3        		JP	C,RBRERR
  E28D  3E1A          		LD	A,01AH
  E28F  BB            		CP	E
  E290  28F0          		JR	Z,RBWDD5
  E292  0B            		DEC	BC
  E293  18EB          		JR	RBWDD1
                      	
                      					;Write random block
  E295                	_SYS26:
  E295  AF            		XOR	A
  E296  3229E5        		LD	(DRDN1),A
  E299  22E3E4        		LD	(LEFT+1),HL	;Write record byte
  E29C  2205E5        		LD	(LEFTX),HL
  E29F  CD6FDD        		CALL	SETDRV
                      	
  E2A2  CD57E4        		CALL	RBX0
  E2A5  DA3BE3        		JP	C,RBWERR
  E2A8  28B5          		JR	Z,RBWDD
  E2AA  CDEBE0        		CALL	WOPEN
  E2AD  DA3BE3        		JP	C,RBWERR
  E2B0  7C            		LD	A,H
  E2B1  B5            		OR	L
  E2B2  CA34E3        		JP	Z,RBW1
                      	
  E2B5  2B            		DEC	HL
                      	
  E2B6  CDFBE4        		CALL	CDERR		;CDE=Random record
                      	
  E2B9  AF            		XOR	A
  E2BA  19            		ADD	HL,DE
  E2BB  89            		ADC	A,C
  E2BC  47            		LD	B,A
  E2BD  4C            		LD	C,H
  E2BE  CD42E1        		CALL	RWXR
  E2C1  DCFCE0        		CALL	C,WRDFX
  E2C4  DA3BE3        		JP	C,RBWERR
                      	
  E2C7  CD80E4        		CALL	RBX2
  E2CA  281A          		JR	Z,RBWB
  E2CC  CD93E4        		CALL	RBXA
  E2CF  386A          		JR	C,RBWERR
  E2D1  EB            		EX	DE,HL
  E2D2  C5            		PUSH	BC
  E2D3  EDB0          		LDIR
  E2D5  2207E5        		LD	(DTAX),HL
                      	
  E2D8  CD70E0        		CALL	SWTDBF
                      	
  E2DB  2A05E5        		LD	HL,(LEFTX)
  E2DE  D1            		POP	DE
  E2DF  ED52          		SBC	HL,DE
  E2E1  2205E5        		LD	(LEFTX),HL
  E2E4  282E          		JR	Z,RBWEND
                      	
  E2E6                	RBWB:
  E2E6  CDC7E4        		CALL	RBXB
  E2E9  2813          		JR	Z,RBWC
  E2EB                	RBWB1:
  E2EB  C5            		PUSH	BC
  E2EC  D5            		PUSH	DE
  E2ED  CD5BDF        		CALL	CLUST
  E2F0  CD33E7        		CALL	DWTC
  E2F3  D1            		POP	DE
  E2F4  C1            		POP	BC
  E2F5  3844          		JR	C,RBWERR
  E2F7  CDF7EC        		CALL	_GNCL
  E2FA  383F          		JR	C,RBWERR
  E2FC  10ED          		DJNZ	RBWB1
  E2FE                	RBWC:
  E2FE  CDD7E4        		CALL	RBXC
  E301  2811          		JR	Z,RBWEND
                      	
  E303  CD5BDF        		CALL	CLUST
  E306  CD28E5        		CALL	DRDN
  E309  3830          		JR	C,RBWERR
  E30B  ED5B7EEC      		LD	DE,(_DTBUF)
  E30F  EDB0          		LDIR
  E311  CD70E0        		CALL	SWTDBF
  E314                	RBWEND:
  E314  CDE2E4        		CALL	RBXEND
                      	
  E317  CD66E4        		CALL	RBX1
  E31A  3018          		JR	NC,RBW1
  E31C  2AE3E4        		LD	HL,(LEFT+1)
  E31F  FD5E10        		LD	E,(IY+16)	;CDE=File size
  E322  FD5611        		LD	D,(IY+17)
  E325  FD4E12        		LD	C,(IY+18)
  E328  AF            		XOR	A
  E329  19            		ADD	HL,DE
  E32A  89            		ADC	A,C
  E32B  FD7510        		LD	(IY+16),L
  E32E  FD7411        		LD	(IY+17),H
  E331  FD7712        		LD	(IY+18),A
  E334                	RBW1:
  E334  FDE1          		POP	IY
  E336  C1            		POP	BC
  E337  D1            		POP	DE
  E338  E1            		POP	HL
  E339                	NUL:
  E339  AF            		XOR	A
  E33A  C9            		RET
                      	
  E33B                	RBWERR:
  E33B  FDE5          		PUSH	IY
  E33D  D1            		POP	DE
  E33E  2A20EC        		LD	HL,(STABLE+2*010H)
  E341  CD0F00        		CALL	K_HL
  E344                	RBRERR1:
  E344  3E01          		LD	A,001H
  E346                	RBRERR2:
  E346  FDE1          		POP	IY
  E348  C1            		POP	BC
  E349  D1            		POP	DE
  E34A  E1            		POP	HL
  E34B  37            		SCF
  E34C  210000        		LD	HL,0
  E34F  C9            		RET
                      	
  E350                	RBRERR:
  E350  3EFF          		LD	A,0FFH
  E352  18F2          		JR	RBRERR2
                      	
  E354                	RBRFL:
  E354  3E00          	RBRFLP:	LD	A,000H
  E356  FE0D          		CP	00DH
  E358  2005          		JR	NZ,RBRFL1
  E35A  D5            		PUSH	DE
  E35B  1E0A          		LD	E,00AH
  E35D  1805          		JR	RBRFL2
  E35F                	RBRFL1:
  E35F  D5            		PUSH	DE
  E360  CDFED9        		CALL	_SYS07
  E363  5F            		LD	E,A
  E364                	RBRFL2:
  E364  CDCDEC        		CALL	_PRINT
  E367  7B            		LD	A,E
  E368  D1            		POP	DE
  E369  3255E3        		LD	(RBRFLP+1),A
  E36C  C9            		RET
  E36D                	DDX:
  E36D  FD7E01        		LD	A,(IY+1)
  E370  CD6EDF        		CALL	CAP
  E373  FE41          		CP	'A'
  E375  C9            		RET
                      	
  E376                	RBRDD:
  E376  E5            		PUSH	HL
  E377  C1            		POP	BC
  E378  2154E3        		LD	HL,RBRFL
  E37B  CD6DE3        		CALL	DDX
  E37E  2005          		JR	NZ,RBRDD2
  E380  2A06EC        		LD	HL,(STABLE+2*3)
  E383  1804          		JR	RBRDD3
  E385                	RBRDD2:
  E385  FE43          		CP	'C'
  E387  202C          		JR	NZ,RBRDERR
  E389                	RBRDD3:
  E389  2299E3        		LD	(RBRDDP+1),HL
                      	
  E38C  ED5B8AEC      		LD	DE,(_DTA)
  E390  210000        		LD	HL,0
  E393                	RBRDD1:
  E393  78            		LD	A,B
  E394  B1            		OR	C
  E395  2818          		JR	Z,RBRDDE1
  E397  23            		INC	HL
  E398  CD54E3        	RBRDDP:	CALL	RBRFL
  E39B  380D          		JR	C,RBRDDE
  E39D  FE1A          		CP	01AH
  E39F  2809          		JR	Z,RBRDDE
  E3A1  FE03          		CP	3
  E3A3  2805          		JR	Z,RBRDDE
  E3A5  12            		LD	(DE),A
  E3A6  13            		INC	DE
  E3A7  0B            		DEC	BC
  E3A8  18E9          		JR	RBRDD1
                      	
  E3AA                	RBRDDE:
  E3AA  3E1A          		LD	A,01AH
  E3AC  12            		LD	(DE),A
  E3AD                	RBRDDE2:
  E3AD  AF            		XOR	A
  E3AE  3C            		INC	A
  E3AF                	RBRDDE1:
  E3AF  3243E4        		LD	(RBRAP+1),A
  E3B2  C33CE4        		JP	RBREND0
  E3B5                	RBRDERR:
  E3B5  210000        		LD	HL,0
  E3B8  18F3          		JR	RBRDDE2
                      	
                      					;Read random block
  E3BA                	_SYS27:
  E3BA  2205E5        		LD	(LEFTX),HL
  E3BD  CD6FDD        		CALL	SETDRV
                      	
  E3C0  FDCB0D66      		BIT	4,(IY+13)
  E3C4  C245E4        		JP	NZ,RBRDIR
  E3C7  CD57E4        		CALL	RBX0
  E3CA  DA50E3        		JP	C,RBRERR
  E3CD  28A7          		JR	Z,RBRDD
  E3CF  CD66E4        		CALL	RBX1
  E3D2  DA44E3        		JP	C,RBRERR1
  E3D5  79            		LD	A,C
  E3D6  EB            		EX	DE,HL
  E3D7  ED52          		SBC	HL,DE		;CP 0HL,CDE
  E3D9  19            		ADD	HL,DE
  E3DA  DE00          		SBC	A,000H
  E3DC  3801          		JR	C,RBR1
  E3DE  EB            		EX	DE,HL
  E3DF                	RBR1:
  E3DF  9F            		SBC	A,A
  E3E0  E601          		AND	1
  E3E2  3243E4        		LD	(RBRAP+1),A
                      	
  E3E5  7C            		LD	A,H
  E3E6  B5            		OR	L
  E3E7  CA3CE4        		JP	Z,RBREND0
                      	
  E3EA  22E3E4        		LD	(LEFT+1),HL	;Read record byte
  E3ED  2205E5        		LD	(LEFTX),HL
                      	
  E3F0  CD80E4        		CALL	RBX2
  E3F3  2819          		JR	Z,RBRB
  E3F5  CD93E4        		CALL	RBXA
  E3F8  DA50E3        		JP	C,RBRERR
  E3FB  C5            		PUSH	BC
  E3FC  EDB0          		LDIR
  E3FE  ED5307E5      		LD	(DTAX),DE
  E402  2A05E5        		LD	HL,(LEFTX)
  E405  D1            		POP	DE
  E406  A7            		AND	A
  E407  ED52          		SBC	HL,DE
  E409  2205E5        		LD	(LEFTX),HL
  E40C  282B          		JR	Z,RBREND
                      	
  E40E                	RBRB:
  E40E  CDC7E4        		CALL	RBXB
  E411  2812          		JR	Z,RBRC
  E413                	RBRB1:
  E413  C5            		PUSH	BC
  E414  D5            		PUSH	DE
  E415  CD5BDF        		CALL	CLUST
  E418  CD27E7        		CALL	DRDC
  E41B  D1            		POP	DE
  E41C  C1            		POP	BC
  E41D  D4F7EC        		CALL	NC,_GNCL
  E420  DA50E3        		JP	C,RBRERR
  E423  10EE          		DJNZ	RBRB1
  E425                	RBRC:
  E425  CDD7E4        		CALL	RBXC
  E428  280F          		JR	Z,RBREND
                      	
  E42A  CD5BDF        		CALL	CLUST
  E42D  CD10E5        		CALL	DRDX
  E430  DA50E3        		JP	C,RBRERR
  E433  EB            		EX	DE,HL
  E434  2A7EEC        		LD	HL,(_DTBUF)
  E437  EDB0          		LDIR
  E439                	RBREND:
  E439  CDE2E4        		CALL	RBXEND
  E43C                	RBREND0:
  E43C  FDE1          		POP	IY
  E43E  C1            		POP	BC
  E43F  D1            		POP	DE
  E440  F1            		POP	AF	;(HL)
  E441  AF            		XOR	A
  E442  3E00          	RBRAP:	LD	A,000H
  E444  C9            		RET
                      	
  E445                	RBRDIR:
  E445  FD6E1A        		LD	L,(IY+26)
  E448  FD661B        		LD	H,(IY+27)
  E44B  CD89DF        		CALL	CHDIR
  E44E  AF            		XOR	A
  E44F  67            		LD	H,A
  E450  6F            		LD	L,A
  E451  3C            		INC	A
  E452  3243E4        		LD	(RBRAP+1),A
  E455  18E5          		JR	RBREND0
                      	
  E457                	RBX0:
  E457  2A8AEC        		LD	HL,(_DTA)
  E45A  2207E5        		LD	(DTAX),HL
  E45D  2A05E5        		LD	HL,(LEFTX)
  E460  FD7E1C        		LD	A,(IY+28)	;Open
  E463  D6FD          		SUB	0FDH
  E465  C9            		RET
                      	
  E466                	RBX1:
  E466  E5            		PUSH	HL		;Record byte
                      	
  E467  FD6E10        		LD	L,(IY+16)	;AHL=File size
  E46A  FD6611        		LD	H,(IY+17)
  E46D  FD7E12        		LD	A,(IY+18)
                      	
  E470  CDFBE4        		CALL	CDERR		;CDE=Random record
                      	
  E473  A7            		AND	A
  E474  ED52          		SBC	HL,DE
  E476  99            		SBC	A,C
  E477  D1            		POP	DE
                      	
  E478  D8            		RET	C
  E479  4F            		LD	C,A
  E47A  EB            		EX	DE,HL	;CDE=File byte	HL=Record byte
  E47B  B2            		OR	D
  E47C  B3            		OR	E
  E47D  C0            		RET	NZ
  E47E  37            		SCF
  E47F  C9            		RET
                      	
  E480                	RBX2:
  E480  FD4E22        		LD	C,(IY+34)	;Cluster settings
  E483  FD4623        		LD	B,(IY+35)
  E486  CD42E1        		CALL	RWXR
  E489  3AA8E4        		LD	A,(IBM5+1)	;1024=3 / 512=1
  E48C  FDA622        		AND	(IY+34)
  E48F  FDB621        		OR	(IY+33)
  E492  C9            		RET
                      	
  E493                	RBXA:
  E493  D5            		PUSH	DE
  E494  CD5BDF        		CALL	CLUST
  E497  CD10E5        		CALL	DRDX
  E49A  D1            		POP	DE
  E49B  D8            		RET	C
  E49C  CDF7EC        		CALL	_GNCL
  E49F  D8            		RET	C
  E4A0  ED535DE2      		LD	(_CLPS),DE
                      	
  E4A4  FD4E21        		LD	C,(IY+33)
  E4A7  3E03          	IBM5:	LD	A,3		;自己書き換え 1024=3 / 512=1
  E4A9  FDA622        		AND	(IY+34)
  E4AC  47            		LD	B,A
  E4AD  210004        	IBM7:	LD	HL,1024		;自己書き換え 1024=0400H / 512=0200H ここに1クラスタのサイズが格納される
  E4B0  ED42          		SBC	HL,BC		;remaining cluster
                      	
  E4B2  ED5B05E5      		LD	DE,(LEFTX)
  E4B6  ED52          		SBC	HL,DE		;CP HL,DE
  E4B8  19            		ADD	HL,DE
  E4B9  3801          		JR	C,RBXA1
  E4BB  EB            		EX	DE,HL
  E4BC                	RBXA1:
  E4BC  E5            		PUSH	HL
  E4BD  2A7EEC        		LD	HL,(_DTBUF)
  E4C0  09            		ADD	HL,BC
  E4C1  ED5B07E5      		LD	DE,(DTAX)
  E4C5  C1            		POP	BC
  E4C6  C9            		RET
                      	
  E4C7                	RBXB:
  E4C7  2A07E5        		LD	HL,(DTAX)
  E4CA  ED5B5DE2      		LD	DE,(_CLPS)
  E4CE  3A06E5        		LD	A,(LEFTX+1)
  E4D1  CB3F          		SRL	A
  E4D3  CB3F          	IBM8:	SRL	A		;自己書き換え 1024=SRL A / 512=NOP NOP
  E4D5  47            		LD	B,A
  E4D6  C9            		RET
                      	
  E4D7                	RBXC:
  E4D7  ED4B05E5      		LD	BC,(LEFTX)
  E4DB  3AA8E4        		LD	A,(IBM5+1)	;1024=3 / 512=1
  E4DE  A0            		AND	B
  E4DF  47            		LD	B,A
  E4E0  B1            		OR	C
  E4E1  C9            		RET
                      	
  E4E2                	RBXEND:
  E4E2  110000        	LEFT:	LD	DE,0
  E4E5  AF            		XOR	A
  E4E6  FD6E21        		LD	L,(IY+33)
  E4E9  FD6622        		LD	H,(IY+34)
  E4EC  19            		ADD	HL,DE
  E4ED  FD8E23        		ADC	A,(IY+35)
  E4F0  FD7521        		LD	(IY+33),L
  E4F3  FD7422        		LD	(IY+34),H
  E4F6  FD7723        		LD	(IY+35),A
  E4F9  EB            		EX	DE,HL		;HL=Read byte
  E4FA  C9            		RET
                      	
  E4FB                	CDERR:
  E4FB  FD5E21        		LD	E,(IY+33)	;CDE=Random record
  E4FE  FD5622        		LD	D,(IY+34)
  E501  FD4E23        		LD	C,(IY+35)
  E504  C9            		RET
                      	
  E505                	CPBUF:
  E505  0000          	LEFTX:	DW	0
  E507  0000          	DTAX:	DW	0
  E509  20            		DB	020H	;DS 7,20h
  E50A  20            		DB	020H
  E50B  20            		DB	020H
  E50C  20            		DB	020H
  E50D  20            		DB	020H
  E50E  20            		DB	020H
  E50F  20            		DB	020H
                      	;
                      	;LDDIO.ASM
                      	
                      	;	LSX-Dodgers DIO
                      	
  E510                	DRDX:
  E510  CD46E5        		CALL	DRDY
  E513  C8            		RET	Z
  E514  CD30E5        		CALL	DRDX1
  E517  D8            		RET	C
  E518  E5            		PUSH	HL
  E519  C5            		PUSH	BC
  E51A  D5            		PUSH	DE
  E51B  2A7EEC        		LD	HL,(_DTBUF)
  E51E  CD27E7        		CALL	DRDC
  E521  DC41E5        		CALL	C,DRDNE
  E524                	POP_DE_BC_HL_RET:
  E524  D1            		POP	DE
  E525  C1            		POP	BC
  E526  E1            		POP	HL
  E527  C9            		RET
                      	
  E528                	DRDN:
  E528  AF            		XOR	A
  E529  00            	DRDN1:	NOP
  E52A  30E4          		JR	NC,DRDX
  E52C                	DRDNX:
  E52C  CD46E5        		CALL	DRDY
  E52F  C8            		RET	Z
  E530                	DRDX1:
  E530  CD57E5        		CALL	DWTX
  E533  ED53A6EC      		LD	(_DCLPS),DE
  E537  3A88EC        		LD	A,(_DRV)
  E53A  32A5EC        		LD	(_DBDRV),A
  E53D  CDD9EC        		CALL	_CHGDRV
  E540  D0            		RET	NC
  E541                	DRDNE:
  E541  9F            		SBC	A,A
  E542  32A5EC        		LD	(_DBDRV),A
  E545  C9            		RET
                      	
  E546                	DRDY:
  E546  E5            		PUSH	HL
  E547  3A88EC        		LD	A,(_DRV)
  E54A  21A5EC        		LD	HL,_DBDRV
  E54D  AE            		XOR	(HL)
  E54E  2005          		JR	NZ,POP_HL_RET
                      	
  E550  2AA6EC        		LD	HL,(_DCLPS)
  E553  ED52          		SBC	HL,DE		;CF=0
  E555                	POP_HL_RET:
  E555  E1            		POP	HL
  E556  C9            		RET
                      	
  E557                	DWTX:
  E557  3AA4EC        		LD	A,(_WTDBF)
  E55A  B7            		OR	A
  E55B  C8            		RET	Z
  E55C  AF            		XOR	A
  E55D  32A4EC        		LD	(_WTDBF),A
                      	
  E560  E5            		PUSH	HL
  E561  C5            		PUSH	BC
  E562  D5            		PUSH	DE
  E563  3AA5EC        		LD	A,(_DBDRV)
  E566  CDD9EC        		CALL	_CHGDRV
  E569  ED5BA6EC      		LD	DE,(_DCLPS)
  E56D  2A7EEC        		LD	HL,(_DTBUF)
  E570  D433E7        		CALL	NC,DWTC
  E573  18AF          		JR	POP_DE_BC_HL_RET
                      	
  E575                	RDFATX:
  E575  E5            		PUSH	HL
  E576  3A88EC        		LD	A,(_DRV)
  E579  21A3EC        		LD	HL,_FATDRV
  E57C  AE            		XOR	(HL)
  E57D  E67F          		AND	07FH
  E57F  28D4          		JR	Z,POP_HL_RET
                      	
  E581  C5            		PUSH	BC
  E582  D5            		PUSH	DE
  E583  DDE5          		PUSH	IX
  E585  CD9DE5        		CALL	WTFATX
  E588  380F          		JR	C,RDFATE1
                      	
  E58A  3A88EC        		LD	A,(_DRV)
  E58D  32A3EC        		LD	(_FATDRV),A
  E590  CDE5EC        		CALL	_RDFAT
  E593                	RDFATE2:
  E593  3004          		JR	NC,RDFATE1
  E595  9F            		SBC	A,A
  E596  32A3EC        		LD	(_FATDRV),A
  E599                	RDFATE1:
  E599  DDE1          		POP	IX
  E59B  1887          		JR	POP_DE_BC_HL_RET
                      	
  E59D                	WTFATX:
  E59D  3AA2EC        		LD	A,(_WTFATF)
  E5A0  B7            		OR	A
  E5A1  C8            		RET	Z
  E5A2  E5            		PUSH	HL
  E5A3  3AA3EC        		LD	A,(_FATDRV)
  E5A6  21A5EC        		LD	HL,_DBDRV
  E5A9  AE            		XOR	(HL)
  E5AA  E67F          		AND	07FH
  E5AC  CC57E5        		CALL	Z,DWTX
  E5AF  38A4          		JR	C,POP_HL_RET
  E5B1  C5            		PUSH	BC
  E5B2  D5            		PUSH	DE
  E5B3  DDE5          		PUSH	IX
  E5B5  CD87E7        		CALL	WTFAT
  E5B8  AF            		XOR	A
  E5B9  32A2EC        		LD	(_WTFATF),A
  E5BC  18DB          		JR	RDFATE1
                      	
  E5BE                	NCL1:
  E5BE  7A            		LD	A,D
  E5BF  B3            		OR	E
  E5C0  37            		SCF
  E5C1  C8            		RET	Z
                      	
  E5C2  3A88EC        		LD	A,(_DRV)
  E5C5  CB5A          		BIT	3,D
  E5C7  2802          		JR	Z,NCL2
  E5C9  F680          		OR	080H
  E5CB                	NCL2:
  E5CB  E5            		PUSH	HL
  E5CC  21A3EC        		LD	HL,_FATDRV
  E5CF  BE            		CP	(HL)
  E5D0  2883          		JR	Z,POP_HL_RET
                      	
  E5D2  C5            		PUSH	BC
  E5D3  D5            		PUSH	DE
  E5D4  DDE5          		PUSH	IX
  E5D6  F5            		PUSH	AF
  E5D7  CD9DE5        		CALL	WTFATX
  E5DA  C1            		POP	BC
  E5DB  38BC          		JR	C,RDFATE1
  E5DD  78            		LD	A,B
  E5DE  32A3EC        		LD	(_FATDRV),A
  E5E1  CD76E7        		CALL	RDFATS
  E5E4  18AD          		JR	RDFATE2
                      	
  E5E6                	NCL3:
  E5E6  CB9A          		RES	3,D
  E5E8  6B            		LD	L,E
  E5E9  62            		LD	H,D
  E5EA  CB3C          		SRL	H
  E5EC  CB1D          		RR	L
  E5EE  1F            		RRA
  E5EF  ED4B7CEC      		LD	BC,(_FATBF)
  E5F3  19            		ADD	HL,DE
  E5F4  09            		ADD	HL,BC
  E5F5  17            		RLA
  E5F6  C9            		RET
                      	
  E5F7                	GNCL:
  E5F7  CDBEE5        		CALL	NCL1		;GET NEW CLUSTER
  E5FA  D8            		RET	C
  E5FB  C5            		PUSH	BC
  E5FC  E5            		PUSH	HL
  E5FD  CDE6E5        		CALL	NCL3
  E600  3809          		JR	C,GNC1
  E602  5E            		LD	E,(HL)
  E603  23            		INC	HL
  E604  7E            		LD	A,(HL)
  E605  E60F          		AND	00FH
  E607  57            		LD	D,A
  E608  E1            		POP	HL
  E609  C1            		POP	BC
  E60A  C9            		RET
  E60B                	GNC1:
  E60B  7E            		LD	A,(HL)
  E60C  23            		INC	HL
  E60D  56            		LD	D,(HL)
  E60E  0604          		LD	B,4
  E610                	GNC1L:
  E610  CB3A          		SRL	D
  E612  1F            		RRA
  E613  10FB          		DJNZ	GNC1L
                      	
  E615  5F            		LD	E,A
  E616  E1            		POP	HL
  E617  C1            		POP	BC
  E618  A7            		AND	A
  E619  C9            		RET
                      	
  E61A                	SNCL:
  E61A  CDBEE5        		CALL	NCL1
  E61D  D8            		RET	C
  E61E  3E01          		LD	A,1
  E620  32A2EC        		LD	(_WTFATF),A
                      	;				SET NEW CLUSTER
  E623  E5            		PUSH	HL
  E624  C5            		PUSH	BC
  E625  D5            		PUSH	DE
  E626  E5            		PUSH	HL
  E627  CDE6E5        		CALL	NCL3
  E62A  D1            		POP	DE
                      	;CF=ODD
  E62B  7E            		LD	A,(HL)
  E62C  73            		LD	(HL),E
  E62D  3806          		JR	C,SNC1
                      	;EVEN
                      	;M[0] = E
                      	;M[1] = (M[1] & 0xF0) | (D & 0x0F)
  E62F  23            		INC	HL
  E630  ED67          		RRD		;M={A[3:0],E[3:0]}
  E632  7A            		LD	A,D
  E633  1804          		JR	SNC11
  E635                	SNC1:
                      	;ODD
                      	;HL[0] = (HL[0]&0x0F) | (E<<4)
                      	;HL[1] = DE>>4
  E635  ED6F          		RLD		;M={D[3:0],E[7:4]}
  E637  23            		INC	HL
  E638  72            		LD	(HL),D	;M={D[3:0],E[7:4]}
  E639                	SNC11:
  E639  ED6F          		RLD		;M={M[7:4],D[3:0]}
  E63B  B7            		OR	A
  E63C  D1            		POP	DE
  E63D  C1            		POP	BC
  E63E  E1            		POP	HL
  E63F  C9            		RET
                      	
  E640                	RDFAT0X:
  E640  CD76E7        		CALL	RDFATS
  E643  D8            		RET	C
  E644  DDBE01        		CP	(IX+1)		;DPB_01_FATID
  E647  C8            		RET	Z
  E648  37            		SCF
  E649  C9            		RET
                      	
  E64A                	RDFAT:
  E64A  3A88EC        		LD	A,(_DRV)
  E64D  CDA1E8        		CALL	CHGDRVR
  E650  D8            		RET	C
  E651  DD7E12        		LD	A,(IX+012H)	;DPB_12_DEVNO
  E654  FE87          		CP	087H
  E656  20E8          		JR	NZ,RDFAT0X
                      	
  E658  3E7F          		LD	A,07FH
  E65A  3247E9        		LD	(CHECK),A	;A=07FH
  E65D  DDCB0A46      		BIT	0,(IX+00AH)	;DPB_0A_FDMODE
  E661  284D          		JR	Z,X2HX
  E663                	E2DX:
  E663  21D7E8        		LD	HL,M2D
  E666  CD3FE7        		CALL	DRDF
  E669  383D          		JR	C,E2HX
  E66B  FEFD          		CP	0FDH		;2D
  E66D  C8            		RET	Z
  E66E  FEF9          		CP	0F9H		;2DD9
  E670  CA1AE7        		JP	Z,E2DD9
  E673  FEFB          		CP	0FBH		;2DD8
  E675  37            		SCF
  E676  C0            		RET	NZ		;NOT 2DD
  E677  21E5E8        		LD	HL,M2DD8
  E67A                	CHGTYPE:
  E67A  D5            		PUSH	DE
  E67B  CD8DE6        		CALL	CHGDV
  E67E  3A84EC        		LD	A,(_DRIVE)
  E681  E603          		AND	3
  E683  F680          		OR	080H
  E685  6F            		LD	L,A
  E686  26EC          		LD	H,_CYL0/256
  E688  3EFF          		LD	A,0FFH
  E68A  77            		LD	(HL),A
  E68B  D1            		POP	DE
  E68C  C9            		RET
                      	
  E68D                	CHGDV:
  E68D  DDE5          		PUSH	IX
  E68F  D1            		POP	DE
  E690  EDA0          		LDI
  E692  EDA0          		LDI
  E694  13            		INC	DE
  E695  13            		INC	DE
  E696  13            		INC	DE
  E697  13            		INC	DE
  E698  010C00        		LD	BC,12
  E69B  EDB0          		LDIR
  E69D                	CHGDV2:
  E69D  3EFF          		LD	A,0FFH
  E69F  3289EC        		LD	(_DSK),A
  E6A2  3A88EC        		LD	A,(_DRV)
  E6A5  C3D9EC        		JP	_CHGDRV
                      	
  E6A8                	E2HX:
  E6A8  3C            		INC	A
  E6A9  C8            		RET	Z
  E6AA  2147E9        		LD	HL,CHECK
  E6AD  CB06          		RLC	(HL)
  E6AF  D8            		RET	C
  E6B0                	X2HX:
  E6B0  210FE9        		LD	HL,M2HD
  E6B3  110000        		LD	DE,0
  E6B6  CD43E7        		CALL	DRDD
  E6B9  300A          		JR	NC,X2HX1
  E6BB  3C            		INC	A
  E6BC  C8            		RET	Z
  E6BD  2147E9        		LD	HL,CHECK
  E6C0  CB06          		RLC	(HL)
  E6C2  D8            		RET	C
  E6C3  189E          		JR	E2DX
  E6C5                	X2HX1:
  E6C5  23            		INC	HL
  E6C6  7E            		LD	A,(HL)
  E6C7  06FE          		LD	B,0FEH
  E6C9  FE0C          		CP	00CH
  E6CB  2838          		JR	Z,X2HDE
  E6CD  06F8          		LD	B,0F8H
  E6CF  D620          		SUB	020H		;020H
  E6D1  2832          		JR	Z,X2HDE
  E6D3  3C            		INC	A		;01FH
  E6D4  282F          		JR	Z,X2HDE
  E6D6  3C            		INC	A		;01EH
  E6D7  2078          		JR	NZ,C2HX		;2HD/2HC/2HQ
  E6D9                	X2HS:
  E6D9  2139E9        		LD	HL,M2HS
  E6DC  CD0BE7        		CALL	X2HSS
  E6DF  D8            		RET	C
  E6E0  2A7CEC        		LD	HL,(_FATBF)
  E6E3  23            		INC	HL
  E6E4  7E            		LD	A,(HL)		;FATBF+1
  E6E5  FE50          		CP	80
  E6E7  3F            		CCF
  E6E8  D0            		RET	NC
  E6E9  FE5A          		CP	90
  E6EB  D0            		RET	NC
  E6EC  DD770C        		LD	(IX+00CH),A	;DPB_0C_MAXCYL
  E6EF  D650          		SUB	80
  E6F1  87            		ADD	A,A	;*2
  E6F2  4F            		LD	C,A
  E6F3  87            		ADD	A,A	;*4
  E6F4  87            		ADD	A,A	;*8
  E6F5  87            		ADD	A,A	;*16
  E6F6  81            		ADD	A,C	;*18
  E6F7  C698          		ADD	A,098H
  E6F9  DD7708        		LD	(IX+8),A	;DPB_08_MAXCL_LOW
  E6FC  3E05          		LD	A,5
  E6FE  CE00          		ADC	A,0
  E700  DD7709        		LD	(IX+9),A	;DPB_08_MAXCL_HIGH
  E703  1898          		JR	CHGDV2
  E705                	X2HDE:
  E705  212BE9        		LD	HL,M2HDE
  E708  23            		INC	HL
  E709  70            		LD	(HL),B
  E70A  2B            		DEC	HL
  E70B                	X2HSS:
  E70B  CD3FE7        		CALL	DRDF
  E70E  D8            		RET	C
  E70F  DDBE01        		CP	(IX+1)		;DPB_01_FATID
  E712  37            		SCF
  E713  C0            		RET	NZ
  E714  CD23E7        		CALL	INCDRD
  E717  300E          		JR	NC,DRDC
  E719  C9            		RET
                      	
  E71A                	E2DD9:
  E71A  21F3E8        		LD	HL,M2DD
  E71D  CD7AE6        		CALL	CHGTYPE
  E720  2A7CEC        		LD	HL,(_FATBF)
  E723                	INCDRD:
  E723  24            		INC	H
  E724  24            		INC	H
  E725  24            		INC	H
  E726  24            		INC	H
  E727                	DRDC:
  E727  CDF1EC        		CALL	_DRD
  E72A  D8            		RET	C
  E72B  3A5EDF        		LD	A,(DBLPAT)
  E72E  B7            		OR	A
  E72F  C2F1EC        		JP	NZ,_DRD
  E732  C9            		RET
                      	
  E733                	DWTC:
  E733  CDF4EC        		CALL	_DWT
  E736  D8            		RET	C
  E737  3A5EDF        		LD	A,(DBLPAT)
  E73A  B7            		OR	A
  E73B  C2F4EC        		JP	NZ,_DWT
  E73E  C9            		RET
                      	
  E73F                	DRDF:
  E73F  ED5B59E2      		LD	DE,(_FATPS)
  E743                	DRDD:
  E743  CD7AE6        		CALL	CHGTYPE
  E746  2A7CEC        		LD	HL,(_FATBF)
  E749  E5            		PUSH	HL
  E74A  CD27E7        		CALL	DRDC
  E74D  E1            		POP	HL
  E74E  D8            		RET	C
  E74F  7E            		LD	A,(HL)
  E750  C9            		RET
                      	
  E751                	C2HX:
  E751  CD76E7        		CALL	RDFATS
  E754  D8            		RET	C
  E755  FEFE          		CP	0FEH	;2HD
  E757  C8            		RET	Z
  E758  211DE9        		LD	HL,M2HQ
  E75B  FEF0          		CP	0F0H
  E75D  2807          		JR	Z,X2HQ
  E75F  FEF9          		CP	0F9H
  E761  37            		SCF
  E762  C0            		RET	NZ
  E763  2101E9        		LD	HL,M2HC
  E766                	X2HQ:
  E766  CD7AE6        		CALL	CHGTYPE
  E769  CDADE7        		CALL	FATS2
  E76C  24            		INC	H	;前2クラスタはすでに読み込まれているのでスキップ
  E76D  24            		INC	H
  E76E  05            		DEC	B
  E76F  13            		INC	DE
  E770  24            		INC	H	;
  E771  24            		INC	H
  E772  05            		DEC	B
  E773  13            		INC	DE
  E774  1804          		JR	RDFATL
  E776                	RDFATS:
  E776  CDA6E7        		CALL	FATS
  E779  D8            		RET	C
  E77A                	RDFATL:
  E77A  C5            		PUSH	BC
  E77B  CDF1EC        		CALL	_DRD
  E77E  C1            		POP	BC
  E77F  D8            		RET	C
  E780  10F8          		DJNZ	RDFATL
  E782  2A7CEC        		LD	HL,(_FATBF)
  E785  7E            		LD	A,(HL)
  E786  C9            		RET
                      	
  E787                	WTFAT:
  E787  CDA6E7        		CALL	FATS
  E78A  D49DE7        		CALL	NC,WTFATL
  E78D  D8            		RET	C
  E78E  DDCB0F4E      		BIT	1,(IX+00FH)	;DPB_0F_FATS
  E792  C8            		RET	Z
  E793  CDADE7        		CALL	FATS2
  E796  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E799                	WTFAT2:
  E799  13            		INC	DE
  E79A  3D            		DEC	A
  E79B  20FC          		JR	NZ,WTFAT2
  E79D                	WTFATL:
  E79D  C5            		PUSH	BC
  E79E  CDF4EC        		CALL	_DWT
  E7A1  C1            		POP	BC
  E7A2  D8            		RET	C
  E7A3  10F8          		DJNZ	WTFATL
  E7A5  C9            		RET
                      	;------------------------
                      	;FATのセットアップ
                      	;out
                      	;	B  : FATセクタ数
                      	;	DE : FAT先頭セクタ番号
                      	;	HL : FATバッファポインタ
                      	;	CF : 1=ドライブ切り替えエラー
                      	;note
                      	;	FATサイズがFATバッファを超える場合は
                      	;	対象クラスタ領域==(_FATDRV).bit7によって
                      	;	FATの前半3KBと後半3KBを切り替える
                      	;------------------------
  E7A6                	FATS:
  E7A6  3AA3EC        		LD	A,(_FATDRV)
  E7A9  CDA1E8        		CALL	CHGDRVR		;ドライブ切り替え
  E7AC  D8            		RET	C
  E7AD                	FATS2:
  E7AD  ED5B59E2      		LD	DE,(_FATPS)	;fat sector pos
  E7B1  2A7CEC        		LD	HL,(_FATBF)
  E7B4  DD4600        		LD	B,(IX+0)	;DPB_00_FATLN
  E7B7  DD7E07        		LD	A,(IX+7)	;DPB_07_DBLCL $29=512 / 0=1024
  E7BA  B7            		OR	A
  E7BB  3E06          		LD	A,6		;3072 / 512 FATバッファに読み込めるセクタ数
  E7BD  2007          		JR	NZ,FATS512
  E7BF  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  E7C3  2001          		JR	NZ,FATS512
  E7C5  1F            		RRA			;A=3 (3072÷1024: 1セクタ1024バイトの場合)
  E7C6                	FATS512:
  E7C6  B8            		CP	B
  E7C7  D0            		RET	NC		;DPB_0F_FATS x sectorSize < fatBufSize
                      	;targetCluster
  E7C8  4F            		LD	C,A		;C = skipCount
  E7C9  3AA3EC        		LD	A,(_FATDRV)	;bit7 = (targetCluster >= 0x800)
  E7CC  87            		ADD	A,A		;CF=(_FATDRV).bit7
  E7CD  3006          		JR	NC,FATS3
                      	;(targerCluster>=0x800)
  E7CF                	FAT_SKP:
  E7CF  13            		INC	DE		;FATPS++
  E7D0  05            		DEC	B		;FATSIZE--
  E7D1  0D            		DEC	C		;skipCnt--
  E7D2  20FB          		JR	NZ,FAT_SKP
  E7D4  48            		LD	C,B
  E7D5                	FATS3:
  E7D5  41            		LD	B,C		;3 or 6
  E7D6  AF            		XOR	A
  E7D7  C9            		RET
                      	
  E7D8                	CHGDRV:
  E7D8  E67F          		AND	07FH
  E7DA  E5            		PUSH	HL
  E7DB  2189EC        		LD	HL,_DSK
  E7DE  BE            		CP	(HL)
  E7DF  280A          		JR	Z,CHGDRVE
  E7E1                	CHGDRV1:
  E7E1  DDE5          		PUSH	IX
  E7E3  CDEDE7        		CALL	CHGDRV0
  E7E6  3A89EC        		LD	A,(_DSK)
  E7E9  DDE1          		POP	IX
  E7EB                	CHGDRVE:
  E7EB  E1            		POP	HL
  E7EC  C9            		RET
                      	
  E7ED                	CHGDRV0:
  E7ED  6F            		LD	L,A
  E7EE  CDDCEC        		CALL	_GETDPB
  E7F1  D8            		RET	C
                      	
  E7F2  7D            		LD	A,L
  E7F3  3289EC        		LD	(_DSK),A
                      	
  E7F6  F3            		DI
  E7F7  ED735EE8      		LD	(SPPAT2+1),SP
                      	
  E7FB  DDF9          		LD	SP,IX
                      	
  E7FD  E1            		POP	HL
  E7FE  E1            		POP	HL
  E7FF  22F2EC        		LD	(_DRD+1),HL
                      	
  E802  E1            		POP	HL
  E803  22F5EC        		LD	(_DWT+1),HL
                      	
  E806  E1            		POP	HL
  E807  225DDF        		LD	(CLSPAT+1),HL	;ADDCL
                      	
  E80A  E1            		POP	HL		;MAXCL
  E80B  7D            		LD	A,L
  E80C  326CDF        		LD	(CLPAT2+1),A
  E80F  7C            		LD	A,H
  E810  3268DF        		LD	(CLPAT1+1),A
  E813  2B            		DEC	HL
  E814  2268E1        		LD	(MAXCLP+1),HL
                      	
  E817  E1            		POP	HL		;H=MAXDIR L=FDMODE
  E818  7D            		LD	A,L
  E819  F6FE          		OR	0FEH
  E81B  32C2E9        		LD	(FDMODE+1),A
  E81E  07            		RLCA
  E81F  E603          		AND	3
  E821  32A9E9        		LD	(FSPAT+1),A
  E824  7C            		LD	A,H
  E825  326ADE        		LD	(RTEPAT+1),A
                      	
  E828  E1            		POP	HL
  E829  7D            		LD	A,L
  E82A  32A1EC        		LD	(_MAXCYL),A
  E82D  7C            		LD	A,H
  E82E  3251E9        		LD	(MAXSEC+1),A
                      	
  E831  E1            		POP	HL
  E832  2600          		LD	H,0
  E834  2259E2        		LD	(_FATPS),HL
                      	
  E837  E1            		POP	HL
  E838  7C            		LD	A,H
  E839  325EE9        		LD	(SECPAT+1),A
  E83C  2600          		LD	H,0
  E83E  225BE2        		LD	(_DIRPS),HL
                      	
  E841  E1            		POP	HL
  E842  7C            		LD	A,H
  E843  3284EC        		LD	(_DRIVE),A
                      	
  E846  E1            		POP	HL
  E847  E1            		POP	HL
  E848  7C            		LD	A,H
  E849  B5            		OR	L
  E84A  2003          		JR	NZ,OGNCL
  E84C  21F7E5        		LD	HL,GNCL		;FAT12(default)
  E84F                	OGNCL:
  E84F  22F8EC        		LD	(_GNCL+1),HL
                      	
  E852  E1            		POP	HL
  E853  7C            		LD	A,H
  E854  B5            		OR	L
  E855  2003          		JR	NZ,OSNCL
  E857  211AE6        		LD	HL,SNCL		;FAT12(default)
  E85A                	OSNCL:
  E85A  22FBEC        		LD	(_SNCL+1),HL
                      	
  E85D  310000        	SPPAT2:	LD	SP,0		;元のSPを復元
  E860  FB            		EI
  E861  D5            		PUSH	DE
  E862  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_FATS
  E866  280A          		JR	Z,NEC
                      					;1クラスタ512 2HC/2HQ(2HD1.44MB)等
  E868  111802        		LD	DE,00218H	;JR +2(直後のRR Cを飛ばす)
  E86B  210000        		LD	HL,0
                      	
  E86E  3E01          		LD	A,1
  E870  1808          		JR	NEC1
  E872                	NEC:
                      					;1クラスタ1024 2D/2DD/2HD/EMM/BRAM/GRAM等
  E872  11            		DB	011H		;LD DE,SRL B
  E873  CB38          		SRL B			;
  E875  21            		DB	021H		;LD HL,SRL A
  E876  CB3F          		SRL A			;
                      	
  E878  3E03          		LD	A,3
  E87A                	NEC1:				;1024	512
  E87A  32A8E4        		LD	(IBM5+1),A	;3	1
  E87D  3C            		INC	A		;4	2
  E87E  32AFE4        		LD	(IBM7+2),A
  E881  87            		ADD	A,A		;8	4
  E882  87            		ADD	A,A		;010H	8
  E883  87            		ADD	A,A		;020H	010H
  E884  32F7DD        		LD	(IBM1+1),A
  E887  87            		ADD	A,A		;040H	020H
  E888  87            		ADD	A,A		;080H	040H
  E889  87            		ADD	A,A		;000H	080H
  E88A  2F            		CPL			;0FFH	07FH
  E88B  324AD3        		LD	(IBM2+1),A
  E88E  ED5346E1      		LD	(IBM4),DE
  E892  22D3E4        		LD	(IBM8),HL
  E895  D1            		POP	DE
  E896  AF            		XOR	A
  E897  C9            		RET
                      	
  E898                	GETDPBD:
  E898  DDE3          		EX	(SP),IX
  E89A  DDE5          		PUSH	IX
  E89C  3A88EC        		LD	A,(_DRV)
  E89F  1807          		JR	GETDPB1
                      	
  E8A1                	CHGDRVR:
  E8A1  CDD9EC        		CALL	_CHGDRV
  E8A4  D8            		RET	C
  E8A5  3A89EC        		LD	A,(_DSK)
  E8A8                	GETDPB1:
  E8A8  C3DCEC        		JP	_GETDPB
                      	
  E8AB                	GETDPB:
  E8AB  FE08          		CP	8
  E8AD  3F            		CCF
  E8AE  D8            		RET	C
  E8AF  87            		ADD	A,A	;*2
  E8B0  87            		ADD	A,A	;*4
  E8B1  87            		ADD	A,A	;*8
  E8B2  87            		ADD	A,A	;*16
  E8B3  87            		ADD	A,A	;*32
                      	;	LD	IXL,A		;OHM-Z80固有マクロ
  E8B4  DD            		DB	0DDH		;Z80未定義命令
  E8B5  6F            		LD	L,A		;
                      	;	LD	IXH,DEVICE/256	;OHM-Z80固有マクロ
  E8B6  DD            		DB	0DDH		;Z80未定義命令
  E8B7  26ED          		LD	H,DEVICE/256	;
  E8B9  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E8BC  FE01          		CP	001H		;A=0 THEN CF=1
  E8BE  C9            		RET
                      	
  E8BF                	FFLUSH:
  E8BF  F5            		PUSH	AF
  E8C0  3EFF          		LD	A,0FFH
  E8C2  3235E2        		LD	(SFILE),A
  E8C5  CD57E5        		CALL	DWTX
  E8C8  3EFF          		LD	A,0FFH
  E8CA  32A5EC        		LD	(_DBDRV),A
  E8CD  CD9DE5        		CALL	WTFATX
  E8D0  3EFF          		LD	A,0FFH
  E8D2  32A3EC        		LD	(_FATDRV),A
  E8D5  F1            		POP	AF
  E8D6  C9            		RET
                      	
  E8D7                	M2D:
  E8D7  02FD0829      		DB	2,0FDH,8,029H
  E8DB  6401          		DW	356
  E8DD  FF0C2809010205		DB	0FFH,12,40,9,1,2,5,1
                      	
  E8E5                	M2DD8:
  E8E5  02FB0829      		DB	2,0FBH,8,029H
  E8E9  7C02          		DW	636
  E8EB  FF0C5008010205		DB	0FFH,12,80,8,1,2,5,1
                      	
  E8F3                	M2DD:
  E8F3  03F90A29      		DB	3,0F9H,0AH,029H
  E8F7  CB02          		DW	715
  E8F9  FF0E5009010207		DB	0FFH,14,80,9,1,2,7,1
                      	
  E901                	M2HC:
  E901  07F91B00      		DB	7,0F9H,27,0
  E905  4509          		DW	2373
  E907  FE1D500F01820F		DB	0FEH,29,80,15,1,082H,15,1
                      	
  E90F                	M2HD:
  E90F  02FE0900      		DB	2,0FEH,9,0
  E913  C704          		DW	1223
  E915  FE0B4D08010205		DB	0FEH,11,77,8,1,2,5,1
                      	
  E91D                	M2HQ:
  E91D  09F01F00      		DB	9,0F0H,31,0
  E921  210B          		DW	2849
  E923  FE215012018213		DB	0FEH,33,80,18,1,082H,19,1
                      	
  E92B                	M2HDE:
  E92B  03FE0B00      		DB	3,0FEH,11,0
  E92F  9505          		DW	1429
  E931  FE0D5009010207		DB	0FEH,13,80,9,1,2,7,1
                      	
  E939                	M2HS:
  E939  03FB0800      		DB	3,0FBH,8,0
  E93D  9805          		DW	1432
  E93F  FE0A5009010104		DB	0FEH,10,80,9,1,1,4,10
                      	
  E947  00            	CHECK:	DB	0
                      	
                      	;LDDISK.ASM
                      	
                      	;	LSX-Dodgers DISK
                      	
                      	
  E948                	SEEK:
  E948  7A            		LD	A,D
  E949  B3            		OR	E
  E94A  3E01          		LD	A,001H
  E94C  2812          		JR	Z,DIV3
                      	
  E94E  0610          		LD	B,16
  E950  0E00          	MAXSEC:	LD	C,000H
  E952  AF            		XOR	A
  E953  EB            		EX	DE,HL
  E954                	DIV1:
  E954  29            		ADD	HL,HL
  E955  8F            		ADC	A,A
  E956  B9            		CP	C
  E957  3802          		JR	C,DIV2
  E959  91            		SUB	C
  E95A  2C            		INC	L
  E95B                	DIV2:
  E95B  10F7          		DJNZ	DIV1
                      	
  E95D  C601          	SECPAT:	ADD	A,001H		;(Self-rewriting)
  E95F  55            		LD	D,L	;Quotient(TRACK)
  E960                	DIV3:
  E960  5F            		LD	E,A	;Remainder
  E961  CB3A          		SRL	D	;CYLINDER
  E963  9F            		SBC	A,A
  E964  E610          		AND	010H	;SIDE
  E966  4F            		LD	C,A
                      	
  E967  3A84EC        		LD	A,(_DRIVE)
  E96A  FE04          		CP	4
  E96C  3F            		CCF
  E96D  D8            		RET	C
  E96E  B1            		OR	C
  E96F  32EEE9        		LD	(MOPAT+1),A	;Motor off data
  E972  01FC0F        		LD	BC,00FFCH
  E975  F680          		OR	080H		;Mortor on
  E977  ED79          		OUT	(C),A
                      	
  E979  CDC0E9        		CALL	SETMODE
  E97C  D8            		RET	C
                      	
  E97D  CD03EA        		CALL	DRIVE
  E980  FEFF          		CP	0FFH		;A=0FFH Unknown CYLINDER
  E982  CCE2E9        		CALL	Z,FDCRES	;Restore
  E985  0EF9          		LD	C,0F9H
  E987  ED79          		OUT	(C),A		;Currrent CYLINDER
  E989  92            		SUB	D
  E98A  C8            		RET	Z		;No seek
                      	
  E98B  3A86EC        		LD	A,(_ISEEK)
  E98E  4F            		LD	C,A
                      	
  E98F  3AA1EC        		LD	A,(_MAXCYL)	;Max CYLINDER
  E992  3D            		DEC	A
  E993  BA            		CP	D		;Over CYLINDER
  E994  D8            		RET	C
                      	
  E995  B9            		CP	C		;for Built-in 2DD
  E996  3803          		JR	C,SETM2
  E998  78            		LD	A,B		;B=00FH
  E999  DBFE          		IN	A,(0FEH)		;2HD mode for 2DD seek
  E99B                	SETM2:
  E99B  78            		LD	A,B
  E99C  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  E99E  0EFB          		LD	C,0FBH
  E9A0  ED51          		OUT	(C),D
  E9A2  72            		LD	(HL),D
  E9A3  0E18          		LD	C,018H		;Seek
  E9A5                	FDCCMD2:
  E9A5  3A85EC        		LD	A,(_SEEKSP)
  E9A8  E6FF          	FSPAT:	AND	0FFH
  E9AA  B1            		OR	C
                      	
  E9AB                	FDCCMD:
  E9AB  CDF9E9        		CALL	COMSET
                      	
  E9AE  3A70EA        	AT_FDCPAT:LD	A,(FDCPAT+1)
  E9B1  E620          		AND	020H		;Write data Write track
  E9B3  3C            		INC	A
                      	
  E9B4                	SST:
  E9B4  0E00          		LD	C,0
  E9B6                	SST1:
  E9B6  0D            		DEC	C		; 4
  E9B7  20FD          		JR	NZ,SST1		;12 * 256 / 4 = About 1ms
  E9B9  3D            		DEC	A
  E9BA  20FA          		JR	NZ,SST1
                      	
  E9BC  3C            		INC	A		;A=1
  E9BD  CDCBE9        		CALL	READY
  E9C0                	SETMODE:
  E9C0  78            		LD	A,B		;B=00FH
  E9C1  DBFF          	FDMODE:	IN	A,(0FFH)		;Floppy mode(2D/2HD) (Self-rewriting)
                      	
  E9C3  78            		LD	A,B
  E9C4  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  E9C6  CDFDE9        		CALL	DELAY0		;Head select time
  E9C9  3E81          		LD	A,081H
  E9CB                	READY:
  E9CB  32D5E9        		LD	(WAITA+1),A
  E9CE  E5            		PUSH	HL
  E9CF  0EF8          		LD	C,0F8H
  E9D1  61            		LD	H,C
  E9D2                	READY2:
  E9D2  ED78          		IN	A,(C)
  E9D4  E681          	WAITA:	AND	081H		;NOT READY,BUSY
  E9D6  2808          		JR	Z,READYE
  E9D8  E3            		EX	(SP),HL		;wait
  E9D9  E3            		EX	(SP),HL		; //
  E9DA  2B            		DEC	HL
  E9DB  7C            		LD	A,H
  E9DC  B5            		OR	L
  E9DD  20F3          		JR	NZ,READY2
  E9DF  37            		SCF
  E9E0                	READYE:
  E9E0  E1            		POP	HL
  E9E1  C9            		RET
                      	
  E9E2                	FDCRES:
  E9E2  3600          		LD	(HL),0
  E9E4  0E08          		LD	C,8
  E9E6  18BD          		JR	FDCCMD2
                      	
  E9E8                	FDMOFF:
  E9E8  F5            		PUSH	AF
  E9E9  C5            		PUSH	BC
  E9EA  01FC0F        		LD	BC,00FFCH	;Motor off
  E9ED  3E00          	MOPAT:	LD	A,000H		;(Self-rewriting)
  E9EF  ED79          		OUT	(C),A
  E9F1  C1            		POP	BC
  E9F2  F1            		POP	AF
  E9F3  C9            		RET
                      	
  E9F4                	SECSET:
  E9F4  01FA0F        		LD	BC,00FFAH
  E9F7  ED59          		OUT	(C),E
  E9F9                	COMSET:
  E9F9  0EF8          		LD	C,0F8H
  E9FB  ED79          		OUT	(C),A
  E9FD                	DELAY0:
  E9FD  3E1A          		LD	A,26
  E9FF                	DELAY:
  E9FF  3D            		DEC	A
  EA00  20FD          		JR	NZ,DELAY
  EA02  C9            		RET
                      	
  EA03                	DRIVE:
  EA03  2A84EC        		LD	HL,(_DRIVE)
  EA06  26EC          		LD	H,_CYL0/256
  EA08  CBFD          		SET	7,L
  EA0A  7E            		LD	A,(HL)
  EA0B  C9            		RET
                      	
  EA0C                	RNF:
  EA0C  CD03EA        		CALL	DRIVE
  EA0F  36FF          		LD	(HL),0FFH
  EA11  C9            		RET
                      	
  EA12  0307          	DEMES:	DB	3,7
  EA14  A5446576696365		DB	0A5H, "Device I/O Error!",5,3
  EA28  41626F72742052		DB	"Abort Retry Ignore?",5,3,0
                      	
  EA3E  02            	RETRY:	DB	2
                      	
                      	
                      	;	FLOPPY DISK DRIVER(DMA)
                      	
                      	
  EA3F                	WTTRK:
  EA3F  3EF4          		LD	A,0F4H
  EA41  01            		DB	1	;JR	WTTRK1
  EA42                	FDWT:
  EA42  3EA0          		LD	A,0A0H
  EA44                	WTTRK1:
  EA44  3270EA        		LD	(FDCPAT+1),A
  EA47  3E10          		LD	A,16
  EA49  F3            		DI
  EA4A  1808          		JR	DISK
                      	
  EA4C                	FDRD:
  EA4C  3E80          		LD	A,080H
  EA4E  00            		NOP
                      	
  EA4F  3270EA        		LD	(FDCPAT+1),A
  EA52  3E0E          		LD	A,14
                      	
  EA54                	DISK:
  EA54  3266EA        		LD	(DMAPAT+1),A
                      	
  EA57  22F0EA        		LD	(DMAD+11),HL
  EA5A                	DISKR:
  EA5A  3E02          		LD	A,2		;Retry count
  EA5C  323EEA        		LD	(RETRY),A
  EA5F                	DISK2:
  EA5F  D5            		PUSH	DE
  EA60  CD48E9        		CALL	SEEK
  EA63  3840          		JR	C,ERRF
                      	
  EA65  3E0E          	DMAPAT:	LD	A,14
  EA67  21E5EA        		LD	HL,DMAD
  EA6A  CDDBEA        		CALL	SETDMA
  EA6D  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EA6F  3E80          	FDCPAT:	LD	A,080H		;FDC COMMAND(Self-rewriting)
  EA71  C5            		PUSH	BC
  EA72  CDF4E9        		CALL	SECSET
  EA75  2AF0EA        		LD	HL,(DMAD+11)
  EA78  23            		INC	HL
  EA79  1106BB        		LD	DE,0BB06H	;READ DMA
                      	
  EA7C  3E03          		LD	A,3
  EA7E  CDCBE9        		CALL	READY
  EA81  ED78          		IN	A,(C)
                      	
  EA83  C1            		POP	BC
  EA84  ED51          		OUT	(C),D
  EA86  ED59          		OUT	(C),E
  EA88  ED58          		IN	E,(C)
  EA8A  ED50          		IN	D,(C)
  EA8C  19            		ADD	HL,DE
  EA8D  D1            		POP	DE
  EA8E  13            		INC	DE
  EA8F  FB            		EI
  EA90  CDE8E9        		CALL	FDMOFF
  EA93  B7            		OR	A
  EA94  C8            		RET	Z
  EA95  1B            		DEC	DE
  EA96  CB67          		BIT	4,A
  EA98  C40CEA        		CALL	NZ,RNF
  EA9B                	DISKE2:
  EA9B  213EEA        		LD	HL,RETRY
  EA9E  35            		DEC	(HL)
  EA9F  20BE          		JR	NZ,DISK2
  EAA1  B7            		OR	A
  EAA2  2834          		JR	Z,ERR
  EAA4  D5            		PUSH	DE
  EAA5                	ERRF:
  EAA5  D1            		POP	DE
  EAA6                	DELP:
  EAA6  CD0CEA        		CALL	RNF
  EAA9  CDE8E9        		CALL	FDMOFF
  EAAC  3A85EC        		LD	A,(_SEEKSP)
  EAAF  87            		ADD	A,A
  EAB0  9F            		SBC	A,A
  EAB1  3825          		JR	C,ERR
  EAB3                	DELP1:
  EAB3  D5            		PUSH	DE
  EAB4  2112EA        		LD	HL,DEMES
  EAB7  CDFAD7        		CALL	MSX
  EABA  CD77D6        		CALL	KEYBC
  EABD                	DELP2:
  EABD  CD12DC        		CALL	INKEY
  EAC0  28FB          		JR	Z,DELP2
                      	
  EAC2  D1            		POP	DE
  EAC3  CD6EDF        		CALL	CAP
  EAC6  FE52          		CP	'R'
  EAC8  CA5AEA        		JP	Z,DISKR
  EACB  FE49          		CP	'I'
  EACD  2807          		JR	Z,IGNORE
  EACF  FE41          		CP	'A'
  EAD1  20E0          		JR	NZ,DELP1
  EAD3  C3F5D9        		JP	BOOT
  EAD6                	IGNORE:
  EAD6  3EFF          		LD	A,0FFH
  EAD8                	ERR:
  EAD8  BF            		CP	A
  EAD9  37            		SCF
  EADA  C9            		RET
                      	
  EADB                	SETDMA:
  EADB  01871F        		LD	BC,01F87H
  EADE                	SDMA:
  EADE  04            		INC	B
  EADF  EDA3          		OUTI
  EAE1  3D            		DEC	A
  EAE2  20FA          		JR	NZ,SDMA
  EAE4  C9            		RET
                      	
  EAE5  C37DFB0FFFFF2C	DMAD:	DB	0C3H,07DH,0FBH,00FH,0FFH,0FFH,02CH,010H		;X1turbo
  EAED  80928D0000CF01		DB	080H,092H,08DH,000H,000H,0CFH,001H,0CFH		;DISK DMA
                      	
                      	
                      	;	EMM DRIVER(DMA)
                      	
                      	
  EAF5                	EDWTC:
  EAF5  3E11          		LD	A,17
  EAF7  01            		DB	1
  EAF8                	EDRDC:
  EAF8  3E0F          		LD	A,15
  EAFA                	EDWTC1:
  EAFA  D5            		PUSH	DE
  EAFB  2237EB        		LD	(EDMAD+12),HL
  EAFE  EB            		EX	DE,HL
  EAFF  29            		ADD	HL,HL
  EB00  29            		ADD	HL,HL
  EB01  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  EB05  0E00          		LD	C,0
  EB07  09            		ADD	HL,BC
  EB08  ED4B84EC      		LD	BC,(_DRIVE)
  EB0C  060D          		LD	B,00DH
  EB0E  ED49          		OUT	(C),C
  EB10  0C            		INC	C
  EB11  ED69          		OUT	(C),L
  EB13  0C            		INC	C
  EB14  ED61          		OUT	(C),H
                      	
  EB16  212BEB        		LD	HL,EDMAD
  EB19  CDDBEA        		CALL	SETDMA
  EB1C  3EB3          		LD	A,0B3H
  EB1E  ED79          		OUT	(C),A
  EB20  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EB22  EB            		EX	DE,HL
  EB23  24            		INC	H
  EB24  24            		INC	H
  EB25  24            		INC	H
  EB26  24            		INC	H
  EB27  D1            		POP	DE
  EB28  13            		INC	DE
  EB29  AF            		XOR	A
  EB2A  C9            		RET
                      	
  EB2B  C37D030DFF032C	EDMAD:	DB	0C3H,07DH,003H,00DH,0FFH,003H,02CH,050H,002H
  EB34  809AAD0000CF01		DB	080H,09AH,0ADH,000H,000H,0CFH,001H,0CFH
                      	
                      	
                      	;	BANK RAM DISK DRIVER
                      	
                      	
  EB3C                	BDRDC:
  EB3C  ED735BEB      		LD	(BANKSP+1),SP
  EB40  3A5CEB        		LD	A,(BANKSP+2)
  EB43  87            		ADD	A,A
  EB44  3803          		JR	C,BDRDC1
  EB46  31D4FF        		LD	SP,EXTSP
  EB49                	BDRDC1:
  EB49  D5            		PUSH	DE
  EB4A  D9            		EXX
  EB4B  C5            		 PUSH	 BC
  EB4C  D5            		 PUSH	 DE
  EB4D  CD81EB        		 CALL	 BADR
  EB50  CD9EEB        		CALL	BTFR
  EB53  D9            		EXX
  EB54                	BDWTCE:
  EB54  D1            		 POP	 DE
  EB55  C1            		 POP	 BC
  EB56  D9            		 EXX
  EB57  D1            		POP	DE
  EB58  13            		INC	DE
  EB59  FB            		EI
  EB5A  310000        	BANKSP:	LD	SP,0
  EB5D  AF            		XOR	A
  EB5E  C9            		RET
                      	
  EB5F                	BDWTC:
  EB5F  ED735BEB      		LD	(BANKSP+1),SP
  EB63  3A5CEB        		LD	A,(BANKSP+2)
  EB66  87            		ADD	A,A
  EB67  3803          		JR	C,BDWTC1
  EB69  31D4FF        		LD	SP,EXTSP
  EB6C                	BDWTC1:
  EB6C  D5            		PUSH	DE
  EB6D  D9            		EXX
  EB6E  C5            		 PUSH	 BC
  EB6F  D5            		 PUSH	 DE
  EB70  CD81EB        		 CALL	 BADR
  EB73  D9            		EXX
  EB74  53            		 LD	D,E
  EB75  5F            		 LD	E,A
  EB76  D9            		 EXX
  EB77  EB            		EX	DE,HL
  EB78  CD9EEB        		CALL	BTFR
  EB7B  EB            		EX	DE,HL
  EB7C  D9            		EXX
  EB7D  ED51          		 OUT	 (C),D	 ;MAIN
  EB7F  18D3          		 JR	 BDWTCE
                      	
  EB81                	BADR:
  EB81  D9            		 EXX
  EB82  7B            		LD	A,E
  EB83  87            		ADD	A,A
  EB84  CB12          		RL	D
  EB86  87            		ADD	A,A
  EB87  CB12          		RL	D
  EB89  F5            		PUSH	AF
  EB8A  87            		ADD	A,A
  EB8B  7A            		LD	A,D
  EB8C  8F            		ADC	A,A
  EB8D  E60F          		AND	00FH
  EB8F  D9            		EXX
  EB90  01000B        		 LD	 BC,00B00H
  EB93  57            		 LD	 D,A	  ;BANK
  EB94  1E10          		 LD	 E,010H	  ;MAIN
  EB96  D9            		 EXX
  EB97  D1            		POP	DE
  EB98  0600          		LD	B,0
  EB9A  58            		LD	E,B
  EB9B  CBBA          		RES	7,D
  EB9D  C9            		RET
                      	
  EB9E                	BTFR:
  EB9E  D5            		PUSH	DE
  EB9F  F3            		DI
                      	
  EBA0                	BTFR1:
  EBA0  D9            		EXX
  EBA1  ED51          		 OUT	 (C),D	 ;BANK(MAIN)
  EBA3  D9            		 EXX
  EBA4  E3            		EX	(SP),HL
  EBA5  7E            		LD	A,(HL)
  EBA6  23            		INC	HL
  EBA7  4E            		LD	C,(HL)
  EBA8  23            		INC	HL
  EBA9  56            		LD	D,(HL)
  EBAA  23            		INC	HL
  EBAB  5E            		LD	E,(HL)
  EBAC  23            		INC	HL
  EBAD  E3            		EX	(SP),HL
  EBAE  D9            		EXX
  EBAF  ED59          		 OUT	 (C),E	 ;MAIN(BANK)
  EBB1  D9            		 EXX
  EBB2  77            		LD	(HL),A
  EBB3  23            		INC	HL
  EBB4  71            		LD	(HL),C
  EBB5  23            		INC	HL
  EBB6  72            		LD	(HL),D
  EBB7  23            		INC	HL
  EBB8  73            		LD	(HL),E
  EBB9  23            		INC	HL
  EBBA  10E4          		DJNZ	BTFR1
  EBBC  D1            		POP	DE
  EBBD  C9            		RET
                      	
                      	
                      	;	GRAPHIC RAM DISK DRIVER
                      	
                      	
  EBBE                	GDRDC:
  EBBE  CDE7EB        		CALL	GADR
  EBC1  D5            		PUSH	DE
  EBC2  110004        		LD	DE,0400H
  EBC5                	GDRDC1:
  EBC5  EDA2          		INI
  EBC7  04            		INC	B
  EBC8  03            		INC	BC
  EBC9  1D            		DEC	E
  EBCA  20F9          		JR	NZ,GDRDC1
  EBCC  15            		DEC	D
  EBCD  20F6          		JR	NZ,GDRDC1
  EBCF                	GDWTC2:
  EBCF  D1            		POP	DE
  EBD0  E6EF          		AND	0EFH		;BANK0
  EBD2  1821          		JR	S1FD0
                      	
  EBD4                	GDWTC:
  EBD4  CDE7EB        		CALL	GADR
  EBD7  D5            		PUSH	DE
  EBD8  110004        		LD	DE,0400H
  EBDB                	GDWTC1:
  EBDB  04            		INC	B
  EBDC  EDA3          		OUTI
  EBDE  03            		INC	BC
  EBDF  1D            		DEC	E
  EBE0  20F9          		JR	NZ,GDWTC1
  EBE2  15            		DEC	D
  EBE3  20F6          		JR	NZ,GDWTC1
  EBE5  18E8          		JR	GDWTC2
                      	
  EBE7                	GADR:
  EBE7  0E00          		LD	C,0
  EBE9  7B            		LD	A,E
  EBEA  87            		ADD	A,A
  EBEB  87            		ADD	A,A
  EBEC  C640          		ADD	A,040H
  EBEE  47            		LD	B,A
  EBEF  13            		INC	DE
  EBF0  3ABFEC        		LD	A,(WK1FD0)
  EBF3  F610          		OR	010H		;BANK1
  EBF5                	S1FD0:
  EBF5  C5            		PUSH	BC
  EBF6  32BFEC        		LD	(WK1FD0),A
  EBF9  01D01F        		LD	BC,01FD0H
  EBFC  ED79          		OUT	(C),A
  EBFE  C1            		POP	BC
  EBFF  C9            		RET
                      	
  1FE4                	AT_R	EQU	WTTRK-AT_WTTRK
                      	
  EC00                	_PE:
                      	
                      	;LDCALL.ASM
                      	
                      	;	LSX-Dodgers SYSTEM CALL
                      	
  EC00                		ORG	0EC00H
                      	
  EC00                	STABLE:
                      	;0
  EC00  0000ABD6B7D6BD		DW	 00000H,_SYS01,_SYS02,_SYS03
  EC08  EDD604D724D7FE		DW	_SYS04,_SYS05,_SYS06,_SYS07
  EC10  2CD76ED265D791		DW	_SYS08,_SYS09,_SYS0A,_SYS0B
  EC18  7DD283D292D2A5		DW	_SYS0C,_SYS0D,_SYS0E,_SYS0F
                      	;1
  EC20  1AD367D3C3D3F9		DW	_SYS10,_SYS11,_SYS12,_SYS13
  EC28  01D422D442D43A		DW	_SYS14,_SYS15,_SYS16,_SYS17
  EC30  A9D4AED4B3D4B9		DW	_SYS18,_SYS19,_SYS1A,_SYS1B
  EC38  6CD2E9D46CD2ED		DW	_SYS1C,_SYS1D,_SYS1E,_SYS1F
                      	;2
  EC40  6CD279D491D4F6		DW	_SYS20,_SYS21,_SYS22,_SYS23
  EC48  15D566D295E2BA		DW	_SYS24,_ERROR,_SYS26,_SYS27
  EC50  91D430D5A7D724		DW	_SYS28,_SYS29,_SYS2A,_SYS2B
  EC58  E1D724DE6CD253		DW	_SYS2C,_SYS2D,_SYS2E,_SYS2F
                      	;3
  EC60  4DD5          		DW	_SYS30
                      	
                      	;LDWORK.ASM
                      	
                      	;	LSX-Dodgers WORK
                      	
  0004                	DDS	EQU	4
  EC62                	DDTB:
  EC62  434F4E20      		DB	"CON "
  EC66  5AD3          		DW	OPENDD
  EC68  41555820      		DB	"AUX "
  EC6C  5AD3          		DW	OPENDD
  EC6E  50524E20      		DB	"PRN "
  EC72  5AD3          		DW	OPENDD
  EC74  4E554C20      		DB	"NUL "
  EC78  5AD3          		DW	OPENDD
                      	
  EC7A                		DS	2
  EC7C  00EE          	_FATBF:	DW	FATBF
  EC7E  00FA          	_DTBUF:	DW	DTBUF
                      	
  EC80  FF            	_CYL0:	DB	0FFH	;Cylinder
  EC81  FF            	_CYL1:	DB	0FFH	;Cylinder
  EC82  FF            	_CYL2:	DB	0FFH	;Cylinder
  EC83  FF            	_CYL3:	DB	0FFH	;Cylinder
  EC84  00            	_DRIVE:	DB	0	;unit number
  EC85  00            	_SEEKSP:DB	0	;Seek speed
  EC86  FF            	_ISEEK:	DB	0FFH	;
  EC87  00            	_DVSW:	DB	0
  EC88  00            	_DRV:	DB	0
  EC89  FF            	_DSK:	DB	0FFH
  EC8A  8000          	_DTA:	DW	00080H
  EC8C  0000          	_CTC:	DW	0
  EC8E  0000          	_TXADR:	DW	0
  EC90  0000          	_KEYPS	DW	0
  EC92  00FF          	_KEYD	DW	0FF00H
  EC94  C210          	_KEYSP:	DW	010C2H
  EC96  07            	_COLORF:DB	7
  EC97  18            	_LINE:	DB	LINE
                      	
  EC98  0000          	_FCB:	DW	0
  EC9A  0000          	_FBPS:	DW	0	;SEARCH FILES
  EC9C  0000          	_FBAD:	DW	0	;    //
  EC9E  00            	_FBCNT:	DB	0	;    //
  EC9F  00            	_FILEN:	DB	0
  ECA0  00            	_DIRF:	DB	0
  ECA1  00            	_MAXCYL:DB	0
  ECA2  00            	_WTFATF:DB	0
  ECA3  FF            	_FATDRV:DB	0FFH
  ECA4  00            	_WTDBF:	DB	0
  ECA5  FF            	_DBDRV:	DB	0FFH
  ECA6  0000          	_DCLPS:	DW	0
                      	
  ECA8                		DS	8
                      	
  ECB0  6F5059381F0219	CRTCD:	DB	06FH,050H,059H,038H,01FH,002H,019H,01CH
  ECB8  0007          		DB	000H,007H
  ECBA  80F8B0FF      		DW	0-80*LINE,0-80
  ECBE  0C            		DB	00CH
  ECBF  A0            	WK1FD0:	DB	0A0H
                      	
  ECC0  DBD5          	CTC0:	DW	INTCTCE
  ECC2  DBD5          	CTC1:	DW	INTCTCE
  ECC4  03D6          	CTC2:	DW	INTCTC2
  ECC6  DBD5          	CTC3:	DW	INTCTCE
  ECC8  9BD5          	INTVEC:	DW	INT
                      	
                      	;	JUMP
                      	
  ECCA  C312DC        	_INKEY:	JP	INKEY
  ECCD  C372D8        	_PRINT:	JP	PRINT
  ECD0  C360DB        	_SCRN:	JP	SCRN
  ECD3  C388DB        	_POS:	JP	POS
  ECD6  C3B7D9        	_LOC:	JP	LOC
  ECD9  C3D8E7        	_CHGDRV:JP	CHGDRV
  ECDC  C3ABE8        	_GETDPB:JP	GETDPB
  ECDF  C3BFE8        	_FFLUSH:JP	FFLUSH
  ECE2  C375E5        	_RDFATX:JP	RDFATX
  ECE5  C34AE6        	_RDFAT:	JP	RDFAT
  ECE8  C33FEA        	_WTTRK:	JP	WTTRK
  ECEB  C34CEA        	_FDRD:	JP	FDRD
  ECEE  C342EA        	_FDWT:	JP	FDWT
  ECF1  C3EBEC        	_DRD:	JP	_FDRD	;(Self-rewriting)
  ECF4  C3EEEC        	_DWT:	JP	_FDWT	;(Self-rewriting)
  ECF7  C3F7E5        	_GNCL:	JP	GNCL	;(Self-rewriting)
  ECFA  C31AE6        	_SNCL:	JP	SNCL	;(Self-rewriting)
  ECFD  C32CCD        	_COMANL:JP	COMANL
                      	
  ED00                	WE:
                      	
                      	;LDDPB.ASM
                      	
                      	;	LSX-Dodgers DPB
                      	
  ED00                	DEVICE:
                      	
                      	;	A:
                      	
  ED00  02            	DPB_00_FATLN:	DB	2
  ED01  FD            	DPB_01_FATID:	DB	0FDH
  ED02  EBEC          	DPB_02_DRDC:	DW	_FDRD
  ED04  EEEC          	DPB_04_DWTC:	DW	_FDWT
  ED06  08            	DPB_06_ADDCL:	DB	8
  ED07  29            	DPB_07_DBLCL:	DB	029H	;029H=1 sector:512 / 0=1 sector:1024
  ED08  6401          	DPB_08_MAXCL:	DW	356
  ED0A  FF            	DPB_0A_FDMODE:	DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED0B  0C            	DPB_0B_MAXDIR:	DB	12
  ED0C  28            	DPB_0C_MAXCYL:	DB	40
  ED0D  09            	DPB_0D_MAXSEC:	DB	9	;Number of sectors
  ED0E  01            	DPB_0E_FATPS:	DB	1
  ED0F  02            	DPB_0F_FATS:	DB	2	;bit7.0:1 cluster=1024 / bit7.1:1 cluster=512 | bit1.1=2FATS(use reserve)
  ED10  05            	DPB_10_DIRPS:	DB	5
  ED11  01            	DPB_11_MINSEC:	DB	1	;Minimum sector
  ED12  87            	DPB_12_DEVNO:	DB	087H	;Device Number
  ED13  00            	DPB_13_UNITNO:	DB	0
  ED14  0000          	DPB_14		DW	0
  ED16  0000          	DPB_16_GNCL:	DW	0
  ED18  0000          	DPB_18_SNCL:	DW	0
  ED1A  0000          	DPB_1A_SDIR:	DW	0
  ED1C  46444430      	DPB_1C_NAME:	DB	"FDD0"
                      	
                      	;	B:
                      	
  ED20  02            		DB	2
  ED21  FD            		DB	0FDH
  ED22  EBEC          		DW	_FDRD
  ED24  EEEC          		DW	_FDWT
  ED26  08            		DB	8
  ED27  29            		DB	029H	;029H=512 / 0=1024
  ED28  6401          		DW	356
  ED2A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED2B  0C            		DB	12
  ED2C  28            		DB	40
  ED2D  09            		DB	9
  ED2E  01            		DB	1
  ED2F  02            		DB	2
  ED30  05            		DB	5
  ED31  01            		DB	1
  ED32  87            		DB	087H	;Device Number
  ED33  01            		DB	1
  ED34  0000          		DW	0
  ED36  0000          		DW	0
  ED38  0000          		DW	0
  ED3A  0000          		DW	0
  ED3C  46444431      		DB	"FDD1"
                      	
                      	;	C:
                      	
  ED40  02            		DB	2
  ED41  FD            		DB	0FDH
  ED42  EBEC          		DW	_FDRD
  ED44  EEEC          		DW	_FDWT
  ED46  08            		DB	8
  ED47  29            		DB	029H	;029H=512 / 0=1024
  ED48  6401          		DW	356
  ED4A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED4B  0C            		DB	12
  ED4C  28            		DB	40
  ED4D  09            		DB	9
  ED4E  01            		DB	1
  ED4F  02            		DB	2
  ED50  05            		DB	5
  ED51  01            		DB	1
  ED52  87            		DB	087H	;Device Number
  ED53  02            		DB	2
  ED54  0000          		DW	0
  ED56  0000          		DW	0
  ED58  0000          		DW	0
  ED5A  0000          		DW	0
  ED5C  46444432      		DB	"FDD2"
                      	
                      	;	D:
                      	
  ED60  02            		DB	2
  ED61  FD            		DB	0FDH
  ED62  EBEC          		DW	_FDRD
  ED64  EEEC          		DW	_FDWT
  ED66  08            		DB	8
  ED67  29            		DB	029H	;029H=512 / 0=1024
  ED68  6401          		DW	356
  ED6A  FF            		DB	0FFH	;0FFH=2D / 0FEH=2HD
  ED6B  0C            		DB	12
  ED6C  28            		DB	40
  ED6D  09            		DB	9
  ED6E  01            		DB	1
  ED6F  02            		DB	2
  ED70  05            		DB	5
  ED71  01            		DB	1
  ED72  87            		DB	087H	;Device Number
  ED73  03            		DB	3
  ED74  0000          		DW	0
  ED76  0000          		DW	0
  ED78  0000          		DW	0
  ED7A  0000          		DW	0
  ED7C  46444433      		DB	"FDD3"
                      	
                      	;	E:
                      	
  ED80  00            	EMMFL:	DB	0
  ED81  FE            		DB	0FEH
  ED82  F8EA          	EMMRD:	DW	EDRDC
  ED84  F5EA          	EMMWR:	DW	EDWTC
  ED86  09            		DB	9
  ED87  00            		DB	0
  ED88  0000          	EMMCL:	DW	0
  ED8A  00            		DB	0
  ED8B  0B            		DB	11
  ED8C  00            	EMMBL:	DB	0
  ED8D  01            		DB	1
  ED8E  01            		DB	1
  ED8F  01            		DB	1
  ED90  05            		DB	5
  ED91  01            		DB	1
  ED92  06            		DB	6	;Device Number
  ED93  00            	EMMDV:	DB	0
  ED94  0000          		DW	0
  ED96  0000          		DW	0
  ED98  0000          		DW	0
  ED9A  0000          		DW	0
  ED9C  454D4D30      		DB	"EMM0"
                      	
                      	;	F:
                      	
  EDA0  00            	BANKFL:	DB	0
  EDA1  F9            		DB	0F9H
  EDA2  3CEB          		DW	BDRDC
  EDA4  5FEB          		DW	BDWTC
  EDA6  03            		DB	3
  EDA7  00            		DB	0
  EDA8  0000          	BANKCL:	DW	0
  EDAA  00            		DB	0
  EDAB  05            		DB	5
  EDAC  00            		DB	0
  EDAD  01            		DB	1
  EDAE  00            		DB	0
  EDAF  01            		DB	1
  EDB0  01            		DB	1
  EDB1  01            		DB	1
  EDB2  0B            		DB	00BH	;Device Number
  EDB3  00            		DB	0
  EDB4  0000          		DW	0
  EDB6  0000          		DW	0
  EDB8  0000          		DW	0
  EDBA  0000          		DW	0
  EDBC  4252414D      		DB	"BRAM"
                      	
                      	;	G:
                      	
  EDC0  01            		DB	1
  EDC1  F9            		DB	0F9H
  EDC2  BEEB          		DW	GDRDC
  EDC4  D4EB          		DW	GDWTC
  EDC6  00            		DB	0
  EDC7  00            		DB	0
  EDC8  3000          		DW	48
  EDCA  00            		DB	0
  EDCB  02            		DB	2
  EDCC  00            		DB	0
  EDCD  01            		DB	1
  EDCE  00            		DB	0
  EDCF  01            		DB	1
  EDD0  01            		DB	1
  EDD1  01            		DB	1
  EDD2  05            		DB	5	;Device Number
  EDD3  01            		DB	1
  EDD4  0000          		DW	0
  EDD6  0000          		DW	0
  EDD8  0000          		DW	0
  EDDA  0000          		DW	0
  EDDC  4752414D      		DB	"GRAM"
                      	
                      	
                      	
  EDE0  00            	LDEND:	DB	0
                      	
  EDE1                		END
