			  Z80 ASSEMBLER - ZASM VER 1.6
                      	;	LSX-Dodgers for X1/turbo/Z
                      	;	Programmed by
                      	;	Gaku (Lovers/Tablacus)
                      	
  C600                	RUN	EQU	0C600h
                      	
  C5F9                		ORG	RUN-7
                      	
                      	;	MSX BINARY HEADER
  C5F9  FE            		DB	0FEH
                      	;	MSX BINARY START ADDRESS
  C5FA  00C6          		DW	RUN
                      	;	MSX BINARY END ADDRESS
  C5FC  E0ED          		DW	LDEND
                      	;	MSX BINARY EXEC ADDRESS
  C5FE  00C6          		DW	RUN
                      	;LDDEF.ASM
                      	
                      	;	LSX-Dodgers DEF
                      	
  1D80                	MAC	EQU	01D80H		;X1
  0001                	VER_1   EQU 1
  0002                	VER_2   EQU 2
  0006                	VER_3   EQU 6
  0126                	VER	EQU	VER_1 * 256 + VER_2 * 16 + VER_3
                      	
  0000                	STACK	EQU	00000H
  0005                	SYSTEM	EQU	00005H
  000F                	K_HL	EQU	0000FH
  005C                	FCB1	EQU	0005CH
  006C                	FCB2	EQU	0006CH
  0080                	DTA1	EQU	00080H
  00DB                	FDRV	EQU	00100H-37
  00DC                	FNAME	EQU	FDRV+1
  00D6                	DECBF	EQU	FDRV-5
  EE00                	FATBF	EQU	0EE00H
  FA00                	DTBUF	EQU	0FA00H
  FE00                	KEYBF	EQU	0FE00H
  FF00                	KBUF	EQU	0FF00H
  FF51                	DTA	EQU	KBUF+81
  FFD4                	EXTSP	EQU	0FFD4H
  0018                	LINE	EQU	24
                      	
                      	;LDINIT.ASM
                      	
                      	;	LSX-Dodgers INIT
                      	
  C600  C307C6        		JP	START
  C603  801D          	MACHINE:DW	MAC
  C605  2601          	VERSION:DW	VER
                      	
  C607                	START:
  C607  F3            		DI
  C608  ED5E          		IM	2
  C60A  310000        		LD	SP,STACK
  C60D  3E1E          		LD	A,01EH
  C60F  D300          		OUT	(0),A
                      	
  C611  010000        		LD	BC,0
  C614  ED438CEC      		LD	(_CTC),BC
  C618  01040A        		LD	BC,00A04H
  C61B  CD48C9        		CALL	CHKCTC
  C61E  010407        		LD	BC,00704H
  C621  CD48C9        		CALL	CHKCTC
  C624  01A81F        		LD	BC,01FA8H
  C627  CD48C9        		CALL	CHKCTC
  C62A  01A01F        		LD	BC,01FA0H
  C62D  CD48C9        		CALL	CHKCTC
                      	;
  C630                	INISIO:
  C630  01911F        		LD	BC,01F91H	;INIT SIO
  C633  1601          		LD	D,1
  C635  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C637  ED71          		DB	0EDH,071H
  C639  0E93          		LD	C,093H
  C63B  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C63D  ED71          		DB	0EDH,071H
  C63F  0E99          		LD	C,099H		;INIT SIO
  C641  1601          		LD	D,1
  C643  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C645  ED71          		DB	0EDH,071H
  C647  0E9B          		LD	C,09BH
  C649  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C64B  ED71          		DB	0EDH,071H
                      	
  C64D  0E80          		LD	C,080H		;INIT DMA
  C64F  2106C3        		LD	HL,0C306H
  C652                	INIDMA:
  C652  ED61          		OUT	(C),H
  C654  2D            		DEC	L
  C655  20FB          		JR	NZ,INIDMA
                      	
  C657  3EE4          		LD	A,0E4H
  C659  CD59DA        		CALL	COMOUT
  C65C  AF            		XOR	A
  C65D  CD33DA        		CALL	OT49SB
                      	
  C660  3EEC          		LD	A,INTVEC/256
  C662  ED47          		LD	I,A
                      	
  C664  ED4B8CEC      		LD	BC,(_CTC)
  C668  0B            		DEC	BC
  C669  0B            		DEC	BC
                      	
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C66A  ED71          		DB	0EDH,071H
  C66C  3EC0          		LD	A,CTC0
  C66E  ED79          		OUT	(C),A
                      	
  C670  0C            		INC	C
  C671  3E47          		LD	A,047H
  C673  ED79          		OUT	(C),A
  C675  3E0D          		LD	A,13		;Baudrate 9600-13
  C677  ED79          		OUT	(C),A
                      	
  C679  79            		LD	A,C
  C67A  D610          		SUB	010H
  C67C  4F            		LD	C,A
  C67D  ED43BCD6      		LD	(SIOAD+1),BC
  C681  ED43E5D6      		LD	(SIOAD0+1),BC
  C685  ED43EBD6      		LD	(SIOAD1+1),BC
                      	
  C689  21F1C9        		LD	HL,SIODATA
  C68C                	SINIT1:
  C68C  7E            		LD	A,(HL)
  C68D  23            		INC	HL
  C68E  FEFF          		CP	0FFH
  C690  2804          		JR	Z,SINIT2
  C692  ED79          		OUT	(C),A
  C694  18F6          		JR	SINIT1
  C696                	SINIT2:
  C696  3EE4          		LD	A,0E4H
  C698  CD59DA        		CALL	COMOUT
  C69B  3EC8          		LD	A,INTVEC
  C69D  CD33DA        		CALL	OT49SB
                      	;
  C6A0  01C41F        		LD	BC,01FC4H
  C6A3  3E0C          		LD	A,00CH
  C6A5  ED79          		OUT	(C),A
                      	
  C6A7  0EC0          		LD	C,0C0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6A9  ED71          		DB	0EDH,071H
                      	
  C6AB  0C            		INC	C
  C6AC  3E28          		LD	A,40
  C6AE  ED79          		OUT	(C),A
                      	
  C6B0  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B1  ED71          		DB	0EDH,071H
                      	
  C6B3  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B4  ED71          		DB	0EDH,071H
                      	
  C6B6  0EC5          		LD	C,0C5H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6B8  ED71          		DB	0EDH,071H
                      	
  C6BA                	TEXT:
  C6BA  0EB0          		LD	C,0B0H
  C6BC  3E80          		LD	A,080H
  C6BE  ED79          		OUT	(C),A
  C6C0  1607          		LD	D,7
  C6C2  0EB9          		LD	C,0B9H
  C6C4  21EAC9        		LD	HL,TEXTDT
  C6C7                	TEXT1:
  C6C7  04            		INC	B
  C6C8  EDA3          		OUTI
  C6CA  0C            		INC	C
  C6CB  15            		DEC	D
  C6CC  20F9          		JR	NZ,TEXT1
  C6CE  01B01F        		LD	BC,01FB0H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D1  ED71          		DB	0EDH,071H
                      	
  C6D3  0EC4          		LD	C,0C4H
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C6D5  ED71          		DB	0EDH,071H
                      	
  C6D7  01011A        		LD	BC,01A01H
  C6DA  ED78          		IN	A,(C)
  C6DC  E608          		AND	8
  C6DE  2809          		JR	Z,PRN
  C6E0  0E03          		LD	C,003H
  C6E2  3E0F          		LD	A,00FH
  C6E4  ED79          		OUT	(C),A
  C6E6  01040A        		LD	BC,00A04H
  C6E9                	PRN:
  C6E9  110100        		LD	DE,1
  C6EC  62            		LD	H,D
  C6ED  6A            		LD	L,D
  C6EE  017F00        		LD	BC,07FH
  C6F1  36FF          		LD	(HL),0FFH
  C6F3  EDB0          		LDIR
  C6F5  017F00        		LD	BC,07FH
  C6F8  3600          		LD	(HL),0
  C6FA  EDB0          		LDIR
                      	
  C6FC  3EC3          		LD	A,0C3H		;JP
  C6FE  21F4D9        		LD	HL,WBOOT
  C701  320000        		LD	(00000H),A
  C704  220100        		LD	(00001H),HL	;IPL
                      	
  C707  2A03C6        		LD	HL,(MACHINE)	;3 bit7  DPB Original(1)
  C70A  220300        		LD	(00003H),HL	;  bit6-0 Machine X1(0)
                      	;				;4 LSX-Dodgers(01DH)
  C70D  2106CC        		LD	HL,BDOS
  C710  320500        		LD	(00005H),A
  C713  220600        		LD	(00006H),HL	;BDOS
                      	
  C716  2174D5        		LD	HL,BIOS
  C719  321800        		LD	(00018H),A	;BIOS-ROM
  C71C  221900        		LD	(00019H),HL
                      	
  C71F  210000        		LD	HL,0
  C722  323800        		LD	(00038H),A	;RST038H
  C725  223900        		LD	(00039H),HL
                      	
  C728  3EEC          		LD	A,STABLE/256
  C72A  320B00        		LD	(0000BH),A
                      	
  C72D  3EE9          		LD	A,0E9H		;JP (HL)
  C72F  320F00        		LD	(0000FH),A
                      	
  C732  3A7DEC        		LD	A,(_FATBF+1)
  C735  321300        		LD	(00013H),A
                      	
  C738  3A7FEC        		LD	A,(_DTBUF+1)
  C73B  321700        		LD	(00017H),A
                      	
  C73E  3EFE          		LD	A,KEYBF/256
  C740  321B00        		LD	(0001BH),A
                      	
  C743  3EFF          		LD	A,KBUF/256
  C745  321F00        		LD	(0001FH),A
                      	
  C748  2A05C6        		LD	HL,(VERSION)
  C74B  225A00        		LD	(0005AH),HL
                      	
  C74E  3EE6          		LD	A,0E6H
  C750  CD59DA        		CALL	COMOUT
  C753  CD3EDA        		CALL	IN49SB
  C756  F5            		PUSH	AF
  C757  CD3EDA        		CALL	IN49SB
  C75A  F1            		POP	AF
  C75B  F5            		PUSH	AF
  C75C  E612          		AND	012H
  C75E  2005          		JR	NZ,KEYR
  C760  3E01          		LD	A,1
  C762  329DC8        		LD	(KEYREP+1),A
  C765                	KEYR:
  C765  F1            		POP	AF
  C766  E603          		AND	3
  C768  280E          		JR	Z,NON
                      	
  C76A  01D03F        		LD	BC,03FD0H
  C76D  ED49          		OUT	(C),C
  C76F  3E37          		LD	A,037H
  C771  D3D0          		OUT	(0D0H),A
  C773  ED78          		IN	A,(C)
  C775  B9            		CP	C
  C776  285C          		JR	Z,TURBO
  C778                	NON:
  C778  3D            		DEC	A		;A=0FFH
  C779  321800        		LD	(00018H),A	;BIOS-ROM
                      	
  C77C  21FDC9        		LD	HL,AT_SCR1
  C77F  11E2DA        		LD	DE,SCR1
  C782  015E00        		LD	BC,AT_SCRE-AT_SCR1
  C785  EDB0          		LDIR
                      	
  C787  215BCA        		LD	HL,AT_WTTRK
  C78A  113FEA        		LD	DE,WTTRK
  C78D  017501        		LD	BC,AT_CPUE-AT_WTTRK
  C790  EDB0          		LDIR
                      	
  C792  2192EA        		LD	HL,AT_DRD+AT_R
  C795  22ECEC        		LD	(_FDRD+1),HL
  C798  2143EA        		LD	HL,AT_DWT+AT_R
  C79B  22EFEC        		LD	(_FDWT+1),HL
  C79E  212AEB        		LD	HL,AT_EDRDC+AT_R
  C7A1  2282ED        		LD	(EMMRD),HL
  C7A4  213EEB        		LD	HL,AT_EDWTC+AT_R
  C7A7  2284ED        		LD	(EMMWR),HL
                      	
  C7AA  2159EA        		LD	HL,DWTPAT+AT_R
  C7AD  22AFE9        		LD	(AT_FDCPAT+1),HL
                      	
  C7B0  210000        		LD	HL,0
  C7B3  2284DA        		LD	(X1PAT),HL
                      	
  C7B6  3EAF          		LD	A,0AFH		;XOR	A
  C7B8  3283D8        		LD	(X1KPAT),A
                      	
  C7BB  2181DB        		LD	HL,SCRNX
  C7BE  22D1EC        		LD	(_SCRN+1),HL
                      	
  C7C1  CD6FC9        		CALL	SETCRTC
  C7C4  0610          		LD	B,010H		;PALET
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7C6  ED71          		DB	0EDH,071H
  C7C8  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7C9  ED71          		DB	0EDH,071H
  C7CB  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CC  ED71          		DB	0EDH,071H
  C7CE  04            		INC	B
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C7CF  ED71          		DB	0EDH,071H
  C7D1  C359C8        		JP	NOBANK
                      	
  C7D4                	TURBO:
  C7D4  3E1F          		LD	A,01FH
  C7D6  DBF0          		IN	A,(0F0H)
  C7D8  0F            		RRCA
  C7D9  380B          		JR	C,CRT1
  C7DB  21DAC9        		LD	HL,_C8025H
  C7DE  11B0EC        		LD	DE,CRTCD
  C7E1  011000        		LD	BC,16
  C7E4  EDB0          		LDIR
  C7E6                	CRT1:
  C7E6  CD6FC9        		CALL	SETCRTC
  C7E9  01AA10        		LD	BC,010AAH	;PALET
  C7EC  ED49          		OUT	(C),C
  C7EE  01CC11        		LD	BC,011CCH
  C7F1  ED49          		OUT	(C),C
  C7F3  01F012        		LD	BC,012F0H
  C7F6  ED49          		OUT	(C),C
  C7F8  04            		INC	B
  C7F9  ED71          		DB	0EDH,071H
                      	
  C7FB  3E1F          		LD	A,01FH
  C7FD  DBF0          		IN	A,(0F0H)
  C7FF  CB57          		BIT	2,A
  C801  2825          		JR	Z,BANK
                      	
  C803  AF            		XOR	A
  C804                	TZ1:
  C804  F5            		PUSH	AF
  C805  CDDCEC        		CALL	_GETDPB
  C808  DD7E12        		LD	A,(IX+012H)
  C80B  FE87          		CP	087H
  C80D  2013          		JR	NZ,TZ2
  C80F  DDE5          		PUSH	IX
  C811  D1            		POP	DE
  C812  210FE9        		LD	HL,M2HD
  C815  EDA0          		LDI
  C817  EDA0          		LDI
  C819  13            		INC	DE
  C81A  13            		INC	DE
  C81B  13            		INC	DE
  C81C  13            		INC	DE
  C81D  010C00        		LD	BC,12
  C820  EDB0          		LDIR
  C822                	TZ2:
  C822  F1            		POP	AF
  C823  3C            		INC	A
  C824  FE08          		CP	8
  C826  38DC          		JR	C,TZ1
                      	
  C828                	BANK:
  C828  01000B        		LD	BC,00B00H
  C82B  21007F        		LD	HL,07F00H
  C82E  F3            		DI
  C82F                	BANK1:
  C82F  ED69          		OUT	(C),L
  C831  5E            		LD	E,(HL)
  C832  7B            		LD	A,E
  C833  C6A5          		ADD	A,0A5H
  C835  77            		LD	(HL),A
  C836  BE            		CP	(HL)
  C837  73            		LD	(HL),E
  C838  2005          		JR	NZ,BANK2
  C83A  2C            		INC	L
  C83B  CB65          		BIT	4,L
  C83D  28F0          		JR	Z,BANK1
  C83F                	BANK2:
  C83F  3E10          		LD	A,010H
  C841  ED79          		OUT	(C),A
  C843  7D            		LD	A,L
  C844  B7            		OR	A
  C845  2812          		JR	Z,NOBANK
  C847  2600          		LD	H,0
  C849  29            		ADD	HL,HL
  C84A  29            		ADD	HL,HL
  C84B  29            		ADD	HL,HL
  C84C  29            		ADD	HL,HL
  C84D  29            		ADD	HL,HL
  C84E  2B            		DEC	HL
  C84F  2B            		DEC	HL
  C850  2B            		DEC	HL
  C851  22A8ED        		LD	(BANKCL),HL
  C854  3E01          		LD	A,1
  C856  32A0ED        		LD	(BANKFL),A
  C859                	NOBANK:
  C859                	EMM:
  C859  CD38C9        		CALL	EADR0
  C85C  ED78          		IN	A,(C)
  C85E  F5            		PUSH	AF
                      	
  C85F  110000        		LD	DE,0
  C862                	ECHECK1:
  C862  13            		INC	DE
  C863  CD1BC9        		CALL	EADR2
  C866  ED60          		IN	H,(C)
  C868  CD1BC9        		CALL	EADR2
  C86B  7C            		LD	A,H
  C86C  C6E5          		ADD	A,0E5H
  C86E  ED79          		OUT	(C),A
  C870  3C            		INC	A
  C871  CD38C9        		CALL	EADR0
  C874  ED79          		OUT	(C),A
  C876  3D            		DEC	A
  C877  CD1BC9        		CALL	EADR2
  C87A  ED68          		IN	L,(C)
  C87C  CD1BC9        		CALL	EADR2
  C87F  ED61          		OUT	(C),H
  C881  BD            		CP	L
  C882  2004          		JR	NZ,ECHECK2
  C884  CB5A          		BIT	3,D
  C886  28DA          		JR	Z,ECHECK1
  C888                	ECHECK2:
  C888  CD38C9        		CALL	EADR0
  C88B  F1            		POP	AF
  C88C  ED79          		OUT	(C),A
                      	
  C88E  21F7FF        		LD	HL,0-9
  C891  19            		ADD	HL,DE
  C892  3008          		JR	NC,NOEMM
  C894  2288ED        		LD	(EMMCL),HL
  C897  3E03          		LD	A,3
  C899  3280ED        		LD	(EMMFL),A
  C89C                	NOEMM:
  C89C  3E00          	KEYREP:	LD	A,000H
  C89E  B7            		OR	A
  C89F  2807          		JR	Z,KEYR1
  C8A1  010000        		LD	BC,0
  C8A4  ED438CEC      		LD	(_CTC),BC
  C8A8                	KEYR1:
  C8A8  0130F8        		LD	BC,0-80*25
  C8AB  2ABAEC        		LD	HL,(CRTCD+10)
  C8AE  ED43BAEC      		LD	(CRTCD+10),BC
  C8B2  1E0C          		LD	E,00CH
  C8B4  CDCDEC        		CALL	_PRINT
  C8B7  22BAEC        		LD	(CRTCD+10),HL
                      	
  C8BA  219AC9        		LD	HL,INIMES
  C8BD                	INIMES1:
  C8BD  7E            		LD	A,(HL)
  C8BE  23            		INC	HL
  C8BF  B7            		OR	A
  C8C0  2806          		JR	Z,INIMES2
  C8C2  5F            		LD	E,A
  C8C3  CDCDEC        		CALL	_PRINT
  C8C6  18F5          		JR	INIMES1
  C8C8                	INIMES2:
  C8C8  3A87FF        		LD	A,(0FF87H)
  C8CB  FE08          		CP	8
  C8CD  301E          		JR	NC,INIT0
  C8CF  5F            		LD	E,A
  C8D0  C641          		ADD	A,'A'
  C8D2  3297C9        		LD	(AUTODV),A
  C8D5  0E0E          		LD	C,00EH
  C8D7  CD0500        		CALL	SYSTEM
  C8DA  1C            		INC	E
  C8DB  2185EC        		LD	HL,_SEEKSP	;Disk error Ignore
  C8DE  CBFE          		SET	7,(HL)
  C8E0  0E1B          		LD	C,01BH
  C8E2  CD0500        		CALL	SYSTEM
  C8E5  2185EC        		LD	HL,_SEEKSP
  C8E8  CBBE          		RES	7,(HL)
                      	
  C8EA  3C            		INC	A
  C8EB  2008          		JR	NZ,INIT1
  C8ED                	INIT0:
  C8ED  1E00          		LD	E,0
  C8EF  0E0E          		LD	C,00EH
  C8F1  CD0500        		CALL	SYSTEM
  C8F4  AF            		XOR	A
  C8F5                	INIT1:
  C8F5  2100FF        		LD	HL,0FF00H
  C8F8  1101FF        		LD	DE,0FF01H
  C8FB  01FF00        		LD	BC,000FFH
  C8FE  75            		LD	(HL),L
  C8FF  EDB0          		LDIR
                      	
  C901  210000        		LD	HL,0
  C904  E5            		PUSH	HL
  C905  B7            		OR	A
  C906  C8            		RET	Z
                      	
  C907  3EE6          		LD	A,0E6H
  C909  CD59DA        		CALL	COMOUT
  C90C  CD3EDA        		CALL	IN49SB
  C90F  CD3EDA        		CALL	IN49SB
  C912  FE1B          		CP	01BH
  C914  C8            		RET	Z
  C915  118EC9        		LD	DE,AUTOD
  C918  C3FDEC        		JP	_COMANL
                      	
  C91B                	EADR2:
  C91B  D5            		PUSH	DE
  C91C  EB            		EX	DE,HL
  C91D  29            		ADD	HL,HL
  C91E  29            		ADD	HL,HL
  C91F  ED4B8BED      		LD	BC,(EMMBL-1)
  C923  0E00          		LD	C,0
  C925  09            		ADD	HL,BC
  C926  ED4B93ED      		LD	BC,(EMMDV)
  C92A  060D          		LD	B,00DH
  C92C  ED49          		OUT	(C),C
  C92E  0C            		INC	C
  C92F  ED69          		OUT	(C),L
  C931  0C            		INC	C
  C932  ED61          		OUT	(C),H
  C934  0C            		INC	C
  C935  EB            		EX	DE,HL
  C936  D1            		POP	DE
  C937  C9            		RET
                      	
  C938                	EADR0:
  C938  ED4B93ED      		LD	BC,(EMMDV)
  C93C  060D          		LD	B,00DH
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C93E  ED71          		DB	0EDH,071H
  C940  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C941  ED71          		DB	0EDH,071H
  C943  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C944  ED71          		DB	0EDH,071H
  C946  0C            		INC	C
  C947  C9            		RET
                      	
  C948                	CHKCTC:
  C948  C5            		PUSH	BC
  C949  110347        		LD	DE,04703H
  C94C                	INICTC1:
  C94C  0C            		INC	C
  C94D  ED51          		OUT	(C),D
                      	;	OUT	(C),0		;未定義命令ニーモニック
  C94F  ED71          		DB	0EDH,071H
  C951  1D            		DEC	E
  C952  20F8          		JR	NZ,INICTC1
  C954  C1            		POP	BC
                      	
  C955  11FA07        		LD	DE,007FAH
  C958  ED51          		OUT	(C),D
  C95A  ED59          		OUT	(C),E
  C95C  ED78          		IN	A,(C)
  C95E  BB            		CP	E
  C95F  C0            		RET	NZ
  C960  ED51          		OUT	(C),D
  C962  ED51          		OUT	(C),D
  C964  ED78          		IN	A,(C)
  C966  BA            		CP	D
  C967  C0            		RET	NZ
  C968  03            		INC	BC
  C969  03            		INC	BC
  C96A  ED438CEC      		LD	(_CTC),BC
  C96E  C9            		RET
                      	
  C96F                	SETCRTC:
  C96F  21B0EC        		LD	HL,CRTCD
  C972  AF            		XOR	A
  C973                	SETCRT1:
  C973  010018        		LD	BC,01800H
  C976  ED79          		OUT	(C),A
  C978  0C            		INC	C
  C979  04            		INC	B
  C97A  EDA3          		OUTI
  C97C  3C            		INC	A
  C97D  FE0C          		CP	12
  C97F  20F2          		JR	NZ,SETCRT1
  C981  23            		INC	HL
  C982  23            		INC	HL
  C983  01031B        		LD	BC,01A03H+00100H
  C986  EDA3          		OUTI
  C988  01D020        		LD	BC,01FD0H+00100H
  C98B  EDA3          		OUTI
  C98D  C9            		RET
                      	
  C98E  4155544F455845	AUTOD:	DB	"AUTOEXEC "
  C997  413A00        	AUTODV:	DB	"A:",0
                      	
  C99A  A54C53582D446F	INIMES:	DB	0A5H, "LSX-Dodgers for X1/turbo version "
  C9BC  312E          		DB	030H + VER_1, '.'
  C9BE  3236          		DB	030H + VER_2 ,030H + VER_3
  C9C0  2047616B752028		DB	' Gaku (Lovers/Tablacus)',0DH,0AH
  C9D9  00            		DB	0
                      	
  C9DA                	_C8025H:
  C9DA  6B5059881B0119		DB	06BH,050H,059H,088H,01BH,001H,019H,01AH
  C9E2  000F          		DB	000H,00FH
  C9E4  80F8B0FF      		DW	0-80*LINE,0-80
  C9E8  0CA3          		DB	00CH,0A3H
                      	
  C9EA  030C0F30333C3F	TEXTDT:	DB	003H,00CH,00FH,030H,033H,03CH,03FH
                      	
  C9F1                	SIODATA:
  C9F1  18            		DB	018H
  C9F2  0100          		DB	1,0
  C9F4  0200          		DB	2,0
  C9F6  03C1          		DB	3,0C1H
  C9F8  0444          		DB	4,044H
  C9FA  05E8          		DB	5,0E8H
  C9FC  FF            		DB	0FFH
                      	
  C9FD                	AT_SCR1:
  C9FD  D9            		EXX
  C9FE  C5            		PUSH	BC
  C9FF  015020        		LD	BC,02000H+80
  CA02  D9            		EXX
  CA03  C5            		PUSH	BC
  CA04  010020        		LD	BC,02000H
                      	
  CA07  67            		LD	H,A
  CA08  B7            		OR	A
  CA09                	AT_SCRUP1:
  CA09  2815          		JR	Z,AT_SCRCL
  CA0B  C5            		PUSH	BC
  CA0C  CBE0          		SET	4,B
  CA0E  D9            		EXX
  CA0F  C5            		PUSH	BC
  CA10  CBE0          		SET	4,B
  CA12  D9            		EXX
  CA13  CD6DEB        		CALL	AT_UPSUB+AT_R
  CA16  D9            		EXX
  CA17  C1            		POP	BC
  CA18  D9            		EXX
  CA19  C1            		POP	BC
  CA1A  CD6DEB        		CALL	AT_UPSUB+AT_R
  CA1D  25            		DEC	H
  CA1E  18E9          		JR	AT_SCRUP1
                      	
  CA20                	AT_SCRCL:
  CA20  211020        		LD	HL,02000H+16
  CA23  3A96EC        		LD	A,(_COLORF)
  CA26                	AT_SCRCL1:
  CA26  CBE0          		SET	4,B
  CA28  ED61          		OUT	(C),H
  CA2A  CBA0          		RES	4,B
  CA2C  ED79          		OUT	(C),A
  CA2E  03            		INC	BC
  CA2F  CBE0          		SET	4,B
  CA31  ED61          		OUT	(C),H
  CA33  CBA0          		RES	4,B
  CA35  ED79          		OUT	(C),A
  CA37  03            		INC	BC
  CA38  CBE0          		SET	4,B
  CA3A  ED61          		OUT	(C),H
  CA3C  CBA0          		RES	4,B
  CA3E  ED79          		OUT	(C),A
  CA40  03            		INC	BC
  CA41  CBE0          		SET	4,B
  CA43  ED61          		OUT	(C),H
  CA45  CBA0          		RES	4,B
  CA47  ED79          		OUT	(C),A
  CA49  03            		INC	BC
  CA4A  CBE0          		SET	4,B
  CA4C  ED61          		OUT	(C),H
  CA4E  CBA0          		RES	4,B
  CA50  ED79          		OUT	(C),A
  CA52  03            		INC	BC
  CA53  2D            		DEC	L
  CA54  20D0          		JR	NZ,AT_SCRCL1
  CA56  C1            		POP	BC
  CA57  D9            		EXX
  CA58  C1            		POP	BC
  CA59  D9            		EXX
  CA5A  C9            		RET
                      	
  CA5B                	AT_SCRE:
                      	
                      	;	FLOPPY DISK DRIVER(CPU)
                      	
  CA5B                	AT_WTTRK:
  CA5B  3EF0          		LD	A,0F0H
  CA5D  1802          		JR	AT_WTTRK1
                      	
  CA5F                	AT_DWT:
  CA5F  3EA0          		LD	A,0A0H
  CA61                	AT_WTTRK1:
  CA61  325AEA        		LD	(DWTPAT+1+AT_R),A
                      	
  CA64  3E02          		LD	A,2		;Retry count
  CA66  323EEA        		LD	(RETRY),A
                      	
  CA69                	DWT0:
  CA69  D5            		PUSH	DE
  CA6A  E5            		PUSH	HL
  CA6B  2210EB        		LD	(DHLPAT+1+AT_R),HL
  CA6E  CD48E9        		CALL	SEEK		;Write disk
  CA71  E1            		POP	HL
  CA72  3830          		JR	C,ERRDW
  CA74  F3            		DI
  CA75  3EA0          	DWTPAT:	LD	A,0A0H
  CA77  CDF4E9        		CALL	SECSET
  CA7A  0EFB          		LD	C,0FBH
                      	
  CA7C                	DWT1:
  CA7C  56            		LD	D,(HL)
  CA7D                	DWT2:
  CA7D  78            		LD	A,B
  CA7E  DBF8          		IN	A,(0F8H)
  CA80  0F            		RRCA
  CA81  3008          		JR	NC,DWT4
  CA83  0F            		RRCA
  CA84  30F7          		JR	NC,DWT2
  CA86                	DWT3:
  CA86  ED51          		OUT	(C),D
  CA88  23            		INC	HL
  CA89  18F1          		JR	DWT1
                      	
  CA8B                	DWT4:
  CA8B  3D            		DEC	A
  CA8C  28F8          		JR	Z,DWT3
  CA8E  3C            		INC	A
  CA8F  FB            		EI
  CA90  D1            		POP	DE
  CA91  13            		INC	DE
  CA92  CDE8E9        		CALL	FDMOFF
  CA95  C8            		RET	Z
  CA96  CDDBEA        		CALL	DISKC+AT_R
  CA99  20CE          		JR	NZ,DWT0
  CA9B  B7            		OR	A
  CA9C  C8            		RET	Z
  CA9D                	ERRW:
  CA9D  3EFF          		LD	A,0FFH
  CA9F                	ERRZ:
  CA9F  BF            		CP	A
  CAA0  37            		SCF
  CAA1  C3E8E9        		JP	FDMOFF
                      	
  CAA4                	ERRDW:
  CAA4  D1            		POP	DE
  CAA5  CDECEA        		CALL	AT_DELP+AT_R
  CAA8  20BF          		JR	NZ,DWT0
  CAAA  B7            		OR	A
  CAAB  20F0          		JR	NZ,ERRW
  CAAD  C9            		RET
                      	
  CAAE                	AT_DRD:
  CAAE  3E80          		LD	A,080H
  CAB0  32ACEA        		LD	(DRDPAT+1+AT_R),A
  CAB3  325AEA        		LD	(DWTPAT+1+AT_R),A
                      	
  CAB6  3E02          		LD	A,2		;Retry count
  CAB8  323EEA        		LD	(RETRY),A
                      	
  CABB                	DRD0:
  CABB  D5            		PUSH	DE
  CABC  E5            		PUSH	HL
  CABD  2210EB        		LD	(DHLPAT+1+AT_R),HL
  CAC0  CD48E9        		CALL	SEEK		;Read disk
  CAC3  E1            		POP	HL
  CAC4  3827          		JR	C,ERRDR
  CAC6  F3            		DI
  CAC7                	DRDPAT:
  CAC7  3E80          		LD	A,080H
  CAC9  CDF4E9        		CALL	SECSET
  CACC  0EFB          		LD	C,0FBH
  CACE                	DRD1:
  CACE  78            		LD	A,B
  CACF  DBF8          		IN	A,(0F8H)
  CAD1  0F            		RRCA
  CAD2  3008          		JR	NC,DRD3
  CAD4  0F            		RRCA
  CAD5  30F7          		JR	NC,DRD1
  CAD7  EDA2          		INI
  CAD9  04            		INC	B
  CADA  18F2          		JR	DRD1
                      	
  CADC                	DRD3:
  CADC  B7            		OR	A
  CADD  FB            		EI
  CADE  D1            		POP	DE
  CADF  13            		INC	DE
  CAE0  CDE8E9        		CALL	FDMOFF
  CAE3  C8            		RET	Z
  CAE4  CDDBEA        		CALL	DISKC+AT_R
  CAE7  20D2          		JR	NZ,DRD0
  CAE9  B7            		OR	A
  CAEA  20B1          		JR	NZ,ERRW
  CAEC  C9            		RET
                      	
  CAED                	ERRDR:
  CAED  D1            		POP	DE
  CAEE  CDECEA        		CALL	AT_DELP+AT_R
  CAF1  20C8          		JR	NZ,DRD0
  CAF3  B7            		OR	A
  CAF4  20A7          		JR	NZ,ERRW
  CAF6  C9            		RET
                      	
  CAF7                	DISKC:
  CAF7  1B            		DEC	DE
  CAF8  CB5F          		BIT	3,A
  CAFA  C40CEA        		CALL	NZ,RNF
  CAFD                	DISKD:
  CAFD  E5            		PUSH	HL
  CAFE  213EEA        		LD	HL,RETRY
  CB01  35            		DEC	(HL)
  CB02  E1            		POP	HL
  CB03  203E          		JR	NZ,AT_ERR		;Retry
  CB05  B7            		OR	A
  CB06  283B          		JR	Z,AT_ERR		;Error
                      	
  CB08                	AT_DELP:
  CB08  CD0CEA        		CALL	RNF
  CB0B  CDE8E9        		CALL	FDMOFF
  CB0E  3A85EC        		LD	A,(_SEEKSP)
  CB11  87            		ADD	A,A
  CB12  382E          		JR	C,AT_ERRZ
  CB14                	AT_DELP1:
  CB14  D5            		PUSH	DE
  CB15  2112EA        		LD	HL,DEMES
  CB18  CDF6D7        		CALL	MSX
  CB1B  CD73D6        		CALL	KEYBC
  CB1E                	AT_DELP2:
  CB1E  CD0EDC        		CALL	INKEY
  CB21  28FB          		JR	Z,AT_DELP2
                      	
  CB23  D1            		POP	DE
  CB24  CD6FDF        		CALL	CAP
  CB27  FE52          		CP	'R'
  CB29  200A          		JR	NZ,AT_DELP3
  CB2B  210000        	DHLPAT:	LD	HL,0
  CB2E  3E02          		LD	A,2
  CB30  323EEA        		LD	(RETRY),A
  CB33  B7            		OR	A
  CB34  C9            		RET
  CB35                	AT_DELP3:
  CB35  FE49          		CP	'I'
  CB37  2807          		JR	Z,AT_IGNORE
  CB39  FE41          		CP	'A'
  CB3B  20D7          		JR	NZ,AT_DELP1
  CB3D  C3F1D9        		JP	BOOT
  CB40                	AT_IGNORE:
  CB40  3EFF          		LD	A,0FFH
  CB42                	AT_ERRZ:
  CB42  BF            		CP	A
  CB43                	AT_ERR:
  CB43  3EFF          		LD	A,0FFH
  CB45  C9            		RET
                      	
                      	
                      	;	EMM DRIVER(CPU)
                      	
                      	
  CB46                	AT_EDRDC:
  CB46  CD52EB        		CALL	AT_EADR+AT_R
  CB49                	AT_EDRDC1:
  CB49  EDA2          		INI
  CB4B  04            		INC	B
  CB4C  EDA2          		INI
  CB4E  04            		INC	B
  CB4F  EDA2          		INI
  CB51  04            		INC	B
  CB52  EDA2          		INI
  CB54  04            		INC	B
  CB55  3D            		DEC	A
  CB56  20F1          		JR	NZ,AT_EDRDC1
  CB58  AF            		XOR	A
  CB59  C9            		RET
                      	
  CB5A                	AT_EDWTC:
  CB5A  CD52EB        		CALL	AT_EADR+AT_R
  CB5D                	AT_EDWTC1:
  CB5D  04            		INC	B
  CB5E  EDA3          		OUTI
  CB60  04            		INC	B
  CB61  EDA3          		OUTI
  CB63  04            		INC	B
  CB64  EDA3          		OUTI
  CB66  04            		INC	B
  CB67  EDA3          		OUTI
  CB69  3D            		DEC	A
  CB6A  20F1          		JR	NZ,AT_EDWTC1
  CB6C  AF            		XOR	A
  CB6D  C9            		RET
                      	
  CB6E                	AT_EADR:
  CB6E  D5            		PUSH	DE
  CB6F  EB            		EX	DE,HL
  CB70  29            		ADD	HL,HL
  CB71  29            		ADD	HL,HL
  CB72  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CB76  0E00          		LD	C,0
  CB78  09            		ADD	HL,BC
  CB79  060D          		LD	B,00DH
  CB7B  ED49          		OUT	(C),C
  CB7D  0C            		INC	C
  CB7E  ED69          		OUT	(C),L
  CB80  0C            		INC	C
  CB81  ED61          		OUT	(C),H
  CB83  0C            		INC	C
  CB84  EB            		EX	DE,HL
  CB85  D1            		POP	DE
  CB86  13            		INC	DE
  CB87  AF            		XOR	A
  CB88  C9            		RET
                      	
  CB89                	AT_UPSUB:
  CB89  2E0A          		LD	L,10
  CB8B                	AT_UPSUB1:
  CB8B  D9            		EXX
  CB8C  ED78          		IN	A,(C)
  CB8E  03            		INC	BC
  CB8F  D9            		EXX
  CB90  ED79          		OUT	(C),A
  CB92  03            		INC	BC
  CB93  D9            		EXX
  CB94  ED78          		IN	A,(C)
  CB96  03            		INC	BC
  CB97  D9            		EXX
  CB98  ED79          		OUT	(C),A
  CB9A  03            		INC	BC
  CB9B  D9            		EXX
  CB9C  ED78          		IN	A,(C)
  CB9E  03            		INC	BC
  CB9F  D9            		EXX
  CBA0  ED79          		OUT	(C),A
  CBA2  03            		INC	BC
  CBA3  D9            		EXX
  CBA4  ED78          		IN	A,(C)
  CBA6  03            		INC	BC
  CBA7  D9            		EXX
  CBA8  ED79          		OUT	(C),A
  CBAA  03            		INC	BC
  CBAB  D9            		EXX
  CBAC  ED78          		IN	A,(C)
  CBAE  03            		INC	BC
  CBAF  D9            		EXX
  CBB0  ED79          		OUT	(C),A
  CBB2  03            		INC	BC
  CBB3  D9            		EXX
  CBB4  ED78          		IN	A,(C)
  CBB6  03            		INC	BC
  CBB7  D9            		EXX
  CBB8  ED79          		OUT	(C),A
  CBBA  03            		INC	BC
  CBBB  D9            		EXX
  CBBC  ED78          		IN	A,(C)
  CBBE  03            		INC	BC
  CBBF  D9            		EXX
  CBC0  ED79          		OUT	(C),A
  CBC2  03            		INC	BC
  CBC3  D9            		EXX
  CBC4  ED78          		IN	A,(C)
  CBC6  03            		INC	BC
  CBC7  D9            		EXX
  CBC8  ED79          		OUT	(C),A
  CBCA  03            		INC	BC
  CBCB  2D            		DEC	L
  CBCC  C26FEB        		JP	NZ,AT_UPSUB1+AT_R
  CBCF  C9            		RET
                      	
  CBD0                	AT_CPUE:
  CBD0                	INITE:
  CBD0                		DS	0CC06H-INITE
                      	
                      	;LDCCP.ASM
                      	
                      	;	LSX-Dodgers CCP
                      	
  CC06                	BDOS:
  CC06  C343D2        		JP	BDOS0
                      	
  CC09  2020          		DB	020H,020H
  0040                	PATHX	EQU	64
  CC0B                	PATHD:	DS	PATHX
  CC4B  00            	PATHE:	DB	0
                      	
  CC4C  4F6B24        	OK:	DB	"Ok$"
  CC4F  536B697024    	SKIP:	DB	"Skip$"
  CC54  6B206279746573	KBFREE:	DB	"k bytes free",9,'$'
  CC62  20202020646972	DIRMES:	DB	"    dir $"
  CC6B  074572726F7221	COMERM:	DB	7,"Error!$"
                      	
  CC73  09            	COMS	DB	9
  CC74                	COMTB:
  CC74  44202020      		DB	"D   "	;1
  CC78  CBCE          		DW	C_DIR
  CC7A  44495220      		DB	"DIR "	;2
  CC7E  CBCE          		DW	C_DIR
  CC80  434F5059      		DB	"COPY"	;3
  CC84  CAD0          		DW	C_COPY
  CC86  43442020      		DB	"CD  "	;4
  CC8A  C3CD          		DW	C_CD
  CC8C  44454C20      		DB	"DEL "	;5
  CC90  B1CE          		DW	C_DEL
  CC92  50415448      		DB	"PATH"	;6
  CC96  7FCF          		DW	C_PATH
  CC98  52454E20      		DB	"REN "	;7
  CC9C  BDCE          		DW	C_REN
  CC9E  54595045      		DB	"TYPE"	;8
  CCA2  EDD1          		DW	C_TYPE
  CCA4  52454D20      		DB	"REM "	;9
  CCA8  AFCE          		DW	C_REM
                      	
  CCAA                	_SYS00:
  CCAA  F3            		DI
  CCAB  310000        		LD	SP,STACK
                      	
  CCAE  3EEC          		LD	A,INTVEC/256
  CCB0  ED47          		LD	I,A
                      	
  CCB2  3EE4          		LD	A,0E4H
  CCB4  CD59DA        		CALL	COMOUT
  CCB7  3EC8          		LD	A,INTVEC
  CCB9  CD33DA        		CALL	OT49SB
                      	
  CCBC  3ABCEC        		LD	A,(CRTCD+12)
  CCBF  B7            		OR	A
  CCC0  200C          		JR	NZ,SETCRT0
  CCC2  2180F8        		LD	HL,0-80*LINE
  CCC5  22BAEC        		LD	(CRTCD+10),HL
  CCC8  21B0FF        		LD	HL,0-80
  CCCB  22BCEC        		LD	(CRTCD+12),HL
  CCCE                	SETCRT0:
  CCCE  21B0EC        		LD	HL,CRTCD
  CCD1  AF            		XOR	A
  CCD2                	SETCRT2:
  CCD2  010018        		LD	BC,01800H
  CCD5  ED79          		OUT	(C),A
  CCD7  0C            		INC	C
  CCD8  04            		INC	B
  CCD9  EDA3          		OUTI
  CCDB  3C            		INC	A
  CCDC  FE0C          		CP	12
  CCDE  20F2          		JR	NZ,SETCRT2
  CCE0  0D            		DEC	C
  CCE1  ED79          		OUT	(C),A
  CCE3  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CCE4  ED71          		DB	0EDH,071H
  CCE6  0D            		DEC	C
  CCE7  3C            		INC	A
  CCE8  ED79          		OUT	(C),A
  CCEA  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CCEB  ED71          		DB	0EDH,071H
  CCED  23            		INC	HL
  CCEE  23            		INC	HL
  CCEF  01031B        		LD	BC,01A03H+00100H
  CCF2  EDA3          		OUTI
  CCF4  01D020        		LD	BC,01FD0H+00100H
  CCF7  EDA3          		OUTI
  CCF9  CD75CF        		CALL	LTNL
  CCFC                	COMMAND:
  CCFC  CDB7CD        		CALL	SETDTA1
  CCFF  D5            		PUSH	DE
  CD00  3A87EC        		LD	A,(_DVSW)
  CD03  C641          		ADD	A,'A'
  CD05  5F            		LD	E,A
  CD06  CDCDEC        		CALL	_PRINT
  CD09  1E3E          		LD	E,'>'
  CD0B  CDCDEC        		CALL	_PRINT
  CD0E  D1            		POP	DE		;DE=DTA1
  CD0F  3E50          		LD	A,80
  CD11  12            		LD	(DE),A
  CD12  0E0A          		LD	C,00AH
  CD14  CD0500        		CALL	SYSTEM
  CD17  CD75CF        		CALL	LTNL
                      	
  CD1A  118200        		LD	DE,DTA1+2
  CD1D  CDFDEC        		CALL	_COMANL
  CD20  30DA          		JR	NC,COMMAND
  CD22  CD73D6        		CALL	KEYBC
  CD25  116BCC        		LD	DE,COMERM
  CD28  CD6ED2        		CALL	_SYS09
  CD2B  C7            		RST	0
                      	
  CD2C                	COMANL:
  CD2C  CD84DC        		CALL	FILE
  CD2F  D5            		PUSH	DE
  CD30  11DC00        		LD	DE,FNAME
  CD33  1A            		LD	A,(DE)
  CD34  FE20          		CP	020H
  CD36  2849          		JR	Z,SDVSW
  CD38  1B            		DEC	DE
  CD39  1A            		LD	A,(DE)
  CD3A  C6FF          		ADD	A,0FFH
  CD3C  380B          		JR	C,COMB
  CD3E  13            		INC	DE
                      	
  CD3F  2174CC        		LD	HL,COMTB
  CD42  3A73CC        		LD	A,(COMS)
  CD45  47            		LD	B,A
  CD46  CD08DF        		CALL	CPNAME
  CD49                	COMB:
  CD49  D1            		POP	DE
  CD4A  D20F00        		JP	NC,K_HL
  CD4D  EB            		EX	DE,HL
  CD4E  222DCE        		LD	(COMPAT+1),HL
  CD51  2287CE        		LD	(BATPAT+1),HL
  CD54  F5            		PUSH	AF
  CD55  CDD5CD        		CALL	CEXE4
  CD58  F1            		POP	AF
  CD59  21DC00        		LD	HL,FNAME
  CD5C  116D00        		LD	DE,FCB2+1	;COMMAND NAME
  CD5F  010B00        		LD	BC,11
  CD62  EDB0          		LDIR
  CD64  110BCC        		LD	DE,PATHD
  CD67                	CEX1:
  CD67  1A            		LD	A,(DE)
  CD68  FE20          		CP	020H
  CD6A  D8            		RET	C
  CD6B  CD79DC        		CALL	FILEC
  CD6E  D5            		PUSH	DE
  CD6F  216D00        		LD	HL,FCB2+1	;COMMAND NAME
  CD72  11DC00        		LD	DE,FNAME
  CD75  010B00        		LD	BC,11
  CD78  EDB0          		LDIR
  CD7A  CDD5CD        		CALL	CEXE4
  CD7D  D1            		POP	DE
  CD7E  13            		INC	DE
  CD7F  18E6          		JR	CEX1
                      	
  CD81                	SDVSW:
  CD81  F1            		POP	AF
  CD82  3ADB00        		LD	A,(FDRV)
  CD85  3D            		DEC	A
  CD86  5F            		LD	E,A
  CD87  0E0E          		LD	C,00EH
  CD89  1833          		JR	SYSTEM0
                      	
  CD8B                	OPEN1:
  CD8B  21DB00        		LD	HL,FDRV
  CD8E                	OPEN:
  CD8E  0E11          		LD	C,011H
  CD90                	OPEN3:
  CD90  D5            		PUSH	DE
  CD91  1151FF        		LD	DE,DTA
  CD94  CDB4CD        		CALL	SETDTA
  CD97  EB            		EX	DE,HL
  CD98  CD0500        		CALL	SYSTEM
  CD9B  D1            		POP	DE
  CD9C  B7            		OR	A
  CD9D  C9            		RET
                      	
  CD9E                	OPEN2:
  CD9E  0E12          		LD	C,012H
  CDA0  18EE          		JR	OPEN3
                      	
  CDA2                	DEFCB:				;Z=Ok NZ=Error
  CDA2  1151FF        		LD	DE,DTA
  CDA5  CDBCCD        		CALL	SYSC0F
                      	
  CDA8  210000        		LD	HL,0
  CDAB  2272FF        		LD	(DTA+33),HL
  CDAE  2274FF        		LD	(DTA+35),HL
  CDB1  110001        		LD	DE,00100H
  CDB4                	SETDTA:
  CDB4  C3B3D4        		JP	_SYS1A
                      	
  CDB7                	SETDTA1:
  CDB7  118000        		LD	DE,DTA1
  CDBA  18F8          		JR	SETDTA
                      	
  CDBC                	SYSC0F:
  CDBC  0E0F          		LD	C,00FH
  CDBE                	SYSTEM0:
  CDBE  CD0500        		CALL	SYSTEM
  CDC1  B7            		OR	A
  CDC2  C9            		RET
                      	
  CDC3                	C_CD:
  CDC3  CD79DC        		CALL	FILEC
  CDC6  210000        		LD	HL,0
  CDC9  11DB00        		LD	DE,FDRV
  CDCC  1803          		JR	S27
                      	
  CDCE                	S27DTA:
  CDCE  1151FF        		LD	DE,DTA
  CDD1                	S27:
  CDD1  0E27          		LD	C,027H
  CDD3  18E9          		JR	SYSTEM0
                      	
  CDD5                	CEXE4:
  CDD5  3ADB00        		LD	A,(FDRV)
  CDD8  325700        		LD	(00057H),A
  CDDB  2AE900        		LD	HL,(FDRV+14)
  CDDE  225800        		LD	(00058H),HL
                      	
  CDE1  21E400        		LD	HL,FNAME+8
  CDE4  7E            		LD	A,(HL)
  CDE5  FE20          		CP	020H
  CDE7  2007          		JR	NZ,CEXE7
  CDE9  3E3F          		LD	A,'?'
  CDEB  77            		LD	(HL),A
  CDEC  23            		INC	HL
  CDED  77            		LD	(HL),A
  CDEE  23            		INC	HL
  CDEF  77            		LD	(HL),A
  CDF0                	CEXE7:
  CDF0  CD8BCD        		CALL	OPEN1
  CDF3                	CEXE5:
  CDF3  C0            		RET	NZ
  CDF4  2A5BFF        		LD	HL,(DTA+1+9)
  CDF7  7C            		LD	A,H
  CDF8  CD6FDF        		CALL	CAP
  CDFB  67            		LD	H,A
  CDFC  7D            		LD	A,L
  CDFD  CD6FDF        		CALL	CAP
  CE00  6F            		LD	L,A
  CE01  3A5AFF        		LD	A,(DTA+1+8)
  CE04  CD6FDF        		CALL	CAP
  CE07  D642          		SUB	'B'
  CE09  2831          		JR	Z,C_BAT
  CE0B  3D            		DEC	A		;'C'
  CE0C  2805          		JR	Z,C_EXE
  CE0E                	CEXE6:
  CE0E  CD9ECD        		CALL	OPEN2
  CE11  18E0          		JR	CEXE5
                      	
  CE13                	C_EXE:
  CE13  7C            		LD	A,H
  CE14  FE4D          		CP	'M'
  CE16  20F6          		JR	NZ,CEXE6
                      	
  CE18  CDA2CD        		CALL	DEFCB
  CE1B  2A0600        		LD	HL,(SYSTEM+1)
  CE1E  25            		DEC	H
  CE1F  CDCECD        		CALL	S27DTA
  CE22  3D            		DEC	A
  CE23  37            		SCF
  CE24  C0            		RET	NZ
  CE25  7C            		LD	A,H
  CE26  B5            		OR	L
  CE27  37            		SCF
  CE28  C8            		RET	Z
  CE29  CDB7CD        		CALL	SETDTA1
  CE2C  110000        	COMPAT:	LD	DE,0
  CE2F  CD85D0        		CALL	SETFCB
  CE32  AF            		XOR	A
  CE33  67            		LD	H,A
  CE34  6F            		LD	L,A
  CE35  310000        		LD	SP,STACK
  CE38  E5            		PUSH	HL
  CE39  C30001        		JP	00100H
                      	
  CE3C                	C_BAT:
  CE3C  114154        		LD	DE,'A'+'T'*256
  CE3F  ED52          		SBC	HL,DE
  CE41  20CB          		JR	NZ,CEXE6
                      	
  CE43  F1            		POP	AF
  CE44  F1            		POP	AF
  CE45  CDA2CD        		CALL	DEFCB
  CE48  210002        		LD	HL,00200H
  CE4B  CDCECD        		CALL	S27DTA
  CE4E  C6FE          		ADD	A,0FEH
  CE50  D8            		RET	C
  CE51  7D            		LD	A,L
  CE52  B7            		OR	A
  CE53  37            		SCF
  CE54  C8            		RET	Z
  CE55  3C            		INC	A
  CE56  F5            		PUSH	AF
                      	
  CE57  CD73D6        		CALL	KEYBC
  CE5A  1E1A          		LD	E,01AH
  CE5C  CDCDEC        		CALL	_PRINT
  CE5F  C1            		POP	BC
  CE60  210001        		LD	HL,00100H
  CE63                	BAT1:
  CE63  A7            		AND	A
  CE64  05            		DEC	B
  CE65  C8            		RET	Z
  CE66  7E            		LD	A,(HL)
  CE67  FE25          		CP	'%'
  CE69  280C          		JR	Z,BAT2
  CE6B                	BAT1X:
  CE6B  7E            		LD	A,(HL)
  CE6C  23            		INC	HL
  CE6D  FE1A          		CP	01AH
  CE6F  C8            		RET	Z
  CE70  FE0A          		CP	00AH
  CE72  C459D6        		CALL	NZ,KEYBS
  CE75  18EC          		JR	BAT1
                      	
  CE77                	BAT2:
  CE77  23            		INC	HL
  CE78  7E            		LD	A,(HL)
  CE79  2B            		DEC	HL
  CE7A  D631          		SUB	'1'
  CE7C  38ED          		JR	C,BAT1X
  CE7E  FE09          		CP	9
  CE80  30E9          		JR	NC,BAT1X
  CE82  23            		INC	HL
  CE83  23            		INC	HL
  CE84  3C            		INC	A
  CE85  4F            		LD	C,A
  CE86  110000        	BATPAT:	LD	DE,0
  CE89                	BAT3:
  CE89  1A            		LD	A,(DE)
  CE8A  B7            		OR	A
  CE8B  28D6          		JR	Z,BAT1
  CE8D  CD5EDD        		CALL	SPCUT
  CE90  0D            		DEC	C
  CE91  2808          		JR	Z,BAT5
  CE93                	BAT4:
  CE93  1A            		LD	A,(DE)
  CE94  FE21          		CP	021H
  CE96  38F1          		JR	C,BAT3
  CE98  13            		INC	DE
  CE99  18F8          		JR	BAT4
  CE9B                	BAT5:
  CE9B  1A            		LD	A,(DE)
  CE9C  FE21          		CP	021H
  CE9E  38C3          		JR	C,BAT1
  CEA0  13            		INC	DE
  CEA1  CD59D6        		CALL	KEYBS
  CEA4  18F5          		JR	BAT5
                      	
  CEA6                	SWITCH:
  CEA6  1A            		LD	A,(DE)
  CEA7                	SW1:
  CEA7  13            		INC	DE
  CEA8  B9            		CP	C
  CEA9  1A            		LD	A,(DE)
  CEAA  C8            		RET	Z
  CEAB  FE20          		CP	020H
  CEAD  30F8          		JR	NC,SW1
  CEAF                	C_REM:
  CEAF  AF            		XOR	A
  CEB0  C9            		RET
                      	
  CEB1                	C_DEL:
  CEB1  CD85D0        		CALL	SETFCB
  CEB4  0E08          		LD	C,8
  CEB6  CD0500        		CALL	SYSTEM
                      	
  CEB9  0E13          		LD	C,013H
  CEBB  1805          		JR	CDEL1
                      	
  CEBD                	C_REN:
  CEBD  CD85D0        		CALL	SETFCB
  CEC0  0E17          		LD	C,017H
  CEC2                	CDEL1:
  CEC2  115C00        		LD	DE,FCB1
  CEC5  CD0500        		CALL	SYSTEM
  CEC8  C6FF          		ADD	A,0FFH
  CECA  C9            		RET
                      	
  CECB                	C_DIR:
  CECB  CD79DC        		CALL	FILEC
  CECE  21DC00        		LD	HL,FDRV+1
  CED1  CD29D2        		CALL	CWILD1
  CED4  3EF1          		LD	A,0F1H
  CED6  32E800        		LD	(FDRV+13),A
  CED9  CD8BCD        		CALL	OPEN1
  CEDC                	CDIR1:
  CEDC  B7            		OR	A
  CEDD  2008          		JR	NZ,PDSKF
  CEDF  CD26CF        		CALL	P_NAME
  CEE2  CD9ECD        		CALL	OPEN2
  CEE5  18F5          		JR	CDIR1
                      	
  CEE7                	PDSKF:
  CEE7  3ADB00        		LD	A,(FDRV)
  CEEA  5F            		LD	E,A
  CEEB  0E1B          		LD	C,01BH
  CEED  CD0500        		CALL	SYSTEM
  CEF0  4F            		LD	C,A
  CEF1  C601          		ADD	A,001H
  CEF3  D8            		RET	C
  CEF4  AF            		XOR	A
  CEF5                	PDS1:
  CEF5  0D            		DEC	C
  CEF6  2804          		JR	Z,PDS2
  CEF8  29            		ADD	HL,HL
  CEF9  8F            		ADC	A,A
  CEFA  18F9          		JR	PDS1
  CEFC                	PDS2:
  CEFC  CB50          		BIT	2,B
  CEFE  2006          		JR	NZ,PDSKF1
  CF00  CB3F          		SRL	A
  CF02  CB1C          		RR	H
  CF04  CB1D          		RR	L
  CF06                	PDSKF1:
  CF06  CDB1CF        		CALL	PRDEC
  CF09  1154CC        		LD	DE,KBFREE
  CF0C  CD6ED2        		CALL	_SYS09
  CF0F  CDA3CF        		CALL	PUTDRV
  CF12  3E5C          		LD	A,05CH
  CF14  CDAAD6        		CALL	MSG_
  CF17  2AE900        		LD	HL,(FDRV+14)
  CF1A  7C            		LD	A,H
  CF1B  B5            		OR	L
  CF1C  2857          		JR	Z,LTNL
  CF1E  2B            		DEC	HL
  CF1F  7C            		LD	A,H
  CF20  B5            		OR	L
  CF21  C4B0CF        		CALL	NZ,PRDEC0
  CF24  184F          		JR	LTNL
                      	
  CF26                	P_NAME:
  CF26  3A52FF        		LD	A,(DTA+1)
  CF29  FE2E          		CP	'.'
  CF2B  C8            		RET	Z
  CF2C  3E20          		LD	A,020H
  CF2E  CDAAD6        		CALL	MSG_
  CF31  CDAAD6        		CALL	MSG_
  CF34  3E3A          		LD	A,':'
  CF36  CDAAD6        		CALL	MSG_
  CF39  3A5DFF        		LD	A,(DTA+1+00BH)
  CF3C  F5            		PUSH	AF
  CF3D  0F            		RRCA
  CF3E  9F            		SBC	A,A
  CF3F  E60A          		AND	'*'-020H
  CF41  C620          		ADD	A,020H
  CF43  0607          		LD	B,7
  CF45                	MZX:
  CF45  C5            		PUSH	BC
  CF46  CDAAD6        		CALL	MSG_
  CF49  C1            		POP	BC
  CF4A  3E20          		LD	A,020H
  CF4C  10F7          		DJNZ	MZX
                      	
  CF4E  CDA3CF        		CALL	PUTDRV
  CF51  2152FF        		LD	HL,DTA+1
  CF54  CDF2CF        		CALL	FPRNT
                      	
  CF57  F1            		POP	AF
  CF58  CB67          		BIT	4,A
  CF5A  2808          		JR	Z,DIR3
  CF5C  1162CC        		LD	DE,DIRMES
  CF5F  CD6ED2        		CALL	_SYS09
  CF62  1809          		JR	DIR6
  CF64                	DIR3:
  CF64  3A70FF        		LD	A,(DTA+1+01EH)
  CF67  2A6EFF        		LD	HL,(DTA+1+01CH)
  CF6A  CDB1CF        		CALL	PRDEC
  CF6D                	DIR6:
  CF6D  3AB1EC        		LD	A,(CRTCD+1)
  CF70  FE29          		CP	40+1
  CF72  D414D0        		CALL	NC,PRTTMS
                      	
  CF75                	LTNL:
  CF75  1E0D          		LD	E,00DH
  CF77  CD25D7        		CALL	PRINTX
  CF7A  1E0A          		LD	E,00AH
  CF7C  C325D7        		JP	PRINTX
                      	
  CF7F                	C_PATH:
  CF7F  CD5EDD        		CALL	SPCUT
  CF82  210BCC        		LD	HL,PATHD
  CF85  FE21          		CP	021H
  CF87  300E          		JR	NC,CPATH0
  CF89  2B            		DEC	HL
  CF8A  2B            		DEC	HL
  CF8B                	CPATHP:
  CF8B  7E            		LD	A,(HL)
  CF8C  23            		INC	HL
  CF8D  FE20          		CP	020H
  CF8F  3F            		CCF
  CF90  30E3          		JR	NC,LTNL
  CF92  CDAAD6        		CALL	MSG_
  CF95  18F4          		JR	CPATHP
  CF97                	CPATH0:
  CF97  FE3B          		CP	';'
  CF99  2001          		JR	NZ,CPATH1
  CF9B  13            		INC	DE
  CF9C                	CPATH1:
  CF9C  EB            		EX	DE,HL
  CF9D  014000        		LD	BC,PATHX
  CFA0  EDB0          		LDIR
  CFA2  C9            		RET
                      	
  CFA3                	PUTDRV:
  CFA3  3ADB00        		LD	A,(FDRV)
  CFA6  C640          		ADD	A,'A'-1
  CFA8  CDAAD6        		CALL	MSG_
  CFAB  3E3A          		LD	A,':'
  CFAD                	MSGR:
  CFAD  C3AAD6        		JP	MSG_
                      	
  CFB0                	PRDEC0:
  CFB0  AF            		XOR	A
  CFB1                	PRDEC:
  CFB1  5F            		LD	E,A
  CFB2  010000        		LD	BC,0
  CFB5  ED43D600      		LD	(DECBF),BC
  CFB9  ED43D800      		LD	(DECBF+2),BC
                      	
  CFBD  0E18          		LD	C,24
  CFBF                	DEC1:
  CFBF  29            		ADD	HL,HL
  CFC0  7B            		LD	A,E
  CFC1  8F            		ADC	A,A
  CFC2  5F            		LD	E,A
  CFC3  E5            		PUSH	HL
  CFC4  21D900        		LD	HL,DECBF+3
  CFC7  0604          		LD	B,4
  CFC9                	DEC2:
  CFC9  7E            		LD	A,(HL)
  CFCA  8F            		ADC	A,A
  CFCB  27            		DAA
  CFCC  77            		LD	(HL),A
  CFCD  2B            		DEC	HL
  CFCE  10F9          		DJNZ	DEC2
  CFD0  E1            		POP	HL
  CFD1  0D            		DEC	C
  CFD2  20EB          		JR	NZ,DEC1
                      	
  CFD4  21D600        		LD	HL,DECBF
  CFD7  3E20          		LD	A,020H
  CFD9  0603          		LD	B,3
  CFDB                	DEC3:
  CFDB  CDE8CF        		CALL	DEC4
  CFDE  CDE8CF        		CALL	DEC4
  CFE1  23            		INC	HL
  CFE2  10F7          		DJNZ	DEC3
  CFE4                	DECX:
  CFE4  CDE8CF        		CALL	DEC4
  CFE7  AF            		XOR	A
  CFE8                	DEC4:
  CFE8  ED6F          		RLD
  CFEA  FE20          		CP	020H
  CFEC  2802          		JR	Z,DEC5
  CFEE  F630          		OR	030H
  CFF0                	DEC5:
  CFF0  18BB          		JR	MSGR
                      	
  CFF2                	FPRNT:
  CFF2  0608          		LD	B,8
  CFF4  CD05D0        		CALL	P_N1
  CFF7  7E            		LD	A,(HL)
  CFF8  C680          		ADD	A,0A0H-020H
  CFFA  FEA0          		CP	0A0H
  CFFC  2802          		JR	Z,FPR1
  CFFE  3E2E          		LD	A,'.'
  D000                	FPR1:
  D000  CDAAD6        		CALL	MSG_
  D003  0603          		LD	B,3
                      	
  D005                	P_N1:
  D005  C5            		PUSH	BC
  D006  E5            		PUSH	HL
  D007  7E            		LD	A,(HL)
  D008  CD7BDF        		CALL	CAP3
  D00B  CDAAD6        		CALL	MSG_
  D00E  E1            		POP	HL
  D00F  C1            		POP	BC
  D010  23            		INC	HL
  D011  10F2          		DJNZ	P_N1
  D013  C9            		RET
                      	
  D014                	PRTTMS:
  D014  3E20          		LD	A,020H
  D016  CDAAD6        		CALL	MSG_
                      	
  D019  2A6AFF        		LD	HL,(DTA+1+24)
  D01C  7D            		LD	A,L
  D01D  B7            		OR	A
  D01E  C8            		RET	Z
  D01F  CB3C          		SRL	H
  D021  17            		RLA
  D022  17            		RLA
  D023  17            		RLA
  D024  17            		RLA
  D025  E60F          		AND	00FH
  D027  57            		LD	D,A
  D028  7C            		LD	A,H
  D029  C650          		ADD	A,80
  D02B  CD70D0        		CALL	PRTA
  D02E  3E2D          		LD	A,'-'
  D030  CDAAD6        		CALL	MSG_
  D033  7A            		LD	A,D
  D034  CD70D0        		CALL	PRTA
  D037  3E2D          		LD	A,'-'
  D039  CDAAD6        		CALL	MSG_
  D03C  7D            		LD	A,L
  D03D  E61F          		AND	01FH
  D03F  CD70D0        		CALL	PRTA
                      	
  D042  2A68FF        		LD	HL,(DTA+1+22)
                      	
  D045  3E20          		LD	A,020H
  D047  CDAAD6        		CALL	MSG_
  D04A  7C            		LD	A,H
  D04B  65            		LD	H,L
  D04C  1F            		RRA
  D04D  CB1D          		RR	L
  D04F  1F            		RRA
  D050  CB1D          		RR	L
  D052  1F            		RRA
  D053  CB1D          		RR	L
  D055  E61F          		AND	01FH
  D057  CD70D0        		CALL	PRTA
  D05A  3E3A          		LD	A,':'
  D05C  CDAAD6        		CALL	MSG_
  D05F  7D            		LD	A,L
  D060  0F            		RRCA
  D061  0F            		RRCA
  D062  E63F          		AND	03FH
  D064  CD70D0        		CALL	PRTA
  D067  3E3A          		LD	A,':'
  D069  CDAAD6        		CALL	MSG_
  D06C  7C            		LD	A,H
  D06D  E61F          		AND	01FH
  D06F  87            		ADD	A,A
                      	
                      	;	PRINT10
                      	
  D070                	PRTA:
  D070  E5            		PUSH	HL
  D071  0608          		LD	B,8
  D073  4F            		LD	C,A
  D074  AF            		XOR	A
  D075                	PRTA1:
  D075  CB01          		RLC	C
  D077  8F            		ADC	A,A
  D078  27            		DAA
  D079  10FA          		DJNZ	PRTA1
  D07B  21D600        		LD	HL,DECBF
  D07E  77            		LD	(HL),A
  D07F  AF            		XOR	A
  D080  CDE4CF        		CALL	DECX
  D083  E1            		POP	HL
  D084  C9            		RET
                      	
  D085                	SETFCB:
  D085  CD5EDD        		CALL	SPCUT
  D088  1A            		LD	A,(DE)
  D089  FE20          		CP	020H
  D08B  3801          		JR	C,SETFCBA
  D08D  1B            		DEC	DE
  D08E                	SETFCBA:
  D08E  D5            		PUSH	DE
  D08F  215C00        		LD	HL,FCB1
  D092  115D00        		LD	DE,FCB1+1
  D095  012300        		LD	BC,00023H
  D098  70            		LD	(HL),B		;B=0
  D099  EDB0          		LDIR
  D09B  D1            		POP	DE
  D09C  D5            		PUSH	DE
  D09D  215C00        		LD	HL,FCB1
  D0A0  0E29          		LD	C,029H
  D0A2  CD0500        		CALL	SYSTEM
  D0A5  216C00        		LD	HL,FCB2
  D0A8  0E29          		LD	C,029H
  D0AA  CD0500        		CALL	SYSTEM
  D0AD  E1            		POP	HL
  D0AE  010050        		LD	BC,05000H
  D0B1  118100        		LD	DE,00081H
  D0B4                	SETFCB1:
  D0B4  7E            		LD	A,(HL)
  D0B5  23            		INC	HL
  D0B6  FE20          		CP	020H
  D0B8  3805          		JR	C,SETFCB2
  D0BA  12            		LD	(DE),A
  D0BB  13            		INC	DE
  D0BC  0C            		INC	C
  D0BD  10F5          		DJNZ	SETFCB1
  D0BF                	SETFCB2:
  D0BF  79            		LD	A,C
  D0C0  328000        		LD	(DTA1),A
  D0C3  04            		INC	B
  D0C4  AF            		XOR	A
  D0C5                	SETFCB3:
  D0C5  12            		LD	(DE),A
  D0C6  13            		INC	DE
  D0C7  10FC          		DJNZ	SETFCB3
  D0C9  C9            		RET
                      	
  D0CA                	C_COPY:
  D0CA  CD85D0        		CALL	SETFCB
  D0CD  118100        		LD	DE,DTA1+1
  D0D0  0E2F          		LD	C,'/'
  D0D2  CDA6CE        		CALL	SWITCH
  D0D5  CD6FDF        		CALL	CAP
  D0D8  3260D1        		LD	(SW+1),A
                      	
  D0DB  1163DC        		LD	DE,BEEPD
  D0DE  CD7CDC        		CALL	FILEC2
  D0E1  216C00        		LD	HL,FCB2
  D0E4  CD33D5        		CALL	S29X1
                      	
  D0E7  3E10          		LD	A,010H
  D0E9  326900        		LD	(FCB1+13),A
  D0EC  216D00        		LD	HL,FCB2+1
  D0EF  CD29D2        		CALL	CWILD1
  D0F2                	COPY0:
  D0F2  CD26D2        		CALL	CWILD
  D0F5  215C00        		LD	HL,FCB1
  D0F8  CD8ECD        		CALL	OPEN
  D0FB  37            		SCF
  D0FC                	COPY1:
  D0FC  C0            		RET	NZ
  D0FD  CDA2CD        		CALL	DEFCB
                      	
  D100  3A5EFF        		LD	A,(DTA+13)
  D103  CB67          		BIT	4,A
  D105  2824          		JR	Z,COPY1A
                      	
  D107  215D00        		LD	HL,FCB1+1
  D10A  CD96E0        		CALL	CHKWILD
  D10D  3817          		JR	C,COPY9
                      	
  D10F  3E20          		LD	A,020H
  D111  325D00        		LD	(FCB1+1),A
  D114  2A6BFF        		LD	HL,(DTA+26)
  D117  23            		INC	HL
  D118  226A00        		LD	(FCB1+14),HL
  D11B  18D5          		JR	COPY0
                      	
  D11D                	COPYS:
  D11D  114FCC        		LD	DE,SKIP
  D120                	COPY8:
  D120  CD6ED2        		CALL	_SYS09
  D123  CD75CF        		CALL	LTNL
  D126                	COPY9:
  D126  CD9ECD        		CALL	OPEN2
  D129  18D1          		JR	COPY1
                      	
  D12B                	COPY1A:
  D12B  216C00        		LD	HL,FCB2
  D12E  11DB00        		LD	DE,FDRV
  D131  0153FF        		LD	BC,DTA+2
  D134  EDA0          		LDI
  D136  3E0B          		LD	A,11
  D138                	COPY2:
  D138  F5            		PUSH	AF
  D139  7E            		LD	A,(HL)
  D13A  FE3F          		CP	'?'
  D13C  2001          		JR	NZ,COPY3
  D13E  0A            		LD	A,(BC)
  D13F                	COPY3:
  D13F  12            		LD	(DE),A
  D140  03            		INC	BC
  D141  13            		INC	DE
  D142  23            		INC	HL
  D143  F1            		POP	AF
  D144  3D            		DEC	A
  D145  20F1          		JR	NZ,COPY2
  D147  010500        		LD	BC,16-11
  D14A  EDB0          		LDIR
  D14C                	PUTNAME:
  D14C  215D00        		LD	HL,FCB1+1
  D14F  CD96E0        		CALL	CHKWILD
  D152  300B          		JR	NC,PUTN1
  D154  21DC00        		LD	HL,FDRV+1
  D157  CDF2CF        		CALL	FPRNT
  D15A  3E20          		LD	A,020H
  D15C  CDAAD6        		CALL	MSG_
  D15F                	PUTN1:
  D15F  3E00          	SW:	LD	A,000H
  D161  FE54          		CP	'T'
  D163  2005          		JR	NZ,CSW1
  D165  217FD1        		LD	HL,SWNE
  D168  1807          		JR	SWT1
  D16A                	CSW1:
  D16A  FE4E          		CP	'N'
  D16C  2011          		JR	NZ,SWNE
  D16E  211DD1        		LD	HL,COPYS
  D171                	SWT1:
  D171  11DB00        		LD	DE,FDRV
  D174  CDBCCD        		CALL	SYSC0F
  D177  2801          		JR	Z,SWN1
  D179  E9            		JP	(HL)
  D17A                	SWN1:
  D17A  CDD8D1        		CALL	CTIME
  D17D  309E          		JR	NC,COPYS
  D17F                	SWNE:
  D17F  11DB00        		LD	DE,FDRV
  D182  0E16          		LD	C,016H
  D184  CDBECD        		CALL	SYSTEM0
  D187  204D          		JR	NZ,COPYE2
  D189  67            		LD	H,A		;A=0
  D18A  6F            		LD	L,A
  D18B  22FC00        		LD	(FDRV+33),HL
  D18E  22FE00        		LD	(FDRV+35),HL
  D191                	COPY6:
  D191  CD38D2        		CALL	BUFSIZ
  D194  CDCECD        		CALL	S27DTA
  D197  47            		LD	B,A
  D198  3C            		INC	A
  D199  2833          		JR	Z,COPYE
  D19B  7C            		LD	A,H
  D19C  B5            		OR	L
  D19D  280E          		JR	Z,COPY7
  D19F  11DB00        		LD	DE,FDRV
  D1A2  0E26          		LD	C,026H
  D1A4  CD0500        		CALL	SYSTEM
  D1A7  B7            		OR	A
  D1A8  2024          		JR	NZ,COPYE
  D1AA  05            		DEC	B
  D1AB  20E4          		JR	NZ,COPY6
  D1AD                	COPY7:
  D1AD  3A5EFF        		LD	A,(DTA+13)
  D1B0  32E800        		LD	(FDRV+13),A
  D1B3  2165FF        		LD	HL,DTA+20
  D1B6  11EF00        		LD	DE,FDRV+20
  D1B9  010400        		LD	BC,4
  D1BC  EDB0          		LDIR
                      	
  D1BE  11DB00        		LD	DE,FDRV
  D1C1  0E10          		LD	C,010H
  D1C3  CDBECD        		CALL	SYSTEM0
  D1C6  2006          		JR	NZ,COPYE
                      	
  D1C8  114CCC        		LD	DE,OK
  D1CB  C320D1        		JP	COPY8
                      	
  D1CE                	COPYE:
  D1CE  11DB00        		LD	DE,FDRV
  D1D1  0E13          		LD	C,013H
  D1D3  CD0500        		CALL	SYSTEM
  D1D6                	COPYE2:
  D1D6  37            		SCF
  D1D7  C9            		RET
                      	
  D1D8                	CTIME:
  D1D8  ED5B65FF      		LD	DE,(DTA+20)
  D1DC  2AEF00        		LD	HL,(FDRV+20)
  D1DF  A7            		AND	A
  D1E0  ED52          		SBC	HL,DE
  D1E2  C0            		RET	NZ
  D1E3  ED5B67FF      		LD	DE,(DTA+22)
  D1E7  2AF100        		LD	HL,(FDRV+22)
  D1EA  ED52          		SBC	HL,DE
  D1EC  C9            		RET
                      	
  D1ED                	C_TYPE:
  D1ED  CD85D0        		CALL	SETFCB
  D1F0  215C00        		LD	HL,FCB1
  D1F3  CD8ECD        		CALL	OPEN
  D1F6  37            		SCF
  D1F7                	TYPE1:
  D1F7  C0            		RET	NZ
  D1F8  CDA2CD        		CALL	DEFCB
  D1FB  1E1A          		LD	E,01AH
  D1FD  CDCDEC        		CALL	_PRINT
  D200                	TYPE2:
  D200  CD38D2        		CALL	BUFSIZ
  D203  CDCECD        		CALL	S27DTA
  D206  C6FE          		ADD	A,0FEH
  D208  D8            		RET	C
  D209  7C            		LD	A,H
  D20A  B5            		OR	L
  D20B  2814          		JR	Z,TYPEE
  D20D  010001        		LD	BC,00100H
  D210                	TYPE3:
  D210  0A            		LD	A,(BC)
  D211  03            		INC	BC
  D212  FE1A          		CP	01AH
  D214  280B          		JR	Z,TYPEE
  D216  5F            		LD	E,A
  D217  CDB3D6        		CALL	_SYS02
  D21A  2B            		DEC	HL
  D21B  7C            		LD	A,H
  D21C  B5            		OR	L
  D21D  20F1          		JR	NZ,TYPE3
  D21F  18DF          		JR	TYPE2
  D221                	TYPEE:
  D221  CD9ECD        		CALL	OPEN2
  D224  18D1          		JR	TYPE1
                      	
  D226                	CWILD:
  D226  215D00        		LD	HL,FCB1+1
  D229                	CWILD1:
  D229  7E            		LD	A,(HL)
  D22A  FE20          		CP	020H
  D22C  C0            		RET	NZ
  D22D                	CWILD2:
  D22D  54            		LD	D,H
  D22E  5D            		LD	E,L
  D22F  13            		INC	DE
  D230  010A00        		LD	BC,10
  D233  363F          		LD	(HL),'?'
  D235  EDB0          		LDIR
  D237  C9            		RET
                      	
  D238                	BUFSIZ:
  D238  3A0700        		LD	A,(SYSTEM+2)
  D23B  D603          		SUB	3
  D23D  E6FC          		AND	0FCH
  D23F  67            		LD	H,A
  D240  2E00          		LD	L,0
  D242  C9            		RET
                      	
                      	
                      	;LDOS.ASM
                      	
                      	;	LSX-Dodgers OS
                      	
  D243                	BDOS0:
  D243  79            		LD	A,C
  D244  FE31          		CP	031H
  D246  301E          		JR	NC,_ERROR
  D248  ED7363D2      		LD	(BDSP+1),SP
  D24C  31D4FF        		LD	SP,EXTSP
  D24F  E5            		PUSH	HL
  D250  C5            		PUSH	BC
  D251  CB21          		SLA	C
  D253  06EC          		LD	B,STABLE/256
  D255  0A            		LD	A,(BC)
  D256  6F            		LD	L,A
  D257  03            		INC	BC
  D258  0A            		LD	A,(BC)
  D259  67            		LD	H,A
  D25A  2260D2        		LD	(BDOS1+1),HL
  D25D  C1            		POP	BC
  D25E  E1            		POP	HL
  D25F  CD0000        	BDOS1:	CALL	0
                      	
  D262  310000        	BDSP:	LD	SP,0
  D265  C9            		RET
                      	
  D266                	_ERROR:
  D266  013201        		LD	BC,00132H
  D269  112601        		LD	DE,VER
  D26C                	_SYS1C:
  D26C                	_SYS1E:
  D26C                	_SYS20:
  D26C                	_SYS2E:
  D26C  AF            		XOR	A
  D26D  C9            		RET
                      	
  D26E                	_SYS09:
  D26E  D5            		PUSH	DE
  D26F                	_SX09:
  D26F  1A            		LD	A,(DE)
  D270  13            		INC	DE
  D271  FE24          		CP	'$'
  D273  282C          		JR	Z,SX0E2
  D275  D5            		PUSH	DE
  D276  5F            		LD	E,A
  D277  CDB3D6        		CALL	_SYS02
  D27A  D1            		POP	DE
  D27B  18F2          		JR	_SX09
                      	
  D27D                	_SYS0C:
  D27D  212200        		LD	HL,00022H
  D280  AF            		XOR	A
  D281  7D            		LD	A,L
  D282  C9            		RET
                      	
  D283                	_SYS0D:
  D283  CDDFEC        		CALL	_FFLUSH
  D286  E5            		PUSH	HL
  D287  218000        		LD	HL,00080H
  D28A  228AEC        		LD	(_DTA),HL
  D28D  E1            		POP	HL
  D28E  D5            		PUSH	DE
  D28F  1E00          		LD	E,0
  D291  3E            		DB	03EH
                      	
  D292                	_SYS0E:
  D292  D5            		PUSH	DE
  D293  7B            		LD	A,E
  D294  DDE5          		PUSH	IX
  D296  CDDCEC        		CALL	_GETDPB
  D299  DDE1          		POP	IX
  D29B  3804          		JR	C,SX0E2
  D29D  7B            		LD	A,E
  D29E  3287EC        		LD	(_DVSW),A
  D2A1                	SX0E2:
  D2A1  3E08          		LD	A,8
  D2A3  D1            		POP	DE
  D2A4  C9            		RET
                      	
  D2A5                	_SYS0F:
  D2A5  CD70DD        		CALL	SETDRV
  D2A8  FD7E1C        		LD	A,(IY+28)	;Open
  D2AB  C602          		ADD	A,002H		;Write
  D2AD  2868          		JR	Z,FEND0F
  D2AF  CD92E0        		CALL	CHKWILDX
                      	
  D2B2  D492DD        		CALL	NC,SOPENX
  D2B5                	_S16XX:
  D2B5  3860          		JR	C,FEND0F
                      					;Directory location
  D2B7  3A9FEC        		LD	A,(_FILEN)
  D2BA  FD7719        		LD	(IY+25),A
                      	;				_DIRF
  D2BD  3AA0EC        		LD	A,(_DIRF)
  D2C0  FD771D        		LD	(IY+29),A
                      	;				_FBPS
  D2C3  FD731E        		LD	(IY+30),E
  D2C6  FD721F        		LD	(IY+31),D
                      	;				Open(Read)
  D2C9  FD361CFF      		LD	(IY+28),0FFH
                      	;				FILENAME
  D2CD  FDE5          		PUSH	IY
  D2CF  D1            		POP	DE
  D2D0  13            		INC	DE
  D2D1  010B00        		LD	BC,11
  D2D4  EDB0          		LDIR
                      	;				Attribute
  D2D6  7E            		LD	A,(HL)
  D2D7  FD770D        		LD	(IY+13),A
                      	;				TIME
  D2DA  110B00        		LD	DE,11
  D2DD  19            		ADD	HL,DE
  D2DE  7E            		LD	A,(HL)
  D2DF  23            		INC	HL
  D2E0  FD7716        		LD	(IY+22),A
  D2E3  7E            		LD	A,(HL)
  D2E4  23            		INC	HL
  D2E5  FD7717        		LD	(IY+23),A
                      	;				DATE
  D2E8  7E            		LD	A,(HL)
  D2E9  23            		INC	HL
  D2EA  FD7714        		LD	(IY+20),A
  D2ED  7E            		LD	A,(HL)
  D2EE  23            		INC	HL
  D2EF  FD7715        		LD	(IY+21),A
                      	;				First cluster
  D2F2  7E            		LD	A,(HL)
  D2F3  23            		INC	HL
  D2F4  FD771A        		LD	(IY+26),A
  D2F7  7E            		LD	A,(HL)
  D2F8  23            		INC	HL
  D2F9  FD771B        		LD	(IY+27),A
                      	;				SIZE
  D2FC  7E            		LD	A,(HL)
  D2FD  23            		INC	HL
  D2FE  FD7710        		LD	(IY+16),A
  D301  7E            		LD	A,(HL)
  D302  23            		INC	HL
  D303  FD7711        		LD	(IY+17),A
  D306  7E            		LD	A,(HL)
  D307  23            		INC	HL
  D308  FD7712        		LD	(IY+18),A
  D30B  7E            		LD	A,(HL)
  D30C  FD7713        		LD	(IY+19),A
  D30F  AF            		XOR	A
  D310  FD770C        		LD	(IY+12),A
  D313  FD22D5D3      		LD	(OFCB+1),IY
  D317                	FEND0F:
  D317  C3BCD3        		JP	FEND
                      	
  D31A                	_SYS10:
  D31A  CD70DD        		CALL	SETDRV
  D31D  FD7E1C        		LD	A,(IY+28)	;Open
  D320  D6FE          		SUB	0FEH
  D322  37            		SCF
  D323  3F            		CCF
  D324  2032          		JR	NZ,FEND10
  D326                	_S10A:				;Write
  D326  FD770E        		LD	(IY+14),A
  D329  FD770F        		LD	(IY+15),A
                      	
  D32C  FD341C        		INC	(IY+28)		;0FEH->0FFH
  D32F  CD83E1        		CALL	SETTMS
                      	
  D332  FD7E1D        		LD	A,(IY+29)
  D335  32A0EC        		LD	(_DIRF),A
  D338  FD5E1E        		LD	E,(IY+30)
  D33B  FD561F        		LD	D,(IY+31)
  D33E  CDB4DE        		CALL	DC
  D341  3879          		JR	C,FEND
                      	
  D343  FD7E19        		LD	A,(IY+25)
  D346  87            		ADD	A,A
  D347  87            		ADD	A,A
  D348  87            		ADD	A,A
  D349  E6FF          	IBM2:	AND	0FFH		;ooo 07FH
  D34B  6F            		LD	L,A
  D34C  2600          		LD	H,0
  D34E  29            		ADD	HL,HL
  D34F  29            		ADD	HL,HL
  D350  ED4B7EEC      		LD	BC,(_DTBUF)
  D354  09            		ADD	HL,BC
                      	
  D355  CDA2E0        		CALL	SDIRENT
  D358                	FEND10:
  D358  1862          		JR	FEND
                      	
  D35A                	OPENDD:
  D35A  FD361CFD      		LD	(IY+28),0FDH
  D35E  FD360D20      		LD	(IY+13),020H
  D362  CD88E1        		CALL	SETTMSX
  D365  1855          		JR	FEND
                      	
  D367                	_SYS11:
  D367  CD70DD        		CALL	SETDRV
  D36A  CDFBDE        		CALL	CHKDDX
  D36D  3818          		JR	C,_S11A
  D36F  FDE5          		PUSH	IY
  D371  E1            		POP	HL
  D372  ED5B8AEC      		LD	DE,(_DTA)
  D376  010C00        		LD	BC,12
  D379  EDB0          		LDIR
  D37B  3E20          		LD	A,020H
  D37D  12            		LD	(DE),A
  D37E  13            		INC	DE
  D37F  62            		LD	H,D
  D380  6B            		LD	L,E
  D381  13            		INC	DE
  D382  0E13          		LD	C,19
  D384  70            		LD	(HL),B
  D385  1833          		JR	_S11B
  D387                	_S11A:
  D387  CDC6DD        		CALL	SOPEN
  D38A                	_S12X1:
  D38A  3830          		JR	C,FEND
  D38C  CD6FDE        		CALL	SOPENE2
  D38F  ED5B8AEC      		LD	DE,(_DTA)
  D393  3A88EC        		LD	A,(_DRV)
  D396  3C            		INC	A
  D397  12            		LD	(DE),A
  D398  D5            		PUSH	DE
  D399  13            		INC	DE
  D39A  012000        		LD	BC,32
  D39D  EDB0          		LDIR
  D39F  FD6E0E        		LD	L,(IY+14)
  D3A2  FD660F        		LD	H,(IY+15)
  D3A5  2230E2        		LD	(SCDIR),HL
  D3A8  2A9AEC        		LD	HL,(_FBPS)
  D3AB  2232E2        		LD	(SFBPS),HL
  D3AE  2A9FEC        		LD	HL,(_FILEN)
  D3B1  2234E2        		LD	(SFNDF),HL	;Directory position and Flags
  D3B4  E1            		POP	HL
  D3B5  1136E2        		LD	DE,SFILE
  D3B8  0E21          		LD	C,33
  D3BA                	_S11B:
  D3BA  EDB0          		LDIR
  D3BC                	FEND:
  D3BC  9F            		SBC	A,A		;CF=0 A=0 : CF=1 A=0FFH
  D3BD                	FENDE:
  D3BD  FDE1          		POP	IY
  D3BF  C1            		POP	BC
  D3C0  D1            		POP	DE
  D3C1  E1            		POP	HL
  D3C2  C9            		RET
                      	
  D3C3                	_SYS12:
  D3C3  E5            		PUSH	HL
  D3C4  D5            		PUSH	DE
  D3C5  C5            		PUSH	BC
  D3C6  FDE5          		PUSH	IY
  D3C8  CD2BDE        		CALL	NOPEN
  D3CB  18BD          		JR	_S12X1
                      	
  D3CD                	_S16K:
  D3CD  FD7E1C        		LD	A,(IY+28)	;Device
  D3D0  FEFD          		CP	0FDH
  D3D2  37            		SCF
  D3D3  C8            		RET	Z
                      	
  D3D4  110000        	OFCB:	LD	DE,0
  D3D7  D5            		PUSH	DE
  D3D8  061A          		LD	B,26		;First cluster
  D3DA                	S16K1:
  D3DA  13            		INC	DE
  D3DB  23            		INC	HL
  D3DC  10FC          		DJNZ	S16K1
                      	
  D3DE  1A            		LD	A,(DE)
  D3DF  BE            		CP	(HL)
  D3E0  2013          		JR	NZ,S16K2
  D3E2  13            		INC	DE
  D3E3  23            		INC	HL
  D3E4  1A            		LD	A,(DE)
  D3E5  BE            		CP	(HL)
  D3E6  200D          		JR	NZ,S16K2
                      	
  D3E8  E1            		POP	HL
  D3E9  FDE5          		PUSH	IY
  D3EB  D1            		POP	DE
  D3EC  1A            		LD	A,(DE)		;Drive
  D3ED  BE            		CP	(HL)
  D3EE  2005          		JR	NZ,S16K2
                      	
  D3F0  ED52          		SBC	HL,DE		;CP HL,DE
  D3F2  37            		SCF
  D3F3  C0            		RET	NZ
  D3F4  E5            		PUSH	HL
  D3F5                	S16K2:
  D3F5  E1            		POP	HL
  D3F6  FDE5          		PUSH	IY
  D3F8  D1            		POP	DE
  D3F9                	_SYS13:
  D3F9  CD70DD        		CALL	SETDRV
  D3FC  CDBEDF        		CALL	KILL
  D3FF                	FEND13:
  D3FF  18BB          		JR	FEND
                      	
  D401                	_SYS14:
  D401  CD70DD        		CALL	SETDRV
  D404  CDB7E1        		CALL	PUSHRR
  D407  CDF8E1        		CALL	GETSEQ
  D40A  CD05E2        		CALL	SETRBR
                      	
  D40D  CD1EE2        		CALL	K_DE27
                      	
  D410  E5            		PUSH	HL
  D411  CDCBE1        		CALL	SETSEQ
  D414                	SREAD:
  D414  E1            		POP	HL
                      	
  D415  C601          		ADD	A,001H
  D417  38A3          		JR	C,FEND
                      	
  D419  7D            		LD	A,L
  D41A  D601          		SUB	001H
  D41C                	FENDX:
  D41C  9F            		SBC	A,A
  D41D  E603          		AND	3
  D41F  1F            		RRA
  D420  189B          		JR	FENDE
                      	
  D422                	_SYS15:
  D422  CD70DD        		CALL	SETDRV
  D425  CDB7E1        		CALL	PUSHRR
  D428  CDF8E1        		CALL	GETSEQ
  D42B  CD05E2        		CALL	SETRBR
                      	
  D42E  CD18E2        		CALL	K_DE26
  D431  E5            		PUSH	HL
  D432  CDCBE1        		CALL	SETSEQ
  D435                	SWRITE:
  D435  E1            		POP	HL
                      	
  D436  C6FF          		ADD	A,0FFH
  D438  18E2          		JR	FENDX
                      	
  D43A                	_SYS17:
  D43A  CD70DD        		CALL	SETDRV
  D43D  CD1AE0        		CALL	NAME
  D440  18BD          		JR	FEND13
                      	
  D442                	_SYS16:
  D442  CD70DD        		CALL	SETDRV
                      	
  D445  CD92E0        		CALL	CHKWILDX
  D448  38B5          		JR	C,FEND13
  D44A  FD7E01        		LD	A,(IY+1)
  D44D  FE05          		CP	5
  D44F  2805          		JR	Z,_S16X2
  D451  FE21          		CP	021H
  D453  DAFFD3        		JP	C,FEND13
  D456                	_S16X2:
                      	;				Clear FCB
  D456  FDE5          		PUSH	IY
  D458  E1            		POP	HL
  D459  011000        		LD	BC,16
  D45C  09            		ADD	HL,BC
  D45D                	_S16X1:
  D45D  70            		LD	(HL),B
  D45E  23            		INC	HL
  D45F  0D            		DEC	C
  D460  20FB          		JR	NZ,_S16X1
                      	
  D462  CD88E1        		CALL	SETTMSX
  D465  FD360DFF      		LD	(IY+13),0FFH	;Attribute
  D469  CD92DD        		CALL	SOPENX
  D46C  3F            		CCF
  D46D  CCCDD3        		CALL	Z,_S16K
  D470  D480DE        		CALL	NC,COPEN
  D473  D4A2E0        		CALL	NC,SDIRENT
  D476  C3B5D2        		JP	_S16XX
                      	
  D479                	_SYS21:
  D479  CD70DD        		CALL	SETDRV
  D47C  CDB7E1        		CALL	PUSHRR
  D47F  FD6E21        		LD	L,(IY+33)	;Random record
  D482  FD6622        		LD	H,(IY+34)
  D485  CD05E2        		CALL	SETRBR
                      	
  D488  CD1EE2        		CALL	K_DE27
  D48B  E5            		PUSH	HL
  D48C  CDE2E1        		CALL	POPRR
  D48F  1883          		JR	SREAD
                      	
  D491                	_SYS22:
  D491                	_SYS28:
  D491  CD70DD        		CALL	SETDRV
  D494  CDB7E1        		CALL	PUSHRR
  D497  FD6E21        		LD	L,(IY+33)	;Random record
  D49A  FD6622        		LD	H,(IY+34)
  D49D  CD05E2        		CALL	SETRBR
                      	
  D4A0  CD18E2        		CALL	K_DE26
  D4A3  E5            		PUSH	HL
  D4A4  CDE2E1        		CALL	POPRR
  D4A7  188C          		JR	SWRITE
                      	
  D4A9                	_SYS18:
  D4A9  21FF00        		LD	HL,000FFH
  D4AC  AF            		XOR	A
  D4AD  C9            		RET
                      	
  D4AE                	_SYS19:
  D4AE  3A87EC        		LD	A,(_DVSW)
  D4B1  A7            		AND	A
  D4B2  C9            		RET
                      	
  D4B3                	_SYS1A:
  D4B3  ED538AEC      		LD	(_DTA),DE
  D4B7  AF            		XOR	A
  D4B8  C9            		RET
                      	
  D4B9                	_SYS1B:
  D4B9  7B            		LD	A,E
  D4BA  CD85DD        		CALL	GETDRV
  D4BD  CDDCEC        		CALL	_GETDPB
  D4C0  D4E2EC        		CALL	NC,_RDFATX
  D4C3  210000        		LD	HL,0
  D4C6  D468E1        		CALL	NC,DSKF
                      	
  D4C9  DD5E08        		LD	E,(IX+8)
  D4CC  DD5609        		LD	D,(IX+9)	;総クラスタ
  D4CF  1B            		DEC	DE
  D4D0  1B            		DEC	DE
  D4D1  FD2A7CEC      		LD	IY,(_FATBF)
  D4D5  9F            		SBC	A,A
  D4D6  D8            		RET	C
  D4D7  DD7E07        		LD	A,(IX+7)
  D4DA  B7            		OR	A
  D4DB  010002        		LD	BC,00200H
  D4DE  78            		LD	A,B		;A=2
  D4DF  C0            		RET	NZ
  D4E0  3D            		DEC	A		;A=1
  D4E1  DDCB0F7E      		BIT	7,(IX+00FH)
  D4E5  C0            		RET	NZ
  D4E6  0604          		LD	B,004H
  D4E8  C9            		RET
                      	
  D4E9                	_SYS1D:
  D4E9  AF            		XOR	A
  D4EA  67            		LD	H,A
  D4EB  6F            		LD	L,A
  D4EC  C9            		RET
                      	
  D4ED                	_SYS1F:
  D4ED  2100ED        		LD	HL,DEVICE
  D4F0  AF            		XOR	A
  D4F1  C9            		RET
                      	
  D4F2                	_SYS23:
  D4F2  E5            		PUSH	HL
  D4F3  2A1EEC        		LD	HL,(STABLE+2*00FH)
  D4F6  CD0F00        		CALL	K_HL
  D4F9  3814          		JR	C,FSIZE1
                      	;	EX	DE,IY
  D4FB  D5            		PUSH	DE
  D4FC  FDE3          		EX	(SP),IY
  D4FE  D1            		POP	DE
                      	;
  D4FF  D5            		PUSH	DE
  D500  CDE8E1        		CALL	GETSIZE
  D503  FD7521        		LD	(IY+33),L	;Random record
  D506  FD7422        		LD	(IY+34),H
  D509  D1            		POP	DE
                      	;	EX	DE,IY
  D50A  D5            		PUSH	DE
  D50B  FDE3          		EX	(SP),IY
  D50D  D1            		POP	DE
                      	;
  D50E  AF            		XOR	A
  D50F                	FSIZE1:
  D50F  E1            		POP	HL
  D510  C9            		RET
                      	
  D511                	_SYS24:
  D511  C5            		PUSH	BC
                      	;	EX	DE,IY
  D512  D5            		PUSH	DE
  D513  FDE3          		EX	(SP),IY
  D515  D1            		POP	DE
                      	;
  D516  D5            		PUSH	DE
  D517  CDF8E1        		CALL	GETSEQ
  D51A  FD7521        		LD	(IY+33),L	;Random record
  D51D  FD7422        		LD	(IY+34),H
  D520  FD362300      		LD	(IY+35),0
  D524  D1            		POP	DE
                      	;	EX	DE,IY
  D525  D5            		PUSH	DE
  D526  FDE3          		EX	(SP),IY
  D528  D1            		POP	DE
                      	;
  D529  C1            		POP	BC
  D52A  AF            		XOR	A
  D52B  C9            		RET
                      	
  D52C                	_SYS29:
  D52C  C5            		PUSH	BC
  D52D  E5            		PUSH	HL
  D52E  CD84DC        		CALL	FILE
  D531  E1            		POP	HL
  D532  C1            		POP	BC
  D533                	S29X1:
  D533  C5            		PUSH	BC
  D534  D5            		PUSH	DE
  D535  E5            		PUSH	HL
  D536  EB            		EX	DE,HL
  D537  21DB00        		LD	HL,FDRV
  D53A  010D00        		LD	BC,13
  D53D  EDB0          		LDIR
  D53F  70            		LD	(HL),B
  D540  0E03          		LD	C,3
  D542  EDB0          		LDIR
  D544  E1            		POP	HL
  D545  D1            		POP	DE
  D546  C1            		POP	BC
  D547  AF            		XOR	A
  D548  C9            		RET
                      	
  D549                	_SYS30:
  D549  C5            		PUSH	BC
  D54A  01F4EC        		LD	BC,_DWT
  D54D  1804          		JR	S2FX
  D54F                	_SYS2F:
  D54F  C5            		PUSH	BC
  D550  01F1EC        		LD	BC,_DRD
  D553                	S2FX:
  D553  ED4368D5      		LD	(S2FPAT+1),BC
  D557  CDBFE8        		CALL	FFLUSH
                      	
  D55A  D5            		PUSH	DE
  D55B  E5            		PUSH	HL
  D55C  7D            		LD	A,L		;Drive
  D55D  CDD9EC        		CALL	_CHGDRV
  D560  380D          		JR	C,S30X2
  D562  44            		LD	B,H		;Number of clusters
  D563  2A8AEC        		LD	HL,(_DTA)
  D566                	S30X:
  D566  C5            		PUSH	BC
  D567  CDF1EC        	S2FPAT:	CALL	_DRD
  D56A  C1            		POP	BC
  D56B  3802          		JR	C,S30X2
  D56D  10F7          		DJNZ	S30X
  D56F                	S30X2:
  D56F  E1            		POP	HL
  D570  D1            		POP	DE
  D571  C1            		POP	BC
  D572  9F            		SBC	A,A
  D573  C9            		RET
                      	
                      	;LDIO.ASM
                      	
                      	;	LSX-Dodgers IO
                      	
                      	
  D574                	BIOS:
  D574  ED738ED5      		LD	(SPPAT+1),SP
  D578  F5            		PUSH	AF
  D579  3A8FD5        		LD	A,(SPPAT+2)
  D57C  3C            		INC	A
  D57D  2806          		JR	Z,BIOS2
  D57F  F1            		POP	AF
  D580  31D4FF        		LD	SP,EXTSP
  D583  1801          		JR	BIOS3
  D585                	BIOS2:
  D585  F1            		POP	AF
  D586                	BIOS3:
  D586  CD91D5        		CALL	BIOS1
  D589  061E          		LD	B,01EH
  D58B  ED79          		OUT	(C),A
  D58D  310000        	SPPAT:	LD	SP,0
  D590  C9            		RET
  D591                	BIOS1:
  D591  C5            		PUSH	BC
  D592  061D          		LD	B,01DH
  D594  ED79          		OUT	(C),A
  D596  C9            		RET
                      	
  D597                	INT:
  D597  F5            		PUSH	AF
  D598  E5            		PUSH	HL
  D599  C5            		PUSH	BC
  D59A  210001        		LD	HL,00100H
  D59D  39            		ADD	HL,SP
  D59E  3807          		JR	C,INTP1
  D5A0  ED73D2D5      		LD	(INTSP+1),SP
  D5A4  31D4FF        		LD	SP,EXTSP
  D5A7                	INTP1:
  D5A7  CD3EDA        		CALL	IN49SB
  D5AA  67            		LD	H,A
  D5AB  CD3EDA        		CALL	IN49SB
  D5AE  6F            		LD	L,A
                      	
  D5AF  CB64          		BIT	4,H		;[GRAPH]
  D5B1  2010          		JR	NZ,SCEXE
  D5B3  7D            		LD	A,L
  D5B4  EE09          		XOR	9
  D5B6  2839          		JR	Z,DIAN
  D5B8  7C            		LD	A,H
  D5B9  0F            		RRCA			;[CTRL]
  D5BA  301E          		JR	NC,SCL
  D5BC  0F            		RRCA			;[SHIFT]
  D5BD  3804          		JR	C,SCEXE
  D5BF  3E80          		LD	A,080H
  D5C1  181E          		JR	SCG1
  D5C3                	SCEXE:
  D5C3  2292EC        		LD	(_KEYD),HL
  D5C6  CD26D6        		CALL	KEYSET1
                      	
  D5C9  21D4FF        		LD	HL,EXTSP
  D5CC  A7            		AND	A
  D5CD  ED72          		SBC	HL,SP
  D5CF  2003          		JR	NZ,INTPE1
                      	
  D5D1  310000        	INTSP:	LD	SP,0
  D5D4                	INTPE1:
  D5D4  C1            		POP	BC
  D5D5                	INTPE:
  D5D5  E1            		POP	HL
  D5D6                	INTPE2:
  D5D6  F1            		POP	AF
  D5D7                	INTCTCE:
  D5D7  FB            		EI
  D5D8  ED4D          		RETI
                      	
  D5DA                	SCL:
  D5DA  7D            		LD	A,L
  D5DB  FE08          		CP	008H
  D5DD  280D          		JR	Z,RESET
                      	
  D5DF  3E02          		LD	A,002H
  D5E1                	SCG1:
  D5E1  E5            		PUSH	HL
  D5E2  21BFEC        		LD	HL,WK1FD0
  D5E5  AE            		XOR	(HL)
  D5E6  CDF5EB        		CALL	S1FD0
  D5E9  E1            		POP	HL
  D5EA  18D7          		JR	SCEXE
                      	
  D5EC                	RESET:
  D5EC  3E1D          		LD	A,01DH
  D5EE  D300          		OUT	(0),A
  D5F0  C7            		RST	0
                      	
  D5F1                	DIAN:
  D5F1  6F            		LD	L,A
  D5F2  C5            		PUSH	BC
  D5F3  01B01F        		LD	BC,01FB0H
  D5F6  ED78          		IN	A,(C)
  D5F8  EE80          		XOR	080H
  D5FA  ED79          		OUT	(C),A
  D5FC  C1            		POP	BC
  D5FD  18C4          		JR	SCEXE
                      	
  D5FF                	INTCTC2:
  D5FF  F5            		PUSH	AF
  D600  3E00          	INTCPAT:LD	A,000H
  D602  3D            		DEC	A
  D603  3201D6        		LD	(INTCPAT+1),A
  D606  20CE          		JR	NZ,INTPE2
                      	
  D608  3A92EC        		LD	A,(_KEYD)
  D60B  B7            		OR	A
  D60C  28C8          		JR	Z,INTPE2
  D60E                	KEYSET0:
  D60E  E5            		PUSH	HL
  D60F  2A90EC        		LD	HL,(_KEYPS)
  D612  7C            		LD	A,H
  D613  AD            		XOR	L
  D614  2006          		JR	NZ,INTC2A
                      	
  D616  2A92EC        		LD	HL,(_KEYD)
  D619  CD50D6        		CALL	KEYSET
  D61C                	INTC2A:
  D61C  3A94EC        		LD	A,(_KEYSP)
  D61F  E60F          		AND	00FH
  D621  3201D6        		LD	(INTCPAT+1),A
                      	
  D624  18AF          		JR	INTPE
                      	
  D626                	KEYSET1:
  D626  CB6C          		BIT	5,H
  D628  F5            		PUSH	AF
  D629  ED4B8CEC      		LD	BC,(_CTC)
  D62D  78            		LD	A,B
  D62E  B1            		OR	C
  D62F  2006          		JR	NZ,KEYS10E
                      	
  D631  F1            		POP	AF
  D632  201C          		JR	NZ,KEYSET
  D634  F5            		PUSH	AF
  D635  18D7          		JR	KEYSET0
  D637                	KEYS10E:
  D637  F1            		POP	AF
  D638  C8            		RET	Z
  D639  F5            		PUSH	AF
  D63A  3E03          		LD	A,3		;CTC STOP
  D63C  ED79          		OUT	(C),A
  D63E  F1            		POP	AF
                      	
  D63F  B7            		OR	A
  D640  C8            		RET	Z
                      	
  D641  E5            		PUSH	HL
  D642  2A94EC        		LD	HL,(_KEYSP)
  D645  3EA7          		LD	A,0A7H
  D647  ED79          		OUT	(C),A
  D649  ED69          		OUT	(C),L
  D64B  7C            		LD	A,H
  D64C  3201D6        		LD	(INTCPAT+1),A
  D64F  E1            		POP	HL
                      	
  D650                	KEYSET:
  D650  7D            		LD	A,L
  D651  CB7C          		BIT	7,H
  D653  CC80D6        		CALL	Z,FKEY
  D656  CB74          		BIT	6,H
  D658  C0            		RET	NZ
  D659                	KEYBS:
  D659  B7            		OR	A
  D65A  C8            		RET	Z
  D65B                	KEYBS1:
  D65B  FE03          		CP	3
  D65D  CC73D6        		CALL	Z,KEYBC
  D660  E5            		PUSH	HL
  D661  F5            		PUSH	AF
  D662  2A90EC        		LD	HL,(_KEYPS)
  D665  2C            		INC	L
  D666  7D            		LD	A,L
  D667  BC            		CP	H
  D668  2812          		JR	Z,KEYBE
  D66A  3290EC        		LD	(_KEYPS),A
  D66D  26FE          		LD	H,KEYBF/256
  D66F  F1            		POP	AF
  D670  77            		LD	(HL),A
  D671  E1            		POP	HL
  D672  C9            		RET
                      	
  D673                	KEYBC:
  D673  E5            		PUSH	HL
  D674  210000        		LD	HL,0
  D677  2290EC        		LD	(_KEYPS),HL
  D67A  E1            		POP	HL
  D67B  C9            		RET
                      	
  D67C                	KEYBE:
  D67C  F1            		POP	AF
  D67D  E1            		POP	HL
  D67E  37            		SCF
  D67F  C9            		RET
                      	
  D680                	FKEY:
  D680  CB75          		BIT	6,L
  D682  C8            		RET	Z
  D683  3E1B          		LD	A,01BH
  D685  CD5BD6        		CALL	KEYBS1
  D688  7D            		LD	A,L
  D689  C6AF          		ADD	A,020H-'q'
  D68B  CB7D          		BIT	7,L
  D68D  C8            		RET	Z
  D68E  2E50          		LD	L,'P'
  D690  D690          		SUB	0E1H+020H-'q'
  D692  2810          		JR	Z,KEYBSL
  D694  2C            		INC	L
  D695  3D            		DEC	A
  D696  280C          		JR	Z,KEYBSL
  D698  2C            		INC	L
  D699  D609          		SUB	0EBH-0E2H
  D69B  2807          		JR	Z,KEYBSL
  D69D  2E43          		LD	L,'C'
  D69F  3D            		DEC	A
  D6A0  2802          		JR	Z,KEYBSL
  D6A2  2E58          		LD	L,'X'
  D6A4                	KEYBSL:
  D6A4  7D            		LD	A,L
  D6A5  18B4          		JR	KEYBS1
                      	
  D6A7                	_SYS01:
  D6A7  CDFAD9        		CALL	_SYS07
  D6AA                	MSG_:
  D6AA  F5            		PUSH	AF
  D6AB  D5            		PUSH	DE
  D6AC  5F            		LD	E,A
  D6AD  CDB3D6        		CALL	_SYS02
  D6B0  D1            		POP	DE
  D6B1  F1            		POP	AF
  D6B2  C9            		RET
                      	
  D6B3                	_SYS02:
  D6B3  CD2DD7        		CALL	BREAK
  D6B6  C325D7        		JP	PRINTX
                      	
  D6B9                	_SYS03:
  D6B9  F3            		DI
  D6BA  C5            		PUSH	BC
  D6BB  01911F        	SIOAD:	LD	BC,01F91H
  D6BE  3E05          		LD	A,5
  D6C0  ED79          		OUT	(C),A
  D6C2  3EEA          		LD	A,0EAH		;RTS ON
  D6C4  ED79          		OUT	(C),A
  D6C6                	REC1:
  D6C6  CDDDD6        		CALL	BREAK2
  D6C9  ED78          		IN	A,(C)
  D6CB  0F            		RRCA			;Arrival
  D6CC  30F8          		JR	NC,REC1
  D6CE                	BREAK2X:
  D6CE  3F            		CCF
  D6CF  3E05          		LD	A,5
  D6D1  ED79          		OUT	(C),A
  D6D3  3EE8          		LD	A,0E8H		;RTS OFF
  D6D5  ED79          		OUT	(C),A
                      	
  D6D7  0D            		DEC	C
  D6D8  ED78          		IN	A,(C)		;Read data
  D6DA  C1            		POP	BC
  D6DB  FB            		EI
  D6DC  C9            		RET
                      	
  D6DD                	BREAK2:
  D6DD  3E1A          		LD	A,01AH
  D6DF  DB01          		IN	A,(1)
  D6E1  0F            		RRCA
  D6E2  D8            		RET	C
  D6E3  C1            		POP	BC		;PC
  D6E4  01911F        	SIOAD0:	LD	BC,01F91H
  D6E7  18E5          		JR	BREAK2X
                      	
  D6E9                	_SYS04:
  D6E9  C5            		PUSH	BC
  D6EA  01911F        	SIOAD1:	LD	BC,01F91H
  D6ED                	XMIT1:
  D6ED  CDDDD6        		CALL	BREAK2
  D6F0  3E10          		LD	A,010H		;Reset status
  D6F2  ED79          		OUT	(C),A
  D6F4  ED78          		IN	A,(C)
  D6F6  2F            		CPL
  D6F7  E624          		AND	024H		;CTS Send Empty
  D6F9  20F2          		JR	NZ,XMIT1
  D6FB  0D            		DEC	C
  D6FC  ED59          		OUT	(C),E
  D6FE  C1            		POP	BC
  D6FF  C9            		RET
                      	
  D700                	_SYS05:
  D700  C5            		PUSH	BC
  D701  01011A        		LD	BC,01A01H
  D704                	_S05X1:
  D704  CDDDD6        		CALL	BREAK2
  D707  ED78          		IN	A,(C)
  D709  E608          		AND	8
  D70B  20F7          		JR	NZ,_S05X1
  D70D  F3            		DI
  D70E  0D            		DEC	C
  D70F  ED59          		OUT	(C),E
  D711  0E03          		LD	C,3
  D713  3E0E          		LD	A,00EH
  D715  ED79          		OUT	(C),A
  D717  3C            		INC	A
  D718  03            		INC	BC
  D719  0B            		DEC	BC
  D71A  ED79          		OUT	(C),A
  D71C  FB            		EI
  D71D  C1            		POP	BC
  D71E  AF            		XOR	A
  D71F  C9            		RET
                      	
  D720                	_SYS06:
  D720  7B            		LD	A,E
  D721  3C            		INC	A
  D722  CACAEC        		JP	Z,_INKEY
  D725                	PRINTX:
  D725  C3CDEC        		JP	_PRINT
                      	
  D728                	_SYS08:
  D728  CDFAD9        		CALL	_SYS07
  D72B  1804          		JR	BREAK1
  D72D                	BREAK:
  D72D  FB            		EI
  D72E  3A92EC        		LD	A,(_KEYD)
  D731                	BREAK1:
  D731  FE03          		CP	3
  D733  CA0000        		JP	Z,0
  D736  FE13          		CP	013H
  D738  C0            		RET	NZ
                      	
  D739                	PAUSE:
  D739  CD73D6        		CALL	KEYBC
                      	
  D73C                	FLGET:
  D73C  CDDFEC        		CALL	_FFLUSH
  D73F  C5            		PUSH	BC
  D740  E5            		PUSH	HL
  D741  ED4B8EEC      		LD	BC,(_TXADR)
  D745  CBE8          		SET	5,B
  D747  ED60          		IN	H,(C)
  D749                	FLGET1:
  D749  3A93EC        		LD	A,(_KEYD+1)
  D74C  0F            		RRCA
  D74D  0F            		RRCA
  D74E  E610          		AND	010H
  D750  F608          		OR	8
  D752  ED68          		IN	L,(C)
  D754  B5            		OR	L
  D755  ED79          		OUT	(C),A
  D757  CDCAEC        		CALL	_INKEY
  D75A  28ED          		JR	Z,FLGET1
  D75C  ED61          		OUT	(C),H
  D75E  E1            		POP	HL
  D75F  C1            		POP	BC
  D760  C9            		RET
                      	
  D761                	_SYS0A:
  D761  C5            		PUSH	BC
  D762  E5            		PUSH	HL
  D763  D5            		PUSH	DE
  D764  CD98DB        		CALL	GETL
  D767  1100FF        		LD	DE,KBUF
  D76A  E1            		POP	HL
  D76B  E5            		PUSH	HL
  D76C  0E00          		LD	C,0
  D76E  3004          		JR	NC,SAX0
  D770  23            		INC	HL
  D771  23            		INC	HL
  D772  1808          		JR	SAX4
  D774                	SAX0:
  D774  46            		LD	B,(HL)
  D775  23            		INC	HL
  D776                	SAX1:
  D776  23            		INC	HL
  D777  1A            		LD	A,(DE)
  D778  13            		INC	DE
  D779  B7            		OR	A
  D77A  2004          		JR	NZ,SAX2
  D77C                	SAX4:
  D77C  360D          		LD	(HL),00DH
  D77E  1804          		JR	SAX3
  D780                	SAX2:
  D780  77            		LD	(HL),A
  D781  0C            		INC	C
  D782  10F2          		DJNZ	SAX1
  D784                	SAX3:
  D784  D1            		POP	DE
  D785  79            		LD	A,C
  D786  13            		INC	DE
  D787  12            		LD	(DE),A
  D788  1B            		DEC	DE
  D789  E1            		POP	HL
  D78A  C1            		POP	BC
  D78B  A7            		AND	A
  D78C  C9            		RET
                      	
  D78D                	_SYS0B:
  D78D  CD2DD7        		CALL	BREAK
  D790  3A92EC        		LD	A,(_KEYD)
  D793  B7            		OR	A
  D794  C8            		RET	Z
  D795                	CONSTX:
  D795  CDDFEC        		CALL	_FFLUSH
  D798  E5            		PUSH	HL
  D799  2A90EC        		LD	HL,(_KEYPS)
  D79C  7C            		LD	A,H
  D79D  AD            		XOR	L
  D79E  E1            		POP	HL
  D79F  C6FF          		ADD	A,0FFH
  D7A1  9F            		SBC	A,A
  D7A2  C9            		RET
                      	
  D7A3                	_SYS2A:
  D7A3  C5            		PUSH	BC
  D7A4  3EED          		LD	A,0EDH		;Read calendar
  D7A6  CD59DA        		CALL	COMOUT
  D7A9  CDCCD7        		CALL	IN49SB_BCD		;YY
  D7AC  6F            		LD	L,A
  D7AD  2600          		LD	H,0
  D7AF  116C07        		LD	DE,1900		;0076CH
  D7B2  FE5A          		CP	90
  D7B4  3002          		JR	NC,RDDATE1
  D7B6  1ED0          		LD	E,0D0H		;2000?ｿｽﾌ会ｿｽ1?ｿｽo?ｿｽC?ｿｽg?ｿｽ?ｿｽ?ｿｽ?ｿｽ?ｿｽ?ｿｽ?ｿｽ?ｿｽ?ｿｽﾖゑｿｽ?ｿｽ?ｿｽ D=007H?ｿｽﾅ変会ｿｽ?ｿｽ?ｿｽ?ｿｽﾈゑｿｽ
  D7B8                	RDDATE1:
  D7B8  19            		ADD	HL,DE
  D7B9  CD3EDA        		CALL	IN49SB		;MM
  D7BC  57            		LD	D,A
  D7BD  CDCCD7        		CALL	IN49SB_BCD	;DD
  D7C0  5F            		LD	E,A
  D7C1  7A            		LD	A,D
  D7C2  E607          		AND	7
  D7C4  0604          		LD	B,4
  D7C6                	RDDATE2:
  D7C6  CB3A          		SRL	D
  D7C8  10FC          		DJNZ	RDDATE2
  D7CA  C1            		POP	BC
  D7CB  C9            		RET
  D7CC                	IN49SB_BCD:
  D7CC  CD3EDA        		CALL	IN49SB
  D7CF                	BCD:
  D7CF  4F            		LD	C,A
  D7D0  E6F0          		AND	0F0H
  D7D2  0F            		RRCA
  D7D3  47            		LD	B,A
  D7D4  0F            		RRCA
  D7D5  0F            		RRCA
  D7D6  80            		ADD	A,B
  D7D7  47            		LD	B,A
  D7D8  79            		LD	A,C
  D7D9  E60F          		AND	00FH
  D7DB  80            		ADD	A,B
  D7DC  C9            		RET
                      	
  D7DD                	_SYS2C:
  D7DD  C5            		PUSH	BC
  D7DE  3EEF          		LD	A,0EFH		;Read time
  D7E0  CD59DA        		CALL	COMOUT
  D7E3  CDCCD7        		CALL	IN49SB_BCD	;TT
  D7E6  67            		LD	H,A
  D7E7  CDCCD7        		CALL	IN49SB_BCD	;MM
  D7EA  6F            		LD	L,A
  D7EB  CDCCD7        		CALL	IN49SB_BCD	;SS
  D7EE  57            		LD	D,A
  D7EF  C1            		POP	BC
  D7F0  AF            		XOR	A
  D7F1  C9            		RET
                      	
  D7F2                	MSX1:
  D7F2  5F            		LD	E,A
  D7F3  CDCDEC        		CALL	_PRINT
  D7F6                	MSX:
  D7F6  7E            		LD	A,(HL)
  D7F7  23            		INC	HL
  D7F8  B7            		OR	A
  D7F9  20F7          		JR	NZ,MSX1
  D7FB  C9            		RET
                      	
  D7FC                	ESC1:
  D7FC  7B            		LD	A,E
  D7FD  FE41          		CP	'A'
  D7FF  CA3DD9        		JP	Z,CTRL1E
  D802  FE42          		CP	'B'
  D804  CAC4DA        		JP	Z,CTRL1F
  D807  FE43          		CP	'C'
  D809  CA4AD9        		JP	Z,CTRL1C
  D80C  FE44          		CP	'D'
  D80E  CA33D9        		JP	Z,CTRL1D
  D811  FE45          		CP	'E'
  D813  2802          		JR	Z,CT0CX
  D815  FE6A          		CP	'j'
  D817                	CT0CX:
  D817  CA97DA        		JP	Z,CTRL0C
  D81A  FE48          		CP	'H'
  D81C  CAC8D9        		JP	Z,CTRL0B
  D81F  FE4A          		CP	'J'
  D821  CA9ADA        		JP	Z,CTRL1A
  D824  FE4B          		CP	'K'
  D826  CA8AD9        		JP	Z,CTRL05
  D829  FE4C          		CP	'L'
  D82B  CAD9DA        		JP	Z,CTRL0E
  D82E  FE78          		CP	'x'
  D830  2804          		JR	Z,ESC1X
  D832  FE79          		CP	'y'
  D834  2002          		JR	NZ,ESC1Y
  D836                	ESC1X:
  D836  3601          		LD	(HL),1
  D838                	ESC1Y:
  D838  FE3D          		CP	'='
  D83A  2804          		JR	Z,ESC1W
  D83C  FE59          		CP	'Y'
  D83E  2002          		JR	NZ,ESC1Z
  D840                	ESC1W:
  D840  3602          		LD	(HL),2
  D842                	ESC1Z:
  D842  FE20          		CP	020H
  D844  3802          		JR	C,ESC1C
  D846  87            		ADD	A,A
  D847  D0            		RET	NC
  D848                	ESC1C:
  D848  E1            		POP	HL
  D849  184A          		JR	ANK
                      	
  D84B                	ESC:
  D84B  21A6D8        		LD	HL,PRINTE5
  D84E  E5            		PUSH	HL
  D84F  2171D8        		LD	HL,ESCFLG+1
  D852  3600          		LD	(HL),0
  D854  3D            		DEC	A
  D855  28A5          		JR	Z,ESC1
  D857  3D            		DEC	A
  D858  2009          		JR	NZ,ESC2
  D85A  3603          		LD	(HL),3
  D85C  7B            		LD	A,E
  D85D  D620          		SUB	020H
  D85F  3266D8        		LD	(ESCYP+1),A
  D862  C9            		RET
  D863                	ESC2:
  D863  3D            		DEC	A
  D864  C0            		RET	NZ
  D865  2600          	ESCYP:	LD	H,0
  D867  7B            		LD	A,E
  D868  D620          		SUB	020H
  D86A  6F            		LD	L,A
  D86B  C3D6EC        		JP	_LOC
                      	
  D86E                	PRINT:
  D86E  C5            		PUSH	BC
  D86F  E5            		PUSH	HL
  D870  3E00          	ESCFLG:	LD	A,000H
  D872  B7            		OR	A
  D873  20D6          		JR	NZ,ESC
                      	
  D875  3E1F          		LD	A,01FH
  D877  BB            		CP	E
  D878  3030          		JR	NC,CTRL
  D87A                	PRINTC:
  D87A  A7            	INSFLG:	AND	A
  D87B  DC62DA        		CALL	C,CTRL12
                      	
  D87E  3E00          	KANFLG:	LD	A,000H
  D880  B7            		OR	A
  D881  2041          		JR	NZ,KANJI2
  D883  7B            	X1KPAT:	LD	A,E
  D884  FE80          		CP	080H
  D886  380D          		JR	C,ANK
  D888  FEA0          		CP	0A0H
  D88A  3804          		JR	C,KANJI1
  D88C  FEE0          		CP	0E0H
  D88E  3805          		JR	C,ANK
  D890                	KANJI1:
  D890  327FD8        		LD	(KANFLG+1),A
  D893  1811          		JR	PRINTE5
  D895                	ANK:
  D895  ED4B8EEC      		LD	BC,(_TXADR)
  D899  78            		LD	A,B
  D89A  F638          		OR	038H
  D89C  47            		LD	B,A
                      	;	OUT	(C),0		;?ｿｽ?ｿｽ?ｿｽ?ｿｽ`?ｿｽ?ｿｽ?ｿｽﾟニ?ｿｽ[?ｿｽ?ｿｽ?ｿｽj?ｿｽb?ｿｽN
  D89D  ED71          		DB	0EDH,071H		;Kanji
  D89F  CB98          		RES	3,B
  D8A1  ED59          		OUT	(C),E		;Text
  D8A3                	KANJIE:
  D8A3  CD0FD9        		CALL	PRINTE7
  D8A6                	PRINTE5:
  D8A6  E1            		POP	HL
  D8A7  C1            		POP	BC
  D8A8  AF            		XOR	A
  D8A9  C9            		RET
                      	
  D8AA                	CTRL:
  D8AA  CDF6D8        		CALL	KANCLR
  D8AD  3EA7          		LD	A,0A7H		;AND	A
  D8AF  327AD8        		LD	(INSFLG),A
  D8B2  7B            		LD	A,E
  D8B3  87            		ADD	A,A
  D8B4  4F            		LD	C,A
  D8B5  0600          		LD	B,0
  D8B7  2123DC        		LD	HL,CTRLTB
  D8BA  09            		ADD	HL,BC
  D8BB  7E            		LD	A,(HL)
  D8BC  23            		INC	HL
  D8BD  66            		LD	H,(HL)
  D8BE  6F            		LD	L,A
  D8BF  CD0F00        		CALL	K_HL
  D8C2  18E2          		JR	PRINTE5
                      	
  D8C4                	KANJI2:
  D8C4  D5            		PUSH	DE
  D8C5  57            		LD	D,A
  D8C6  01812F        		LD	BC,02F81H	;SFTJIS
  D8C9  DF            		RST	018H
  D8CA  01C32F        		LD	BC,02FC3H	;Instead or JISVRM
  D8CD  DF            		RST	018H
                      	
  D8CE  ED4B8EEC      		LD	BC,(_TXADR)
  D8D2  78            		LD	A,B
  D8D3  F638          		OR	038H
  D8D5  47            		LD	B,A
  D8D6  ED51          		OUT	(C),D		;kanji
  D8D8  CB98          		RES	3,B
  D8DA  ED59          		OUT	(C),E		;Text
  D8DC  CD0FD9        		CALL	PRINTE7
  D8DF  ED4B8EEC      		LD	BC,(_TXADR)
  D8E3  78            		LD	A,B
  D8E4  F638          		OR	038H
  D8E6  47            		LD	B,A
  D8E7  CBF2          		SET	6,D
  D8E9  ED51          		OUT	(C),D		;Kanji
  D8EB  CB98          		RES	3,B
  D8ED  ED59          		OUT	(C),E		;Text
  D8EF  D1            		POP	DE
  D8F0  AF            		XOR	A
  D8F1  327FD8        		LD	(KANFLG+1),A
  D8F4  18AD          		JR	KANJIE
                      	
  D8F6                	KANCLR:
  D8F6  3A7FD8        		LD	A,(KANFLG+1)
  D8F9  B7            		OR	A
  D8FA  C8            		RET	Z
  D8FB  ED4B8EEC      		LD	BC,(_TXADR)
  D8FF  78            		LD	A,B
  D900  F638          		OR	038H
  D902  47            		LD	B,A
  D903  AF            		XOR	A
  D904  327FD8        		LD	(KANFLG+1),A
  D907  ED79          		OUT	(C),A		;Kanji
  D909  CB98          		RES	3,B
  D90B  3E20          		LD	A,020H
  D90D  ED79          		OUT	(C),A		;Text
  D90F                	PRINTE7:
  D90F  CBA0          		RES	4,B
  D911                	PRINTE6:
  D911  3A96EC        		LD	A,(_COLORF)
  D914                	PRINTE4:
  D914  ED79          		OUT	(C),A		;Color
  D916  78            		LD	A,B
  D917  E607          		AND	7
  D919  47            		LD	B,A
  D91A                	PRINTE2:
  D91A  03            		INC	BC
  D91B                	PRINTE3:
  D91B  2ABAEC        		LD	HL,(CRTCD+10)
  D91E  A7            		AND	A
  D91F  ED4A          		ADC	HL,BC
  D921                	PRINTE8:
  D921  2805          		JR	Z,PRINT2
  D923                	PRINTE1:
  D923  ED438EEC      		LD	(_TXADR),BC
  D927                	PRINTE:
  D927  C9            		RET
                      	
  D928                	PRINT2:
  D928  CDDEDA        		CALL	SCR
  D92B  2ABCEC        		LD	HL,(CRTCD+12)
  D92E  09            		ADD	HL,BC
  D92F  228EEC        		LD	(_TXADR),HL
  D932  C9            		RET
                      	
  D933                	CTRL08:
  D933                	CTRL1D:
  D933  ED4B8EEC      		LD	BC,(_TXADR)
  D937  78            		LD	A,B
  D938  B1            		OR	C
  D939  C8            		RET	Z
  D93A  0B            		DEC	BC
  D93B  18E6          		JR	PRINTE1
                      	
  D93D                	CTRL1E:
  D93D  ED4B8EEC      		LD	BC,(_TXADR)
  D941  2ABCEC        		LD	HL,(CRTCD+12)
  D944  09            		ADD	HL,BC
  D945  D0            		RET	NC
  D946  44            		LD	B,H
  D947  4D            		LD	C,L
  D948  18D9          		JR	PRINTE1
                      	
  D94A                	CTRL1C:
  D94A  ED4B8EEC      		LD	BC,(_TXADR)
  D94E  18CA          		JR	PRINTE2
                      	
  D950                	CTRL09:
  D950  ED4B8EEC      		LD	BC,(_TXADR)
  D954  79            		LD	A,C
  D955  E6F8          		AND	0F8H
  D957  C608          		ADD	A,8
  D959  4F            		LD	C,A
  D95A  88            		ADC	A,B
  D95B  91            		SUB	C
  D95C  47            		LD	B,A
  D95D  18BC          		JR	PRINTE3
                      	
  D95F                	CTRL02:
  D95F  2A8EEC        		LD	HL,(_TXADR)
  D962  7C            		LD	A,H
  D963  B5            		OR	L
  D964  C8            		RET	Z
  D965  2B            		DEC	HL
  D966  228EEC        		LD	(_TXADR),HL
  D969  D5            		PUSH	DE
  D96A  CDD3EC        		CALL	_POS
  D96D  3AB1EC        		LD	A,(CRTCD+1)
  D970  95            		SUB	L
  D971  6F            		LD	L,A
  D972  2D            		DEC	L
  D973  2638          		LD	H,038H
  D975  ED4B8EEC      		LD	BC,(_TXADR)
  D979  09            		ADD	HL,BC
  D97A  44            		LD	B,H
  D97B  4D            		LD	C,L
  D97C  110020        		LD	DE,02000H	;D:Text E:kanji
  D97F  2A96EC        		LD	HL,(_COLORF)	;L:Color
  D982                	C8X1:
  D982  CD7EDA        		CALL	C12S
  D985  0B            		DEC	BC
  D986  20FA          		JR	NZ,C8X1
  D988  D1            		POP	DE
  D989  C9            		RET
                      	
  D98A                	CTRL05:
  D98A  CDD3EC        		CALL	_POS
  D98D  3AB1EC        		LD	A,(CRTCD+1)
  D990  95            		SUB	L
  D991  6F            		LD	L,A
  D992  2620          		LD	H,020H
  D994  ED4B8EEC      		LD	BC,(_TXADR)
  D998                	C05X1:
  D998  78            		LD	A,B
  D999  F638          		OR	038H
  D99B  47            		LD	B,A
                      	;	OUT	(C),0		;?ｿｽ?ｿｽ?ｿｽ?ｿｽ`?ｿｽ?ｿｽ?ｿｽﾟニ?ｿｽ[?ｿｽ?ｿｽ?ｿｽj?ｿｽb?ｿｽN
  D99C  ED71          		DB	0EDH,071H		;kanji
  D99E  CB98          		RES	3,B
  D9A0  ED61          		OUT	(C),H		;Text
  D9A2  CBA0          		RES	4,B
  D9A4  3A96EC        		LD	A,(_COLORF)
  D9A7  ED79          		OUT	(C),A		;Color
  D9A9  03            		INC	BC
  D9AA  2D            		DEC	L
  D9AB  20EB          		JR	NZ,C05X1
  D9AD  C9            		RET
                      	
  D9AE                	CTRL0D:
  D9AE  CDD3EC        		CALL	_POS
  D9B1  2E00          		LD	L,0
  D9B3                	LOC:
  D9B3  C5            		PUSH	BC
  D9B4  E5            		PUSH	HL
  D9B5  CDF6D8        		CALL	KANCLR
  D9B8  CDDBD9        		CALL	LOC1
  D9BB  ED438EEC      		LD	(_TXADR),BC
  D9BF  E1            		POP	HL
  D9C0  C1            		POP	BC
  D9C1  C9            		RET
                      	
  D9C2                	CTRL01:
  D9C2  3E37          		LD	A,037H		;SCF
  D9C4  327AD8        		LD	(INSFLG),A
  D9C7  C9            		RET
                      	
  D9C8                	CTRL0B:
  D9C8  210000        		LD	HL,0
  D9CB  228EEC        		LD	(_TXADR),HL
  D9CE  C9            		RET
                      	
  D9CF                	PRINTS:
  D9CF  CD2DD7        		CALL	BREAK
  D9D2  C3CDEC        		JP	_PRINT
                      	
  D9D5                	CTRL1B:
  D9D5  3E01          		LD	A,1
  D9D7  3271D8        		LD	(ESCFLG+1),A
  D9DA  C9            		RET
                      	
  D9DB                	LOC1:
  D9DB  44            		LD	B,H
  D9DC  4D            		LD	C,L
  D9DD  04            		INC	B
  D9DE  05            		DEC	B
  D9DF  C8            		RET	Z
  D9E0  D5            		PUSH	DE
  D9E1  ED5BB1EC      		LD	DE,(CRTCD+1)
  D9E5  210000        		LD	HL,0
  D9E8  55            		LD	D,L
  D9E9                	LOC2:
  D9E9  19            		ADD	HL,DE
  D9EA  10FD          		DJNZ	LOC2
  D9EC  09            		ADD	HL,BC
  D9ED  D1            		POP	DE
  D9EE                	LOC3:
  D9EE  44            		LD	B,H
  D9EF  4D            		LD	C,L
  D9F0  C9            		RET
                      	
  D9F1                	BOOT:
  D9F1  C30000        		JP	0
  D9F4                	WBOOT:
  D9F4  C3AACC        		JP	_SYS00
  D9F7                	CONST_:
  D9F7  C395D7        		JP	CONSTX
  D9FA                	_SYS07:
  D9FA                	CONIN:
  D9FA  C33CD7        		JP	FLGET
  D9FD                	CONOUT0:
  D9FD  C300DA        		JP	CONOUT
  DA00                	CONOUT:
  DA00  CD12DA        		CALL	CURSOR
  DA03  59            		LD	E,C
  DA04  CDCDEC        		CALL	_PRINT
  DA07  7B            		LD	A,E
  DA08  FE0A          		CP	00AH
  DA0A  2006          		JR	NZ,CURSOR
  DA0C  CDAED9        		CALL	CTRL0D
  DA0F  CD8AD9        		CALL	CTRL05
  DA12                	CURSOR:
  DA12  C5            		PUSH	BC
  DA13  ED4B8EEC      		LD	BC,(_TXADR)
  DA17  CBE8          		SET	5,B
  DA19  ED78          		IN	A,(C)
  DA1B  EE18          		XOR	018H
  DA1D  ED79          		OUT	(C),A
  DA1F  C1            		POP	BC
  DA20  C9            		RET
                      	
  DA21                	CTRL07:
  DA21  2163DC        		LD	HL,BEEPD
  DA24                	BEEP1:
  DA24  7E            		LD	A,(HL)
  DA25  23            		INC	HL
  DA26  FEFF          		CP	0FFH
  DA28  C8            		RET	Z
  DA29  F3            		DI
  DA2A  061C          		LD	B,01CH
  DA2C  ED79          		OUT	(C),A
  DA2E  EDA3          		OUTI
  DA30  FB            		EI
  DA31  18F1          		JR	BEEP1
                      	
  DA33                	OT49SB:
  DA33  C5            		PUSH	BC
  DA34  CD4FDA        		CALL	CANW
  DA37  010019        		LD	BC,01900H
  DA3A  ED79          		OUT	(C),A
  DA3C  C1            		POP	BC
  DA3D  C9            		RET
                      	
  DA3E                	IN49SB:
  DA3E  C5            		PUSH	BC
  DA3F  01011A        		LD	BC,01A01H
  DA42                	CANR:
  DA42  ED78          		IN	A,(C)
  DA44  E620          		AND	020H
  DA46  20FA          		JR	NZ,CANR
  DA48  010019        		LD	BC,01900H
  DA4B  ED78          		IN	A,(C)
  DA4D  C1            		POP	BC
  DA4E  C9            		RET
                      	
  DA4F                	CANW:
  DA4F  01011A        		LD	BC,01A01H
  DA52  ED48          		IN	C,(C)
  DA54  CB71          		BIT	6,C
  DA56  20F7          		JR	NZ,CANW
  DA58  C9            		RET
                      	
  DA59                	COMOUT:
  DA59  FB            		EI
  DA5A  CD33DA        		CALL	OT49SB
  DA5D  CD4FDA        		CALL	CANW
  DA60  F3            		DI
  DA61  C9            		RET
                      	
  DA62                	CTRL12:
  DA62  D5            		PUSH	DE
  DA63  CDD3EC        		CALL	_POS
  DA66  3AB1EC        		LD	A,(CRTCD+1)
  DA69  95            		SUB	L
  DA6A  ED4B8EEC      		LD	BC,(_TXADR)
  DA6E  110020        		LD	DE,02000H	;D:Text E:Kanji
  DA71  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DA74  CBE8          		SET	5,B
  DA76                	C12X1:
  DA76  CD7EDA        		CALL	C12S
  DA79  03            		INC	BC
  DA7A  20FA          		JR	NZ,C12X1
  DA7C  D1            		POP	DE
  DA7D  C9            		RET
                      	
  DA7E                	C12S:
  DA7E  CBE0          		SET	4,B
  DA80  CBD8          		SET	3,B
  DA82  ED60          		IN	H,(C)
  DA84  ED59          	X1PAT:	OUT	(C),E
  DA86  5C            		LD	E,H
  DA87  CB98          		RES	3,B
  DA89  ED60          		IN	H,(C)
  DA8B  ED51          		OUT	(C),D
  DA8D  54            		LD	D,H
  DA8E  CBA0          		RES	4,B
  DA90  ED60          		IN	H,(C)
  DA92  ED69          		OUT	(C),L
  DA94  6C            		LD	L,H
  DA95  3D            		DEC	A
  DA96  C9            		RET
                      	
  DA97                	CTRL0C:
  DA97  CDC8D9        		CALL	CTRL0B
  DA9A                	CTRL1A:
  DA9A  ED4B8EEC      		LD	BC,(_TXADR)
  DA9E                	C1AX1:
  DA9E  78            		LD	A,B
  DA9F  F638          		OR	038H
  DAA1  47            		LD	B,A
                      	;	OUT	(C),0		;?ｿｽ?ｿｽ?ｿｽ?ｿｽ`?ｿｽ?ｿｽ?ｿｽﾟニ?ｿｽ[?ｿｽ?ｿｽ?ｿｽj?ｿｽb?ｿｽN
  DAA2  ED71          		DB	0EDH,071H		;kanji
  DAA4  CB98          		RES	3,B
  DAA6  3E20          		LD	A,020H
  DAA8  ED79          		OUT	(C),A		;Text
  DAAA  CBA0          		RES	4,B
  DAAC  3A96EC        		LD	A,(_COLORF)
  DAAF  ED79          		OUT	(C),A		;Color
  DAB1  03            		INC	BC
  DAB2  CBA8          		RES	5,B
  DAB4  2ABAEC        		LD	HL,(CRTCD+10)
  DAB7  09            		ADD	HL,BC
  DAB8  30E4          		JR	NC,C1AX1
  DABA  C9            		RET
                      	
  DABB                	CTRL04:
  DABB  CDD3EC        		CALL	_POS
  DABE  7D            		LD	A,L
  DABF  B7            		OR	A
  DAC0  C8            		RET	Z
  DAC1                	CTRL03:
  DAC1  CDAED9        		CALL	CTRL0D
  DAC4                	CTRL0A:
  DAC4                	CTRL1F:
  DAC4  ED4B8EEC      		LD	BC,(_TXADR)
  DAC8  2AB1EC        		LD	HL,(CRTCD+1)
  DACB  2600          		LD	H,0
  DACD  09            		ADD	HL,BC
  DACE  44            		LD	B,H
  DACF  4D            		LD	C,L
  DAD0  2ABAEC        		LD	HL,(CRTCD+10)
  DAD3  09            		ADD	HL,BC
  DAD4  3F            		CCF
  DAD5  9F            		SBC	A,A
  DAD6  C321D9        		JP	PRINTE8
                      	
  DAD9                	CTRL0E:
  DAD9  CDD3EC        		CALL	_POS
  DADC  7C            		LD	A,H
  DADD  01            		DB	001H
  DADE                	SCR:
  DADE  3A97EC        		LD	A,(_LINE)
  DAE1  3D            		DEC	A
  DAE2                	SCR1:
  DAE2  C5            		PUSH	BC
  DAE3  D5            		PUSH	DE
  DAE4  01801F        		LD	BC,01F80H	;DMA
  DAE7  1EC3          		LD	E,0C3H
  DAE9  ED59          		OUT	(C),E
  DAEB  119A65        		LD	DE,0659AH
  DAEE  ED59          		OUT	(C),E
  DAF0  ED51          		OUT	(C),D
  DAF2  114F00        		LD	DE,79
  DAF5  ED59          		OUT	(C),E
  DAF7  ED51          		OUT	(C),D
                      	
  DAF9  210038        		LD	HL,03800H
  DAFC  11181C        		LD	DE,01C18H
  DAFF  ED51          		OUT	(C),D
  DB01  ED59          		OUT	(C),E
                      	
  DB03                	SCRUP1:
  DB03  B7            		OR	A
  DB04  2839          		JR	Z,SCRCL
  DB06  F5            		PUSH	AF
  DB07  CD20DB        		CALL	UPSUB		;kanji
  DB0A  ED5BBCEC      		LD	DE,(CRTCD+12)
  DB0E  16F7          		LD	D,0F7H
  DB10  19            		ADD	HL,DE
  DB11  D5            		PUSH	DE
  DB12  CD20DB        		CALL	UPSUB		;Text
  DB15  D1            		POP	DE
  DB16  19            		ADD	HL,DE
  DB17  CD20DB        		CALL	UPSUB		;Color
  DB1A  CBE4          		SET	4,H
  DB1C  F1            		POP	AF
  DB1D  3D            		DEC	A
  DB1E  18E3          		JR	SCRUP1
                      	
  DB20                	UPSUB:
  DB20  ED5BB1EC      		LD	DE,(CRTCD+1)
  DB24  1600          		LD	D,0
  DB26  3ECD          		LD	A,0CDH
  DB28  ED79          		OUT	(C),A
  DB2A  ED69          		OUT	(C),L		;SOURCE
  DB2C  ED61          		OUT	(C),H
  DB2E  19            		ADD	HL,DE
  DB2F  3E1D          		LD	A,01DH
  DB31  ED79          		OUT	(C),A		;DIST
  DB33  ED69          		OUT	(C),L
  DB35  ED61          		OUT	(C),H
  DB37  1187CF        		LD	DE,0CF87H
  DB3A  ED51          		OUT	(C),D
  DB3C  ED59          		OUT	(C),E
  DB3E  C9            		RET
                      	
  DB3F                	SCRCL:
  DB3F  44            		LD	B,H
  DB40  4D            		LD	C,L
  DB41  215020        		LD	HL,02000H+80
  DB44  3A96EC        		LD	A,(_COLORF)
  DB47                	SCRCL1:
                      	;	OUT	(C),0		;?ｿｽ?ｿｽ?ｿｽ?ｿｽ`?ｿｽ?ｿｽ?ｿｽﾟニ?ｿｽ[?ｿｽ?ｿｽ?ｿｽj?ｿｽb?ｿｽN
  DB47  ED71          		DB	0EDH,071H
  DB49  CB98          		RES	3,B
  DB4B  ED61          		OUT	(C),H
  DB4D  CBA0          		RES	4,B
  DB4F  ED79          		OUT	(C),A
  DB51  CBD8          		SET	3,B
  DB53  CBE0          		SET	4,B
  DB55  03            		INC	BC
  DB56  2D            		DEC	L
  DB57  20EE          		JR	NZ,SCRCL1
  DB59  D1            		POP	DE
  DB5A  C1            		POP	BC
  DB5B  C9            		RET
                      	
  DB5C                	SCRN:
  DB5C  D5            		PUSH	DE
  DB5D  ED58          		IN	E,(C)		;Text
  DB5F  CBD8          		SET	3,B
  DB61  ED50          		IN	D,(C)		;Kanji
  DB63  2819          		JR	Z,SCRNE
  DB65  AF            		XOR	A
  DB66  C5            		PUSH	BC
  DB67  013730        		LD	BC,03037H	;VRMJIS
  DB6A  DF            		RST	018H
  DB6B  01522F        		LD	BC,02F52H	;JISSFT
  DB6E  DF            		RST	018H
  DB6F  C1            		POP	BC
  DB70  ED78          		IN	A,(C)
  DB72  CB98          		RES	3,B
  DB74  E640          		AND	040H
  DB76  2003          		JR	NZ,SCRN1
  DB78  7A            		LD	A,D
  DB79  D1            		POP	DE
  DB7A  C9            		RET
  DB7B                	SCRN1:
  DB7B  7B            		LD	A,E
  DB7C  D1            		POP	DE
  DB7D  C9            		RET
                      	
  DB7E                	SCRNE:
  DB7E  D1            		POP	DE
  DB7F  CB98          		RES	3,B
  DB81                	SCRNX:
  DB81  ED78          		IN	A,(C)
  DB83  C9            		RET
                      	
  DB84                	POS:
  DB84  2A8EEC        		LD	HL,(_TXADR)
  DB87  C5            		PUSH	BC
  DB88  ED4BBCEC      		LD	BC,(CRTCD+12)
  DB8C  AF            		XOR	A
  DB8D                	POS1:
  DB8D  09            		ADD	HL,BC
  DB8E  3C            		INC	A
  DB8F  38FC          		JR	C,POS1
  DB91  ED42          		SBC	HL,BC
  DB93  3D            		DEC	A
  DB94  67            		LD	H,A
  DB95  C1            		POP	BC
  DB96  A7            		AND	A
  DB97  C9            		RET
                      	
  DB98                	GETL:
  DB98  CDD3EC        		CALL	_POS
  DB9B  E5            		PUSH	HL
  DB9C                	GETL1:
  DB9C  CDD3EC        		CALL	_POS
  DB9F  C1            		POP	BC
  DBA0  C5            		PUSH	BC
  DBA1  7D            		LD	A,L
  DBA2  91            		SUB	C
  DBA3  69            		LD	L,C
  DBA4  4F            		LD	C,A
  DBA5  DCD6EC        		CALL	C,_LOC
  DBA8                	GET1W:
  DBA8  CD28D7        		CALL	_SYS08
  DBAB  FE08          		CP	8
  DBAD  2007          		JR	NZ,GETL1X
  DBAF  0D            		DEC	C
  DBB0  CB79          		BIT	7,C
  DBB2  2002          		JR	NZ,GETL1X
  DBB4  3E02          		LD	A,2
  DBB6                	GETL1X:
  DBB6  FE1B          		CP	01BH
  DBB8  2016          		JR	NZ,GETL1V
  DBBA  CD28D7        		CALL	_SYS08
  DBBD  FE22          		CP	022H
  DBBF  2008          		JR	NZ,GETL1Y
  DBC1  2100FF        		LD	HL,KBUF
  DBC4  CDF6D7        		CALL	MSX
  DBC7  180B          		JR	GETL1Z
  DBC9                	GETL1Y:
  DBC9  F5            		PUSH	AF
  DBCA  1E1B          		LD	E,01BH
  DBCC  CDCDEC        		CALL	_PRINT
  DBCF  F1            		POP	AF
  DBD0                	GETL1V:
  DBD0  5F            		LD	E,A
  DBD1  CDCDEC        		CALL	_PRINT
  DBD4                	GETL1Z:
  DBD4  7B            		LD	A,E
  DBD5  FE0D          		CP	00DH
  DBD7  20C3          		JR	NZ,GETL1
                      	
  DBD9  2100FF        		LD	HL,KBUF
  DBDC  AF            		XOR	A
  DBDD  ED4BB0EC      		LD	BC,(CRTCD)
  DBE1                	GETL0:
  DBE1  77            		LD	(HL),A
  DBE2  23            		INC	HL
  DBE3  10FC          		DJNZ	GETL0
                      	
  DBE5  D1            		POP	DE
  DBE6  CDD3EC        		CALL	_POS
  DBE9  6B            		LD	L,E
  DBEA  3AB1EC        		LD	A,(CRTCD+1)
  DBED  95            		SUB	L
  DBEE  57            		LD	D,A
  DBEF  CDDBD9        		CALL	LOC1
  DBF2  78            		LD	A,B
  DBF3  F630          		OR	030H
  DBF5  47            		LD	B,A
  DBF6  5A            		LD	E,D
  DBF7  2100FF        		LD	HL,KBUF
  DBFA                	GETL2:
  DBFA  CDD0EC        		CALL	_SCRN
  DBFD  03            		INC	BC
  DBFE  77            		LD	(HL),A
  DBFF  23            		INC	HL
  DC00  1D            		DEC	E
  DC01  20F7          		JR	NZ,GETL2
  DC03                	GETL3:
  DC03  2B            		DEC	HL
  DC04  7E            		LD	A,(HL)
  DC05  FE21          		CP	021H
  DC07  D0            		RET	NC
  DC08  3600          		LD	(HL),0
  DC0A  15            		DEC	D
  DC0B  20F6          		JR	NZ,GETL3
  DC0D  C9            		RET
                      	
  DC0E                	INKEY:
  DC0E  FB            		EI
  DC0F  E5            		PUSH	HL
  DC10  2A90EC        		LD	HL,(_KEYPS)
  DC13  7C            		LD	A,H
  DC14  AD            		XOR	L
  DC15  2809          		JR	Z,INKEY1
  DC17  7C            		LD	A,H
  DC18  3C            		INC	A
  DC19  3291EC        		LD	(_KEYPS+1),A
  DC1C  6F            		LD	L,A
  DC1D  26FE          		LD	H,KEYBF/256
  DC1F  7E            		LD	A,(HL)
  DC20                	INKEY1:
  DC20  E1            		POP	HL
  DC21  B7            		OR	A
  DC22  C9            		RET
                      	
  DC23                	CTRLTB:
  DC23  27D9C2D95FD9C1		DW	PRINTE,CTRL01,CTRL02,CTRL03
  DC2B  BBDA8AD99ADA21		DW	CTRL04,CTRL05,CTRL1A,CTRL07
  DC33  33D950D9C4DAC8		DW	CTRL08,CTRL09,CTRL0A,CTRL0B
  DC3B  97DAAED9D9DA27		DW	CTRL0C,CTRL0D,CTRL0E,PRINTE
  DC43  27D927D9C2D927		DW	PRINTE,PRINTE,CTRL01,PRINTE
  DC4B  27D927D927D927		DW	PRINTE,PRINTE,PRINTE,PRINTE
  DC53  27D927D99ADAD5		DW	PRINTE,PRINTE,CTRL1A,CTRL1B
  DC5B  4AD933D93DD9C4		DW	CTRL1C,CTRL1D,CTRL1E,CTRL1F
                      	
  DC63                	BEEPD:
  DC63  008E01000B000C		DB	0,08EH,1,0,00BH,0,00CH,010H
  DC6B  073E08100D00FF		DB	007H,03EH,008H,010H,00DH,0,0FFH
                      	
  DC72  00            	REDDATA:DB	0
                      	
  DC73                		DS	6	;余りの数合わせ
                      	
                      	
                      	;LDFILE.ASM
                      	
                      	;	LSX-Dodgers FILE
                      	
  DC79                	FILEC:
  DC79  CD84DC        		CALL	FILE
  DC7C                	FILEC2:
  DC7C  3ADC00        		LD	A,(FDRV+1)
  DC7F  FE20          		CP	020H
  DC81  C8            		RET	Z
  DC82  183B          		JR	SETDIR1
                      	
  DC84                	FILE:
  DC84  AF            		XOR	A
  DC85  32DB00        		LD	(FDRV),A
  DC88  67            		LD	H,A
  DC89  6F            		LD	L,A
  DC8A  22E900        		LD	(FDRV+14),HL
  DC8D  CD5EDD        		CALL	SPCUT
  DC90  CD43DD        		CALL	CCHK3
  DC93  2812          		JR	Z,DEVI1
  DC95  13            		INC	DE
  DC96  1A            		LD	A,(DE)
  DC97  1B            		DEC	DE
  DC98  FE3A          		CP	':'
  DC9A  200B          		JR	NZ,DEVI1
  DC9C  1A            		LD	A,(DE)		;DRIVE
  DC9D  CD6FDF        		CALL	CAP
  DCA0  D640          		SUB	'@'
  DCA2  13            		INC	DE
  DCA3  13            		INC	DE
  DCA4  32DB00        		LD	(FDRV),A
  DCA7                	DEVI1:
  DCA7  1A            		LD	A,(DE)
  DCA8  D65C          		SUB	05CH
  DCAA  200B          		JR	NZ,NOROOT
  DCAC  210000        		LD	HL,0
  DCAF  22F500        		LD	(FDRV+26),HL
  DCB2  2C            		INC	L
  DCB3  22E900        		LD	(FDRV+14),HL
  DCB6  13            		INC	DE
  DCB7                	NOROOT:
                      	
  DCB7                	SETDIR:
  DCB7  CDE3DC        		CALL	FILED
  DCBA  1A            		LD	A,(DE)
  DCBB  FE5C          		CP	05CH
  DCBD  C0            		RET	NZ
  DCBE  13            		INC	DE
  DCBF                	SETDIR1:
  DCBF  3E10          		LD	A,010H		;Directory
  DCC1  32E800        		LD	(FDRV+13),A
  DCC4  D5            		PUSH	DE
  DCC5  11DB00        		LD	DE,FDRV
  DCC8  2A1EEC        		LD	HL,(STABLE+2*00FH)
  DCCB  CD0F00        		CALL	K_HL
  DCCE  D1            		POP	DE
  DCCF  B7            		OR	A
  DCD0  C0            		RET	NZ
                      	
  DCD1  3AE800        		LD	A,(FDRV+13)
  DCD4  CB67          		BIT	4,A
  DCD6  C8            		RET	Z
                      	
  DCD7  CD2ADD        		CALL	FILEI
  DCDA  2AF500        		LD	HL,(FDRV+26)
  DCDD  23            		INC	HL
  DCDE  22E900        		LD	(FDRV+14),HL
  DCE1  18D4          		JR	SETDIR
                      	
  DCE3                	FILED:
  DCE3  CD2ADD        		CALL	FILEI
                      	
  DCE6  0608          		LD	B,8
  DCE8                	FILE2:
  DCE8  CD38DD        		CALL	CCHKF
  DCEB  C8            		RET	Z
  DCEC  FE2A          		CP	'*'
  DCEE  282E          		JR	Z,FILE9
  DCF0  FE2E          		CP	'.'
  DCF2  280C          		JR	Z,FILE4
  DCF4  77            		LD	(HL),A
  DCF5  23            		INC	HL
  DCF6  10F0          		DJNZ	FILE2
                      	
  DCF8                	FILE3:
  DCF8  CD38DD        		CALL	CCHKF
  DCFB  C8            		RET	Z
  DCFC  FE2E          		CP	'.'
  DCFE  20F8          		JR	NZ,FILE3
                      	
  DD00                	FILE4:
  DD00  21E400        		LD	HL,FNAME+8
  DD03  0603          		LD	B,3
                      	
  DD05                	FILE4L:
  DD05  CD38DD        		CALL	CCHKF
  DD08  C8            		RET	Z
  DD09  FE2E          		CP	'.'
  DD0B  2008          		JR	NZ,FILE12
  DD0D  32DC00        		LD	(FNAME),A	;Parent directory(..)
  DD10  32DD00        		LD	(FNAME+1),A
  DD13  3E20          		LD	A,020H
  DD15                	FILE12:
  DD15  FE2A          		CP	'*'
  DD17  280A          		JR	Z,FILE10
  DD19  77            		LD	(HL),A
  DD1A  23            		INC	HL
  DD1B  10E8          		DJNZ	FILE4L
  DD1D  C9            		RET
                      	
  DD1E                	FILE9:
  DD1E  CD23DD        		CALL	FILE10
  DD21  18D5          		JR	FILE3
                      	
  DD23                	FILE10:
  DD23  3E3F          		LD	A,'?'
                      	
  DD25                	FILE7:
  DD25  77            		LD	(HL),A
  DD26  23            		INC	HL
  DD27  10FC          		DJNZ	FILE7
  DD29  C9            		RET
                      	
  DD2A                	FILEI:
  DD2A  3E20          		LD	A,020H
  DD2C  01000B        		LD	BC,11*256
  DD2F  21DC00        		LD	HL,FNAME
  DD32  E5            		PUSH	HL
  DD33  CD25DD        		CALL	FILE7
  DD36  E1            		POP	HL
  DD37  C9            		RET
                      	
  DD38                	CCHKF:
  DD38  1A            		LD	A,(DE)
  DD39  CD40DD        		CALL	CCHK2
  DD3C  C8            		RET	Z
  DD3D  C37FE0        		JP	FKAN
                      	
  DD40                	CCHK2:
  DD40  0C            		INC	C
  DD41  0D            		DEC	C
  DD42  C0            		RET	NZ
  DD43                	CCHK3:
  DD43  FE2B          		CP	'+'
  DD45  C8            		RET	Z
  DD46  FE2C          		CP	','
  DD48  C8            		RET	Z
  DD49  FE2F          		CP	'/'
  DD4B  C8            		RET	Z
  DD4C  FE3A          		CP	':'
  DD4E  C8            		RET	Z
  DD4F  FE3B          		CP	';'
  DD51  C8            		RET	Z
  DD52  FE3D          		CP	'='
  DD54  C8            		RET	Z
  DD55  FE5C          		CP	05CH
  DD57  C8            		RET	Z
  DD58  FE20          		CP	020H
  DD5A  D0            		RET	NC
  DD5B  BF            		CP	A		;Z=1
  DD5C  C9            		RET
                      	
  DD5D                	SS1:
  DD5D  13            		INC	DE
  DD5E                	SPCUT:
  DD5E  1A            		LD	A,(DE)
  DD5F  FE20          		CP	020H
  DD61  28FA          		JR	Z,SS1
  DD63  C9            		RET
                      	
  DD64                	SETDRVF:
  DD64  11DB00        		LD	DE,FDRV
  DD67                	SETDRV0:
  DD67  CD70DD        		CALL	SETDRV
  DD6A  FDE1          		POP	IY
  DD6C  C1            		POP	BC
  DD6D  D1            		POP	DE
  DD6E  E1            		POP	HL
  DD6F  C9            		RET
                      	
  DD70                	SETDRV:
  DD70  E3            		EX	(SP),HL		;HL=RETRN ADDRESS
  DD71  D5            		PUSH	DE		;PUSH HL/DE/BC/IY
  DD72  C5            		PUSH	BC
  DD73  1A            		LD	A,(DE)
                      	;	EX	DE,IY
  DD74  D5            		PUSH	DE
  DD75  FDE3          		EX	(SP),IY
  DD77  D1            		POP	DE
                      	;
  DD78  D5            		PUSH	DE
  DD79  CD85DD        		CALL	GETDRV
  DD7C  3C            		INC	A
  DD7D  FD7700        		LD	(IY+0),A
  DD80  3D            		DEC	A
  DD81  CDD9EC        		CALL	_CHGDRV
                      	
  DD84  E9            		JP	(HL)
                      	
  DD85                	GETDRV:
  DD85  E67F          		AND	07FH
  DD87  D601          		SUB	001H
  DD89  3003          		JR	NC,GETDRV1
  DD8B  3A87EC        		LD	A,(_DVSW)	;Current Drive
  DD8E                	GETDRV1:
  DD8E  3288EC        		LD	(_DRV),A
  DD91  C9            		RET
                      	
  DD92                	SOPENX:
  DD92  CDFBDE        		CALL	CHKDDX
  DD95  3802          		JR	C,SOPENX1
  DD97  C1            		POP	BC
  DD98  E9            		JP	(HL)
  DD99                	SOPENX1:
  DD99  1136E2        		LD	DE,SFILE
  DD9C  1A            		LD	A,(DE)
  DD9D  FDBE00        		CP	(IY+0)
  DDA0  2024          		JR	NZ,SOPEN
  DDA2  13            		INC	DE
  DDA3  FDE5          		PUSH	IY
  DDA5  E1            		POP	HL
  DDA6  23            		INC	HL
  DDA7  CD2BDF        		CALL	CPFILE
  DDAA  201A          		JR	NZ,SOPEN
                      	
  DDAC  2A30E2        		LD	HL,(SCDIR)
  DDAF  FD750E        		LD	(IY+14),L
  DDB2  FD740F        		LD	(IY+15),H
                      	
  DDB5  2A34E2        		LD	HL,(SFNDF)	;Direcroty location and Flags
  DDB8  229FEC        		LD	(_FILEN),HL
                      	
  DDBB  ED5B32E2      		LD	DE,(SFBPS)
  DDBF  2136E2        		LD	HL,SFILE
  DDC2  36FF          		LD	(HL),0FFH
  DDC4  23            		INC	HL
  DDC5  C9            		RET
  DDC6                	SOPEN:
  DDC6  21C3DE        		LD	HL,FILESE
  DDC9                	SOPENC:
  DDC9  2203DE        		LD	(OPENPAT+1),HL
                      	
  DDCC  CDE2EC        		CALL	_RDFATX		;Detect Media
  DDCF  3857          		JR	C,RDDERR
                      	
  DDD1  AF            		XOR	A
  DDD2  329FEC        		LD	(_FILEN),A
  DDD5                	SOPEN0:
  DDD5  CDABDF        		CALL	LDDIRX
  DDD8  2819          		JR	Z,SDIRX1
                      	
  DDDA  CDB4DE        		CALL	DC		;Sub Directory
  DDDD  3808          		JR	C,SDIRX0
  DDDF  2A7EEC        		LD	HL,(_DTBUF)
  DDE2  7E            		LD	A,(HL)
  DDE3  FE2E          		CP	'.'
  DDE5  2810          		JR	Z,SOPEN1
  DDE7                	SDIRX0:
  DDE7  AF            		XOR	A
  DDE8  32A0EC        		LD	(_DIRF),A
  DDEB  FD360E01      		LD	(IY+14),1
  DDEF  FD360F00      		LD	(IY+15),0
  DDF3                	SDIRX1:
  DDF3  ED5B5CE2      		LD	DE,(_DIRPS)	;Root Directory
                      	
  DDF7                	SOPEN1:
  DDF7  0E20          	IBM1:	LD	C,32		;ooo 16
  DDF9                	SOPEN1X:
  DDF9  CDB4DE        		CALL	DC		;FILE SEARCH
  DDFC  382A          		JR	C,RDDERR
  DDFE  2A7EEC        		LD	HL,(_DTBUF)
  DE01                	SOPEN2:
  DE01  D5            		PUSH	DE
  DE02  CDC3DE        	OPENPAT:CALL	FILESE		;(Self-rewriting)
  DE05  D1            		POP	DE
  DE06  3876          		JR	C,SOPENE
  DE08  281B          		JR	Z,NOTSE
  DE0A                	SOPEN3:
  DE0A  3AA0EC        		LD	A,(_DIRF)
  DE0D  B7            		OR	A
  DE0E  200C          		JR	NZ,SOPEN5
                      	
  DE10  CD61DE        		CALL	ENDRDI
  DE13  280E          		JR	Z,SOPEN6
  DE15  3C            		INC	A
  DE16  200B          		JR	NZ,SOPEN6
  DE18  0E10          		LD	C,16
  DE1A  18DD          		JR	SOPEN1X
  DE1C                	SOPEN5:
  DE1C  CDF7EC        		CALL	_GNCL	;END DIR
  DE1F  D8            		RET	C
  DE20  CD67DF        		CALL	ENDCL
  DE23                	SOPEN6:
  DE23  38D2          		JR	C,SOPEN1
                      	
  DE25                	_SYS2B:
  DE25                	_SYS2D:
  DE25                	NOTSE:
  DE25  37            		SCF			;CF=1
  DE26  9F            		SBC	A,A		;A=0FFH
  DE27  C9            		RET
                      	
  DE28                	RDDERR:
  DE28  BF            		CP	A		;READ ERR CF=1 ZF=1
  DE29  37            		SCF
  DE2A  C9            		RET
                      	
  DE2B                	NOPEN:
  DE2B  21C3DE        		LD	HL,FILESE
  DE2E  2203DE        		LD	(OPENPAT+1),HL
  DE31  FD2A98EC      		LD	IY,(_FCB)
  DE35  CD92E0        		CALL	CHKWILDX
  DE38  30EB          		JR	NC,NOTSE
  DE3A  FD7E00        		LD	A,(IY+0)
  DE3D  3D            		DEC	A
  DE3E  3288EC        		LD	(_DRV),A
  DE41  CDD9EC        		CALL	_CHGDRV
  DE44  D8            		RET	C
                      	
  DE45  CDABDF        		CALL	LDDIRX
  DE48  ED5B9AEC      		LD	DE,(_FBPS)
  DE4C  CDB4DE        		CALL	DC
  DE4F  38D7          		JR	C,RDDERR
  DE51  3A9EEC        		LD	A,(_FBCNT)
  DE54  3D            		DEC	A
  DE55  28B3          		JR	Z,SOPEN3
  DE57                	NOPEN2:
  DE57  2A9CEC        		LD	HL,(_FBAD)
  DE5A  012000        		LD	BC,020H
  DE5D  09            		ADD	HL,BC
  DE5E  4F            		LD	C,A
  DE5F  18A0          		JR	SOPEN2
                      	
  DE61                	ENDRDI:
  DE61  3A5FDF        		LD	A,(DBLPAT)	;A=029H or 0
  DE64  E601          		AND	1
  DE66  4F            		LD	C,A
  DE67  3C            		INC	A
  DE68  83            		ADD	A,E
  DE69  5F            		LD	E,A
  DE6A  D60C          	RTEPAT:	SUB	12		;(Self-rewriting)
  DE6C  CB41          		BIT	0,C
  DE6E  C9            		RET
                      	
  DE6F                	SOPENE2:
  DE6F  229CEC        		LD	(_FBAD),HL
  DE72  79            		LD	A,C
  DE73  329EEC        		LD	(_FBCNT),A
  DE76  ED539AEC      		LD	(_FBPS),DE
  DE7A  FD2298EC      		LD	(_FCB),IY
  DE7E                	SOPENE:
  DE7E  AF            		XOR	A
  DE7F  C9            		RET
                      	
  DE80                	COPEN:
  DE80  FD360D20      		LD	(IY+13),020H		;Attribute
                      	
  DE84  21E0DE        		LD	HL,NEXTSE
  DE87  CDC9DD        		CALL	SOPENC
  DE8A  D0            		RET	NC
  DE8B  C8            		RET	Z
  DE8C  3AA0EC        		LD	A,(_DIRF)
  DE8F  D601          		SUB	001H
  DE91  D8            		RET	C
  DE92  0601          		LD	B,1
  DE94  CD04E1        		CALL	WRDF
  DE97  D8            		RET	C
  DE98  ED5B5EE2      		LD	DE,(_CLPS)
  DE9C  D5            		PUSH	DE
  DE9D  CD54DF        		CALL	DCPAT
  DEA0  CD2DE5        		CALL	DRDNX
  DEA3  2A7EEC        		LD	HL,(_DTBUF)
  DEA6  5D            		LD	E,L
  DEA7  54            		LD	D,H
  DEA8  13            		INC	DE		;DE,DTBUF+1
  DEA9  01FF03        		LD	BC,1023
  DEAC  AF            		XOR	A
  DEAD  77            		LD	(HL),A
  DEAE  E5            		PUSH	HL
  DEAF  EDB0          		LDIR
  DEB1  E1            		POP	HL
  DEB2  D1            		POP	DE
  DEB3  C9            		RET
                      	
  DEB4                	DC:
  DEB4  ED535EE2      		LD	(_CLPS),DE
  DEB8  C5            		PUSH	BC
  DEB9  D5            		PUSH	DE
  DEBA  CD54DF        		CALL	DCPAT
  DEBD  CD11E5        		CALL	DRDX
  DEC0  D1            		POP	DE
  DEC1  C1            		POP	BC
  DEC2  C9            		RET
                      	
  DEC3                	FILESE:
  DEC3  7E            		LD	A,(HL)
  DEC4  B7            		OR	A
  DEC5  C8            		RET	Z		;END:ZF=1 CF=0
  DEC6  FEE5          		CP	0E5H
  DEC8  280E          		JR	Z,FILESE1
  DECA  FDE5          		PUSH	IY
  DECC  D1            		POP	DE
  DECD  13            		INC	DE
  DECE  E5            		PUSH	HL
  DECF  CD2BDF        		CALL	CPFILE
  DED2  CC4CDF        		CALL	Z,CPFILE2
  DED5  E1            		POP	HL
  DED6  37            		SCF
  DED7  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DED8                	FILESE1:
  DED8  CDEFDE        		CALL	FNEXT
  DEDB  20E6          		JR	NZ,FILESE
  DEDD                	ZFCF0:
  DEDD  F6FF          		OR	0FFH		;ZF=0 CF=0
  DEDF  C9            		RET
                      	
  DEE0                	NEXTSE:
  DEE0  7E            		LD	A,(HL)
  DEE1  B7            		OR	A
  DEE2  37            		SCF
  DEE3  C8            		RET	Z		;!!!:ZF=1 CF=1
  DEE4  FEE5          		CP	0E5H
  DEE6  37            		SCF
  DEE7  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DEE8  CDEFDE        		CALL	FNEXT
  DEEB  20F3          		JR	NZ,NEXTSE
  DEED  18EE          		JR	ZFCF0
                      	
  DEEF                	FNEXT:
  DEEF  E5            		PUSH	HL
  DEF0  219FEC        		LD	HL,_FILEN
  DEF3  34            		INC	(HL)
  DEF4  E1            		POP	HL
  DEF5  112000        		LD	DE,020H
  DEF8  19            		ADD	HL,DE
  DEF9  0D            		DEC	C
  DEFA  C9            		RET
                      	
  DEFB                	CHKDDX:
  DEFB  CD92E0        		CALL	CHKWILDX
  DEFE  D8            		RET	C
  DEFF  FDE5          		PUSH	IY
  DF01  D1            		POP	DE
  DF02  13            		INC	DE
  DF03  2162EC        		LD	HL,DDTB
  DF06  0604          		LD	B,DDS
  DF08                	CPNAME:
  DF08  C5            		PUSH	BC
  DF09  D5            		PUSH	DE
  DF0A  1106E5        		LD	DE,CPBUF
  DF0D  010400        		LD	BC,4
  DF10  EDB0          		LDIR
  DF12  D1            		POP	DE
  DF13  D5            		PUSH	DE
  DF14  E5            		PUSH	HL
  DF15  2106E5        		LD	HL,CPBUF
  DF18  CD2BDF        		CALL	CPFILE
  DF1B  E1            		POP	HL
  DF1C  D1            		POP	DE
  DF1D  C1            		POP	BC
  DF1E  2005          		JR	NZ,CPNAME1
  DF20  7E            		LD	A,(HL)
  DF21  23            		INC	HL
  DF22  66            		LD	H,(HL)
  DF23  6F            		LD	L,A
  DF24  C9            		RET
  DF25                	CPNAME1:
  DF25  23            		INC	HL
  DF26  23            		INC	HL
  DF27  10DF          		DJNZ	CPNAME
  DF29  37            		SCF
  DF2A  C9            		RET
                      	
  DF2B                	CPFILE:
  DF2B  C5            		PUSH	BC
  DF2C  01000B        		LD	BC,00B00H
  DF2F                	CPSTR1:
  DF2F  1A            		LD	A,(DE)
  DF30  FE3F          		CP	'?'		;Wild card
  DF32  2812          		JR	Z,CPSTR2
  DF34  7E            		LD	A,(HL)
  DF35  CD78E0        		CALL	FKANC
  DF38  E5            		PUSH	HL
  DF39  67            		LD	H,A
  DF3A  1A            		LD	A,(DE)
  DF3B  CB01          		RLC	C
  DF3D  CD78E0        		CALL	FKANC
  DF40  CB09          		RRC	C
  DF42  BC            		CP	H		;CP (HL),(DE)
  DF43  E1            		POP	HL
  DF44  2004          		JR	NZ,CPSTR3
  DF46                	CPSTR2:
  DF46  13            		INC	DE
  DF47  23            		INC	HL
  DF48  10E5          		DJNZ	CPSTR1
  DF4A                	CPSTR3:
  DF4A  C1            		POP	BC
  DF4B  C9            		RET
                      	
  DF4C                	CPFILE2:
  DF4C  FD7E0D        		LD	A,(IY+13)
  DF4F  F6E1          		OR	0E1H
  DF51  2F            		CPL
  DF52  A6            		AND	(HL)
  DF53  C9            		RET
                      	
  DF54                	DCPAT:
  DF54  2A7EEC        		LD	HL,(_DTBUF)
  DF57  3AA0EC        		LD	A,(_DIRF)
  DF5A  B7            		OR	A
  DF5B  C8            		RET	Z
                      	
  DF5C                	CLUST:
  DF5C  EB            		EX	DE,HL
  DF5D  3E08          	CLSPAT:	LD	A,8	;DE=DE+8 (2D)  !ADDCL (Self-rewriting)
  DF5F  29            	DBLPAT:	ADD	HL,HL	;DE=DE*2 (512) !DBLCL (Self-rewriting)
  DF60  EB            		EX	DE,HL
  DF61  83            		ADD	A,E
  DF62  5F            		LD	E,A
  DF63  8A            		ADC	A,D
  DF64  93            		SUB	E
  DF65  57            		LD	D,A
  DF66  C9            		RET
                      	
  DF67                	ENDCL:
  DF67  7A            		LD	A,D	;END CLUSTER
  DF68  FE01          	CLPAT1:	CP	1	;164=356	(Self-rewriting)
  DF6A  C0            		RET	NZ
  DF6B  7B            		LD	A,E
  DF6C  FE64          	CLPAT2:	CP	064H	;		(Self-rewriting)
  DF6E  C9            		RET
                      	
  DF6F                	CAP:
  DF6F  FE61          		CP	'a'
  DF71  D8            		RET	C
  DF72  FE7B          		CP	'z'+1
  DF74  D0            		RET	NC
  DF75  D620          		SUB	020H
  DF77  C9            		RET
  DF78                	CAP2:
  DF78  CD6FDF        		CALL	CAP
  DF7B                	CAP3:
  DF7B  CD84DF        		CALL	CAP4
  DF7E  FE21          		CP	021H
  DF80  D0            		RET	NC
  DF81  3EA0          		LD	A,0A0H
  DF83  C9            		RET
  DF84                	CAP4:
  DF84  FE05          		CP	5
  DF86  C0            		RET	NZ
  DF87  3EE5          		LD	A,0E5H
  DF89  C9            		RET
                      	
  DF8A                	CHDIR:
  DF8A  CD98E8        		CALL	GETDPBD
  DF8D  3806          		JR	C,CHDIR2
  DF8F  DD751A        		LD	(IX+01AH),L		;_SDIR_
  DF92  DD741B        		LD	(IX+01BH),H		;_SDIR_+1
  DF95                	CHDIR2:
  DF95  DDE1          		POP	IX
  DF97  C9            		RET
                      	
  DF98                	LDDIR:
  DF98  CD98E8        		CALL	GETDPBD
  DF9B  DD5E1A        		LD	E,(IX+01AH)		;_SDIR_
  DF9E  DD561B        		LD	D,(IX+01BH)		;_SDIR_+1
  DFA1  13            		INC	DE
  DFA2  FD730E        		LD	(IY+14),E
  DFA5  FD720F        		LD	(IY+15),D
  DFA8  1B            		DEC	DE
  DFA9  18EA          		JR	CHDIR2
                      	
  DFAB                	LDDIRX:
  DFAB  FD5E0E        		LD	E,(IY+14)
  DFAE  FD560F        		LD	D,(IY+15)
  DFB1  1B            		DEC	DE
  DFB2  CD67DF        		CALL	ENDCL
  DFB5  D498DF        		CALL	NC,LDDIR
  DFB8                	LDDIRS:
  DFB8  7A            		LD	A,D
  DFB9  B3            		OR	E
  DFBA  32A0EC        		LD	(_DIRF),A
  DFBD  C9            		RET
                      	
  DFBE                	KILL:
  DFBE  CD92E0        		CALL	CHKWILDX
  DFC1  3838          		JR	C,KILLW
  DFC3  CDFBDE        		CALL	CHKDDX
  DFC6  3F            		CCF
  DFC7  D499DD        		CALL	NC,SOPENX1
  DFCA                	KILLS:
  DFCA  D40EE0        		CALL	NC,CHKATT
  DFCD  D8            		RET	C
  DFCE                	KILLSX:
  DFCE  36E5          		LD	(HL),0E5H	;DIR
  DFD0  CD6CE0        		CALL	WTDB
  DFD3  111A00        		LD	DE,01AH
  DFD6  19            		ADD	HL,DE
  DFD7  5E            		LD	E,(HL)
  DFD8  23            		INC	HL
  DFD9  56            		LD	D,(HL)
  DFDA  1804          		JR	KILLS2
  DFDC                	KILLS1:
  DFDC  ED5B5EE2      		LD	DE,(_CLPS)	;FAT
  DFE0                	KILLS2:
  DFE0  CD67DF        		CALL	ENDCL
  DFE3  D0            		RET	NC		;CF=0
  DFE4  21FEFF        		LD	HL,0-2
  DFE7  19            		ADD	HL,DE
  DFE8  D0            		RET	NC		;DE= 0 or 1
  DFE9  D5            		PUSH	DE
  DFEA  CDF7EC        		CALL	_GNCL
  DFED  ED535EE2      		LD	(_CLPS),DE
  DFF1  D1            		POP	DE
  DFF2  210000        		LD	HL,0
  DFF5  D4FAEC        		CALL	NC,_SNCL
  DFF8  30E2          		JR	NC,KILLS1
  DFFA  C9            		RET
                      	
  DFFB                	KILLW:
  DFFB  CDC6DD        		CALL	SOPEN
  DFFE                	KILLW1:
  DFFE  380B          		JR	C,KILLW2
  E000  CD6FDE        		CALL	SOPENE2
  E003  CDCADF        		CALL	KILLS
  E006  CD2BDE        		CALL	NOPEN
  E009  18F3          		JR	KILLW1
  E00B                	KILLW2:
  E00B  C8            		RET	Z
  E00C  3F            		CCF
  E00D  C9            		RET
                      	
  E00E                	CHKATT:
  E00E  E5            		PUSH	HL
  E00F  110B00        		LD	DE,00BH
  E012  19            		ADD	HL,DE
  E013  7E            		LD	A,(HL)
  E014  E1            		POP	HL
  E015  E61F          		AND	01FH
  E017  C8            		RET	Z
  E018  37            		SCF
  E019  C9            		RET
                      	
  E01A                	NAME:
  E01A  CD92E0        		CALL	CHKWILDX
  E01D  D8            		RET	C
  E01E  110400        		LD	DE,4
  E021  19            		ADD	HL,DE
  E022  2238E0        		LD	(NAMEP+2),HL
  E025  23            		INC	HL
  E026  CD96E0        		CALL	CHKWILD
  E029  D8            		RET	C
                      	
  E02A  CD99DD        		CALL	SOPENX1
  E02D  D40EE0        		CALL	NC,CHKATT
  E030  D8            		RET	C
                      	
  E031  FD7E00        		LD	A,(IY+0)
  E034  FDE5          		PUSH	IY
  E036  FD210000      	NAMEP:	LD	IY,0
  E03A  FD7700        		LD	(IY+0),A
  E03D  CD99DD        		CALL	SOPENX1
  E040  FDE3          		EX	(SP),IY
  E042  3F            		CCF
  E043  D4C6DD        		CALL	NC,SOPEN
  E046  EB            		EX	DE,HL
  E047  E1            		POP	HL
  E048  D8            		RET	C
                      	
  E049                	SETNAME:
  E049  01000B        		LD	BC,11*256
  E04C  23            		INC	HL
  E04D  7E            		LD	A,(HL)
  E04E  FEE5          		CP	0E5H
  E050  2004          		JR	NZ,SNAME1
  E052  3E05          		LD	A,5
  E054  180E          		JR	SNAME3
  E056                	SNAME1:
  E056  7E            		LD	A,(HL)
  E057  0C            		INC	C
  E058  0D            		DEC	C
  E059  2009          		JR	NZ,SNAME3
  E05B  CD6FDF        		CALL	CAP
  E05E  FEA0          		CP	0A0H
  E060  2002          		JR	NZ,SNAME3
  E062  3E20          		LD	A,020H
  E064                	SNAME3:
  E064  12            		LD	(DE),A
  E065  7E            		LD	A,(HL)
  E066  23            		INC	HL
  E067  CD7FE0        		CALL	FKAN
  E06A  10EA          		DJNZ	SNAME1
  E06C                	WTDB:
  E06C  3EFF          		LD	A,0FFH
  E06E  3236E2        		LD	(SFILE),A
  E071                	SWTDBF:
  E071  3E01          		LD	A,1
  E073  32A4EC        		LD	(_WTDBF),A
  E076  AF            		XOR	A
  E077  C9            		RET
                      	
  E078                	FKANC:
  E078  CB41          		BIT	0,C
  E07A  CC78DF        		CALL	Z,CAP2
  E07D  1801          		JR	FKANX
  E07F                	FKAN:
  E07F  13            		INC	DE
  E080                	FKANX:
  E080  CB41          		BIT	0,C
  E082  CB81          		RES	0,C
  E084  C0            		RET	NZ
  E085  FE80          		CP	080H
  E087  D8            		RET	C
  E088  FEA0          		CP	0A0H
  E08A  3803          		JR	C,FKAN1
  E08C  FEE0          		CP	0E0H
  E08E  D8            		RET	C
  E08F                	FKAN1:
  E08F  0C            		INC	C
  E090  A7            		AND	A
  E091  C9            		RET
                      	
  E092                	CHKWILDX:
  E092  FDE5          		PUSH	IY
  E094  E1            		POP	HL
  E095  23            		INC	HL
  E096                	CHKWILD:
  E096  060B          		LD	B,11
  E098  3E3F          		LD	A,'?'
  E09A                	CHKWIL1:
  E09A  BE            		CP	(HL)
  E09B  23            		INC	HL
  E09C  37            		SCF
  E09D  C8            		RET	Z
  E09E  10FA          		DJNZ	CHKWIL1
  E0A0  AF            		XOR	A
  E0A1  C9            		RET
                      	
  E0A2                	SDIRENT:		;IY=FCB HL=DIR
  E0A2  D5            		PUSH	DE
  E0A3  E5            		PUSH	HL
  E0A4  FDE5          		PUSH	IY
  E0A6  D1            		POP	DE
  E0A7  EB            		EX	DE,HL
  E0A8  CD49E0        		CALL	SETNAME
                      	;				Attribute
  E0AB  FD7E0D        		LD	A,(IY+13)
  E0AE  12            		LD	(DE),A
  E0AF  13            		INC	DE
                      	;				Reserved
  E0B0  AF            		XOR	A
  E0B1  060A          		LD	B,10
  E0B3                	SDE1:
  E0B3  12            		LD	(DE),A
  E0B4  13            		INC	DE
  E0B5  10FC          		DJNZ	SDE1
                      	;				TIME
  E0B7  FD7E16        		LD	A,(IY+22)
  E0BA  12            		LD	(DE),A
  E0BB  13            		INC	DE
  E0BC  FD7E17        		LD	A,(IY+23)
  E0BF  12            		LD	(DE),A
  E0C0  13            		INC	DE
                      	;				DATE
  E0C1  FD7E14        		LD	A,(IY+20)
  E0C4  12            		LD	(DE),A
  E0C5  13            		INC	DE
  E0C6  FD7E15        		LD	A,(IY+21)
  E0C9  12            		LD	(DE),A
  E0CA  13            		INC	DE
                      	;				First cluster
  E0CB  FD7E1A        		LD	A,(IY+26)
  E0CE  12            		LD	(DE),A
  E0CF  13            		INC	DE
  E0D0  FD7E1B        		LD	A,(IY+27)
  E0D3  12            		LD	(DE),A
  E0D4  13            		INC	DE
                      	;				SIZE
  E0D5  FD7E10        		LD	A,(IY+16)
  E0D8  12            		LD	(DE),A
  E0D9  13            		INC	DE
  E0DA  FD7E11        		LD	A,(IY+17)
  E0DD  12            		LD	(DE),A
  E0DE  13            		INC	DE
  E0DF  FD7E12        		LD	A,(IY+18)
  E0E2  12            		LD	(DE),A
  E0E3  13            		INC	DE
  E0E4  FD7E13        		LD	A,(IY+19)
  E0E7  12            		LD	(DE),A
                      	
  E0E8  AF            		XOR	A
  E0E9  E1            		POP	HL
  E0EA  D1            		POP	DE
  E0EB  C9            		RET
                      	
  E0EC                	WOPEN:
  E0EC  FD7E0D        		LD	A,(IY+13)
  E0EF  E61F          		AND	01FH
  E0F1  37            		SCF
  E0F2  C0            		RET	NZ
  E0F3  FD361CFE      		LD	(IY+28),0FEH	;Open
  E0F7                	TOPEN2:
  E0F7  AF            		XOR	A
  E0F8                	TOPEN:
  E0F8  FD3617FF      		LD	(IY+23),0FFH	;Initializes the time stamp
  E0FC  C9            		RET
                      	
  E0FD                	WRDFX:
  E0FD  41            		LD	B,C
  E0FE  04            		INC	B
  E0FF  3E37          		LD	A,037H
  E101  322AE5        		LD	(DRDN1),A
                      	
  E104                	WRDF:
  E104  110200        		LD	DE,2
  E107                	WRDF1:
  E107  C5            		PUSH	BC
  E108  D5            		PUSH	DE
  E109  CDF7EC        		CALL	_GNCL
  E10C  381C          		JR	C,WRDF3
  E10E  7A            		LD	A,D
  E10F  B3            		OR	E
  E110  2027          		JR	NZ,WRDF4
  E112  E1            		POP	HL
  E113  E5            		PUSH	HL
  E114  ED5B5EE2      		LD	DE,(_CLPS)
  E118  225EE2        		LD	(_CLPS),HL
  E11B  7A            		LD	A,D
  E11C  B3            		OR	E
  E11D  2008          		JR	NZ,WRDF2
  E11F  FD751A        		LD	(IY+26),L	;Start cluster
  E122  FD741B        		LD	(IY+27),H
  E125  1803          		JR	WRDF3
  E127                	WRDF2:
  E127  CDFAEC        		CALL	_SNCL
  E12A                	WRDF3:
  E12A  D1            		POP	DE
  E12B  C1            		POP	BC
  E12C  D8            		RET	C
  E12D  100C          		DJNZ	WRDF5
  E12F  ED5B5EE2      		LD	DE,(_CLPS)
  E133  21FFFF        		LD	HL,0FFFFH
  E136  C3FAEC        		JP	_SNCL
                      	
  E139                	WRDF4:
  E139  D1            		POP	DE
  E13A  C1            		POP	BC
  E13B                	WRDF5:
  E13B  13            		INC	DE
  E13C  CD67DF        		CALL	ENDCL
  E13F  38C6          		JR	C,WRDF1
  E141  37            		SCF
  E142  C9            		RET
                      	
  E143                	RWXR:
  E143  CB38          		SRL	B
  E145  CB19          		RR	C
  E147  CB38          	IBM4:	SRL	B	;ooo
  E149  CB19          		RR	C
                      	
  E14B  FD5E1A        		LD	E,(IY+26)	;Cluster
  E14E  FD561B        		LD	D,(IY+27)
  E151                	RWX1:
  E151  ED535EE2      		LD	(_CLPS),DE
  E155  7A            		LD	A,D
  E156  B3            		OR	E
  E157  37            		SCF
  E158  C8            		RET	Z
                      	
  E159  78            		LD	A,B
  E15A  B1            		OR	C
  E15B  C8            		RET	Z
                      	
  E15C  CDF7EC        		CALL	_GNCL
  E15F  D8            		RET	C
  E160  0B            		DEC	BC
  E161  CD67DF        		CALL	ENDCL
  E164  38EB          		JR	C,RWX1
  E166  37            		SCF
  E167  C9            		RET
                      	
  E168                	DSKF:
  E168  110000        	MAXCLP:	LD	DE,0
  E16B  210000        		LD	HL,0
  E16E                	DSKF1:
  E16E  D5            		PUSH	DE
  E16F  CDF7EC        		CALL	_GNCL
  E172  380C          		JR	C,POPSCF
  E174  7A            		LD	A,D
  E175  B3            		OR	E
  E176  2001          		JR	NZ,DSKF2
  E178  23            		INC	HL
  E179                	DSKF2:
  E179  D1            		POP	DE
  E17A  1B            		DEC	DE
  E17B  7A            		LD	A,D
  E17C  B3            		OR	E
  E17D  20EF          		JR	NZ,DSKF1
  E17F  C9            		RET
                      	
  E180                	POPSCF:
  E180  F1            		POP	AF
  E181  37            		SCF
  E182  C9            		RET
                      	
  E183                	SETTMS:
  E183  FD7E17        		LD	A,(IY+23)
  E186  3C            		INC	A
  E187  C0            		RET	NZ
  E188                	SETTMSX:
  E188  CDDDD7        		CALL	_SYS2C
                      	
  E18B  CB25          		SLA	L
  E18D  CB25          		SLA	L
  E18F  29            		ADD	HL,HL
  E190  29            		ADD	HL,HL
  E191  29            		ADD	HL,HL
  E192  7A            		LD	A,D
  E193  0F            		RRCA
  E194  E61F          		AND	01FH
  E196  B5            		OR	L
  E197  6F            		LD	L,A
  E198  FD7516        		LD	(IY+22),L
  E19B  FD7417        		LD	(IY+23),H
                      	
  E19E  CDA3D7        		CALL	_SYS2A
                      	
  E1A1  0144F8        		LD	BC,0-1980
  E1A4  09            		ADD	HL,BC
  E1A5  65            		LD	H,L
                      	
  E1A6  7A            		LD	A,D
  E1A7  87            		ADD	A,A
  E1A8  87            		ADD	A,A
  E1A9  87            		ADD	A,A
  E1AA  87            		ADD	A,A
  E1AB  6F            		LD	L,A
  E1AC  29            		ADD	HL,HL
  E1AD  7D            		LD	A,L
  E1AE  B3            		OR	E
  E1AF  6F            		LD	L,A
  E1B0  FD7514        		LD	(IY+20),L
  E1B3  FD7415        		LD	(IY+21),H
  E1B6  C9            		RET
                      	
  E1B7                	PUSHRR:
  E1B7  CDBDE1        		CALL	SUBRR
  E1BA                	POPRR1:
  E1BA  EDB0          		LDIR
  E1BC  C9            		RET
                      	
  E1BD                	SUBRR:
  E1BD  FDE5          		PUSH	IY
  E1BF  E1            		POP	HL
  E1C0  112100        		LD	DE,33
  E1C3  19            		ADD	HL,DE
  E1C4  1157E2        		LD	DE,HLBUF
  E1C7  010300        		LD	BC,3
  E1CA  C9            		RET
                      	
  E1CB                	SETSEQ:
  E1CB  F5            		PUSH	AF
  E1CC  FD7E21        		LD	A,(IY+33)
  E1CF  FD6E22        		LD	L,(IY+34)
  E1D2  FD6623        		LD	H,(IY+35)
                      	
  E1D5  CDF1E1        		CALL	SSQ1
                      	
  E1D8  29            		ADD	HL,HL
  E1D9  CB3D          		SRL	L
  E1DB  FD7520        		LD	(IY+32),L
  E1DE  FD740C        		LD	(IY+12),H
  E1E1  F1            		POP	AF
                      	
  E1E2                	POPRR:
  E1E2  CDBDE1        		CALL	SUBRR
  E1E5  EB            		EX	DE,HL
  E1E6  18D2          		JR	POPRR1
                      	
  E1E8                	GETSIZE:
  E1E8  FD7E10        		LD	A,(IY+16)
  E1EB  FD6E11        		LD	L,(IY+17)
  E1EE  FD6612        		LD	H,(IY+18)
  E1F1                	SSQ1:
  E1F1  87            		ADD	A,A
  E1F2  ED6A          		ADC	HL,HL
  E1F4  B7            		OR	A
  E1F5  C8            		RET	Z
  E1F6  23            		INC	HL
  E1F7  C9            		RET
                      	
  E1F8                	GETSEQ:
  E1F8  FD6E20        		LD	L,(IY+32)
  E1FB  FD660C        		LD	H,(IY+12)
                      	
  E1FE  CB25          		SLA	L
                      	
  E200  CB3C          		SRL	H
  E202  CB1D          		RR	L
  E204  C9            		RET
                      	
  E205                	SETRBR:
  E205  AF            		XOR	A	;HLA = HL*128
  E206  CB3C          		SRL	H
  E208  CB1D          		RR	L
  E20A  1F            		RRA
  E20B  FD7721        		LD	(IY+33),A
  E20E  FD7522        		LD	(IY+34),L
  E211  FD7423        		LD	(IY+35),H
  E214  218000        		LD	HL,128
  E217  C9            		RET
                      	
  E218                	K_DE26:
  E218  ED5B4CEC      		LD	DE,(STABLE+2*026H)
  E21C  1804          		JR	K_DE1
  E21E                	K_DE27:
  E21E  ED5B4EEC      		LD	DE,(STABLE+2*027H)
  E222                	K_DE1:
  E222  CD2AE2        		CALL	K_DE
                      	;	EX	DE,IY
  E225  D5            		PUSH	DE
  E226  FDE3          		EX	(SP),IY
  E228  D1            		POP	DE
                      	;
  E229  C9            		RET
  E22A                	K_DE:
                      	;	EX	DE,IY
  E22A  D5            		PUSH	DE
  E22B  FDE3          		EX	(SP),IY
  E22D  D1            		POP	DE
  E22E  FDE9          		JP	(IY)
                      	
  E230                	SCDIR:	DS	2		;+14 +15
  E232                	SFBPS:	DS	2		;FBPS
  E234                	SFNDF:	DS	2		;FILEN DIRF
  E236                	SFILE:	DS	33		;DRV FILENAME
  E257                	HLBUF:	DS	3		;Random record buffer
                      	
  E25A  0000          	_FATPS:	DW	0
  E25C  0000          	_DIRPS:	DW	0
  E25E  0000          	_CLPS:	DW	0
                      	
                      	;LDFILE2.ASM
                      	
                      	;	LSX-Dodgers FILE2
                      	
  E260                	RBWDD:
  E260  E5            		PUSH	HL
  E261  C1            		POP	BC
  E262  213AE3        		LD	HL,NUL
  E265  CD6EE3        		CALL	DDX
  E268  2003          		JR	NZ,RBWDD2
  E26A  2A08EC        		LD	HL,(STABLE+2*4)
  E26D                	RBWDD2:
  E26D  FE43          		CP	'C'
  E26F  2003          		JR	NZ,RBWDD3
  E271  21CFD9        		LD	HL,PRINTS
  E274                	RBWDD3:
  E274  FE50          		CP	'P'
  E276  2003          		JR	NZ,RBWDD4
  E278  2A0AEC        		LD	HL,(STABLE+2*5)
  E27B                	RBWDD4:
  E27B  2289E2        		LD	(RBWDDP+1),HL
  E27E  2A8AEC        		LD	HL,(_DTA)
  E281                	RBWDD1:
  E281  78            		LD	A,B
  E282  B1            		OR	C
  E283                	RBWDD5:
  E283  CA35E3        		JP	Z,RBW1
  E286  5E            		LD	E,(HL)
  E287  23            		INC	HL
  E288  CDB3D6        	RBWDDP:	CALL	_SYS02
  E28B  DA51E3        		JP	C,RBRERR
  E28E  3E1A          		LD	A,01AH
  E290  BB            		CP	E
  E291  28F0          		JR	Z,RBWDD5
  E293  0B            		DEC	BC
  E294  18EB          		JR	RBWDD1
                      	
                      					;Write random block
  E296                	_SYS26:
  E296  AF            		XOR	A
  E297  322AE5        		LD	(DRDN1),A
  E29A  22E4E4        		LD	(LEFT+1),HL	;Write record byte
  E29D  2206E5        		LD	(LEFTX),HL
  E2A0  CD70DD        		CALL	SETDRV
                      	
  E2A3  CD58E4        		CALL	RBX0
  E2A6  DA3CE3        		JP	C,RBWERR
  E2A9  28B5          		JR	Z,RBWDD
  E2AB  CDECE0        		CALL	WOPEN
  E2AE  DA3CE3        		JP	C,RBWERR
  E2B1  7C            		LD	A,H
  E2B2  B5            		OR	L
  E2B3  CA35E3        		JP	Z,RBW1
                      	
  E2B6  2B            		DEC	HL
                      	
  E2B7  CDFCE4        		CALL	CDERR		;CDE=Random record
                      	
  E2BA  AF            		XOR	A
  E2BB  19            		ADD	HL,DE
  E2BC  89            		ADC	A,C
  E2BD  47            		LD	B,A
  E2BE  4C            		LD	C,H
  E2BF  CD43E1        		CALL	RWXR
  E2C2  DCFDE0        		CALL	C,WRDFX
  E2C5  DA3CE3        		JP	C,RBWERR
                      	
  E2C8  CD81E4        		CALL	RBX2
  E2CB  281A          		JR	Z,RBWB
  E2CD  CD93E4        		CALL	RBXA
  E2D0  386A          		JR	C,RBWERR
  E2D2  EB            		EX	DE,HL
  E2D3  C5            		PUSH	BC
  E2D4  EDB0          		LDIR
  E2D6  2208E5        		LD	(DTAX),HL
                      	
  E2D9  CD71E0        		CALL	SWTDBF
                      	
  E2DC  2A06E5        		LD	HL,(LEFTX)
  E2DF  D1            		POP	DE
  E2E0  ED52          		SBC	HL,DE
  E2E2  2206E5        		LD	(LEFTX),HL
  E2E5  282E          		JR	Z,RBWEND
                      	
  E2E7                	RBWB:
  E2E7  CDC8E4        		CALL	RBXB
  E2EA  2813          		JR	Z,RBWC
  E2EC                	RBWB1:
  E2EC  C5            		PUSH	BC
  E2ED  D5            		PUSH	DE
  E2EE  CD5CDF        		CALL	CLUST
  E2F1  CD34E7        		CALL	DWTC
  E2F4  D1            		POP	DE
  E2F5  C1            		POP	BC
  E2F6  3844          		JR	C,RBWERR
  E2F8  CDF7EC        		CALL	_GNCL
  E2FB  383F          		JR	C,RBWERR
  E2FD  10ED          		DJNZ	RBWB1
  E2FF                	RBWC:
  E2FF  CDD8E4        		CALL	RBXC
  E302  2811          		JR	Z,RBWEND
                      	
  E304  CD5CDF        		CALL	CLUST
  E307  CD29E5        		CALL	DRDN
  E30A  3830          		JR	C,RBWERR
  E30C  ED5B7EEC      		LD	DE,(_DTBUF)
  E310  EDB0          		LDIR
  E312  CD71E0        		CALL	SWTDBF
  E315                	RBWEND:
  E315  CDE3E4        		CALL	RBXEND
                      	
  E318  CD67E4        		CALL	RBX1
  E31B  3018          		JR	NC,RBW1
  E31D  2AE4E4        		LD	HL,(LEFT+1)
  E320  FD5E10        		LD	E,(IY+16)	;CDE=File size
  E323  FD5611        		LD	D,(IY+17)
  E326  FD4E12        		LD	C,(IY+18)
  E329  AF            		XOR	A
  E32A  19            		ADD	HL,DE
  E32B  89            		ADC	A,C
  E32C  FD7510        		LD	(IY+16),L
  E32F  FD7411        		LD	(IY+17),H
  E332  FD7712        		LD	(IY+18),A
  E335                	RBW1:
  E335  FDE1          		POP	IY
  E337  C1            		POP	BC
  E338  D1            		POP	DE
  E339  E1            		POP	HL
  E33A                	NUL:
  E33A  AF            		XOR	A
  E33B  C9            		RET
                      	
  E33C                	RBWERR:
  E33C  FDE5          		PUSH	IY
  E33E  D1            		POP	DE
  E33F  2A20EC        		LD	HL,(STABLE+2*010H)
  E342  CD0F00        		CALL	K_HL
  E345                	RBRERR1:
  E345  3E01          		LD	A,001H
  E347                	RBRERR2:
  E347  FDE1          		POP	IY
  E349  C1            		POP	BC
  E34A  D1            		POP	DE
  E34B  E1            		POP	HL
  E34C  37            		SCF
  E34D  210000        		LD	HL,0
  E350  C9            		RET
                      	
  E351                	RBRERR:
  E351  3EFF          		LD	A,0FFH
  E353  18F2          		JR	RBRERR2
                      	
  E355                	RBRFL:
  E355  3E00          	RBRFLP:	LD	A,000H
  E357  FE0D          		CP	00DH
  E359  2005          		JR	NZ,RBRFL1
  E35B  D5            		PUSH	DE
  E35C  1E0A          		LD	E,00AH
  E35E  1805          		JR	RBRFL2
  E360                	RBRFL1:
  E360  D5            		PUSH	DE
  E361  CDFAD9        		CALL	_SYS07
  E364  5F            		LD	E,A
  E365                	RBRFL2:
  E365  CDCDEC        		CALL	_PRINT
  E368  7B            		LD	A,E
  E369  D1            		POP	DE
  E36A  3256E3        		LD	(RBRFLP+1),A
  E36D  C9            		RET
  E36E                	DDX:
  E36E  FD7E01        		LD	A,(IY+1)
  E371  CD6FDF        		CALL	CAP
  E374  FE41          		CP	'A'
  E376  C9            		RET
                      	
  E377                	RBRDD:
  E377  E5            		PUSH	HL
  E378  C1            		POP	BC
  E379  2155E3        		LD	HL,RBRFL
  E37C  CD6EE3        		CALL	DDX
  E37F  2005          		JR	NZ,RBRDD2
  E381  2A06EC        		LD	HL,(STABLE+2*3)
  E384  1804          		JR	RBRDD3
  E386                	RBRDD2:
  E386  FE43          		CP	'C'
  E388  202C          		JR	NZ,RBRDERR
  E38A                	RBRDD3:
  E38A  229AE3        		LD	(RBRDDP+1),HL
                      	
  E38D  ED5B8AEC      		LD	DE,(_DTA)
  E391  210000        		LD	HL,0
  E394                	RBRDD1:
  E394  78            		LD	A,B
  E395  B1            		OR	C
  E396  2818          		JR	Z,RBRDDE1
  E398  23            		INC	HL
  E399  CD55E3        	RBRDDP:	CALL	RBRFL
  E39C  380D          		JR	C,RBRDDE
  E39E  FE1A          		CP	01AH
  E3A0  2809          		JR	Z,RBRDDE
  E3A2  FE03          		CP	3
  E3A4  2805          		JR	Z,RBRDDE
  E3A6  12            		LD	(DE),A
  E3A7  13            		INC	DE
  E3A8  0B            		DEC	BC
  E3A9  18E9          		JR	RBRDD1
                      	
  E3AB                	RBRDDE:
  E3AB  3E1A          		LD	A,01AH
  E3AD  12            		LD	(DE),A
  E3AE                	RBRDDE2:
  E3AE  AF            		XOR	A
  E3AF  3C            		INC	A
  E3B0                	RBRDDE1:
  E3B0  3244E4        		LD	(RBRAP+1),A
  E3B3  C33DE4        		JP	RBREND0
  E3B6                	RBRDERR:
  E3B6  210000        		LD	HL,0
  E3B9  18F3          		JR	RBRDDE2
                      	
                      					;Read random block
  E3BB                	_SYS27:
  E3BB  2206E5        		LD	(LEFTX),HL
  E3BE  CD70DD        		CALL	SETDRV
                      	
  E3C1  FDCB0D66      		BIT	4,(IY+13)
  E3C5  C246E4        		JP	NZ,RBRDIR
  E3C8  CD58E4        		CALL	RBX0
  E3CB  DA51E3        		JP	C,RBRERR
  E3CE  28A7          		JR	Z,RBRDD
  E3D0  CD67E4        		CALL	RBX1
  E3D3  DA45E3        		JP	C,RBRERR1
  E3D6  79            		LD	A,C
  E3D7  EB            		EX	DE,HL
  E3D8  ED52          		SBC	HL,DE		;CP 0HL,CDE
  E3DA  19            		ADD	HL,DE
  E3DB  DE00          		SBC	A,000H
  E3DD  3801          		JR	C,RBR1
  E3DF  EB            		EX	DE,HL
  E3E0                	RBR1:
  E3E0  9F            		SBC	A,A
  E3E1  E601          		AND	1
  E3E3  3244E4        		LD	(RBRAP+1),A
                      	
  E3E6  7C            		LD	A,H
  E3E7  B5            		OR	L
  E3E8  CA3DE4        		JP	Z,RBREND0
                      	
  E3EB  22E4E4        		LD	(LEFT+1),HL	;Read record byte
  E3EE  2206E5        		LD	(LEFTX),HL
                      	
  E3F1  CD81E4        		CALL	RBX2
  E3F4  2819          		JR	Z,RBRB
  E3F6  CD93E4        		CALL	RBXA
  E3F9  DA51E3        		JP	C,RBRERR
  E3FC  C5            		PUSH	BC
  E3FD  EDB0          		LDIR
  E3FF  ED5308E5      		LD	(DTAX),DE
  E403  2A06E5        		LD	HL,(LEFTX)
  E406  D1            		POP	DE
  E407  A7            		AND	A
  E408  ED52          		SBC	HL,DE
  E40A  2206E5        		LD	(LEFTX),HL
  E40D  282B          		JR	Z,RBREND
                      	
  E40F                	RBRB:
  E40F  CDC8E4        		CALL	RBXB
  E412  2812          		JR	Z,RBRC
  E414                	RBRB1:
  E414  C5            		PUSH	BC
  E415  D5            		PUSH	DE
  E416  CD5CDF        		CALL	CLUST
  E419  CD28E7        		CALL	DRDC
  E41C  D1            		POP	DE
  E41D  C1            		POP	BC
  E41E  D4F7EC        		CALL	NC,_GNCL
  E421  DA51E3        		JP	C,RBRERR
  E424  10EE          		DJNZ	RBRB1
  E426                	RBRC:
  E426  CDD8E4        		CALL	RBXC
  E429  280F          		JR	Z,RBREND
                      	
  E42B  CD5CDF        		CALL	CLUST
  E42E  CD11E5        		CALL	DRDX
  E431  DA51E3        		JP	C,RBRERR
  E434  EB            		EX	DE,HL
  E435  2A7EEC        		LD	HL,(_DTBUF)
  E438  EDB0          		LDIR
  E43A                	RBREND:
  E43A  CDE3E4        		CALL	RBXEND
  E43D                	RBREND0:
  E43D  FDE1          		POP	IY
  E43F  C1            		POP	BC
  E440  D1            		POP	DE
  E441  F1            		POP	AF	;(HL)
  E442  AF            		XOR	A
  E443  3E00          	RBRAP:	LD	A,000H
  E445  C9            		RET
                      	
  E446                	RBRDIR:
  E446  FD6E1A        		LD	L,(IY+26)
  E449  FD661B        		LD	H,(IY+27)
  E44C  CD8ADF        		CALL	CHDIR
  E44F  AF            		XOR	A
  E450  67            		LD	H,A
  E451  6F            		LD	L,A
  E452  3C            		INC	A
  E453  3244E4        		LD	(RBRAP+1),A
  E456  18E5          		JR	RBREND0
                      	
  E458                	RBX0:
  E458  2A8AEC        		LD	HL,(_DTA)
  E45B  2208E5        		LD	(DTAX),HL
  E45E  2A06E5        		LD	HL,(LEFTX)
  E461  FD7E1C        		LD	A,(IY+28)	;Open
  E464  D6FD          		SUB	0FDH
  E466  C9            		RET
                      	
  E467                	RBX1:
  E467  E5            		PUSH	HL		;Record byte
                      	
  E468  FD6E10        		LD	L,(IY+16)	;AHL=File size
  E46B  FD6611        		LD	H,(IY+17)
  E46E  FD7E12        		LD	A,(IY+18)
                      	
  E471  CDFCE4        		CALL	CDERR		;CDE=Random record
                      	
  E474  A7            		AND	A
  E475  ED52          		SBC	HL,DE
  E477  99            		SBC	A,C
  E478  D1            		POP	DE
                      	
  E479  D8            		RET	C
  E47A  4F            		LD	C,A
  E47B  EB            		EX	DE,HL	;CDE=File byte	HL=Record byte
  E47C  B2            		OR	D
  E47D  B3            		OR	E
  E47E  C0            		RET	NZ
  E47F  37            		SCF
  E480  C9            		RET
                      	
  E481                	RBX2:
  E481  FD4E22        		LD	C,(IY+34)	;Cluster settings
  E484  FD4623        		LD	B,(IY+35)
  E487  CD43E1        		CALL	RWXR
  E48A  3E03          	IBM5:	LD	A,3		;ooo 1
  E48C  FDA622        		AND	(IY+34)
  E48F  FDB621        		OR	(IY+33)
  E492  C9            		RET
                      	
  E493                	RBXA:
  E493  D5            		PUSH	DE
  E494  CD5CDF        		CALL	CLUST
  E497  CD11E5        		CALL	DRDX
  E49A  D1            		POP	DE
  E49B  D8            		RET	C
  E49C  CDF7EC        		CALL	_GNCL
  E49F  D8            		RET	C
  E4A0  ED535EE2      		LD	(_CLPS),DE
                      	
  E4A4  FD4E21        		LD	C,(IY+33)
  E4A7  3A8BE4        		LD	A,(IBM5+1)		;ooo 1
  E4AA  FDA622        		AND	(IY+34)
  E4AD  47            		LD	B,A
  E4AE  210004        	IBM7:	LD	HL,1024		;ooo 512
  E4B1  ED42          		SBC	HL,BC		;remaining cluster
                      	
  E4B3  ED5B06E5      		LD	DE,(LEFTX)
  E4B7  ED52          		SBC	HL,DE		;CP HL,DE
  E4B9  19            		ADD	HL,DE
  E4BA  3801          		JR	C,RBXA1
  E4BC  EB            		EX	DE,HL
  E4BD                	RBXA1:
  E4BD  E5            		PUSH	HL
  E4BE  2A7EEC        		LD	HL,(_DTBUF)
  E4C1  09            		ADD	HL,BC
  E4C2  ED5B08E5      		LD	DE,(DTAX)
  E4C6  C1            		POP	BC
  E4C7  C9            		RET
                      	
  E4C8                	RBXB:
  E4C8  2A08E5        		LD	HL,(DTAX)
  E4CB  ED5B5EE2      		LD	DE,(_CLPS)
  E4CF  3A07E5        		LD	A,(LEFTX+1)
  E4D2  CB3F          		SRL	A
  E4D4  CB3F          	IBM8:	SRL	A		;ooo
  E4D6  47            		LD	B,A
  E4D7  C9            		RET
                      	
  E4D8                	RBXC:
  E4D8  ED4B06E5      		LD	BC,(LEFTX)
  E4DC  3A8BE4        		LD	A,(IBM5+1)
  E4DF  A0            		AND	B
  E4E0  47            		LD	B,A
  E4E1  B1            		OR	C
  E4E2  C9            		RET
                      	
  E4E3                	RBXEND:
  E4E3  110000        	LEFT:	LD	DE,0
  E4E6  AF            		XOR	A
  E4E7  FD6E21        		LD	L,(IY+33)
  E4EA  FD6622        		LD	H,(IY+34)
  E4ED  19            		ADD	HL,DE
  E4EE  FD8E23        		ADC	A,(IY+35)
  E4F1  FD7521        		LD	(IY+33),L
  E4F4  FD7422        		LD	(IY+34),H
  E4F7  FD7723        		LD	(IY+35),A
  E4FA  EB            		EX	DE,HL		;HL=Read byte
  E4FB  C9            		RET
                      	
  E4FC                	CDERR:
  E4FC  FD5E21        		LD	E,(IY+33)	;CDE=Random record
  E4FF  FD5622        		LD	D,(IY+34)
  E502  FD4E23        		LD	C,(IY+35)
  E505  C9            		RET
                      	
  E506                	CPBUF:
  E506  0000          	LEFTX:	DW	0
  E508  0000          	DTAX:	DW	0
  E50A  20            		DB	020H	;DS 7,20h
  E50B  20            		DB	020H
  E50C  20            		DB	020H
  E50D  20            		DB	020H
  E50E  20            		DB	020H
  E50F  20            		DB	020H
  E510  20            		DB	020H
                      	;
                      	;LDDIO.ASM
                      	
                      	;	LSX-Dodgers DIO
                      	
  E511                	DRDX:
  E511  CD47E5        		CALL	DRDY
  E514  C8            		RET	Z
  E515  CD31E5        		CALL	DRDX1
  E518  D8            		RET	C
  E519  E5            		PUSH	HL
  E51A  C5            		PUSH	BC
  E51B  D5            		PUSH	DE
  E51C  2A7EEC        		LD	HL,(_DTBUF)
  E51F  CD28E7        		CALL	DRDC
  E522  DC42E5        		CALL	C,DRDNE
  E525                	DRDXE1:
  E525  D1            		POP	DE
  E526  C1            		POP	BC
  E527                	DRDXE2:
  E527  E1            		POP	HL
  E528  C9            		RET
                      	
  E529                	DRDN:
  E529  AF            		XOR	A
  E52A  00            	DRDN1:	NOP
  E52B  30E4          		JR	NC,DRDX
  E52D                	DRDNX:
  E52D  CD47E5        		CALL	DRDY
  E530  C8            		RET	Z
  E531                	DRDX1:
  E531  CD58E5        		CALL	DWTX
  E534  ED53A6EC      		LD	(_DCLPS),DE
  E538  3A88EC        		LD	A,(_DRV)
  E53B  32A5EC        		LD	(_DBDRV),A
  E53E  CDD9EC        		CALL	_CHGDRV
  E541  D0            		RET	NC
  E542                	DRDNE:
  E542  9F            		SBC	A,A
  E543  32A5EC        		LD	(_DBDRV),A
  E546  C9            		RET
                      	
  E547                	DRDY:
  E547  E5            		PUSH	HL
  E548  3A88EC        		LD	A,(_DRV)
  E54B  21A5EC        		LD	HL,_DBDRV
  E54E  AE            		XOR	(HL)
  E54F  2005          		JR	NZ,DRDY1
                      	
  E551  2AA6EC        		LD	HL,(_DCLPS)
  E554  ED52          		SBC	HL,DE		;CF=0
  E556                	DRDY1:
  E556  E1            		POP	HL
  E557  C9            		RET
                      	
  E558                	DWTX:
  E558  3AA4EC        		LD	A,(_WTDBF)
  E55B  B7            		OR	A
  E55C  C8            		RET	Z
  E55D  AF            		XOR	A
  E55E  32A4EC        		LD	(_WTDBF),A
                      	
  E561  E5            		PUSH	HL
  E562  C5            		PUSH	BC
  E563  D5            		PUSH	DE
  E564  3AA5EC        		LD	A,(_DBDRV)
  E567  CDD9EC        		CALL	_CHGDRV
  E56A  ED5BA6EC      		LD	DE,(_DCLPS)
  E56E  2A7EEC        		LD	HL,(_DTBUF)
  E571  D434E7        		CALL	NC,DWTC
  E574  18AF          		JR	DRDXE1
                      	
  E576                	RDFATX:
  E576  E5            		PUSH	HL
  E577  3A88EC        		LD	A,(_DRV)
  E57A  21A3EC        		LD	HL,_FATDRV
  E57D  AE            		XOR	(HL)
  E57E  E67F          		AND	07FH
  E580  28D4          		JR	Z,DRDY1
                      	
  E582  C5            		PUSH	BC
  E583  D5            		PUSH	DE
  E584  DDE5          		PUSH	IX
  E586  CD9EE5        		CALL	WTFATX
  E589  380F          		JR	C,RDFATE1
                      	
  E58B  3A88EC        		LD	A,(_DRV)
  E58E  32A3EC        		LD	(_FATDRV),A
  E591  CDE5EC        		CALL	_RDFAT
  E594                	RDFATE2:
  E594  3004          		JR	NC,RDFATE1
  E596  9F            		SBC	A,A
  E597  32A3EC        		LD	(_FATDRV),A
  E59A                	RDFATE1:
  E59A  DDE1          		POP	IX
  E59C  1887          		JR	DRDXE1
                      	
  E59E                	WTFATX:
  E59E  3AA2EC        		LD	A,(_WTFATF)
  E5A1  B7            		OR	A
  E5A2  C8            		RET	Z
  E5A3  E5            		PUSH	HL
  E5A4  3AA3EC        		LD	A,(_FATDRV)
  E5A7  21A5EC        		LD	HL,_DBDRV
  E5AA  AE            		XOR	(HL)
  E5AB  E67F          		AND	07FH
  E5AD  CC58E5        		CALL	Z,DWTX
  E5B0  38A4          		JR	C,DRDY1
  E5B2  C5            		PUSH	BC
  E5B3  D5            		PUSH	DE
  E5B4  DDE5          		PUSH	IX
  E5B6  CD84E7        		CALL	WTFAT
  E5B9  AF            		XOR	A
  E5BA  32A2EC        		LD	(_WTFATF),A
  E5BD  18DB          		JR	RDFATE1
                      	
  E5BF                	NCL1:
  E5BF  7A            		LD	A,D
  E5C0  B3            		OR	E
  E5C1  37            		SCF
  E5C2  C8            		RET	Z
                      	
  E5C3  3A88EC        		LD	A,(_DRV)
  E5C6  CB5A          		BIT	3,D
  E5C8  2802          		JR	Z,NCL2
  E5CA  F680          		OR	080H
  E5CC                	NCL2:
  E5CC  E5            		PUSH	HL
  E5CD  21A3EC        		LD	HL,_FATDRV
  E5D0  BE            		CP	(HL)
  E5D1  2883          		JR	Z,DRDY1
                      	
  E5D3  C5            		PUSH	BC
  E5D4  D5            		PUSH	DE
  E5D5  DDE5          		PUSH	IX
  E5D7  F5            		PUSH	AF
  E5D8  CD9EE5        		CALL	WTFATX
  E5DB  C1            		POP	BC
  E5DC  38BC          		JR	C,RDFATE1
  E5DE  78            		LD	A,B
  E5DF  32A3EC        		LD	(_FATDRV),A
  E5E2  CD73E7        		CALL	RDFATS
  E5E5  18AD          		JR	RDFATE2
                      	
  E5E7                	NCL3:
  E5E7  CB9A          		RES	3,D
  E5E9  6B            		LD	L,E
  E5EA  62            		LD	H,D
  E5EB  CB3C          		SRL	H
  E5ED  CB1D          		RR	L
  E5EF  1F            		RRA
  E5F0  ED4B7CEC      		LD	BC,(_FATBF)
  E5F4  19            		ADD	HL,DE
  E5F5  09            		ADD	HL,BC
  E5F6  17            		RLA
  E5F7  C9            		RET
                      	
  E5F8                	GNCL:
  E5F8  CDBFE5        		CALL	NCL1		;GET NEW CLUSTER
  E5FB  D8            		RET	C
  E5FC  C5            		PUSH	BC
  E5FD  E5            		PUSH	HL
  E5FE  CDE7E5        		CALL	NCL3
  E601  3809          		JR	C,GNC1
  E603  5E            		LD	E,(HL)
  E604  23            		INC	HL
  E605  7E            		LD	A,(HL)
  E606  E60F          		AND	00FH
  E608  57            		LD	D,A
  E609  E1            		POP	HL
  E60A  C1            		POP	BC
  E60B  C9            		RET
  E60C                	GNC1:
  E60C  7E            		LD	A,(HL)
  E60D  23            		INC	HL
  E60E  56            		LD	D,(HL)
  E60F  0604          		LD	B,4
  E611                	GNC1L:
  E611  CB3A          		SRL	D
  E613  1F            		RRA
  E614  10FB          		DJNZ	GNC1L
                      	
  E616  5F            		LD	E,A
  E617  E1            		POP	HL
  E618  C1            		POP	BC
  E619  A7            		AND	A
  E61A  C9            		RET
                      	
  E61B                	SNCL:
  E61B  CDBFE5        		CALL	NCL1
  E61E  D8            		RET	C
  E61F  3E01          		LD	A,1
  E621  32A2EC        		LD	(_WTFATF),A
                      	;				SET NEW CLUSTER
  E624  C5            		PUSH	BC
  E625  D5            		PUSH	DE
  E626  E5            		PUSH	HL
  E627  E5            		PUSH	HL
  E628  CDE7E5        		CALL	NCL3
  E62B  D1            		POP	DE
                      	;CF=ODD
  E62C  7E            		LD	A,(HL)
  E62D  73            		LD	(HL),E
  E62E  3806          		JR	C,SNC1
                      	;EVEN
                      	;M[0] = E
                      	;M[1] = (M[1] & 0xF0) | (D & 0x0F)
  E630  23            		INC	HL
  E631  ED67          		RRD		;M={A[3:0],E[3:0]}
  E633  7A            		LD	A,D
  E634  1804          		JR	SNC11
  E636                	SNC1:
                      	;ODD
                      	;HL[0] = (HL[0]&0x0F) | (E<<4)
                      	;HL[1] = DE>>4
  E636  ED6F          		RLD		;M={D[3:0],E[7:4]}
  E638  23            		INC	HL
  E639  72            		LD	(HL),D	;M={D[3:0],E[7:4]}
  E63A                	SNC11:
  E63A  ED6F          		RLD		;M={M[7:4],D[3:0]}
  E63C  E1            		POP	HL
  E63D  D1            		POP	DE
  E63E  C1            		POP	BC
  E63F  B7            		OR	A
  E640  C9            		RET
                      	
  E641                	RDFAT0X:
  E641  CD73E7        		CALL	RDFATS
  E644  D8            		RET	C
  E645  DDBE01        		CP	(IX+1)
  E648  C8            		RET	Z
  E649  37            		SCF
  E64A  C9            		RET
                      	
  E64B                	RDFAT:
  E64B  3A88EC        		LD	A,(_DRV)
  E64E  CDA1E8        		CALL	CHGDRVR
  E651  D8            		RET	C
  E652  DD7E12        		LD	A,(IX+012H)
  E655  FE87          		CP	087H
  E657  20E8          		JR	NZ,RDFAT0X
                      	
  E659  3E7F          		LD	A,07FH
  E65B  3247E9        		LD	(CHECK),A	;A=07FH
  E65E  DDCB0A46      		BIT	0,(IX+00AH)
  E662  284D          		JR	Z,X2HX
  E664                	E2DX:
  E664  21D7E8        		LD	HL,M2D
  E667  CD40E7        		CALL	DRDF
  E66A  383D          		JR	C,E2HX
  E66C  FEFD          		CP	0FDH		;2D
  E66E  C8            		RET	Z
  E66F  FEF9          		CP	0F9H		;2DD9
  E671  CA1BE7        		JP	Z,E2DD9
  E674  FEFB          		CP	0FBH		;2DD8
  E676  37            		SCF
  E677  C0            		RET	NZ		;NOT 2DD
  E678  21E5E8        		LD	HL,M2DD8
  E67B                	CHGTYPE:
  E67B  D5            		PUSH	DE
  E67C  CD8EE6        		CALL	CHGDV
  E67F  3A84EC        		LD	A,(_DRIVE)
  E682  E603          		AND	3
  E684  F680          		OR	080H
  E686  6F            		LD	L,A
  E687  26EC          		LD	H,_CYL0/256
  E689  3EFF          		LD	A,0FFH
  E68B  77            		LD	(HL),A
  E68C  D1            		POP	DE
  E68D  C9            		RET
                      	
  E68E                	CHGDV:
  E68E  DDE5          		PUSH	IX
  E690  D1            		POP	DE
  E691  EDA0          		LDI
  E693  EDA0          		LDI
  E695  13            		INC	DE
  E696  13            		INC	DE
  E697  13            		INC	DE
  E698  13            		INC	DE
  E699  010C00        		LD	BC,12
  E69C  EDB0          		LDIR
  E69E                	CHGDV2:
  E69E  3EFF          		LD	A,0FFH
  E6A0  3289EC        		LD	(_DSK),A
  E6A3  3A88EC        		LD	A,(_DRV)
  E6A6  C3D9EC        		JP	_CHGDRV
                      	
  E6A9                	E2HX:
  E6A9  3C            		INC	A
  E6AA  C8            		RET	Z
  E6AB  2147E9        		LD	HL,CHECK
  E6AE  CB06          		RLC	(HL)
  E6B0  D8            		RET	C
  E6B1                	X2HX:
  E6B1  210FE9        		LD	HL,M2HD
  E6B4  110000        		LD	DE,0
  E6B7  CD44E7        		CALL	DRDD
  E6BA  300A          		JR	NC,X2HX1
  E6BC  3C            		INC	A
  E6BD  C8            		RET	Z
  E6BE  2147E9        		LD	HL,CHECK
  E6C1  CB06          		RLC	(HL)
  E6C3  D8            		RET	C
  E6C4  189E          		JR	E2DX
  E6C6                	X2HX1:
  E6C6  23            		INC	HL
  E6C7  7E            		LD	A,(HL)
  E6C8  06FE          		LD	B,0FEH
  E6CA  FE0C          		CP	00CH
  E6CC  2838          		JR	Z,X2HDE
  E6CE  06F8          		LD	B,0F8H
  E6D0  D620          		SUB	020H		;020H
  E6D2  2832          		JR	Z,X2HDE
  E6D4  3C            		INC	A		;01FH
  E6D5  282F          		JR	Z,X2HDE
  E6D7  3C            		INC	A		;01EH
  E6D8  2078          		JR	NZ,C2HX		;2HD/2HC/2HQ
  E6DA                	X2HS:
  E6DA  2139E9        		LD	HL,M2HS
  E6DD  CD0CE7        		CALL	X2HSS
  E6E0  D8            		RET	C
  E6E1  2A7CEC        		LD	HL,(_FATBF)
  E6E4  23            		INC	HL
  E6E5  7E            		LD	A,(HL)		;FATBF+1
  E6E6  FE50          		CP	80
  E6E8  3F            		CCF
  E6E9  D0            		RET	NC
  E6EA  FE5A          		CP	90
  E6EC  D0            		RET	NC
  E6ED  DD770C        		LD	(IX+00CH),A
  E6F0  D650          		SUB	80
  E6F2  87            		ADD	A,A	;*2
  E6F3  4F            		LD	C,A
  E6F4  87            		ADD	A,A	;*4
  E6F5  87            		ADD	A,A	;*8
  E6F6  87            		ADD	A,A	;*16
  E6F7  81            		ADD	A,C	;*18
  E6F8  C698          		ADD	A,098H
  E6FA  DD7708        		LD	(IX+8),A
  E6FD  3E05          		LD	A,5
  E6FF  CE00          		ADC	A,0
  E701  DD7709        		LD	(IX+9),A
  E704  1898          		JR	CHGDV2
  E706                	X2HDE:
  E706  212BE9        		LD	HL,M2HDE
  E709  23            		INC	HL
  E70A  70            		LD	(HL),B
  E70B  2B            		DEC	HL
  E70C                	X2HSS:
  E70C  CD40E7        		CALL	DRDF
  E70F  D8            		RET	C
  E710  DDBE01        		CP	(IX+1)
  E713  37            		SCF
  E714  C0            		RET	NZ
  E715  CD24E7        		CALL	INCDRD
  E718  300E          		JR	NC,DRDC
  E71A  C9            		RET
                      	
  E71B                	E2DD9:
  E71B  21F3E8        		LD	HL,M2DD
  E71E  CD7BE6        		CALL	CHGTYPE
  E721  2A7CEC        		LD	HL,(_FATBF)
  E724                	INCDRD:
  E724  24            		INC	H
  E725  24            		INC	H
  E726  24            		INC	H
  E727  24            		INC	H
  E728                	DRDC:
  E728  CDF1EC        		CALL	_DRD
  E72B  D8            		RET	C
  E72C  3A5FDF        		LD	A,(DBLPAT)
  E72F  B7            		OR	A
  E730  C2F1EC        		JP	NZ,_DRD
  E733  C9            		RET
                      	
  E734                	DWTC:
  E734  CDF4EC        		CALL	_DWT
  E737  D8            		RET	C
  E738  3A5FDF        		LD	A,(DBLPAT)
  E73B  B7            		OR	A
  E73C  C2F4EC        		JP	NZ,_DWT
  E73F  C9            		RET
                      	
  E740                	DRDF:
  E740  ED5B5AE2      		LD	DE,(_FATPS)
  E744                	DRDD:
  E744  CD7BE6        		CALL	CHGTYPE
  E747  2A7CEC        		LD	HL,(_FATBF)
  E74A  E5            		PUSH	HL
  E74B  CD28E7        		CALL	DRDC
  E74E  E1            		POP	HL
  E74F  D8            		RET	C
  E750  7E            		LD	A,(HL)
  E751  C9            		RET
                      	
  E752                	C2HX:
  E752  CD73E7        		CALL	RDFATS
  E755  D8            		RET	C
  E756  FEFE          		CP	0FEH
  E758  C8            		RET	Z
  E759  FEF0          		CP	0F0H
  E75B  2810          		JR	Z,X2HQ
  E75D  FEF9          		CP	0F9H
  E75F  37            		SCF
  E760  C0            		RET	NZ
  E761  E5            		PUSH	HL
  E762  2101E9        		LD	HL,M2HC
  E765                	X2HQ1:
  E765  CD7BE6        		CALL	CHGTYPE
  E768  E1            		POP	HL
  E769  0604          		LD	B,4
  E76B  180A          		JR	RDFATL
  E76D                	X2HQ:
  E76D  E5            		PUSH	HL
  E76E  211DE9        		LD	HL,M2HQ
  E771  18F2          		JR	X2HQ1
                      	
  E773                	RDFATS:
  E773  CDA6E7        		CALL	FATS
  E776  D8            		RET	C
  E777                	RDFATL:
  E777  C5            		PUSH	BC
  E778  CDF1EC        		CALL	_DRD
  E77B  C1            		POP	BC
  E77C  D8            		RET	C
  E77D  10F8          		DJNZ	RDFATL
  E77F  2A7CEC        		LD	HL,(_FATBF)
  E782  7E            		LD	A,(HL)
  E783  C9            		RET
                      	
  E784                	WTFAT:
  E784  CDA6E7        		CALL	FATS
  E787  D49DE7        		CALL	NC,WTFATL
  E78A  D8            		RET	C
  E78B  DDCB0F4E      		BIT	1,(IX+00FH)
  E78F  C8            		RET	Z
  E790  CDADE7        		CALL	FATS2
  E793  C5            		PUSH	BC
  E794  DD4E00        		LD	C,(IX+0)
  E797  0600          		LD	B,0
  E799  EB            		EX	DE,HL
  E79A  09            		ADD	HL,BC
  E79B  EB            		EX	DE,HL
  E79C  C1            		POP	BC
  E79D                	WTFATL:
  E79D  C5            		PUSH	BC
  E79E  CDF4EC        		CALL	_DWT
  E7A1  C1            		POP	BC
  E7A2  D8            		RET	C
  E7A3  10F8          		DJNZ	WTFATL
  E7A5  C9            		RET
                      	;------------------------
                      	;FATのセットアップ
                      	;out
                      	;	B  : FATセクタ数
                      	;	DE : FAT先頭セクタ番号
                      	;	HL : FATバッファポインタ
                      	;	CF : 1=ドライブ切り替えエラー
                      	;note
                      	;	FATサイズがFATバッファを超える場合は
                      	;	対象クラスタ領域==(_FATDRV).bit7によって
                      	;	FATの前半3KBと後半3KBを切り替える
                      	;------------------------
  E7A6                	FATS:
  E7A6  3AA3EC        		LD	A,(_FATDRV)
  E7A9  CDA1E8        		CALL	CHGDRVR		;ドライブ切り替え
  E7AC  D8            		RET	C
  E7AD                	FATS2:
  E7AD  ED5B5AE2      		LD	DE,(_FATPS)	;fat sector pos
  E7B1  2A7CEC        		LD	HL,(_FATBF)
  E7B4  DD4600        		LD	B,(IX+0)	;DPB.FATLN
  E7B7  DD7E07        		LD	A,(IX+7)	;$29=512 / 0=1024
  E7BA  B7            		OR	A
  E7BB  3E06          		LD	A,6		;3072 / 512 FATバッファに読み込めるセクタ数
  E7BD  2007          		JR	NZ,FATS512
  E7BF  DDCB0F7E      		BIT	7,(IX+00FH)
  E7C3  2001          		JR	NZ,FATS512
  E7C5  1F            		RRA			;A=3 (3072÷1024: 1セクタ1024バイトの場合)
  E7C6                	FATS512:
  E7C6  B8            		CP	B
  E7C7  D0            		RET	NC		;DPB.FATS x sectorSize < fatBufSize
                      	;targetCluster
  E7C8  4F            		LD	C,A		;C = skipCount
  E7C9  3AA3EC        		LD	A,(_FATDRV)	;bit7 = (targetCluster >= 0x800)
  E7CC  87            		ADD	A,A		;CF=(_FATDRV).bit7
  E7CD  3006          		JR	NC,FATS3
                      	;(targerCluster>=0x800)
  E7CF                	FAT_SKP:
  E7CF  13            		INC	DE		;FATPS++
  E7D0  05            		DEC	B		;FATSIZE--
  E7D1  0D            		DEC	C		;skipCnt--
  E7D2  20FB          		JR	NZ,FAT_SKP
  E7D4  48            		LD	C,B
  E7D5                	FATS3:
  E7D5  41            		LD	B,C		;3 or 6
  E7D6  AF            		XOR	A
  E7D7  C9            		RET
                      	
  E7D8                	CHGDRV:
  E7D8  E67F          		AND	07FH
  E7DA  E5            		PUSH	HL
  E7DB  2189EC        		LD	HL,_DSK
  E7DE  BE            		CP	(HL)
  E7DF  280A          		JR	Z,CHGDRVE
  E7E1                	CHGDRV1:
  E7E1  DDE5          		PUSH	IX
  E7E3  CDEDE7        		CALL	CHGDRV0
  E7E6  3A89EC        		LD	A,(_DSK)
  E7E9  DDE1          		POP	IX
  E7EB                	CHGDRVE:
  E7EB  E1            		POP	HL
  E7EC  C9            		RET
                      	
  E7ED                	CHGDRV0:
  E7ED  6F            		LD	L,A
  E7EE  CDDCEC        		CALL	_GETDPB
  E7F1  D8            		RET	C
                      	
  E7F2  7D            		LD	A,L
  E7F3  3289EC        		LD	(_DSK),A
                      	
  E7F6  F3            		DI
  E7F7  ED735EE8      		LD	(SPPAT2+1),SP
                      	
  E7FB  DDF9          		LD	SP,IX
                      	
  E7FD  E1            		POP	HL
  E7FE  E1            		POP	HL
  E7FF  22F2EC        		LD	(_DRD+1),HL
                      	
  E802  E1            		POP	HL
  E803  22F5EC        		LD	(_DWT+1),HL
                      	
  E806  E1            		POP	HL
  E807  225EDF        		LD	(CLSPAT+1),HL	;ADDCL
                      	
  E80A  E1            		POP	HL		;MAXCL
  E80B  7D            		LD	A,L
  E80C  326DDF        		LD	(CLPAT2+1),A
  E80F  7C            		LD	A,H
  E810  3269DF        		LD	(CLPAT1+1),A
  E813  2B            		DEC	HL
  E814  2269E1        		LD	(MAXCLP+1),HL
                      	
  E817  E1            		POP	HL		;H=MAXDIR L=FDMODE
  E818  7D            		LD	A,L
  E819  F6FE          		OR	0FEH
  E81B  32C2E9        		LD	(FDMODE+1),A
  E81E  07            		RLCA
  E81F  E603          		AND	3
  E821  32A9E9        		LD	(FSPAT+1),A
  E824  7C            		LD	A,H
  E825  326BDE        		LD	(RTEPAT+1),A
                      	
  E828  E1            		POP	HL
  E829  7D            		LD	A,L
  E82A  32A1EC        		LD	(_MAXCYL),A
  E82D  7C            		LD	A,H
  E82E  3251E9        		LD	(MAXSEC+1),A
                      	
  E831  E1            		POP	HL
  E832  2600          		LD	H,0
  E834  225AE2        		LD	(_FATPS),HL
                      	
  E837  E1            		POP	HL
  E838  7C            		LD	A,H
  E839  325EE9        		LD	(SECPAT+1),A
  E83C  2600          		LD	H,0
  E83E  225CE2        		LD	(_DIRPS),HL
                      	
  E841  E1            		POP	HL
  E842  7C            		LD	A,H
  E843  3284EC        		LD	(_DRIVE),A
                      	
  E846  E1            		POP	HL
  E847  E1            		POP	HL
  E848  7C            		LD	A,H
  E849  B5            		OR	L
  E84A  2003          		JR	NZ,OGNCL
  E84C  21F8E5        		LD	HL,GNCL		;FAT12(default)
  E84F                	OGNCL:
  E84F  22F8EC        		LD	(_GNCL+1),HL
                      	
  E852  E1            		POP	HL
  E853  7C            		LD	A,H
  E854  B5            		OR	L
  E855  2003          		JR	NZ,OSNCL
  E857  211BE6        		LD	HL,SNCL		;FAT12(default)
  E85A                	OSNCL:
  E85A  22FBEC        		LD	(_SNCL+1),HL
                      	
  E85D  310000        	SPPAT2:	LD	SP,0
  E860  FB            		EI
  E861  D5            		PUSH	DE
  E862  DDCB0F7E      		BIT	7,(IX+00FH)
  E866  280A          		JR	Z,NEC
                      	
  E868  111802        		LD	DE,00218H
  E86B  210000        		LD	HL,0
                      	
  E86E  3E03          		LD	A,3
  E870  1808          		JR	NEC1
  E872                	NEC:
  E872  11CB38        		LD	DE,038CBH	;SRL B
  E875  21CB3F        		LD	HL,03FCBH	;SRL A
                      	
  E878  3E03          		LD	A,3
  E87A                	NEC1:
  E87A  328BE4        		LD	(IBM5+1),A	;3 1
  E87D  3C            		INC	A		;4 2
  E87E  32B0E4        		LD	(IBM7+2),A
  E881  87            		ADD	A,A		;8 4
  E882  87            		ADD	A,A		;010H 8
  E883  87            		ADD	A,A		;020H 010H
  E884  32F8DD        		LD	(IBM1+1),A
  E887  87            		ADD	A,A		;040H 020H
  E888  87            		ADD	A,A		;080H 040H
  E889  87            		ADD	A,A		;000H 080H
  E88A  2F            		CPL			;0FFH 07FH
  E88B  324AD3        		LD	(IBM2+1),A
  E88E  ED5347E1      		LD	(IBM4),DE
  E892  22D4E4        		LD	(IBM8),HL
  E895  D1            		POP	DE
  E896  AF            		XOR	A
  E897  C9            		RET
                      	
  E898                	GETDPBD:
  E898  DDE3          		EX	(SP),IX
  E89A  DDE5          		PUSH	IX
  E89C  3A88EC        		LD	A,(_DRV)
  E89F  1807          		JR	GETDPB1
                      	
  E8A1                	CHGDRVR:
  E8A1  CDD9EC        		CALL	_CHGDRV
  E8A4  D8            		RET	C
  E8A5  3A89EC        		LD	A,(_DSK)
  E8A8                	GETDPB1:
  E8A8  C3DCEC        		JP	_GETDPB
                      	
  E8AB                	GETDPB:
  E8AB  FE08          		CP	8
  E8AD  3F            		CCF
  E8AE  D8            		RET	C
  E8AF  87            		ADD	A,A	;*2
  E8B0  87            		ADD	A,A	;*4
  E8B1  87            		ADD	A,A	;*8
  E8B2  87            		ADD	A,A	;*16
  E8B3  87            		ADD	A,A	;*32
                      	;	LD	IXL,A		;OHM-Z80固有マクロ
  E8B4  DD            		DB	0DDH		;Z80未定義命令
  E8B5  6F            		LD	L,A		;
                      	;	LD	IXH,DEVICE/256	;OHM-Z80固有マクロ
  E8B6  DD            		DB	0DDH		;Z80未定義命令
  E8B7  26ED          		LD	H,DEVICE/256	;
  E8B9  DD7E00        		LD	A,(IX+0)
  E8BC  FE01          		CP	001H		;A=0 THEN CF=1
  E8BE  C9            		RET
                      	
  E8BF                	FFLUSH:
  E8BF  F5            		PUSH	AF
  E8C0  3EFF          		LD	A,0FFH
  E8C2  3236E2        		LD	(SFILE),A
  E8C5  CD58E5        		CALL	DWTX
  E8C8  3EFF          		LD	A,0FFH
  E8CA  32A5EC        		LD	(_DBDRV),A
  E8CD  CD9EE5        		CALL	WTFATX
  E8D0  3EFF          		LD	A,0FFH
  E8D2  32A3EC        		LD	(_FATDRV),A
  E8D5  F1            		POP	AF
  E8D6  C9            		RET
                      	
  E8D7                	M2D:
  E8D7  02FD          		DB	2,0FDH
  E8D9  08296401      		DW	02908H,356
  E8DD  FF0C2809010205		DB	0FFH,12,40,9,1,2,5,1
                      	
  E8E5                	M2DD8:
  E8E5  02FB          		DB	2,0FBH
  E8E7  08297C02      		DW	02908H,636
  E8EB  FF0C5008010205		DB	0FFH,12,80,8,1,2,5,1
                      	
  E8F3                	M2DD:
  E8F3  03F9          		DB	3,0F9H
  E8F5  0A29CB02      		DW	0290AH,715
  E8F9  FF0E5009010207		DB	0FFH,14,80,9,1,2,7,1
                      	
  E901                	M2HC:
  E901  07F9          		DB	7,0F9H
  E903  1B004509      		DW	27,2373
  E907  FE1D500F01820F		DB	0FEH,29,80,15,1,082H,15,1
                      	
  E90F                	M2HD:
  E90F  02FE          		DB	2,0FEH
  E911  0900C704      		DW	9,1223
  E915  FE0B4D08010205		DB	0FEH,11,77,8,1,2,5,1
                      	
  E91D                	M2HQ:
  E91D  09F0          		DB	9,0F0H
  E91F  1F00210B      		DW	31,2849
  E923  FE245012018213		DB	0FEH,36,80,18,1,082H,19,1
                      	
  E92B                	M2HDE:
  E92B  03FE          		DB	3,0FEH
  E92D  0B009505      		DW	11,1429
  E931  FE0D5009010207		DB	0FEH,13,80,9,1,2,7,1
                      	
  E939                	M2HS:
  E939  03FB          		DB	3,0FBH
  E93B  08009805      		DW	8,1432
  E93F  FE0A5009010104		DB	0FEH,10,80,9,1,1,4,10
                      	
  E947  00            	CHECK:	DB	0
                      	
                      	;LDDISK.ASM
                      	
                      	;	LSX-Dodgers DISK
                      	
                      	
  E948                	SEEK:
  E948  7A            		LD	A,D
  E949  B3            		OR	E
  E94A  3E01          		LD	A,001H
  E94C  2812          		JR	Z,DIV3
                      	
  E94E  0610          		LD	B,16
  E950  0E00          	MAXSEC:	LD	C,000H
  E952  AF            		XOR	A
  E953  EB            		EX	DE,HL
  E954                	DIV1:
  E954  29            		ADD	HL,HL
  E955  8F            		ADC	A,A
  E956  B9            		CP	C
  E957  3802          		JR	C,DIV2
  E959  91            		SUB	C
  E95A  2C            		INC	L
  E95B                	DIV2:
  E95B  10F7          		DJNZ	DIV1
                      	
  E95D  C601          	SECPAT:	ADD	A,001H		;(Self-rewriting)
  E95F  55            		LD	D,L	;Quotient(TRACK)
  E960                	DIV3:
  E960  5F            		LD	E,A	;Remainder
  E961  CB3A          		SRL	D	;CYLINDER
  E963  9F            		SBC	A,A
  E964  E610          		AND	010H	;SIDE
  E966  4F            		LD	C,A
                      	
  E967  3A84EC        		LD	A,(_DRIVE)
  E96A  FE04          		CP	4
  E96C  3F            		CCF
  E96D  D8            		RET	C
  E96E  B1            		OR	C
  E96F  32EEE9        		LD	(MOPAT+1),A	;Motor off data
  E972  01FC0F        		LD	BC,00FFCH
  E975  F680          		OR	080H		;Mortor on
  E977  ED79          		OUT	(C),A
                      	
  E979  CDC0E9        		CALL	SETMODE
  E97C  D8            		RET	C
                      	
  E97D  CD03EA        		CALL	DRIVE
  E980  FEFF          		CP	0FFH		;A=0FFH Unknown CYLINDER
  E982  CCE2E9        		CALL	Z,FDCRES	;Restore
  E985  0EF9          		LD	C,0F9H
  E987  ED79          		OUT	(C),A		;Currrent CYLINDER
  E989  92            		SUB	D
  E98A  C8            		RET	Z		;No seek
                      	
  E98B  3A86EC        		LD	A,(_ISEEK)
  E98E  4F            		LD	C,A
                      	
  E98F  3AA1EC        		LD	A,(_MAXCYL)	;Max CYLINDER
  E992  3D            		DEC	A
  E993  BA            		CP	D		;Over CYLINDER
  E994  D8            		RET	C
                      	
  E995  B9            		CP	C		;for Built-in 2DD
  E996  3803          		JR	C,SETM2
  E998  78            		LD	A,B		;B=00FH
  E999  DBFE          		IN	A,(0FEH)		;2HD mode for 2DD seek
  E99B                	SETM2:
  E99B  78            		LD	A,B
  E99C  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  E99E  0EFB          		LD	C,0FBH
  E9A0  ED51          		OUT	(C),D
  E9A2  72            		LD	(HL),D
  E9A3  0E18          		LD	C,018H		;Seek
  E9A5                	FDCCMD2:
  E9A5  3A85EC        		LD	A,(_SEEKSP)
  E9A8  E6FF          	FSPAT:	AND	0FFH
  E9AA  B1            		OR	C
                      	
  E9AB                	FDCCMD:
  E9AB  CDF9E9        		CALL	COMSET
                      	
  E9AE  3A70EA        	AT_FDCPAT:LD	A,(FDCPAT+1)
  E9B1  E620          		AND	020H		;Write data Write track
  E9B3  3C            		INC	A
                      	
  E9B4                	SST:
  E9B4  0E00          		LD	C,0
  E9B6                	SST1:
  E9B6  0D            		DEC	C		; 4
  E9B7  20FD          		JR	NZ,SST1		;12 * 256 / 4 = About 1ms
  E9B9  3D            		DEC	A
  E9BA  20FA          		JR	NZ,SST1
                      	
  E9BC  3C            		INC	A		;A=1
  E9BD  CDCBE9        		CALL	READY
  E9C0                	SETMODE:
  E9C0  78            		LD	A,B		;B=00FH
  E9C1  DBFF          	FDMODE:	IN	A,(0FFH)		;Floppy mode(2D/2HD) (Self-rewriting)
                      	
  E9C3  78            		LD	A,B
  E9C4  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  E9C6  CDFDE9        		CALL	DELAY0		;Head select time
  E9C9  3E81          		LD	A,081H
  E9CB                	READY:
  E9CB  32D5E9        		LD	(WAITA+1),A
  E9CE  E5            		PUSH	HL
  E9CF  0EF8          		LD	C,0F8H
  E9D1  61            		LD	H,C
  E9D2                	READY2:
  E9D2  ED78          		IN	A,(C)
  E9D4  E681          	WAITA:	AND	081H		;NOT READY,BUSY
  E9D6  2808          		JR	Z,READYE
  E9D8  E3            		EX	(SP),HL		;wait
  E9D9  E3            		EX	(SP),HL		; //
  E9DA  2B            		DEC	HL
  E9DB  7C            		LD	A,H
  E9DC  B5            		OR	L
  E9DD  20F3          		JR	NZ,READY2
  E9DF  37            		SCF
  E9E0                	READYE:
  E9E0  E1            		POP	HL
  E9E1  C9            		RET
                      	
  E9E2                	FDCRES:
  E9E2  3600          		LD	(HL),0
  E9E4  0E08          		LD	C,8
  E9E6  18BD          		JR	FDCCMD2
                      	
  E9E8                	FDMOFF:
  E9E8  F5            		PUSH	AF
  E9E9  C5            		PUSH	BC
  E9EA  01FC0F        		LD	BC,00FFCH	;Motor off
  E9ED  3E00          	MOPAT:	LD	A,000H		;(Self-rewriting)
  E9EF  ED79          		OUT	(C),A
  E9F1  C1            		POP	BC
  E9F2  F1            		POP	AF
  E9F3  C9            		RET
                      	
  E9F4                	SECSET:
  E9F4  01FA0F        		LD	BC,00FFAH
  E9F7  ED59          		OUT	(C),E
  E9F9                	COMSET:
  E9F9  0EF8          		LD	C,0F8H
  E9FB  ED79          		OUT	(C),A
  E9FD                	DELAY0:
  E9FD  3E1A          		LD	A,26
  E9FF                	DELAY:
  E9FF  3D            		DEC	A
  EA00  20FD          		JR	NZ,DELAY
  EA02  C9            		RET
                      	
  EA03                	DRIVE:
  EA03  2A84EC        		LD	HL,(_DRIVE)
  EA06  26EC          		LD	H,_CYL0/256
  EA08  CBFD          		SET	7,L
  EA0A  7E            		LD	A,(HL)
  EA0B  C9            		RET
                      	
  EA0C                	RNF:
  EA0C  CD03EA        		CALL	DRIVE
  EA0F  36FF          		LD	(HL),0FFH
  EA11  C9            		RET
                      	
  EA12  0307          	DEMES:	DB	3,7
  EA14  A5446576696365		DB	0A5H, "Device I/O Error!",5,3
  EA28  41626F72742052		DB	"Abort Retry Ignore?",5,3,0
                      	
  EA3E  02            	RETRY:	DB	2
                      	
                      	
                      	;	FLOPPY DISK DRIVER(DMA)
                      	
                      	
  EA3F                	WTTRK:
  EA3F  3EF4          		LD	A,0F4H
  EA41  01            		DB	1	;JR	WTTRK1
  EA42                	FDWT:
  EA42  3EA0          		LD	A,0A0H
  EA44                	WTTRK1:
  EA44  3270EA        		LD	(FDCPAT+1),A
  EA47  3E10          		LD	A,16
  EA49  F3            		DI
  EA4A  1808          		JR	DISK
                      	
  EA4C                	FDRD:
  EA4C  3E80          		LD	A,080H
  EA4E  00            		NOP
                      	
  EA4F  3270EA        		LD	(FDCPAT+1),A
  EA52  3E0E          		LD	A,14
                      	
  EA54                	DISK:
  EA54  3266EA        		LD	(DMAPAT+1),A
                      	
  EA57  22F0EA        		LD	(DMAD+11),HL
  EA5A                	DISKR:
  EA5A  3E02          		LD	A,2		;Retry count
  EA5C  323EEA        		LD	(RETRY),A
  EA5F                	DISK2:
  EA5F  D5            		PUSH	DE
  EA60  CD48E9        		CALL	SEEK
  EA63  3840          		JR	C,ERRF
                      	
  EA65  3E0E          	DMAPAT:	LD	A,14
  EA67  21E5EA        		LD	HL,DMAD
  EA6A  CDDBEA        		CALL	SETDMA
  EA6D  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EA6F  3E80          	FDCPAT:	LD	A,080H		;FDC COMMAND(Self-rewriting)
  EA71  C5            		PUSH	BC
  EA72  CDF4E9        		CALL	SECSET
  EA75  2AF0EA        		LD	HL,(DMAD+11)
  EA78  23            		INC	HL
  EA79  1106BB        		LD	DE,0BB06H	;READ DMA
                      	
  EA7C  3E03          		LD	A,3
  EA7E  CDCBE9        		CALL	READY
  EA81  ED78          		IN	A,(C)
                      	
  EA83  C1            		POP	BC
  EA84  ED51          		OUT	(C),D
  EA86  ED59          		OUT	(C),E
  EA88  ED58          		IN	E,(C)
  EA8A  ED50          		IN	D,(C)
  EA8C  19            		ADD	HL,DE
  EA8D  D1            		POP	DE
  EA8E  13            		INC	DE
  EA8F  FB            		EI
  EA90  CDE8E9        		CALL	FDMOFF
  EA93  B7            		OR	A
  EA94  C8            		RET	Z
  EA95  1B            		DEC	DE
  EA96  CB67          		BIT	4,A
  EA98  C40CEA        		CALL	NZ,RNF
  EA9B                	DISKE2:
  EA9B  213EEA        		LD	HL,RETRY
  EA9E  35            		DEC	(HL)
  EA9F  20BE          		JR	NZ,DISK2
  EAA1  B7            		OR	A
  EAA2  2834          		JR	Z,ERR
  EAA4  D5            		PUSH	DE
  EAA5                	ERRF:
  EAA5  D1            		POP	DE
  EAA6                	DELP:
  EAA6  CD0CEA        		CALL	RNF
  EAA9  CDE8E9        		CALL	FDMOFF
  EAAC  3A85EC        		LD	A,(_SEEKSP)
  EAAF  87            		ADD	A,A
  EAB0  9F            		SBC	A,A
  EAB1  3825          		JR	C,ERR
  EAB3                	DELP1:
  EAB3  D5            		PUSH	DE
  EAB4  2112EA        		LD	HL,DEMES
  EAB7  CDF6D7        		CALL	MSX
  EABA  CD73D6        		CALL	KEYBC
  EABD                	DELP2:
  EABD  CD0EDC        		CALL	INKEY
  EAC0  28FB          		JR	Z,DELP2
                      	
  EAC2  D1            		POP	DE
  EAC3  CD6FDF        		CALL	CAP
  EAC6  FE52          		CP	'R'
  EAC8  CA5AEA        		JP	Z,DISKR
  EACB  FE49          		CP	'I'
  EACD  2807          		JR	Z,IGNORE
  EACF  FE41          		CP	'A'
  EAD1  20E0          		JR	NZ,DELP1
  EAD3  C3F1D9        		JP	BOOT
  EAD6                	IGNORE:
  EAD6  3EFF          		LD	A,0FFH
  EAD8                	ERR:
  EAD8  BF            		CP	A
  EAD9  37            		SCF
  EADA  C9            		RET
                      	
  EADB                	SETDMA:
  EADB  01871F        		LD	BC,01F87H
  EADE                	SDMA:
  EADE  04            		INC	B
  EADF  EDA3          		OUTI
  EAE1  3D            		DEC	A
  EAE2  20FA          		JR	NZ,SDMA
  EAE4  C9            		RET
                      	
  EAE5  C37DFB0FFFFF2C	DMAD:	DB	0C3H,07DH,0FBH,00FH,0FFH,0FFH,02CH,010H		;X1turbo
  EAED  80928D0000CF01		DB	080H,092H,08DH,000H,000H,0CFH,001H,0CFH		;DISK DMA
                      	
                      	
                      	;	EMM DRIVER(DMA)
                      	
                      	
  EAF5                	EDWTC:
  EAF5  3E11          		LD	A,17
  EAF7  01            		DB	1
  EAF8                	EDRDC:
  EAF8  3E0F          		LD	A,15
  EAFA                	EDWTC1:
  EAFA  D5            		PUSH	DE
  EAFB  2237EB        		LD	(EDMAD+12),HL
  EAFE  EB            		EX	DE,HL
  EAFF  29            		ADD	HL,HL
  EB00  29            		ADD	HL,HL
  EB01  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  EB05  0E00          		LD	C,0
  EB07  09            		ADD	HL,BC
  EB08  ED4B84EC      		LD	BC,(_DRIVE)
  EB0C  060D          		LD	B,00DH
  EB0E  ED49          		OUT	(C),C
  EB10  0C            		INC	C
  EB11  ED69          		OUT	(C),L
  EB13  0C            		INC	C
  EB14  ED61          		OUT	(C),H
                      	
  EB16  212BEB        		LD	HL,EDMAD
  EB19  CDDBEA        		CALL	SETDMA
  EB1C  3EB3          		LD	A,0B3H
  EB1E  ED79          		OUT	(C),A
  EB20  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EB22  EB            		EX	DE,HL
  EB23  24            		INC	H
  EB24  24            		INC	H
  EB25  24            		INC	H
  EB26  24            		INC	H
  EB27  D1            		POP	DE
  EB28  13            		INC	DE
  EB29  AF            		XOR	A
  EB2A  C9            		RET
                      	
  EB2B  C37D030DFF032C	EDMAD:	DB	0C3H,07DH,003H,00DH,0FFH,003H,02CH,050H,002H
  EB34  809AAD0000CF01		DB	080H,09AH,0ADH,000H,000H,0CFH,001H,0CFH
                      	
                      	
                      	;	BANK RAM DISK DRIVER
                      	
                      	
  EB3C                	BDRDC:
  EB3C  ED735BEB      		LD	(BANKSP+1),SP
  EB40  3A5CEB        		LD	A,(BANKSP+2)
  EB43  87            		ADD	A,A
  EB44  3803          		JR	C,BDRDC1
  EB46  31D4FF        		LD	SP,EXTSP
  EB49                	BDRDC1:
  EB49  D5            		PUSH	DE
  EB4A  D9            		EXX
  EB4B  C5            		 PUSH	 BC
  EB4C  D5            		 PUSH	 DE
  EB4D  CD81EB        		 CALL	 BADR
  EB50  CD9EEB        		CALL	BTFR
  EB53  D9            		EXX
  EB54                	BDWTCE:
  EB54  D1            		 POP	 DE
  EB55  C1            		 POP	 BC
  EB56  D9            		 EXX
  EB57  D1            		POP	DE
  EB58  13            		INC	DE
  EB59  FB            		EI
  EB5A  310000        	BANKSP:	LD	SP,0
  EB5D  AF            		XOR	A
  EB5E  C9            		RET
                      	
  EB5F                	BDWTC:
  EB5F  ED735BEB      		LD	(BANKSP+1),SP
  EB63  3A5CEB        		LD	A,(BANKSP+2)
  EB66  87            		ADD	A,A
  EB67  3803          		JR	C,BDWTC1
  EB69  31D4FF        		LD	SP,EXTSP
  EB6C                	BDWTC1:
  EB6C  D5            		PUSH	DE
  EB6D  D9            		EXX
  EB6E  C5            		 PUSH	 BC
  EB6F  D5            		 PUSH	 DE
  EB70  CD81EB        		 CALL	 BADR
  EB73  D9            		EXX
  EB74  53            		 LD	D,E
  EB75  5F            		 LD	E,A
  EB76  D9            		 EXX
  EB77  EB            		EX	DE,HL
  EB78  CD9EEB        		CALL	BTFR
  EB7B  EB            		EX	DE,HL
  EB7C  D9            		EXX
  EB7D  ED51          		 OUT	 (C),D	 ;MAIN
  EB7F  18D3          		 JR	 BDWTCE
                      	
  EB81                	BADR:
  EB81  D9            		 EXX
  EB82  7B            		LD	A,E
  EB83  87            		ADD	A,A
  EB84  CB12          		RL	D
  EB86  87            		ADD	A,A
  EB87  CB12          		RL	D
  EB89  F5            		PUSH	AF
  EB8A  87            		ADD	A,A
  EB8B  7A            		LD	A,D
  EB8C  8F            		ADC	A,A
  EB8D  E60F          		AND	00FH
  EB8F  D9            		EXX
  EB90  01000B        		 LD	 BC,00B00H
  EB93  57            		 LD	 D,A	  ;BANK
  EB94  1E10          		 LD	 E,010H	  ;MAIN
  EB96  D9            		 EXX
  EB97  D1            		POP	DE
  EB98  0600          		LD	B,0
  EB9A  58            		LD	E,B
  EB9B  CBBA          		RES	7,D
  EB9D  C9            		RET
                      	
  EB9E                	BTFR:
  EB9E  D5            		PUSH	DE
  EB9F  F3            		DI
                      	
  EBA0                	BTFR1:
  EBA0  D9            		EXX
  EBA1  ED51          		 OUT	 (C),D	 ;BANK(MAIN)
  EBA3  D9            		 EXX
  EBA4  E3            		EX	(SP),HL
  EBA5  7E            		LD	A,(HL)
  EBA6  23            		INC	HL
  EBA7  4E            		LD	C,(HL)
  EBA8  23            		INC	HL
  EBA9  56            		LD	D,(HL)
  EBAA  23            		INC	HL
  EBAB  5E            		LD	E,(HL)
  EBAC  23            		INC	HL
  EBAD  E3            		EX	(SP),HL
  EBAE  D9            		EXX
  EBAF  ED59          		 OUT	 (C),E	 ;MAIN(BANK)
  EBB1  D9            		 EXX
  EBB2  77            		LD	(HL),A
  EBB3  23            		INC	HL
  EBB4  71            		LD	(HL),C
  EBB5  23            		INC	HL
  EBB6  72            		LD	(HL),D
  EBB7  23            		INC	HL
  EBB8  73            		LD	(HL),E
  EBB9  23            		INC	HL
  EBBA  10E4          		DJNZ	BTFR1
  EBBC  D1            		POP	DE
  EBBD  C9            		RET
                      	
                      	
                      	;	GRAPHIC RAM DISK DRIVER
                      	
                      	
  EBBE                	GDRDC:
  EBBE  CDE7EB        		CALL	GADR
  EBC1  D5            		PUSH	DE
  EBC2  110004        		LD	DE,0400H
  EBC5                	GDRDC1:
  EBC5  EDA2          		INI
  EBC7  04            		INC	B
  EBC8  03            		INC	BC
  EBC9  1D            		DEC	E
  EBCA  20F9          		JR	NZ,GDRDC1
  EBCC  15            		DEC	D
  EBCD  20F6          		JR	NZ,GDRDC1
  EBCF                	GDWTC2:
  EBCF  D1            		POP	DE
  EBD0  E6EF          		AND	0EFH		;BANK0
  EBD2  1821          		JR	S1FD0
                      	
  EBD4                	GDWTC:
  EBD4  CDE7EB        		CALL	GADR
  EBD7  D5            		PUSH	DE
  EBD8  110004        		LD	DE,0400H
  EBDB                	GDWTC1:
  EBDB  04            		INC	B
  EBDC  EDA3          		OUTI
  EBDE  03            		INC	BC
  EBDF  1D            		DEC	E
  EBE0  20F9          		JR	NZ,GDWTC1
  EBE2  15            		DEC	D
  EBE3  20F6          		JR	NZ,GDWTC1
  EBE5  18E8          		JR	GDWTC2
                      	
  EBE7                	GADR:
  EBE7  0E00          		LD	C,0
  EBE9  7B            		LD	A,E
  EBEA  87            		ADD	A,A
  EBEB  87            		ADD	A,A
  EBEC  C640          		ADD	A,040H
  EBEE  47            		LD	B,A
  EBEF  13            		INC	DE
  EBF0  3ABFEC        		LD	A,(WK1FD0)
  EBF3  F610          		OR	010H		;BANK1
  EBF5                	S1FD0:
  EBF5  C5            		PUSH	BC
  EBF6  32BFEC        		LD	(WK1FD0),A
  EBF9  01D01F        		LD	BC,01FD0H
  EBFC  ED79          		OUT	(C),A
  EBFE  C1            		POP	BC
  EBFF  C9            		RET
                      	
  1FE4                	AT_R	EQU	WTTRK-AT_WTTRK
                      	
  EC00                	_PE:
                      	
                      	;LDCALL.ASM
                      	
                      	;	LSX-Dodgers SYSTEM CALL
                      	
  EC00                		ORG	0EC00H
                      	
  EC00                	STABLE:
                      	;0
  EC00  0000A7D6B3D6B9		DW	 00000H,_SYS01,_SYS02,_SYS03
  EC08  E9D600D720D7FA		DW	_SYS04,_SYS05,_SYS06,_SYS07
  EC10  28D76ED261D78D		DW	_SYS08,_SYS09,_SYS0A,_SYS0B
  EC18  7DD283D292D2A5		DW	_SYS0C,_SYS0D,_SYS0E,_SYS0F
                      	;1
  EC20  1AD367D3C3D3F9		DW	_SYS10,_SYS11,_SYS12,_SYS13
  EC28  01D422D442D43A		DW	_SYS14,_SYS15,_SYS16,_SYS17
  EC30  A9D4AED4B3D4B9		DW	_SYS18,_SYS19,_SYS1A,_SYS1B
  EC38  6CD2E9D46CD2ED		DW	_SYS1C,_SYS1D,_SYS1E,_SYS1F
                      	;2
  EC40  6CD279D491D4F2		DW	_SYS20,_SYS21,_SYS22,_SYS23
  EC48  11D566D296E2BB		DW	_SYS24,_ERROR,_SYS26,_SYS27
  EC50  91D42CD5A3D725		DW	_SYS28,_SYS29,_SYS2A,_SYS2B
  EC58  DDD725DE6CD24F		DW	_SYS2C,_SYS2D,_SYS2E,_SYS2F
                      	;3
  EC60  49D5          		DW	_SYS30
                      	
                      	;LDWORK.ASM
                      	
                      	;	LSX-Dodgers WORK
                      	
  0004                	DDS	EQU	4
  EC62                	DDTB:
  EC62  434F4E20      		DB	"CON "
  EC66  5AD3          		DW	OPENDD
  EC68  41555820      		DB	"AUX "
  EC6C  5AD3          		DW	OPENDD
  EC6E  50524E20      		DB	"PRN "
  EC72  5AD3          		DW	OPENDD
  EC74  4E554C20      		DB	"NUL "
  EC78  5AD3          		DW	OPENDD
                      	
  EC7A                		DS	2
  EC7C  00EE          	_FATBF:	DW	FATBF
  EC7E  00FA          	_DTBUF:	DW	DTBUF
                      	
  EC80  FF            	_CYL0:	DB	0FFH	;Cylinder
  EC81  FF            	_CYL1:	DB	0FFH	;Cylinder
  EC82  FF            	_CYL2:	DB	0FFH	;Cylinder
  EC83  FF            	_CYL3:	DB	0FFH	;Cylinder
  EC84  00            	_DRIVE:	DB	0	;unit number
  EC85  00            	_SEEKSP:DB	0	;Seek speed
  EC86  FF            	_ISEEK:	DB	0FFH	;
  EC87  00            	_DVSW:	DB	0
  EC88  00            	_DRV:	DB	0
  EC89  FF            	_DSK:	DB	0FFH
  EC8A  8000          	_DTA:	DW	00080H
  EC8C  0000          	_CTC:	DW	0
  EC8E  0000          	_TXADR:	DW	0
  EC90  0000          	_KEYPS	DW	0
  EC92  00FF          	_KEYD	DW	0FF00H
  EC94  C210          	_KEYSP:	DW	010C2H
  EC96  07            	_COLORF:DB	7
  EC97  18            	_LINE:	DB	LINE
                      	
  EC98  0000          	_FCB:	DW	0
  EC9A  0000          	_FBPS:	DW	0	;SEARCH FILES
  EC9C  0000          	_FBAD:	DW	0	;    //
  EC9E  00            	_FBCNT:	DB	0	;    //
  EC9F  00            	_FILEN:	DB	0
  ECA0  00            	_DIRF:	DB	0
  ECA1  00            	_MAXCYL:DB	0
  ECA2  00            	_WTFATF:DB	0
  ECA3  FF            	_FATDRV:DB	0FFH
  ECA4  00            	_WTDBF:	DB	0
  ECA5  FF            	_DBDRV:	DB	0FFH
  ECA6  0000          	_DCLPS:	DW	0
                      	
  ECA8                		DS	8
                      	
  ECB0  6F5059381F0219	CRTCD:	DB	06FH,050H,059H,038H,01FH,002H,019H,01CH
  ECB8  0007          		DB	000H,007H
  ECBA  80F8B0FF      		DW	0-80*LINE,0-80
  ECBE  0C            		DB	00CH
  ECBF  A0            	WK1FD0:	DB	0A0H
                      	
  ECC0  D7D5          	CTC0:	DW	INTCTCE
  ECC2  D7D5          	CTC1:	DW	INTCTCE
  ECC4  FFD5          	CTC2:	DW	INTCTC2
  ECC6  D7D5          	CTC3:	DW	INTCTCE
  ECC8  97D5          	INTVEC:	DW	INT
                      	
                      	;	JUMP
                      	
  ECCA  C30EDC        	_INKEY:	JP	INKEY
  ECCD  C36ED8        	_PRINT:	JP	PRINT
  ECD0  C35CDB        	_SCRN:	JP	SCRN
  ECD3  C384DB        	_POS:	JP	POS
  ECD6  C3B3D9        	_LOC:	JP	LOC
  ECD9  C3D8E7        	_CHGDRV:JP	CHGDRV
  ECDC  C3ABE8        	_GETDPB:JP	GETDPB
  ECDF  C3BFE8        	_FFLUSH:JP	FFLUSH
  ECE2  C376E5        	_RDFATX:JP	RDFATX
  ECE5  C34BE6        	_RDFAT:	JP	RDFAT
  ECE8  C33FEA        	_WTTRK:	JP	WTTRK
  ECEB  C34CEA        	_FDRD:	JP	FDRD
  ECEE  C342EA        	_FDWT:	JP	FDWT
  ECF1  C3EBEC        	_DRD:	JP	_FDRD	;(Self-rewriting)
  ECF4  C3EEEC        	_DWT:	JP	_FDWT	;(Self-rewriting)
  ECF7  C3F8E5        	_GNCL:	JP	GNCL	;(Self-rewriting)
  ECFA  C31BE6        	_SNCL:	JP	SNCL	;(Self-rewriting)
  ECFD  C32CCD        	_COMANL:JP	COMANL
                      	
  ED00                	WE:
                      	
                      	;LDDPB.ASM
                      	
                      	;	LSX-Dodgers DPB
                      	
  ED00                	DEVICE:
                      	
                      	;	A:
                      	
  ED00  02            	DPB_00_FATLN:	DB	2
  ED01  FD            	DPB_01_FATID:	DB	0FDH
  ED02  EBEC          	DPB_02_DRDC:	DW	_FDRD
  ED04  EEEC          	DPB_04_DWTC:	DW	_FDWT
  ED06  0829          	DPB_06_ADDCL:	DW	02908H	;H(029H=512,0=1024)L=CLADD
  ED08  6401          	DPB_08_MAXCL:	DW	356
  ED0A  FF            	DPB_0A_FDMODE:	DB	0FFH	;0FFH=2D	0FEH=2HD
  ED0B  0C            	DPB_0B_MAXDIR:	DB	12
  ED0C  28            	DPB_0C_MAXCYL:	DB	40
  ED0D  09            	DPB_0D_MAXSEC:	DB	9	;Number of sectors
  ED0E  01            	DPB_0E_FATPS:	DB	1
  ED0F  02            	DPB_0F_FATS:	DB	2
  ED10  05            	DPB_10_DIRPS:	DB	5
  ED11  01            	DPB_11_MINSEC:	DB	1	;Minimum sector
  ED12  87            	DPB_12_DEVNO:	DB	087H	;Device Number
  ED13  00            	DPB_13_UNITNO:	DB	0
  ED14  0000          	DPB_14		DW	0
  ED16  0000          	DPB_16_GNCL:	DW	0
  ED18  0000          	DPB_18_SNCL:	DW	0
  ED1A  0000          	DPB_1A_SDIR:	DW	0
  ED1C  46444430      	DPB_1C_NAME:	DB	"FDD0"
                      	
                      	;	B:
                      	
  ED20  02            		DB	2
  ED21  FD            		DB	0FDH
  ED22  EBEC          		DW	_FDRD
  ED24  EEEC          		DW	_FDWT
  ED26  0829          		DW	02908H	;H(029H=512,0=1024)L=CLADD
  ED28  6401          		DW	356
  ED2A  FF            		DB	0FFH	;0FFH=2D	0FEH=2HD
  ED2B  0C            		DB	12
  ED2C  28            		DB	40
  ED2D  09            		DB	9
  ED2E  01            		DB	1
  ED2F  02            		DB	2
  ED30  05            		DB	5
  ED31  01            		DB	1
  ED32  87            		DB	087H	;Device Number
  ED33  01            		DB	1
  ED34  0000          		DW	0
  ED36  0000          		DW	0
  ED38  0000          		DW	0
  ED3A  0000          		DW	0
  ED3C  46444431      		DB	"FDD1"
                      	
                      	;	C:
                      	
  ED40  02            		DB	2
  ED41  FD            		DB	0FDH
  ED42  EBEC          		DW	_FDRD
  ED44  EEEC          		DW	_FDWT
  ED46  0829          		DW	02908H	;H(029H=512,0=1024)L=CLADD
  ED48  6401          		DW	356
  ED4A  FF            		DB	0FFH	;0FFH=2D	0FEH=2HD
  ED4B  0C            		DB	12
  ED4C  28            		DB	40
  ED4D  09            		DB	9
  ED4E  01            		DB	1
  ED4F  02            		DB	2
  ED50  05            		DB	5
  ED51  01            		DB	1
  ED52  87            		DB	087H	;Device Number
  ED53  02            		DB	2
  ED54  0000          		DW	0
  ED56  0000          		DW	0
  ED58  0000          		DW	0
  ED5A  0000          		DW	0
  ED5C  46444432      		DB	"FDD2"
                      	
                      	;	D:
                      	
  ED60  02            		DB	2
  ED61  FD            		DB	0FDH
  ED62  EBEC          		DW	_FDRD
  ED64  EEEC          		DW	_FDWT
  ED66  0829          		DW	02908H	;H(029H=512,0=1024)L=CLADD
  ED68  6401          		DW	356
  ED6A  FF            		DB	0FFH	;0FFH=2D	0FEH=2HD
  ED6B  0C            		DB	12
  ED6C  28            		DB	40
  ED6D  09            		DB	9
  ED6E  01            		DB	1
  ED6F  02            		DB	2
  ED70  05            		DB	5
  ED71  01            		DB	1
  ED72  87            		DB	087H	;Device Number
  ED73  03            		DB	3
  ED74  0000          		DW	0
  ED76  0000          		DW	0
  ED78  0000          		DW	0
  ED7A  0000          		DW	0
  ED7C  46444433      		DB	"FDD3"
                      	
                      	;	E:
                      	
  ED80  00            	EMMFL:	DB	0
  ED81  FE            		DB	0FEH
  ED82  F8EA          	EMMRD:	DW	EDRDC
  ED84  F5EA          	EMMWR:	DW	EDWTC
  ED86  0900          		DW	9
  ED88  0000          	EMMCL:	DW	0
  ED8A  00            		DB	0
  ED8B  0B            		DB	11
  ED8C  00            	EMMBL:	DB	0
  ED8D  01            		DB	1
  ED8E  01            		DB	1
  ED8F  01            		DB	1
  ED90  05            		DB	5
  ED91  01            		DB	1
  ED92  06            		DB	6	;Device Number
  ED93  00            	EMMDV:	DB	0
  ED94  0000          		DW	0
  ED96  0000          		DW	0
  ED98  0000          		DW	0
  ED9A  0000          		DW	0
  ED9C  454D4D30      		DB	"EMM0"
                      	
                      	;	F:
                      	
  EDA0  00            	BANKFL:	DB	0
  EDA1  F9            		DB	0F9H
  EDA2  3CEB          		DW	BDRDC
  EDA4  5FEB          		DW	BDWTC
  EDA6  0300          		DW	3
  EDA8  0000          	BANKCL:	DW	0
  EDAA  00            		DB	0
  EDAB  05            		DB	5
  EDAC  00            		DB	0
  EDAD  01            		DB	1
  EDAE  00            		DB	0
  EDAF  01            		DB	1
  EDB0  01            		DB	1
  EDB1  01            		DB	1
  EDB2  0B            		DB	00BH	;Device Number
  EDB3  00            		DB	0
  EDB4  0000          		DW	0
  EDB6  0000          		DW	0
  EDB8  0000          		DW	0
  EDBA  0000          		DW	0
  EDBC  4252414D      		DB	"BRAM"
                      	
                      	;	G:
                      	
  EDC0  01            		DB	1
  EDC1  F9            		DB	0F9H
  EDC2  BEEB          		DW	GDRDC
  EDC4  D4EB          		DW	GDWTC
  EDC6  0000          		DW	0
  EDC8  3000          		DW	48
  EDCA  00            		DB	0
  EDCB  02            		DB	2
  EDCC  00            		DB	0
  EDCD  01            		DB	1
  EDCE  00            		DB	0
  EDCF  01            		DB	1
  EDD0  01            		DB	1
  EDD1  01            		DB	1
  EDD2  05            		DB	5	;Device Number
  EDD3  01            		DB	1
  EDD4  0000          		DW	0
  EDD6  0000          		DW	0
  EDD8  0000          		DW	0
  EDDA  0000          		DW	0
  EDDC  4752414D      		DB	"GRAM"
                      	
                      	
                      	
  EDE0  00            	LDEND:	DB	0
                      	
  EDE1                		END
