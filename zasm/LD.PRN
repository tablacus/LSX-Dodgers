			  Z80 ASSEMBLER - ZASM VER 1.6
                      	;	LSX-Dodgers for X1/turbo/Z
                      	;	Programmed by
                      	;	Gaku (Lovers/Tablacus)
                      	
  C600                	RUN	EQU	0C600h
                      	
  C5F9                		ORG	RUN-7
                      	
                      	;	MSX BINARY HEADER
  C5F9  FE            		DB	0FEH
                      	;	MSX BINARY START ADDRESS
  C5FA  00C6          		DW	RUN
                      	;	MSX BINARY END ADDRESS
  C5FC  E0ED          		DW	LDEND
                      	;	MSX BINARY EXEC ADDRESS
  C5FE  00C6          		DW	RUN
                      	;LDDEF.ASM
                      	
                      	;	LSX-Dodgers DEF
                      	
  1D90                	MAC	EQU	01D90H		;X1
  0001                	VER_1   EQU	1
  0003                	VER_2   EQU	3
  0004                	VER_3   EQU	4
  0134                	VER	EQU	VER_1 * 256 + VER_2 * 16 + VER_3
                      	
  0000                	STACK	EQU	00000H
  0005                	SYSTEM	EQU	00005H
  000F                	JP_HL	EQU	0000FH
  005C                	FCB1	EQU	0005CH
  006C                	FCB2	EQU	0006CH
  0080                	DTA1	EQU	00080H
  00DB                	FDRV	EQU	00100H-37
  00DC                	FNAME	EQU	FDRV+1
  00D6                	DECBF	EQU	FDRV-5
  EE00                	FATBF	EQU	0EE00H
  FA00                	DTBUF	EQU	0FA00H
  FE00                	KEYBF	EQU	0FE00H
  FF00                	KBUF	EQU	0FF00H
  FF51                	DTA	EQU	KBUF+81
  FFD4                	EXTSP	EQU	0FFD4H
  0019                	LINE	EQU	25
                      	
                      	;LDINIT.ASM
                      	
                      	;	LSX-Dodgers INIT
                      	
  C600  C307C6        		JP	START
  C603  901D          	MACHINE:DW	MAC
  C605  3401          	VERSION:DW	VER
                      	
  C607                	START:
  C607  F3            		DI
  C608  ED5E          		IM	2
  C60A  310000        		LD	SP,STACK
  C60D  CD1BC6        		CALL	INIT		;NZならAUTOEXECを実行
  C610  210000        		LD	HL,0
  C613  E5            		PUSH	HL
  C614  C8            		RET	Z
  C615  11B2C9        		LD	DE,AUTOD
  C618  C3FDEC        		JP	_COMANL
                      	
  C61B                	INIT:
  C61B  3E1E          		LD	A,01EH
  C61D  D300          		OUT	(0),A
                      	
  C61F  010000        		LD	BC,0
  C622  ED438CEC      		LD	(_CTC),BC
  C626  01040A        		LD	BC,00A04H
  C629  CD6CC9        		CALL	CHKCTC
  C62C  010407        		LD	BC,00704H
  C62F  CD6CC9        		CALL	CHKCTC
  C632  01A81F        		LD	BC,01FA8H
  C635  CD6CC9        		CALL	CHKCTC
  C638  01A01F        		LD	BC,01FA0H
  C63B  CD6CC9        		CALL	CHKCTC
                      	;
  C63E                	INISIO:
  C63E  01911F        		LD	BC,01F91H	;INIT SIO
  C641  1601          		LD	D,1
  C643  ED51          		OUT	(C),D
                      	
  C645  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C647  0E93          		LD	C,093H
  C649  ED51          		OUT	(C),D
  C64B  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C64D  0E99          		LD	C,099H		;INIT SIO
  C64F  1601          		LD	D,1
  C651  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C653  0E9B          		LD	C,09BH
  C655  ED51          		OUT	(C),D
  C657  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C659  0E80          		LD	C,080H		;INIT DMA
  C65B  2106C3        		LD	HL,0C306H
  C65E                	INIDMA:
  C65E  ED61          		OUT	(C),H
  C660  2D            		DEC	L
  C661  20FB          		JR	NZ,INIDMA
                      	
  C663  3EE4          		LD	A,0E4H
  C665  CDFADA        		CALL	COMOUT
  C668  AF            		XOR	A
  C669  CDD4DA        		CALL	OT49SB
                      	
  C66C  3EEC          		LD	A,INTVEC/256
  C66E  ED47          		LD	I,A
                      	
  C670  ED4B8CEC      		LD	BC,(_CTC)
  C674  0B            		DEC	BC
  C675  0B            		DEC	BC
                      	
  C676  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C678  3EC0          		LD	A,CTC0
  C67A  ED79          		OUT	(C),A
                      	
  C67C  0C            		INC	C
  C67D  3E47          		LD	A,047H
  C67F  ED79          		OUT	(C),A
  C681  3E0D          		LD	A,13		;Baudrate 9600-13
  C683  ED79          		OUT	(C),A
                      	
  C685  79            		LD	A,C
  C686  D610          		SUB	010H
  C688  4F            		LD	C,A
  C689  ED4331CC      		LD	(SIOAD+1),BC
  C68D  ED435ACC      		LD	(SIOAD0+1),BC
  C691  ED4360CC      		LD	(SIOAD1+1),BC
                      	
  C695  2114CA        		LD	HL,SIODATA
  C698                	SINIT1:
  C698  7E            		LD	A,(HL)
  C699  23            		INC	HL
  C69A  FEFF          		CP	0FFH
  C69C  2804          		JR	Z,SINIT2
  C69E  ED79          		OUT	(C),A
  C6A0  18F6          		JR	SINIT1
  C6A2                	SINIT2:
  C6A2  3EE4          		LD	A,0E4H
  C6A4  CDFADA        		CALL	COMOUT
  C6A7  3EC8          		LD	A,INTVEC
  C6A9  CDD4DA        		CALL	OT49SB
                      	;
  C6AC  01C41F        		LD	BC,01FC4H
  C6AF  3E0C          		LD	A,00CH
  C6B1  ED79          		OUT	(C),A
                      	
  C6B3  0EC0          		LD	C,0C0H
  C6B5  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6B7  0C            		INC	C
  C6B8  3E28          		LD	A,40
  C6BA  ED79          		OUT	(C),A
                      	
  C6BC  0C            		INC	C
  C6BD  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6BF  0C            		INC	C
  C6C0  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6C2  0EC5          		LD	C,0C5H
  C6C4  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6C6                	TEXT:
  C6C6  0EB0          		LD	C,0B0H
  C6C8  3E80          		LD	A,080H
  C6CA  ED79          		OUT	(C),A
  C6CC  1607          		LD	D,7
  C6CE  0EB9          		LD	C,0B9H
  C6D0  210DCA        		LD	HL,TEXTDT
  C6D3                	TEXT1:
  C6D3  04            		INC	B
  C6D4  EDA3          		OUTI
  C6D6  0C            		INC	C
  C6D7  15            		DEC	D
  C6D8  20F9          		JR	NZ,TEXT1
  C6DA  01B01F        		LD	BC,01FB0H
  C6DD  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6DF  0EC4          		LD	C,0C4H
  C6E1  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
                      	
  C6E3  01011A        		LD	BC,01A01H
  C6E6  ED78          		IN	A,(C)
  C6E8  E608          		AND	8
  C6EA  2809          		JR	Z,PRN
  C6EC  0E03          		LD	C,003H
  C6EE  3E0F          		LD	A,00FH
  C6F0  ED79          		OUT	(C),A
  C6F2  01040A        		LD	BC,00A04H
  C6F5                	PRN:
  C6F5  110100        		LD	DE,1
  C6F8  62            		LD	H,D
  C6F9  6A            		LD	L,D
  C6FA  017F00        		LD	BC,07FH
  C6FD  36FF          		LD	(HL),0FFH
  C6FF  EDB0          		LDIR
  C701  017F00        		LD	BC,07FH
  C704  3600          		LD	(HL),0
  C706  EDB0          		LDIR
                      	
  C708  3EC3          		LD	A,0C3H		;JP
  C70A  219DD3        		LD	HL,WBOOT
  C70D  320000        		LD	(00000H),A
  C710  220100        		LD	(00001H),HL	;IPL
                      	
  C713  2A03C6        		LD	HL,(MACHINE)	;3 bit7  DPB Original(1)
                      					;  bit6-4 DPB_LEVEL
  C716  220300        		LD	(00003H),HL	;  bit3-0 Machine X1(0)
                      	;				;4 LSX-Dodgers(01DH)
  C719  2106CC        		LD	HL,BDOS
  C71C  320500        		LD	(00005H),A
  C71F  220600        		LD	(00006H),HL	;BDOS
                      	
  C722  2195D6        		LD	HL,BIOS
  C725  321800        		LD	(00018H),A	;BIOS-ROM
  C728  221900        		LD	(00019H),HL
                      	
  C72B  210000        		LD	HL,0
  C72E  323800        		LD	(00038H),A	;RST038H
  C731  223900        		LD	(00039H),HL
                      	
  C734  3EEC          		LD	A,STABLE/256
  C736  320B00        		LD	(0000BH),A
                      	
  C739  3EE9          		LD	A,0E9H		;JP (HL)
  C73B  320F00        		LD	(0000FH),A
                      	
  C73E  3A7DEC        		LD	A,(_FATBF+1)
  C741  321300        		LD	(00013H),A
                      	
  C744  3A7FEC        		LD	A,(_DTBUF+1)
  C747  321700        		LD	(00017H),A
                      	
  C74A  3EFE          		LD	A,KEYBF/256
  C74C  321B00        		LD	(0001BH),A
                      	
  C74F  3EFF          		LD	A,KBUF/256
  C751  321F00        		LD	(0001FH),A
                      	
  C754  2A05C6        		LD	HL,(VERSION)
  C757  225A00        		LD	(0005AH),HL
                      	
  C75A  3EE6          		LD	A,0E6H
  C75C  CDFADA        		CALL	COMOUT
  C75F  CDDFDA        		CALL	IN49SB
  C762  F5            		PUSH	AF
  C763  CDDFDA        		CALL	IN49SB
  C766  F1            		POP	AF
  C767  F5            		PUSH	AF
  C768  E612          		AND	012H
  C76A  2005          		JR	NZ,KEYR
  C76C  3E01          		LD	A,1
  C76E  32D3C8        		LD	(KEYREP+1),A
  C771                	KEYR:
  C771  F1            		POP	AF
  C772  E603          		AND	3
  C774  280E          		JR	Z,NON
                      	
  C776  01D03F        		LD	BC,03FD0H
  C779  ED49          		OUT	(C),C
  C77B  3E37          		LD	A,037H
  C77D  D3D0          		OUT	(0D0H),A
  C77F  ED78          		IN	A,(C)
  C781  B9            		CP	C
  C782  2878          		JR	Z,TURBO
  C784                	NON:
  C784  3D            		DEC	A		;A=0FFH
  C785  321800        		LD	(00018H),A	;BIOS-ROM
                      	
  C788  2120CA        		LD	HL,AT_SCR1
  C78B  1184DB        		LD	DE,SCR1
  C78E  019F00        		LD	BC,SCRNX-SCR1	;転送先のサイズ確認用
  C791  019F00        		LD	BC,AT_SCRE-AT_SCR1
  C794  EDB0          		LDIR
                      	
  C796  21BFCA        		LD	HL,AT_WTTRK
  C799  11B9EA        		LD	DE,WTTRK
  C79C  01B700        		LD	BC,DMAE-WTTRK	;転送先のサイズ確認用
  C79F  019B00        		LD	BC,AT_CPUE-AT_WTTRK
  C7A2  EDB0          		LDIR
                      	
  C7A4  215ACB        		LD	HL,AT_EDWTC
  C7A7  1126CD        		LD	DE,EDWTC
  C7AA  014700        		LD	BC,EMME-EDWTC	;転送先のサイズ確認用
  C7AD  014300        		LD	BC,AT_EMME-AT_EDWTC
  C7B0  EDB0          		LDIR
                      	
  C7B2  210DEB        		LD	HL,AT_DRD+AT_R
  C7B5  22ECEC        		LD	(_FDRD+1),HL
  C7B8  21BDEA        		LD	HL,AT_DWT+AT_R
  C7BB  22EFEC        		LD	(_FDWT+1),HL
  C7BE  213ACD        		LD	HL,AT_EDRDC+AT_RE
  C7C1  2282ED        		LD	(EMMRD),HL
  C7C4  2126CD        		LD	HL,AT_EDWTC+AT_RE
  C7C7  2284ED        		LD	(EMMWR),HL
                      	
  C7CA  3E27          		LD	A,027H			;ノンターボはMFM切り替えを行わない
  C7CC  3212ED        		LD	(DEVICE+012H),A		;Aドライブ
  C7CF  3232ED        		LD	(DEVICE+012H+32),A	;Bドライブ
  C7D2  3252ED        		LD	(DEVICE+012H+32*2),A	;Cドライブ
  C7D5  3272ED        		LD	(DEVICE+012H+32*3),A	;Dドライブ
                      	
  C7D8  210000        		LD	HL,0
  C7DB  2225DB        		LD	(X1PAT),HL
                      	
  C7DE  3EAF          		LD	A,0AFH		;XOR	A
  C7E0  3235D9        		LD	(X1KPAT),A
                      	
  C7E3  2123DC        		LD	HL,SCRNX
  C7E6  22D1EC        		LD	(_SCRN+1),HL
                      	
  C7E9  CD93C9        		CALL	SETCRTC
  C7EC  0610          		LD	B,010H		;PALET
  C7EE  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C7F0  04            		INC	B
  C7F1  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C7F3  04            		INC	B
  C7F4  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C7F6  04            		INC	B
  C7F7  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C7F9  C38FC8        		JP	NOBANK
                      	
  C7FC                	TURBO:
  C7FC  F3            		DI			;Check BIOS
  C7FD  061D          		LD	B,01DH
  C7FF  ED79          		OUT	(C),A		;BIOS ON
  C801  3A512F        		LD	A,(02F51H)
  C804  04            		INC	B		;B=01EH
  C805  ED79          		OUT	(C),A		;BIOS OFF
  C807  FB            		EI
  C808  FEC9          		CP	0C9H
  C80A  280B          		JR	Z,BIOSOK
  C80C  3EAF          		LD	A,0AFH		;XOR	A
  C80E  3235D9        		LD	(X1KPAT),A
  C811  2123DC        		LD	HL,SCRNX
  C814  22D1EC        		LD	(_SCRN+1),HL
  C817                	BIOSOK:
  C817  3E1F          		LD	A,01FH
  C819  DBF0          		IN	A,(0F0H)
  C81B  0F            		RRCA
  C81C  380B          		JR	C,CRT1
  C81E  21FDC9        		LD	HL,_C8025H
  C821  11B0EC        		LD	DE,CRTCD
  C824  011000        		LD	BC,16
  C827  EDB0          		LDIR
  C829                	CRT1:
  C829  CD93C9        		CALL	SETCRTC
  C82C  01AA10        		LD	BC,010AAH	;PALET
  C82F  ED49          		OUT	(C),C
  C831  01CC11        		LD	BC,011CCH
  C834  ED49          		OUT	(C),C
  C836  01F012        		LD	BC,012F0H
  C839  ED49          		OUT	(C),C
  C83B  04            		INC	B
  C83C  ED71          		DB	0EDH,071H
                      	
  C83E  3E1F          		LD	A,01FH		;スタートポート
  C840  DBF0          		IN	A,(0F0H)
  C842  CB57          		BIT	2,A
  C844  2818          		JR	Z,BANK
                      	
  C846  AF            		XOR	A
  C847                	TZ1:				;前面スイッチが2HDの場合はMFMモードを2HDにしておく
  C847  F5            		PUSH	AF
  C848  CDDCEC        		CALL	_GETDPB
  C84B  DD7E12        		LD	A,(IX+012H)	;DPB_12_DEVICE
  C84E  E68F          		AND	08FH
  C850  FE87          		CP	087H		;フロッピーでMEM切り替えがON
  C852  2004          		JR	NZ,TZ2
  C854  DDCB0A86      		RES	0,(IX+0AH)	;(DPB_0A_FDMODE)
  C858                	TZ2:
  C858  F1            		POP	AF
  C859  3C            		INC	A
  C85A  FE08          		CP	8
  C85C  38E9          		JR	C,TZ1
                      	
  C85E                	BANK:
  C85E  01000B        		LD	BC,00B00H
  C861  21007F        		LD	HL,07F00H
  C864  F3            		DI
  C865                	BANK1:
  C865  ED69          		OUT	(C),L
  C867  5E            		LD	E,(HL)
  C868  7B            		LD	A,E
  C869  C6A5          		ADD	A,0A5H
  C86B  77            		LD	(HL),A
  C86C  BE            		CP	(HL)
  C86D  73            		LD	(HL),E
  C86E  2005          		JR	NZ,BANK2
  C870  2C            		INC	L
  C871  CB65          		BIT	4,L
  C873  28F0          		JR	Z,BANK1
  C875                	BANK2:
  C875  3E10          		LD	A,010H
  C877  ED79          		OUT	(C),A
  C879  7D            		LD	A,L
  C87A  B7            		OR	A
  C87B  2812          		JR	Z,NOBANK
  C87D  2600          		LD	H,0
  C87F  29            		ADD	HL,HL	;*2
  C880  29            		ADD	HL,HL	;*4
  C881  29            		ADD	HL,HL	;*8
  C882  29            		ADD	HL,HL	;*16
  C883  29            		ADD	HL,HL	;*32
  C884  2B            		DEC	HL	;-1
  C885  2B            		DEC	HL	;-2
  C886  2B            		DEC	HL	;-3
  C887  22A8ED        		LD	(BANKCL),HL
  C88A  3E01          		LD	A,1
  C88C  32A0ED        		LD	(BANKFL),A
  C88F                	NOBANK:
  C88F                	EMM:
  C88F  CD5CC9        		CALL	EADR0
  C892  ED78          		IN	A,(C)
  C894  F5            		PUSH	AF
                      	
  C895  110000        		LD	DE,0
  C898                	ECHECK1:
  C898  13            		INC	DE
  C899  CD3FC9        		CALL	EADR2
  C89C  ED60          		IN	H,(C)
  C89E  CD3FC9        		CALL	EADR2
  C8A1  7C            		LD	A,H
  C8A2  C6E5          		ADD	A,0E5H
  C8A4  ED79          		OUT	(C),A
  C8A6  3C            		INC	A
  C8A7  CD5CC9        		CALL	EADR0
  C8AA  ED79          		OUT	(C),A
  C8AC  3D            		DEC	A
  C8AD  CD3FC9        		CALL	EADR2
  C8B0  ED68          		IN	L,(C)
  C8B2  CD3FC9        		CALL	EADR2
  C8B5  ED61          		OUT	(C),H
  C8B7  BD            		CP	L
  C8B8  2004          		JR	NZ,ECHECK2
  C8BA  CB5A          		BIT	3,D
  C8BC  28DA          		JR	Z,ECHECK1
  C8BE                	ECHECK2:
  C8BE  CD5CC9        		CALL	EADR0
  C8C1  F1            		POP	AF
  C8C2  ED79          		OUT	(C),A
                      	
  C8C4  21F7FF        		LD	HL,0-9
  C8C7  19            		ADD	HL,DE
  C8C8  3008          		JR	NC,NOEMM
  C8CA  2288ED        		LD	(EMMCL),HL
  C8CD  3E03          		LD	A,3
  C8CF  3280ED        		LD	(EMMFL),A
  C8D2                	NOEMM:
  C8D2  3E00          	KEYREP:	LD	A,000H
  C8D4  B7            		OR	A
  C8D5  2807          		JR	Z,KEYR1
  C8D7  010000        		LD	BC,0
  C8DA  ED438CEC      		LD	(_CTC),BC
  C8DE                	KEYR1:
  C8DE  0130F8        		LD	BC,0-80*25
  C8E1  2ABAEC        		LD	HL,(CRTCD+10)
  C8E4  ED43BAEC      		LD	(CRTCD+10),BC
  C8E8  1E0C          		LD	E,00CH
  C8EA  CDCDEC        		CALL	_PRINT
  C8ED  22BAEC        		LD	(CRTCD+10),HL
                      	
  C8F0  21BEC9        		LD	HL,INIMES
  C8F3  CDA8D8        		CALL	MSX
                      	
  C8F6  3A87FF        		LD	A,(0FF87H)
  C8F9  FE08          		CP	8
  C8FB  301E          		JR	NC,INIT0
  C8FD  5F            		LD	E,A
  C8FE  C641          		ADD	A,'A'
  C900  32BBC9        		LD	(AUTODV),A
  C903  0E0E          		LD	C,00EH
  C905  CD0500        		CALL	SYSTEM
  C908  1C            		INC	E
  C909  2185EC        		LD	HL,_SEEKSP	;Disk error Ignore
  C90C  CBFE          		SET	7,(HL)
  C90E  0E1B          		LD	C,01BH
  C910  CD0500        		CALL	SYSTEM
                      	
  C913  2185EC        		LD	HL,_SEEKSP
  C916  CBBE          		RES	7,(HL)
                      	
  C918  3C            		INC	A
  C919  2008          		JR	NZ,INIT1
  C91B                	INIT0:
  C91B  1E00          		LD	E,0
  C91D  0E0E          		LD	C,00EH
  C91F  CD0500        		CALL	SYSTEM
  C922  AF            		XOR	A
  C923                	INIT1:
  C923  2100FF        		LD	HL,0FF00H
  C926  1101FF        		LD	DE,0FF01H
  C929  01FF00        		LD	BC,000FFH
  C92C  75            		LD	(HL),L
  C92D  EDB0          		LDIR
                      	
  C92F  B7            		OR	A
  C930  C8            		RET	Z
                      	
  C931  3EE6          		LD	A,0E6H
  C933  CDFADA        		CALL	COMOUT
  C936  CDDFDA        		CALL	IN49SB
  C939  CDDFDA        		CALL	IN49SB
  C93C  FE1B          		CP	01BH
  C93E  C9            		RET
                      	
  C93F                	EADR2:
  C93F  D5            		PUSH	DE
  C940  EB            		EX	DE,HL
  C941  29            		ADD	HL,HL
  C942  29            		ADD	HL,HL
  C943  ED4B8BED      		LD	BC,(EMMBL-1)
  C947  0E00          		LD	C,0
  C949  09            		ADD	HL,BC
  C94A  ED4B93ED      		LD	BC,(EMMDV)
  C94E  060D          		LD	B,00DH
  C950  ED49          		OUT	(C),C
  C952  0C            		INC	C
  C953  ED69          		OUT	(C),L
  C955  0C            		INC	C
  C956  ED61          		OUT	(C),H
  C958  0C            		INC	C
  C959  EB            		EX	DE,HL
  C95A  D1            		POP	DE
  C95B  C9            		RET
                      	
  C95C                	EADR0:
  C95C  ED4B93ED      		LD	BC,(EMMDV)
  C960  060D          		LD	B,00DH
  C962  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C964  0C            		INC	C
  C965  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C967  0C            		INC	C
  C968  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C96A  0C            		INC	C
  C96B  C9            		RET
                      	
  C96C                	CHKCTC:
  C96C  C5            		PUSH	BC
  C96D  110347        		LD	DE,04703H
  C970                	INICTC1:
  C970  0C            		INC	C
  C971  ED51          		OUT	(C),D
  C973  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  C975  1D            		DEC	E
  C976  20F8          		JR	NZ,INICTC1
  C978  C1            		POP	BC
                      	
  C979  11FA07        		LD	DE,007FAH
  C97C  ED51          		OUT	(C),D
  C97E  ED59          		OUT	(C),E
  C980  ED78          		IN	A,(C)
  C982  BB            		CP	E
  C983  C0            		RET	NZ
  C984  ED51          		OUT	(C),D
  C986  ED51          		OUT	(C),D
  C988  ED78          		IN	A,(C)
  C98A  BA            		CP	D
  C98B  C0            		RET	NZ
  C98C  03            		INC	BC
  C98D  03            		INC	BC
  C98E  ED438CEC      		LD	(_CTC),BC
  C992  C9            		RET
                      	
  C993                	SETCRTC:
  C993  21B0EC        		LD	HL,CRTCD
  C996  AF            		XOR	A
  C997                	SETCRT1:
  C997  010018        		LD	BC,01800H
  C99A  ED79          		OUT	(C),A
  C99C  0C            		INC	C
  C99D  04            		INC	B
  C99E  EDA3          		OUTI
  C9A0  3C            		INC	A
  C9A1  FE0C          		CP	12
  C9A3  20F2          		JR	NZ,SETCRT1
  C9A5  23            		INC	HL
  C9A6  23            		INC	HL
  C9A7  01031B        		LD	BC,01A03H+00100H
  C9AA  EDA3          		OUTI
  C9AC  01D020        		LD	BC,01FD0H+00100H
  C9AF  EDA3          		OUTI
  C9B1  C9            		RET
                      	
  C9B2  4155544F455845	AUTOD:	DB	"AUTOEXEC "
  C9BB  413A00        	AUTODV:	DB	"A:",0
                      	
  C9BE  4C53582D446F64	INIMES:	DB	"LSX-Dodgers for X1/turbo version "
  C9DF  312E          		DB	030H + VER_1, '.'
  C9E1  3334          		DB	030H + VER_2 ,030H + VER_3
  C9E3  2047616B752028		DB	' Gaku (Lovers/Tablacus)',0DH,0AH
  C9FC  00            		DB	0
                      	
  C9FD                	_C8025H:
  C9FD  6B5059881B0119		DB	06BH,050H,059H,088H,01BH,001H,019H,01AH
  CA05  000F          		DB	000H,00FH
  CA07  30F8B0FF      		DW	0-80*LINE,0-80
  CA0B  0CA3          		DB	00CH,0A3H
                      	
  CA0D  030C0F30333C3F	TEXTDT:	DB	003H,00CH,00FH,030H,033H,03CH,03FH
                      	
  CA14                	SIODATA:
  CA14  18            		DB	018H
  CA15  0100          		DB	1,0
  CA17  0200          		DB	2,0
  CA19  03C1          		DB	3,0C1H
  CA1B  0444          		DB	4,044H
  CA1D  05E8          		DB	5,0E8H
  CA1F  FF            		DB	0FFH
                      	
                      	;	ノンターボ用パッチ
                      	
  CA20                	AT_SCR1:
  CA20  D9            		EXX
  CA21  C5            		PUSH	BC
  CA22  015020        		LD	BC,02000H+80
  CA25  D9            		EXX
  CA26  C5            		PUSH	BC
  CA27  010020        		LD	BC,02000H
                      	
  CA2A  67            		LD	H,A
  CA2B  B7            		OR	A
  CA2C                	AT_SCRUP1:
  CA2C  2815          		JR	Z,AT_SCRCL
  CA2E  C5            		PUSH	BC
  CA2F  CBE0          		SET	4,B
  CA31  D9            		EXX
  CA32  C5            		PUSH	BC
  CA33  CBE0          		SET	4,B
  CA35  D9            		EXX
  CA36  CDBEDB        		CALL	AT_UPSUB+AT_RS
  CA39  D9            		EXX
  CA3A  C1            		POP	BC
  CA3B  D9            		EXX
  CA3C  C1            		POP	BC
  CA3D  CDBEDB        		CALL	AT_UPSUB+AT_RS
  CA40  25            		DEC	H
  CA41  18E9          		JR	AT_SCRUP1
                      	
  CA43                	AT_SCRCL:
  CA43  215020        		LD	HL,02000H+80
  CA46  3A96EC        		LD	A,(_COLORF)
  CA49                	AT_SCRCL1:
  CA49  CBE0          		SET	4,B
  CA4B  ED61          		OUT	(C),H
  CA4D  CBA0          		RES	4,B
  CA4F  ED79          		OUT	(C),A
  CA51  03            		INC	BC
  CA52  2D            		DEC	L
  CA53  20F4          		JR	NZ,AT_SCRCL1
  CA55  C1            		POP	BC
  CA56  D9            		EXX
  CA57  C1            		POP	BC
  CA58  D9            		EXX
  CA59  C9            		RET
                      	
  CA5A                	AT_UPSUB:
  CA5A  2E28          		LD	L,40
  CA5C                	AT_UPSUB1:
  CA5C  D9            		EXX
  CA5D  ED78          		IN	A,(C)
  CA5F  03            		INC	BC
  CA60  D9            		EXX
  CA61  ED79          		OUT	(C),A
  CA63  03            		INC	BC
  CA64  D9            		EXX
  CA65  ED78          		IN	A,(C)
  CA67  03            		INC	BC
  CA68  D9            		EXX
  CA69  ED79          		OUT	(C),A
  CA6B  03            		INC	BC
  CA6C  2D            		DEC	L
  CA6D  20ED          		JR	NZ,AT_UPSUB1
  CA6F  C9            		RET
                      	
                      	;	FLOPPY DISK DRIVER(CPU)
                      	
  CA70                	DISKC:
  CA70  1B            		DEC	DE
  CA71  CB5F          		BIT	3,A
  CA73  C4B2EA        		CALL	NZ,RNF
  CA76                	DISKD:
  CA76  E5            		PUSH	HL
  CA77  21B8EA        		LD	HL,RETRY
  CA7A  35            		DEC	(HL)
  CA7B  E1            		POP	HL
  CA7C  203E          		JR	NZ,AT_ERR		;Retry
  CA7E  B7            		OR	A
  CA7F  283B          		JR	Z,AT_ERR		;Error
                      	
  CA81                	AT_DELP:
  CA81  CDB2EA        		CALL	RNF
  CA84  CD8EEA        		CALL	FDMOFF
  CA87  3A85EC        		LD	A,(_SEEKSP)
  CA8A  87            		ADD	A,A
  CA8B  382E          		JR	C,AT_ERRZ
  CA8D                	AT_DELP1:
  CA8D  D5            		PUSH	DE
  CA8E  21C0EB        		LD	HL,DEMES
  CA91  CDA8D8        		CALL	MSX
  CA94  CD93D7        		CALL	KEYBC
  CA97                	AT_DELP2:
  CA97  CDCAEC        		CALL	_INKEY
  CA9A  28FB          		JR	Z,AT_DELP2
                      	
  CA9C  D1            		POP	DE
  CA9D  CDD5DF        		CALL	CAP
  CAA0  FE52          		CP	'R'		;Retry
  CAA2  200A          		JR	NZ,AT_DELP3
  CAA4  210000        	DHLPAT:	LD	HL,0
  CAA7  3E02          		LD	A,2
  CAA9  32B8EA        		LD	(RETRY),A
  CAAC  B7            		OR	A
  CAAD  C9            		RET
  CAAE                	AT_DELP3:
  CAAE  FE49          		CP	'I'		;Ignore
  CAB0  2807          		JR	Z,AT_IGNORE
  CAB2  FE41          		CP	'A'		;Abort
  CAB4  20D7          		JR	NZ,AT_DELP1
  CAB6  C39AD3        		JP	BOOT
  CAB9                	AT_IGNORE:
  CAB9  3EFF          		LD	A,0FFH
  CABB                	AT_ERRZ:
  CABB  BF            		CP	A
  CABC                	AT_ERR:
  CABC  3EFF          		LD	A,0FFH
  CABE  C9            		RET
                      	
  CABF                	AT_SCRE:
                      	
  CABF                	AT_WTTRK:
  CABF  3EF0          		LD	A,0F0H
  CAC1  1802          		JR	AT_WTTRK1
                      	
  CAC3                	AT_DWT:
  CAC3  3EA0          		LD	A,0A0H
  CAC5                	AT_WTTRK1:
  CAC5  3256EA        		LD	(FDCPAT+1),A
                      	
  CAC8  3E02          		LD	A,2		;Retry count
  CACA  32B8EA        		LD	(RETRY),A
                      	
  CACD                	DWT0:
  CACD  D5            		PUSH	DE
  CACE  E5            		PUSH	HL
  CACF  2209DC        		LD	(DHLPAT+1+AT_RS),HL
  CAD2  CDF0E9        		CALL	SEEK		;Write disk
  CAD5  E1            		POP	HL
  CAD6  3831          		JR	C,ERRDW
  CAD8  F3            		DI
  CAD9  3A56EA        		LD	A,(FDCPAT+1)
  CADC  CD9AEA        		CALL	SECSET
  CADF  0EFB          		LD	C,0FBH
                      	
  CAE1                	DWT1:
  CAE1  56            		LD	D,(HL)
  CAE2                	DWT2:
  CAE2  78            		LD	A,B
  CAE3  DBF8          		IN	A,(0F8H)
  CAE5  0F            		RRCA
  CAE6  3008          		JR	NC,DWT4
  CAE8  0F            		RRCA
  CAE9  30F7          		JR	NC,DWT2
  CAEB                	DWT3:
  CAEB  ED51          		OUT	(C),D
  CAED  23            		INC	HL
  CAEE  18F1          		JR	DWT1
                      	
  CAF0                	DWT4:
  CAF0  3D            		DEC	A
  CAF1  28F8          		JR	Z,DWT3
  CAF3  3C            		INC	A
  CAF4  FB            		EI
  CAF5  D1            		POP	DE
  CAF6  13            		INC	DE
  CAF7  CD8EEA        		CALL	FDMOFF
  CAFA  C8            		RET	Z
  CAFB  CDD4DB        		CALL	DISKC+AT_RS
  CAFE  20CD          		JR	NZ,DWT0
  CB00  B7            		OR	A
  CB01  C8            		RET	Z
  CB02                	ERRW:
  CB02  3EFF          		LD	A,0FFH
  CB04                	ERRZ:
  CB04  BF            		CP	A
  CB05  37            		SCF
  CB06  C38EEA        		JP	FDMOFF
                      	
  CB09                	ERRDW:
  CB09  D1            		POP	DE
  CB0A  CDE5DB        		CALL	AT_DELP+AT_RS
  CB0D  20BE          		JR	NZ,DWT0
  CB0F  B7            		OR	A
  CB10  20F0          		JR	NZ,ERRW
  CB12  C9            		RET
                      	
  CB13                	AT_DRD:
  CB13  3E80          		LD	A,080H
  CB15  3256EA        		LD	(FDCPAT+1),A
                      	
  CB18  3E02          		LD	A,2		;Retry count
  CB1A  32B8EA        		LD	(RETRY),A
                      	
  CB1D                	DRD0:
  CB1D  D5            		PUSH	DE
  CB1E  E5            		PUSH	HL
  CB1F  2209DC        		LD	(DHLPAT+1+AT_RS),HL
  CB22  CDF0E9        		CALL	SEEK		;Read disk
  CB25  E1            		POP	HL
  CB26  3828          		JR	C,ERRDR
  CB28  F3            		DI
  CB29  3A56EA        		LD	A,(FDCPAT+1)
  CB2C  CD9AEA        		CALL	SECSET
  CB2F  0EFB          		LD	C,0FBH
  CB31                	DRD1:
  CB31  78            		LD	A,B
  CB32  DBF8          		IN	A,(0F8H)
  CB34  0F            		RRCA
  CB35  3008          		JR	NC,DRD3
  CB37  0F            		RRCA
  CB38  30F7          		JR	NC,DRD1
  CB3A  EDA2          		INI
  CB3C  04            		INC	B
  CB3D  18F2          		JR	DRD1
                      	
  CB3F                	DRD3:
  CB3F  B7            		OR	A
  CB40  FB            		EI
  CB41  D1            		POP	DE
  CB42  13            		INC	DE
  CB43  CD8EEA        		CALL	FDMOFF
  CB46  C8            		RET	Z
  CB47  CDD4DB        		CALL	DISKC+AT_RS
  CB4A  20D1          		JR	NZ,DRD0
  CB4C  B7            		OR	A
  CB4D  20B3          		JR	NZ,ERRW
  CB4F  C9            		RET
                      	
  CB50                	ERRDR:
  CB50  D1            		POP	DE
  CB51  CDE5DB        		CALL	AT_DELP+AT_RS
  CB54  20C7          		JR	NZ,DRD0
  CB56  B7            		OR	A
  CB57  20A9          		JR	NZ,ERRW
  CB59  C9            		RET
                      	
  CB5A                	AT_CPUE:
                      	
                      	
                      	;	EMM DRIVER(CPU)
                      	
                      	
  CB5A                	AT_EDWTC:
  CB5A  CD4ECD        		CALL	AT_EADR+AT_RE
  CB5D                	AT_EDWTC1:
  CB5D  04            		INC	B
  CB5E  EDA3          		OUTI
  CB60  04            		INC	B
  CB61  EDA3          		OUTI
  CB63  04            		INC	B
  CB64  EDA3          		OUTI
  CB66  04            		INC	B
  CB67  EDA3          		OUTI
  CB69  3D            		DEC	A
  CB6A  20F1          		JR	NZ,AT_EDWTC1
  CB6C  AF            		XOR	A
  CB6D  C9            		RET
                      	
  CB6E                	AT_EDRDC:
  CB6E  CD4ECD        		CALL	AT_EADR+AT_RE
  CB71                	AT_EDRDC1:
  CB71  EDA2          		INI
  CB73  04            		INC	B
  CB74  EDA2          		INI
  CB76  04            		INC	B
  CB77  EDA2          		INI
  CB79  04            		INC	B
  CB7A  EDA2          		INI
  CB7C  04            		INC	B
  CB7D  3D            		DEC	A
  CB7E  20F1          		JR	NZ,AT_EDRDC1
  CB80  AF            		XOR	A
  CB81  C9            		RET
                      	
  CB82                	AT_EADR:
  CB82  D5            		PUSH	DE
  CB83  EB            		EX	DE,HL
  CB84  29            		ADD	HL,HL
  CB85  29            		ADD	HL,HL
  CB86  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CB8A  0E00          		LD	C,0
  CB8C  09            		ADD	HL,BC
  CB8D  060D          		LD	B,00DH
  CB8F  ED49          		OUT	(C),C
  CB91  0C            		INC	C
  CB92  ED69          		OUT	(C),L
  CB94  0C            		INC	C
  CB95  ED61          		OUT	(C),H
  CB97  0C            		INC	C
  CB98  EB            		EX	DE,HL
  CB99  D1            		POP	DE
  CB9A  13            		INC	DE
  CB9B  AF            		XOR	A
  CB9C  C9            		RET
                      	
  CB9D                	AT_EMME:
                      	
  CB9D                	INITE:
  CB9D                		DS	0CC06H-INITE
                      	
  CC06                	BDOS:
  CC06  C3A9D3        		JP	BDOS0
  CC09                		DS	37	;Reserved
                      	
                      	;LDIO2.ASM
                      	
                      	;	LSX-Dodgers IO2
                      	
  CC2E                	_SYS03:		;(BDOS)外部入力
  CC2E  F3            		DI
  CC2F  C5            		PUSH	BC
  CC30  01911F        	SIOAD:	LD	BC,01F91H
  CC33  3E05          		LD	A,5
  CC35  ED79          		OUT	(C),A
  CC37  3EEA          		LD	A,0EAH		;RTS ON
  CC39  ED79          		OUT	(C),A
  CC3B                	REC1:
  CC3B  CD52CC        		CALL	BREAK2
  CC3E  ED78          		IN	A,(C)
  CC40  0F            		RRCA			;Arrival
  CC41  30F8          		JR	NC,REC1
  CC43                	BREAK2X:
  CC43  3F            		CCF
  CC44  3E05          		LD	A,5
  CC46  ED79          		OUT	(C),A
  CC48  3EE8          		LD	A,0E8H		;RTS OFF
  CC4A  ED79          		OUT	(C),A
                      	
  CC4C  0D            		DEC	C
  CC4D  ED78          		IN	A,(C)		;Read data
  CC4F  C1            		POP	BC
  CC50  FB            		EI
  CC51  C9            		RET
                      	
  CC52                	BREAK2:
  CC52  3E1A          		LD	A,01AH
  CC54  DB01          		IN	A,(1)
  CC56  0F            		RRCA
  CC57  D8            		RET	C
  CC58  C1            		POP	BC		;PC
  CC59  01911F        	SIOAD0:	LD	BC,01F91H
  CC5C  18E5          		JR	BREAK2X
                      	
  CC5E                	_SYS04:		;(BDOS)外部出力
  CC5E  C5            		PUSH	BC
  CC5F  01911F        	SIOAD1:	LD	BC,01F91H
  CC62                	XMIT1:
  CC62  CD52CC        		CALL	BREAK2
  CC65  3E10          		LD	A,010H		;Reset status
  CC67  ED79          		OUT	(C),A
  CC69  ED78          		IN	A,(C)
  CC6B  2F            		CPL
  CC6C  E624          		AND	024H		;CTS Send Empty
  CC6E  20F2          		JR	NZ,XMIT1
  CC70  0D            		DEC	C
  CC71  ED59          		OUT	(C),E
  CC73  C1            		POP	BC
  CC74  C9            		RET
                      	
                      	
                      	;LDDISK2.ASM
                      	
                      	;	LSX-Dodgers DISK2
                      	
                      	
                      	;	GRAPHIC RAM DISK DRIVER
                      	
                      	
  CC75                	GDRD:
  CC75  CD8BCC        		CALL	GADR
  CC78                	GDRDC1:
  CC78  EDA2          		INI
  CC7A  04            		INC	B
  CC7B  0C            		INC	C
  CC7C  20FA          		JR	NZ,GDRDC1
  CC7E  1817          		JR	S1FD0
                      	
  CC80                	GDWT:
  CC80  CD8BCC        		CALL	GADR
  CC83                	GDWTC1:
  CC83  04            		INC	B
  CC84  EDA3          		OUTI
  CC86  0C            		INC	C
  CC87  20FA          		JR	NZ,GDWTC1
  CC89  180C          		JR	S1FD0
                      	
  CC8B                	GADR:
  CC8B  0E00          		LD	C,0
  CC8D  7B            		LD	A,E
  CC8E  C640          		ADD	A,040H
  CC90  47            		LD	B,A
  CC91  13            		INC	DE
  CC92  3ABFEC        		LD	A,(WK1FD0)
  CC95  F610          		OR	010H		;BANK1
  CC97                	S1FD0:
  CC97  C5            		PUSH	BC
  CC98  32BFEC        		LD	(WK1FD0),A
  CC9B  01D01F        		LD	BC,01FD0H
  CC9E  ED79          		OUT	(C),A
  CCA0  C1            		POP	BC
  CCA1  E6EF          		AND	0EFH		;BANK0
  CCA3  C9            		RET
                      	
                      	
                      	;	BANK RAM DISK DRIVER
                      	
                      	
  CCA4                	BDRDC:
  CCA4  ED73C3CC      		LD	(BANKSP+1),SP
  CCA8  3AC4CC        		LD	A,(BANKSP+2)
  CCAB  87            		ADD	A,A
  CCAC  3803          		JR	C,BDRDC1
  CCAE  31D4FF        		LD	SP,EXTSP
  CCB1                	BDRDC1:
  CCB1  D5            		PUSH	DE
  CCB2  D9            		EXX
  CCB3  C5            		 PUSH	 BC
  CCB4  D5            		 PUSH	 DE
  CCB5  CDE9CC        		 CALL	 BADR
  CCB8  CD06CD        		CALL	BTFR
  CCBB  D9            		EXX
  CCBC                	BDWTCE:
  CCBC  D1            		 POP	 DE
  CCBD  C1            		 POP	 BC
  CCBE  D9            		 EXX
  CCBF  D1            		POP	DE
  CCC0  13            		INC	DE
  CCC1  FB            		EI
  CCC2  310000        	BANKSP:	LD	SP,0
  CCC5  AF            		XOR	A
  CCC6  C9            		RET
                      	
  CCC7                	BDWTC:
  CCC7  ED73C3CC      		LD	(BANKSP+1),SP
  CCCB  3AC4CC        		LD	A,(BANKSP+2)
  CCCE  87            		ADD	A,A
  CCCF  3803          		JR	C,BDWTC1
  CCD1  31D4FF        		LD	SP,EXTSP
  CCD4                	BDWTC1:
  CCD4  D5            		PUSH	DE
  CCD5  D9            		EXX
  CCD6  C5            		 PUSH	 BC
  CCD7  D5            		 PUSH	 DE
  CCD8  CDE9CC        		 CALL	 BADR
  CCDB  D9            		EXX
  CCDC  53            		 LD	D,E
  CCDD  5F            		 LD	E,A
  CCDE  D9            		 EXX
  CCDF  EB            		EX	DE,HL
  CCE0  CD06CD        		CALL	BTFR
  CCE3  EB            		EX	DE,HL
  CCE4  D9            		EXX
  CCE5  ED51          		 OUT	 (C),D	 ;MAIN
  CCE7  18D3          		 JR	 BDWTCE
                      	
  CCE9                	BADR:
  CCE9  D9            		 EXX
  CCEA  7B            		LD	A,E
  CCEB  87            		ADD	A,A
  CCEC  CB12          		RL	D
  CCEE  87            		ADD	A,A
  CCEF  CB12          		RL	D
  CCF1  F5            		PUSH	AF
  CCF2  87            		ADD	A,A
  CCF3  7A            		LD	A,D
  CCF4  8F            		ADC	A,A
  CCF5  E60F          		AND	00FH
  CCF7  D9            		EXX
  CCF8  01000B        		 LD	 BC,00B00H
  CCFB  57            		 LD	 D,A	  ;BANK
  CCFC  1E10          		 LD	 E,010H	  ;MAIN
  CCFE  D9            		 EXX
  CCFF  D1            		POP	DE
  CD00  0600          		LD	B,0
  CD02  58            		LD	E,B
  CD03  CBBA          		RES	7,D
  CD05  C9            		RET
                      	
  CD06                	BTFR:
  CD06  D5            		PUSH	DE
  CD07  F3            		DI
                      	
  CD08                	BTFR1:
  CD08  D9            		EXX
  CD09  ED51          		 OUT	 (C),D	 ;BANK(MAIN)
  CD0B  D9            		 EXX
  CD0C  E3            		EX	(SP),HL
  CD0D  7E            		LD	A,(HL)
  CD0E  23            		INC	HL
  CD0F  4E            		LD	C,(HL)
  CD10  23            		INC	HL
  CD11  56            		LD	D,(HL)
  CD12  23            		INC	HL
  CD13  5E            		LD	E,(HL)
  CD14  23            		INC	HL
  CD15  E3            		EX	(SP),HL
  CD16  D9            		EXX
  CD17  ED59          		 OUT	 (C),E	 ;MAIN(BANK)
  CD19  D9            		 EXX
  CD1A  77            		LD	(HL),A
  CD1B  23            		INC	HL
  CD1C  71            		LD	(HL),C
  CD1D  23            		INC	HL
  CD1E  72            		LD	(HL),D
  CD1F  23            		INC	HL
  CD20  73            		LD	(HL),E
  CD21  23            		INC	HL
  CD22  10E4          		DJNZ	BTFR1
  CD24  D1            		POP	DE
  CD25  C9            		RET
                      	
                      	
                      	;	EMM DRIVER(DMA)
                      	
                      	
  CD26                	EDWTC:
  CD26  3E11          		LD	A,17
  CD28  01            		DB	1
  CD29                	EDRDC:
  CD29  3E0F          		LD	A,15
  CD2B                	EDWTC1:
  CD2B  D5            		PUSH	DE
  CD2C  2268CD        		LD	(EDMAD+12),HL
  CD2F  EB            		EX	DE,HL
  CD30  29            		ADD	HL,HL
  CD31  29            		ADD	HL,HL
  CD32  ED4BA0EC      		LD	BC,(_MAXCYL-1)
  CD36  0E00          		LD	C,0
  CD38  09            		ADD	HL,BC
  CD39  ED4B84EC      		LD	BC,(_DRIVE)
  CD3D  060D          		LD	B,00DH
  CD3F  ED49          		OUT	(C),C
  CD41  0C            		INC	C
  CD42  ED69          		OUT	(C),L
  CD44  0C            		INC	C
  CD45  ED61          		OUT	(C),H
                      	
  CD47  215CCD        		LD	HL,EDMAD
  CD4A  CD56EB        		CALL	SETDMA
  CD4D  3EB3          		LD	A,0B3H
  CD4F  ED79          		OUT	(C),A
  CD51  ED49          		OUT	(C),C		;OUT 01F87H,087H
  CD53  EB            		EX	DE,HL
  CD54  24            		INC	H
  CD55  24            		INC	H
  CD56  24            		INC	H
  CD57  24            		INC	H
  CD58  D1            		POP	DE
  CD59  13            		INC	DE
  CD5A  AF            		XOR	A
  CD5B  C9            		RET
                      	
  CD5C  C37D030DFF032C	EDMAD:	DB	0C3H,07DH,003H,00DH,0FFH,003H,02CH,050H,002H
  CD65  809AAD0000CF01		DB	080H,09AH,0ADH,000H,000H,0CFH,001H,0CFH
                      	
  CD6D                	EMME:
                      	
  01CC                	AT_RE	EQU	EDWTC-AT_EDWTC
                      	
                      	
                      	;LDCCP.ASM
                      	
                      	;	LSX-Dodgers CCP
                      	
  0040                	PATHX	EQU	64
  CD6D                	PATHD:	DS	PATHX
  CDAD  00            	PATHE:	DB	0
                      	
  CDAE  4F4B24        	OK:	DB	"OK$"
  CDB1  536B697024    	SKIP:	DB	"Skip$"
  CDB6  6B206279746573	KBFREE:	DB	"k bytes free",9,'$'
  CDC4  20202020646972	DIRMES:	DB	"    dir $"
  CDCD  074572726F7221	COMERM:	DB	7,"Error!$"
                      	
  0009                	COMS	EQU	9
  CDD5                	COMTB:
  CDD5  44202020      		DB	"D   "	;1
  CDD9  29D0          		DW	C_DIR
  CDDB  44495220      		DB	"DIR "	;2
  CDDF  29D0          		DW	C_DIR
  CDE1  434F5059      		DB	"COPY"	;3
  CDE5  21D2          		DW	C_COPY
  CDE7  43442020      		DB	"CD  "	;4
  CDEB  21CF          		DW	C_CD
  CDED  44454C20      		DB	"DEL "	;5
  CDF1  0CD0          		DW	C_DEL
  CDF3  50415448      		DB	"PATH"	;6
  CDF7  DAD0          		DW	C_PATH
  CDF9  52454E20      		DB	"REN "	;7
  CDFD  16D0          		DW	C_REN
  CDFF  54595045      		DB	"TYPE"	;8
  CE03  44D3          		DW	C_TYPE
  CE05  52454D20      		DB	"REM "	;9
  CE09  0AD0          		DW	C_REM
                      	
  CE0B                	WBOOT1:
  CE0B  F3            		DI
  CE0C  310000        		LD	SP,STACK
                      	
  CE0F  3EEC          		LD	A,INTVEC/256
  CE11  ED47          		LD	I,A
                      	
  CE13  3EE4          		LD	A,0E4H
  CE15  CDFADA        		CALL	COMOUT
  CE18  3EC8          		LD	A,INTVEC
  CE1A  CDD4DA        		CALL	OT49SB
                      	
  CE1D  3ABCEC        		LD	A,(CRTCD+12)
  CE20  B7            		OR	A
  CE21  200C          		JR	NZ,SETCRT0
  CE23  2130F8        		LD	HL,0-80*LINE
  CE26  22BAEC        		LD	(CRTCD+10),HL
  CE29  21B0FF        		LD	HL,0-80
  CE2C  22BCEC        		LD	(CRTCD+12),HL
  CE2F                	SETCRT0:
  CE2F  21B0EC        		LD	HL,CRTCD
  CE32  AF            		XOR	A
  CE33                	SETCRT2:
  CE33  010018        		LD	BC,01800H
  CE36  ED79          		OUT	(C),A
  CE38  0C            		INC	C
  CE39  04            		INC	B
  CE3A  EDA3          		OUTI
  CE3C  3C            		INC	A
  CE3D  FE0C          		CP	12
  CE3F  20F2          		JR	NZ,SETCRT2
  CE41  0D            		DEC	C
  CE42  ED79          		OUT	(C),A
  CE44  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CE45  ED71          		DB	0EDH,071H
  CE47  0D            		DEC	C
  CE48  3C            		INC	A
  CE49  ED79          		OUT	(C),A
  CE4B  0C            		INC	C
                      	;	OUT	(C),0		;未定義命令ニーモニック
  CE4C  ED71          		DB	0EDH,071H
  CE4E  23            		INC	HL
  CE4F  23            		INC	HL
  CE50  01031B        		LD	BC,01A03H+00100H
  CE53  EDA3          		OUTI
  CE55  01D020        		LD	BC,01FD0H+00100H
  CE58  EDA3          		OUTI
  CE5A  CDD0D0        		CALL	LTNL
  CE5D                	COMMAND:
  CE5D  CD15CF        		CALL	SETDTA1
  CE60  D5            		PUSH	DE
  CE61  3A87EC        		LD	A,(_DVSW)
  CE64  C641          		ADD	A,'A'
  CE66  5F            		LD	E,A
  CE67  CDCDEC        		CALL	_PRINT
  CE6A  1E3E          		LD	E,'>'
  CE6C  CDCDEC        		CALL	_PRINT
  CE6F  D1            		POP	DE		;DE=DTA1
  CE70  3E50          		LD	A,80
  CE72  12            		LD	(DE),A
  CE73  CD19D8        		CALL	_SYS0A		;(BDOS)文字列入力
  CE76  CDD0D0        		CALL	LTNL
                      	
  CE79  118200        		LD	DE,DTA1+2
  CE7C  CDFDEC        		CALL	_COMANL
  CE7F  30DC          		JR	NC,COMMAND
  CE81  CD93D7        		CALL	KEYBC
  CE84  11CDCD        		LD	DE,COMERM
  CE87  CDD5D3        		CALL	_SYS09		;(BDOS)文字列出力
  CE8A  C7            		RST	0
                      	
  CE8B                	COMANL:
  CE8B  CDD3DC        		CALL	FILE
  CE8E  D5            		PUSH	DE
  CE8F  11DC00        		LD	DE,FNAME
  CE92  1A            		LD	A,(DE)
  CE93  FE20          		CP	020H
  CE95  2848          		JR	Z,SDVSW
  CE97  1B            		DEC	DE
  CE98  1A            		LD	A,(DE)
  CE99  C6FF          		ADD	A,0FFH
  CE9B  380A          		JR	C,COMB
  CE9D  13            		INC	DE
                      	
  CE9E  21D5CD        		LD	HL,COMTB
  CEA1  3E09          		LD	A,COMS
  CEA3  47            		LD	B,A
  CEA4  CD68DF        		CALL	CPNAME
  CEA7                	COMB:
  CEA7  D1            		POP	DE
  CEA8  D20F00        		JP	NC,JP_HL
  CEAB  EB            		EX	DE,HL
  CEAC  228BCF        		LD	(COMPAT+1),HL
  CEAF  22E2CF        		LD	(BATPAT+1),HL
  CEB2  F5            		PUSH	AF
  CEB3  CD33CF        		CALL	CEXE4
  CEB6  F1            		POP	AF
  CEB7  21DC00        		LD	HL,FNAME
  CEBA  116D00        		LD	DE,FCB2+1	;COMMAND NAME
  CEBD  010B00        		LD	BC,11
  CEC0  EDB0          		LDIR
  CEC2  116DCD        		LD	DE,PATHD
  CEC5                	CEX1:
  CEC5  1A            		LD	A,(DE)
  CEC6  FE20          		CP	020H
  CEC8  D8            		RET	C
  CEC9  CDC8DC        		CALL	FILEC
  CECC  D5            		PUSH	DE
  CECD  216D00        		LD	HL,FCB2+1	;COMMAND NAME
  CED0  11DC00        		LD	DE,FNAME
  CED3  010B00        		LD	BC,11
  CED6  EDB0          		LDIR
  CED8  CD33CF        		CALL	CEXE4
  CEDB  D1            		POP	DE
  CEDC  13            		INC	DE
  CEDD  18E6          		JR	CEX1
                      	
  CEDF                	SDVSW:
  CEDF  F1            		POP	AF
  CEE0  3ADB00        		LD	A,(FDRV)
  CEE3  3D            		DEC	A
  CEE4  5F            		LD	E,A
  CEE5  0E0E          		LD	C,00EH		;(BDOS)カレント・ドライブの設定
  CEE7  1833          		JR	SYSTEM0
                      	
  CEE9                	OPEN1:
  CEE9  21DB00        		LD	HL,FDRV
  CEEC                	OPEN:
  CEEC  0E11          		LD	C,011H		;(BDOS)最初のファイルの検索
  CEEE                	OPEN3:
  CEEE  D5            		PUSH	DE
  CEEF  1151FF        		LD	DE,DTA
  CEF2  CD12CF        		CALL	SETDTA
  CEF5  EB            		EX	DE,HL
  CEF6  CD0500        		CALL	SYSTEM
  CEF9  D1            		POP	DE
  CEFA  B7            		OR	A
  CEFB  C9            		RET
                      	
  CEFC                	OPEN2:
  CEFC  0E12          		LD	C,012H
  CEFE  18EE          		JR	OPEN3
                      	
  CF00                	DEFCB:				;Z=Ok NZ=Error
  CF00  1151FF        		LD	DE,DTA
  CF03  CD1ACF        		CALL	SYSC0F
                      	
  CF06  210000        		LD	HL,0
  CF09  2272FF        		LD	(DTA+33),HL
  CF0C  2274FF        		LD	(DTA+35),HL
  CF0F  110001        		LD	DE,00100H
  CF12                	SETDTA:
  CF12  C3EED5        		JP	_SYS1A		;(BDOS)DTAの設定
                      	
  CF15                	SETDTA1:
  CF15  118000        		LD	DE,DTA1
  CF18  18F8          		JR	SETDTA
                      	
  CF1A                	SYSC0F:
  CF1A  0E0F          		LD	C,00FH		;(BDOS)ファイルのオープン
  CF1C                	SYSTEM0:
  CF1C  CD0500        		CALL	SYSTEM
  CF1F  B7            		OR	A
  CF20  C9            		RET
                      	
  CF21                	C_CD:
  CF21  CDC8DC        		CALL	FILEC
  CF24  210000        		LD	HL,0
  CF27  11DB00        		LD	DE,FDRV
  CF2A  1803          		JR	S27
                      	
  CF2C                	S27DTA:
  CF2C  1151FF        		LD	DE,DTA
  CF2F                	S27:
  CF2F  0E27          		LD	C,027H		;(BDOS)ランダム・ブロック・リード
  CF31  18E9          		JR	SYSTEM0
                      	
  CF33                	CEXE4:
  CF33  3ADB00        		LD	A,(FDRV)
  CF36  325700        		LD	(00057H),A
  CF39  2AE900        		LD	HL,(FDRV+14)
  CF3C  225800        		LD	(00058H),HL
                      	
  CF3F  21E400        		LD	HL,FNAME+8
  CF42  7E            		LD	A,(HL)
  CF43  FE20          		CP	020H
  CF45  2007          		JR	NZ,CEXE7
  CF47  3E3F          		LD	A,'?'
  CF49  77            		LD	(HL),A
  CF4A  23            		INC	HL
  CF4B  77            		LD	(HL),A
  CF4C  23            		INC	HL
  CF4D  77            		LD	(HL),A
  CF4E                	CEXE7:
  CF4E  CDE9CE        		CALL	OPEN1
  CF51                	CEXE5:
  CF51  C0            		RET	NZ
  CF52  2A5BFF        		LD	HL,(DTA+1+9)
  CF55  7C            		LD	A,H
  CF56  CDD5DF        		CALL	CAP
  CF59  67            		LD	H,A
  CF5A  7D            		LD	A,L
  CF5B  CDD5DF        		CALL	CAP
  CF5E  6F            		LD	L,A
  CF5F  3A5AFF        		LD	A,(DTA+1+8)
  CF62  CDD5DF        		CALL	CAP
  CF65  D642          		SUB	'B'
  CF67  282E          		JR	Z,C_BAT
  CF69  3D            		DEC	A		;'C'
  CF6A  2805          		JR	Z,C_EXE
  CF6C                	CEXE6:
  CF6C  CDFCCE        		CALL	OPEN2
  CF6F  18E0          		JR	CEXE5
                      	
  CF71                	C_EXE:
  CF71  7C            		LD	A,H
  CF72  FE4D          		CP	'M'
  CF74  20F6          		JR	NZ,CEXE6
                      	
  CF76  CD00CF        		CALL	DEFCB
  CF79  2A0600        		LD	HL,(SYSTEM+1)
  CF7C  25            		DEC	H
  CF7D  CD2CCF        		CALL	S27DTA
  CF80  3D            		DEC	A
  CF81  37            		SCF
  CF82  C0            		RET	NZ
  CF83  7C            		LD	A,H
  CF84  B5            		OR	L
  CF85  37            		SCF
  CF86  C8            		RET	Z
  CF87  CD15CF        		CALL	SETDTA1
  CF8A  110000        	COMPAT:	LD	DE,0
  CF8D  CDE0D1        		CALL	SETFCB
  CF90  AF            		XOR	A
  CF91  67            		LD	H,A
  CF92  6F            		LD	L,A	;HL=0x0000
  CF93  F9            		LD	SP,HL	;STACK=0
  CF94  E5            		PUSH	HL
  CF95  24            		INC	H	;HL=0x0100
  CF96  E9            		JP	(HL)
                      	
  CF97                	C_BAT:
  CF97  114154        		LD	DE,'A'+'T'*256
  CF9A  ED52          		SBC	HL,DE
  CF9C  20CE          		JR	NZ,CEXE6
                      	
  CF9E  F1            		POP	AF
  CF9F  F1            		POP	AF
  CFA0  CD00CF        		CALL	DEFCB
  CFA3  210002        		LD	HL,00200H
  CFA6  CD2CCF        		CALL	S27DTA
  CFA9  C6FE          		ADD	A,0FEH
  CFAB  D8            		RET	C
  CFAC  7D            		LD	A,L
  CFAD  B7            		OR	A
  CFAE  37            		SCF
  CFAF  C8            		RET	Z
  CFB0  3C            		INC	A
  CFB1  F5            		PUSH	AF
                      	
  CFB2  CD93D7        		CALL	KEYBC
  CFB5  1E1A          		LD	E,01AH
  CFB7  CDCDEC        		CALL	_PRINT
  CFBA  C1            		POP	BC
  CFBB  210001        		LD	HL,00100H
  CFBE                	BAT1:
  CFBE  A7            		AND	A
  CFBF  05            		DEC	B
  CFC0  C8            		RET	Z
  CFC1  7E            		LD	A,(HL)
  CFC2  FE25          		CP	'%'
  CFC4  280C          		JR	Z,BAT2
  CFC6                	BAT1X:
  CFC6  7E            		LD	A,(HL)
  CFC7  23            		INC	HL
  CFC8  FE1A          		CP	01AH
  CFCA  C8            		RET	Z
  CFCB  FE0A          		CP	00AH
  CFCD  C479D7        		CALL	NZ,KEYBS
  CFD0  18EC          		JR	BAT1
                      	
  CFD2                	BAT2:
  CFD2  23            		INC	HL
  CFD3  7E            		LD	A,(HL)
  CFD4  2B            		DEC	HL
  CFD5  D631          		SUB	'1'
  CFD7  38ED          		JR	C,BAT1X
  CFD9  FE09          		CP	9
  CFDB  30E9          		JR	NC,BAT1X
  CFDD  23            		INC	HL
  CFDE  23            		INC	HL
  CFDF  3C            		INC	A
  CFE0  4F            		LD	C,A
  CFE1  110000        	BATPAT:	LD	DE,0
  CFE4                	BAT3:
  CFE4  1A            		LD	A,(DE)
  CFE5  B7            		OR	A
  CFE6  28D6          		JR	Z,BAT1
  CFE8  CDADDD        		CALL	SPCUT
  CFEB  0D            		DEC	C
  CFEC  2808          		JR	Z,BAT5
  CFEE                	BAT4:
  CFEE  1A            		LD	A,(DE)
  CFEF  FE21          		CP	021H
  CFF1  38F1          		JR	C,BAT3
  CFF3  13            		INC	DE
  CFF4  18F8          		JR	BAT4
  CFF6                	BAT5:
  CFF6  1A            		LD	A,(DE)
  CFF7  FE21          		CP	021H
  CFF9  38C3          		JR	C,BAT1
  CFFB  13            		INC	DE
  CFFC  CD79D7        		CALL	KEYBS
  CFFF  18F5          		JR	BAT5
                      	
  D001                	SWITCH:
  D001  1A            		LD	A,(DE)
  D002                	SW1:
  D002  13            		INC	DE
  D003  B9            		CP	C
  D004  1A            		LD	A,(DE)
  D005  C8            		RET	Z
  D006  FE20          		CP	020H
  D008  30F8          		JR	NC,SW1
  D00A                	C_REM:
  D00A  AF            		XOR	A
  D00B  C9            		RET
                      	
  D00C                	C_DEL:
  D00C  CDE0D1        		CALL	SETFCB
  D00F  CDE0D7        		CALL	_SYS08		;(BDOS)エコーなしコンソール入力
                      	
  D012  0E13          		LD	C,013H
  D014  180A          		JR	CDEL1
                      	
  D016                	C_REN:
  D016  CDE0D1        		CALL	SETFCB
  D019  3E10          		LD	A,010H		;ディレクトリも対象にする
  D01B  326900        		LD	(FCB1+13),A	;属性
  D01E  0E17          		LD	C,017H		;(BDOS)ファイル名の変更
  D020                	CDEL1:
  D020  115C00        		LD	DE,FCB1
  D023  CD0500        		CALL	SYSTEM
  D026  C6FF          		ADD	A,0FFH
  D028  C9            		RET
                      	
  D029                	C_DIR:
  D029  CDC8DC        		CALL	FILEC
  D02C  21DC00        		LD	HL,FDRV+1
  D02F  CD80D3        		CALL	CWILD1
  D032  3EF1          		LD	A,0F1H
  D034  32E800        		LD	(FDRV+13),A
  D037  CDE9CE        		CALL	OPEN1
  D03A                	CDIR1:
  D03A  B7            		OR	A
  D03B  2008          		JR	NZ,PDSKF
  D03D  CD89D0        		CALL	P_NAME
  D040  CDFCCE        		CALL	OPEN2
  D043  18F5          		JR	CDIR1
                      	
  D045                	PDSKF:
  D045  3ADB00        		LD	A,(FDRV)
  D048  5F            		LD	E,A
  D049  0E1B          		LD	C,01BH		;(BDOS)ディスク情報の獲得
  D04B  CD0500        		CALL	SYSTEM
  D04E  4F            		LD	C,A
  D04F  C601          		ADD	A,001H
  D051  D8            		RET	C
  D052  AF            		XOR	A
  D053                	PDS1:
  D053  CB19          		RR	C
  D055  3804          		JR	C,PDS2
  D057  29            		ADD	HL,HL
  D058  8F            		ADC	A,A
  D059  18F8          		JR	PDS1
  D05B                	PDS2:
  D05B  CB50          		BIT	2,B
  D05D  200A          		JR	NZ,PDSKF1
  D05F  CB3F          		SRL	A
  D061  CB1C          		RR	H
  D063  CB1D          		RR	L
  D065  CB10          		RL	B
  D067  18F2          		JR	PDS2
  D069                	PDSKF1:
  D069  CD0CD1        		CALL	PRDEC
  D06C  11B6CD        		LD	DE,KBFREE
  D06F  CDD5D3        		CALL	_SYS09		;(BDOS)文字列出力
  D072  CDFED0        		CALL	PUTDRV
  D075  3E5C          		LD	A,05CH
  D077  CDCAD7        		CALL	MSG_
  D07A  2AE900        		LD	HL,(FDRV+14)
  D07D  7C            		LD	A,H
  D07E  B5            		OR	L
  D07F  284F          		JR	Z,LTNL
  D081  2B            		DEC	HL
  D082  7C            		LD	A,H
  D083  B5            		OR	L
  D084  C40BD1        		CALL	NZ,PRDEC0
  D087  1847          		JR	LTNL
                      	
  D089                	P_NAME:
  D089  3A52FF        		LD	A,(DTA+1)
  D08C  FE2E          		CP	'.'
  D08E  C8            		RET	Z
  D08F  3E20          		LD	A,020H
  D091  CDCAD7        		CALL	MSG_
  D094  CDCAD7        		CALL	MSG_
  D097  3E3A          		LD	A,':'
  D099  CDCAD7        		CALL	MSG_
  D09C  3A5DFF        		LD	A,(DTA+1+00BH)
  D09F  F5            		PUSH	AF
  D0A0  0F            		RRCA
  D0A1  9F            		SBC	A,A
  D0A2  E60A          		AND	'*'-020H
  D0A4  C620          		ADD	A,020H
  D0A6  CDCAD7        		CALL	MSG_
  D0A9  CDFED0        		CALL	PUTDRV
  D0AC  2152FF        		LD	HL,DTA+1
  D0AF  CD4DD1        		CALL	FPRNT
                      	
  D0B2  F1            		POP	AF
  D0B3  CB67          		BIT	4,A
  D0B5  2808          		JR	Z,DIR3
  D0B7  11C4CD        		LD	DE,DIRMES
  D0BA  CDD5D3        		CALL	_SYS09		;(BDOS)文字列出力
  D0BD  1809          		JR	DIR6
  D0BF                	DIR3:
  D0BF  3A70FF        		LD	A,(DTA+1+01EH)
  D0C2  2A6EFF        		LD	HL,(DTA+1+01CH)
  D0C5  CD0CD1        		CALL	PRDEC
  D0C8                	DIR6:
  D0C8  3AB1EC        		LD	A,(CRTCD+1)
  D0CB  FE29          		CP	40+1
  D0CD  D46FD1        		CALL	NC,PRTTMS
                      	
  D0D0                	LTNL:
  D0D0  1E0D          		LD	E,00DH
  D0D2  CDDDD7        		CALL	PRINTX
  D0D5  1E0A          		LD	E,00AH
  D0D7  C3DDD7        		JP	PRINTX
                      	
  D0DA                	C_PATH:
  D0DA  CDADDD        		CALL	SPCUT
  D0DD  216DCD        		LD	HL,PATHD
  D0E0  FE21          		CP	021H
  D0E2  300E          		JR	NC,CPATH0
  D0E4  2B            		DEC	HL
  D0E5  2B            		DEC	HL
  D0E6                	CPATHP:
  D0E6  7E            		LD	A,(HL)
  D0E7  23            		INC	HL
  D0E8  FE20          		CP	020H
  D0EA  3F            		CCF
  D0EB  30E3          		JR	NC,LTNL
  D0ED  CDCAD7        		CALL	MSG_
  D0F0  18F4          		JR	CPATHP
  D0F2                	CPATH0:
  D0F2  FE3B          		CP	';'
  D0F4  2001          		JR	NZ,CPATH1
  D0F6  13            		INC	DE
  D0F7                	CPATH1:
  D0F7  EB            		EX	DE,HL
  D0F8  014000        		LD	BC,PATHX
  D0FB  EDB0          		LDIR
  D0FD  C9            		RET
                      	
  D0FE                	PUTDRV:
  D0FE  3ADB00        		LD	A,(FDRV)
  D101  C640          		ADD	A,'A'-1
  D103  CDCAD7        		CALL	MSG_
  D106  3E3A          		LD	A,':'
  D108                	MSGR:
  D108  C3CAD7        		JP	MSG_
                      	
  D10B                	PRDEC0:
  D10B  AF            		XOR	A
  D10C                	PRDEC:
  D10C  5F            		LD	E,A
  D10D  010000        		LD	BC,0
  D110  ED43D600      		LD	(DECBF),BC
  D114  ED43D800      		LD	(DECBF+2),BC
                      	
  D118  0E18          		LD	C,24
  D11A                	DEC1:
  D11A  29            		ADD	HL,HL
  D11B  7B            		LD	A,E
  D11C  8F            		ADC	A,A
  D11D  5F            		LD	E,A
  D11E  E5            		PUSH	HL
  D11F  21D900        		LD	HL,DECBF+3
  D122  0604          		LD	B,4
  D124                	DEC2:
  D124  7E            		LD	A,(HL)
  D125  8F            		ADC	A,A
  D126  27            		DAA
  D127  77            		LD	(HL),A
  D128  2B            		DEC	HL
  D129  10F9          		DJNZ	DEC2
  D12B  E1            		POP	HL
  D12C  0D            		DEC	C
  D12D  20EB          		JR	NZ,DEC1
                      	
  D12F  21D600        		LD	HL,DECBF
  D132  3E20          		LD	A,020H
  D134  0603          		LD	B,3
  D136                	DEC3:
  D136  CD43D1        		CALL	DEC4
  D139  CD43D1        		CALL	DEC4
  D13C  23            		INC	HL
  D13D  10F7          		DJNZ	DEC3
  D13F                	DECX:
  D13F  CD43D1        		CALL	DEC4
  D142  AF            		XOR	A
  D143                	DEC4:
  D143  ED6F          		RLD
  D145  FE20          		CP	020H
  D147  2802          		JR	Z,DEC5
  D149  F630          		OR	030H
  D14B                	DEC5:
  D14B  18BB          		JR	MSGR
                      	
  D14D                	FPRNT:
  D14D  0608          		LD	B,8
  D14F  CD60D1        		CALL	P_N1
  D152  7E            		LD	A,(HL)
  D153  C680          		ADD	A,0A0H-020H
  D155  FEA0          		CP	0A0H
  D157  2802          		JR	Z,FPR1
  D159  3E2E          		LD	A,'.'
  D15B                	FPR1:
  D15B  CDCAD7        		CALL	MSG_
  D15E  0603          		LD	B,3
                      	
  D160                	P_N1:
  D160  C5            		PUSH	BC
  D161  E5            		PUSH	HL
  D162  7E            		LD	A,(HL)
  D163  CDE1DF        		CALL	CAP3
  D166  CDCAD7        		CALL	MSG_
  D169  E1            		POP	HL
  D16A  C1            		POP	BC
  D16B  23            		INC	HL
  D16C  10F2          		DJNZ	P_N1
  D16E  C9            		RET
                      	
  D16F                	PRTTMS:
  D16F  3E20          		LD	A,020H
  D171  CDCAD7        		CALL	MSG_
                      	
  D174  2A6AFF        		LD	HL,(DTA+1+24)
  D177  7D            		LD	A,L
  D178  B7            		OR	A
  D179  C8            		RET	Z
  D17A  CB3C          		SRL	H
  D17C  17            		RLA
  D17D  17            		RLA
  D17E  17            		RLA
  D17F  17            		RLA
  D180  E60F          		AND	00FH
  D182  57            		LD	D,A
  D183  7C            		LD	A,H
  D184  C650          		ADD	A,80
  D186  CDCBD1        		CALL	PRTA
  D189  3E2D          		LD	A,'-'
  D18B  CDCAD7        		CALL	MSG_
  D18E  7A            		LD	A,D
  D18F  CDCBD1        		CALL	PRTA
  D192  3E2D          		LD	A,'-'
  D194  CDCAD7        		CALL	MSG_
  D197  7D            		LD	A,L
  D198  E61F          		AND	01FH
  D19A  CDCBD1        		CALL	PRTA
                      	
  D19D  2A68FF        		LD	HL,(DTA+1+22)
                      	
  D1A0  3E20          		LD	A,020H
  D1A2  CDCAD7        		CALL	MSG_
  D1A5  7C            		LD	A,H
  D1A6  65            		LD	H,L
  D1A7  1F            		RRA
  D1A8  CB1D          		RR	L
  D1AA  1F            		RRA
  D1AB  CB1D          		RR	L
  D1AD  1F            		RRA
  D1AE  CB1D          		RR	L
  D1B0  E61F          		AND	01FH
  D1B2  CDCBD1        		CALL	PRTA
  D1B5  3E3A          		LD	A,':'
  D1B7  CDCAD7        		CALL	MSG_
  D1BA  7D            		LD	A,L
  D1BB  0F            		RRCA
  D1BC  0F            		RRCA
  D1BD  E63F          		AND	03FH
  D1BF  CDCBD1        		CALL	PRTA
  D1C2  3E3A          		LD	A,':'
  D1C4  CDCAD7        		CALL	MSG_
  D1C7  7C            		LD	A,H
  D1C8  E61F          		AND	01FH
  D1CA  87            		ADD	A,A
                      	
                      	;	PRINT10
                      	
  D1CB                	PRTA:
  D1CB  E5            		PUSH	HL
  D1CC  0608          		LD	B,8
  D1CE  4F            		LD	C,A
  D1CF  AF            		XOR	A
  D1D0                	PRTA1:
  D1D0  CB01          		RLC	C
  D1D2  8F            		ADC	A,A
  D1D3  27            		DAA
  D1D4  10FA          		DJNZ	PRTA1
  D1D6  21D600        		LD	HL,DECBF
  D1D9  77            		LD	(HL),A
  D1DA  AF            		XOR	A
  D1DB  CD3FD1        		CALL	DECX
  D1DE  E1            		POP	HL
  D1DF  C9            		RET
                      	
  D1E0                	SETFCB:
  D1E0  CDADDD        		CALL	SPCUT
  D1E3  1A            		LD	A,(DE)
  D1E4  FE20          		CP	020H
  D1E6  3801          		JR	C,SETFCBA
  D1E8  1B            		DEC	DE
  D1E9                	SETFCBA:
  D1E9  D5            		PUSH	DE
  D1EA  215C00        		LD	HL,FCB1
  D1ED  115D00        		LD	DE,FCB1+1
  D1F0  012300        		LD	BC,00023H
  D1F3  70            		LD	(HL),B		;B=0
  D1F4  EDB0          		LDIR
  D1F6  D1            		POP	DE
  D1F7  D5            		PUSH	DE
  D1F8  215C00        		LD	HL,FCB1
  D1FB  CD4DD6        		CALL	_SYS29		;(BDOS)ファイル名の解析
  D1FE  216C00        		LD	HL,FCB2
  D201  CD4DD6        		CALL	_SYS29		;(BDOS)ファイル名の解析
  D204  E1            		POP	HL
  D205  010050        		LD	BC,05000H
  D208  118100        		LD	DE,00081H
  D20B                	SETFCB1:
  D20B  7E            		LD	A,(HL)
  D20C  23            		INC	HL
  D20D  FE20          		CP	020H
  D20F  3805          		JR	C,SETFCB2
  D211  12            		LD	(DE),A
  D212  13            		INC	DE
  D213  0C            		INC	C
  D214  10F5          		DJNZ	SETFCB1
  D216                	SETFCB2:
  D216  79            		LD	A,C
  D217  328000        		LD	(DTA1),A
  D21A  04            		INC	B
  D21B  AF            		XOR	A
  D21C                	SETFCB3:
  D21C  12            		LD	(DE),A
  D21D  13            		INC	DE
  D21E  10FC          		DJNZ	SETFCB3
  D220  C9            		RET
                      	
  D221                	C_COPY:
  D221  CDE0D1        		CALL	SETFCB
  D224  118100        		LD	DE,DTA1+1
  D227  0E2F          		LD	C,'/'
  D229  CD01D0        		CALL	SWITCH
  D22C  CDD5DF        		CALL	CAP
  D22F  32B7D2        		LD	(SW+1),A
                      	
  D232  1170EB        		LD	DE,BEEPD
  D235  CDCBDC        		CALL	FILEC2
  D238  216C00        		LD	HL,FCB2
  D23B  CD54D6        		CALL	S29X1
                      	
  D23E  3E10          		LD	A,010H
  D240  326900        		LD	(FCB1+13),A
  D243  216D00        		LD	HL,FCB2+1
  D246  CD80D3        		CALL	CWILD1
  D249                	COPY0:
  D249  CD7DD3        		CALL	CWILD
  D24C  215C00        		LD	HL,FCB1
  D24F  CDECCE        		CALL	OPEN
  D252  37            		SCF
  D253                	COPY1:
  D253  C0            		RET	NZ
  D254  CD00CF        		CALL	DEFCB
                      	
  D257  3A5EFF        		LD	A,(DTA+13)
  D25A  CB67          		BIT	4,A
  D25C  2824          		JR	Z,COPY1A
                      	
  D25E  215D00        		LD	HL,FCB1+1
  D261  CDFEE0        		CALL	CHKWILD
  D264  3817          		JR	C,COPY9
                      	
  D266  3E20          		LD	A,020H
  D268  325D00        		LD	(FCB1+1),A
  D26B  2A6BFF        		LD	HL,(DTA+26)
  D26E  23            		INC	HL
  D26F  226A00        		LD	(FCB1+14),HL
  D272  18D5          		JR	COPY0
                      	
  D274                	COPYS:
  D274  11B1CD        		LD	DE,SKIP
  D277                	COPY8:
  D277  CDD5D3        		CALL	_SYS09		;(BDOS)文字列出力
  D27A  CDD0D0        		CALL	LTNL
  D27D                	COPY9:
  D27D  CDFCCE        		CALL	OPEN2
  D280  18D1          		JR	COPY1
                      	
  D282                	COPY1A:
  D282  216C00        		LD	HL,FCB2
  D285  11DB00        		LD	DE,FDRV
  D288  0153FF        		LD	BC,DTA+2
  D28B  EDA0          		LDI
  D28D  3E0B          		LD	A,11
  D28F                	COPY2:
  D28F  F5            		PUSH	AF
  D290  7E            		LD	A,(HL)
  D291  FE3F          		CP	'?'
  D293  2001          		JR	NZ,COPY3
  D295  0A            		LD	A,(BC)
  D296                	COPY3:
  D296  12            		LD	(DE),A
  D297  03            		INC	BC
  D298  13            		INC	DE
  D299  23            		INC	HL
  D29A  F1            		POP	AF
  D29B  3D            		DEC	A
  D29C  20F1          		JR	NZ,COPY2
  D29E  010500        		LD	BC,16-11
  D2A1  EDB0          		LDIR
  D2A3                	PUTNAME:
  D2A3  215D00        		LD	HL,FCB1+1
  D2A6  CDFEE0        		CALL	CHKWILD
  D2A9  300B          		JR	NC,PUTN1
  D2AB  21DC00        		LD	HL,FDRV+1
  D2AE  CD4DD1        		CALL	FPRNT
  D2B1  3E20          		LD	A,020H
  D2B3  CDCAD7        		CALL	MSG_
  D2B6                	PUTN1:
  D2B6  3E00          	SW:	LD	A,000H
  D2B8  FE54          		CP	'T'
  D2BA  2005          		JR	NZ,CSW1
  D2BC  21D6D2        		LD	HL,SWNE
  D2BF  1807          		JR	SWT1
  D2C1                	CSW1:
  D2C1  FE4E          		CP	'N'
  D2C3  2011          		JR	NZ,SWNE
  D2C5  2174D2        		LD	HL,COPYS
  D2C8                	SWT1:
  D2C8  11DB00        		LD	DE,FDRV
  D2CB  CD1ACF        		CALL	SYSC0F
  D2CE  2801          		JR	Z,SWN1
  D2D0  E9            		JP	(HL)
  D2D1                	SWN1:
  D2D1  CD2FD3        		CALL	CTIME
  D2D4  309E          		JR	NC,COPYS
  D2D6                	SWNE:
  D2D6  11DB00        		LD	DE,FDRV
  D2D9  0E16          		LD	C,016H		;(BDOS)ファイルの作成
  D2DB  CD1CCF        		CALL	SYSTEM0
  D2DE  204D          		JR	NZ,COPYE2
  D2E0  67            		LD	H,A		;A=0
  D2E1  6F            		LD	L,A
  D2E2  22FC00        		LD	(FDRV+33),HL
  D2E5  22FE00        		LD	(FDRV+35),HL
  D2E8                	COPY6:
  D2E8  CD8FD3        		CALL	BUFSIZ
  D2EB  CD2CCF        		CALL	S27DTA
  D2EE  47            		LD	B,A
  D2EF  3C            		INC	A
  D2F0  2833          		JR	Z,COPYE
  D2F2  7C            		LD	A,H
  D2F3  B5            		OR	L
  D2F4  280E          		JR	Z,COPY7
  D2F6  11DB00        		LD	DE,FDRV
  D2F9  0E26          		LD	C,026H		;(BDOS)ランダム・ブロック・ライト
  D2FB  CD0500        		CALL	SYSTEM
  D2FE  B7            		OR	A
  D2FF  2024          		JR	NZ,COPYE
  D301  05            		DEC	B
  D302  20E4          		JR	NZ,COPY6
  D304                	COPY7:
  D304  3A5EFF        		LD	A,(DTA+13)
  D307  32E800        		LD	(FDRV+13),A
  D30A  2165FF        		LD	HL,DTA+20
  D30D  11EF00        		LD	DE,FDRV+20
  D310  010400        		LD	BC,4
  D313  EDB0          		LDIR
                      	
  D315  11DB00        		LD	DE,FDRV
  D318  0E10          		LD	C,010H		;(BDOS)ファイルのクローズ
  D31A  CD1CCF        		CALL	SYSTEM0
  D31D  2006          		JR	NZ,COPYE
                      	
  D31F  11AECD        		LD	DE,OK
  D322  C377D2        		JP	COPY8
                      	
  D325                	COPYE:
  D325  11DB00        		LD	DE,FDRV
  D328  0E13          		LD	C,013H		;(BDOS)ファイルの削除
  D32A  CD0500        		CALL	SYSTEM
  D32D                	COPYE2:
  D32D  37            		SCF
  D32E  C9            		RET
                      	
  D32F                	CTIME:
  D32F  ED5B65FF      		LD	DE,(DTA+20)
  D333  2AEF00        		LD	HL,(FDRV+20)
  D336  A7            		AND	A
  D337  ED52          		SBC	HL,DE
  D339  C0            		RET	NZ
  D33A  ED5B67FF      		LD	DE,(DTA+22)
  D33E  2AF100        		LD	HL,(FDRV+22)
  D341  ED52          		SBC	HL,DE
  D343  C9            		RET
                      	
  D344                	C_TYPE:
  D344  CDE0D1        		CALL	SETFCB
  D347  215C00        		LD	HL,FCB1
  D34A  CDECCE        		CALL	OPEN
  D34D  37            		SCF
  D34E                	TYPE1:
  D34E  C0            		RET	NZ
  D34F  CD00CF        		CALL	DEFCB
  D352  1E1A          		LD	E,01AH
  D354  CDCDEC        		CALL	_PRINT
  D357                	TYPE2:
  D357  CD8FD3        		CALL	BUFSIZ
  D35A  CD2CCF        		CALL	S27DTA
  D35D  C6FE          		ADD	A,0FEH
  D35F  D8            		RET	C
  D360  7C            		LD	A,H
  D361  B5            		OR	L
  D362  2814          		JR	Z,TYPEE
  D364  010001        		LD	BC,00100H
  D367                	TYPE3:
  D367  0A            		LD	A,(BC)
  D368  03            		INC	BC
  D369  FE1A          		CP	01AH
  D36B  280B          		JR	Z,TYPEE
  D36D  5F            		LD	E,A
  D36E  CDD3D7        		CALL	_SYS02		;(BDOS)コンソール出力
  D371  2B            		DEC	HL
  D372  7C            		LD	A,H
  D373  B5            		OR	L
  D374  20F1          		JR	NZ,TYPE3
  D376  18DF          		JR	TYPE2
  D378                	TYPEE:
  D378  CDFCCE        		CALL	OPEN2
  D37B  18D1          		JR	TYPE1
                      	
  D37D                	CWILD:
  D37D  215D00        		LD	HL,FCB1+1
  D380                	CWILD1:
  D380  7E            		LD	A,(HL)
  D381  FE20          		CP	020H
  D383  C0            		RET	NZ
  D384                	CWILD2:
  D384  54            		LD	D,H
  D385  5D            		LD	E,L
  D386  13            		INC	DE
  D387  010A00        		LD	BC,10
  D38A  363F          		LD	(HL),'?'
  D38C  EDB0          		LDIR
  D38E  C9            		RET
                      	
  D38F                	BUFSIZ:
  D38F  3A0700        		LD	A,(SYSTEM+2)
  D392  D603          		SUB	3
  D394  E6F8          		AND	0F8H
  D396  67            		LD	H,A
  D397  2E00          		LD	L,0
  D399  C9            		RET
                      	
                      	
                      	;LDOS.ASM
                      	
                      	;	LSX-Dodgers OS
                      	
  D39A                	BOOT:
  D39A  C30000        		JP	0
  D39D                	_SYS00:		;(BDOS)プログラム終了
  D39D                	WBOOT:
  D39D  C30BCE        		JP	WBOOT1
  D3A0                	CONST_:
  D3A0  C34DD8        		JP	CONSTX
  D3A3                	_SYS07:		;(BDOS)コンソール直接入力
  D3A3                	CONIN:
  D3A3  C3F4D7        		JP	FLGET
  D3A6                	CONOUT:
  D3A6  C3A1DA        		JP	CONOUT1
                      	
  D3A9                	BDOS0:
  D3A9  E5            		PUSH	HL
  D3AA  210001        		LD	HL,00100H
  D3AD  39            		ADD	HL,SP
  D3AE  3810          		JR	C,BDOS1X	;EXTSP = 0FFD4H
  D3B0                	BDOS2:
  D3B0  E1            		POP	HL
  D3B1  ED73BCD3      		LD	(BDSP+1),SP
  D3B5  31D4FF        		LD	SP,EXTSP
  D3B8  CDBFD3        		CALL	BDOS1
  D3BB  310000        	BDSP:	LD	SP,0
  D3BE  C9            		RET
  D3BF                	BDOS1:
  D3BF  E5            		PUSH	HL
  D3C0                	BDOS1X:
  D3C0  79            		LD	A,C
  D3C1  FE31          		CP	031H
  D3C3  300A          		JR	NC,OVERFN
  D3C5  87            		ADD	A,A
  D3C6  6F            		LD	L,A
  D3C7  26EC          		LD	H,STABLE/256
  D3C9  7E            		LD	A,(HL)
  D3CA  2C            		INC	L
  D3CB  66            		LD	H,(HL)
  D3CC  6F            		LD	L,A
  D3CD  E3            		EX	(SP),HL
  D3CE  C9            		RET
  D3CF                	OVERFN
  D3CF  E1            		POP	HL
  D3D0                	_ERROR:
  D3D0                	_SYS2B:		;(BDOS)日付の設定
  D3D0                	_SYS2D:		;(BDOS)時刻の設定
  D3D0                	_SYS05:		;(BDOS)プリンタ出力
  D3D0  37            		SCF			;CF=1
  D3D1  9F            		SBC	A,A		;A=0FFH
  D3D2  C9            		RET
  D3D3                	_SYS1C:		;(BDOS)ディスクの書き込み禁止化
  D3D3                	_SYS1E:		;(BDOS)ファイル属性の設定
  D3D3                	_SYS20:		;(BDOS)利用者番号の設定と読み出し
  D3D3                	_SYS2E:		;(BDOS)ベリファイ・フラグの設定
  D3D3  AF            		XOR	A
  D3D4  C9            		RET
                      	
  D3D5                	_SYS09:		;文字列出力
  D3D5  D5            		PUSH	DE
  D3D6                	_SX09:
  D3D6  1A            		LD	A,(DE)
  D3D7  13            		INC	DE
  D3D8  FE24          		CP	'$'
  D3DA  282C          		JR	Z,SX0E2
  D3DC  D5            		PUSH	DE
  D3DD  5F            		LD	E,A
  D3DE  CDD3D7        		CALL	_SYS02
  D3E1  D1            		POP	DE
  D3E2  18F2          		JR	_SX09
                      	
  D3E4                	_SYS0C:		;(BDOS)バージョン番号の獲得
  D3E4  212200        		LD	HL,00022H
  D3E7  AF            		XOR	A
  D3E8  7D            		LD	A,L
  D3E9  C9            		RET
                      	
  D3EA                	_SYS0D:		;(BDOS)ディスク・リセット
  D3EA  CDDFEC        		CALL	_FFLUSH
  D3ED  E5            		PUSH	HL
  D3EE  218000        		LD	HL,00080H
  D3F1  228AEC        		LD	(_DTA),HL
  D3F4  E1            		POP	HL
  D3F5  D5            		PUSH	DE
  D3F6  1E00          		LD	E,0
  D3F8  3E            		DB	03EH
                      	
  D3F9                	_SYS0E:		;(BDOS)カレント・ドライブの設定
  D3F9  D5            		PUSH	DE
  D3FA  7B            		LD	A,E
  D3FB  DDE5          		PUSH	IX
  D3FD  CDDCEC        		CALL	_GETDPB
  D400  DDE1          		POP	IX
  D402  3804          		JR	C,SX0E2
  D404  7B            		LD	A,E
  D405  3287EC        		LD	(_DVSW),A
  D408                	SX0E2:
  D408  3E08          		LD	A,8
  D40A  D1            		POP	DE
  D40B  C9            		RET
                      	
  D40C                	_SYS0F:		;(BDOS)ファイルのオープン
  D40C  CDBFDD        		CALL	SETDRV
  D40F  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D412  C602          		ADD	A,002H		;Write
  D414  2848          		JR	Z,FEND0F
  D416  CDFAE0        		CALL	CHKWILDX
                      	
  D419  D4DFDD        		CALL	NC,SOPENX
  D41C                	_S16XX:
  D41C  3840          		JR	C,FEND0F
                      					;Directory location
  D41E  3A9FEC        		LD	A,(_FILEN)
  D421  FD7719        		LD	(IY+25),A	;(FCB)ディレクトリ・ロケーション
                      	;				_DIRF
  D424  3AA0EC        		LD	A,(_DIRF)
  D427  FD771D        		LD	(IY+29),A	;(FCB)ディレクトリ・モード
                      	;				_FBPS
  D42A  FD731E        		LD	(IY+30),E	;(FCB)ディレクトリ・ポジション
  D42D  FD721F        		LD	(IY+31),D
                      	;				Open(Read)
  D430  FD361CFF      		LD	(IY+28),0FFH	;(FCB)オープン・モード
                      	;				FILENAME
  D434  FDE5          		PUSH	IY
  D436  D1            		POP	DE
  D437  13            		INC	DE
  D438  010B00        		LD	BC,11
  D43B  EDB0          		LDIR
                      	;				Attribute
  D43D  7E            		LD	A,(HL)
  D43E  FD770D        		LD	(IY+13),A	;(FCB)属性(アトリビュート)
  D441  110B00        		LD	DE,11		;Reserved
  D444  19            		ADD	HL,DE
                      						;(FCB)ファイルを最後に変更した時刻
  D445  11EAEB        		LD	DE,SDDATA		;(FCB)ファイルを最後に変更した日付
  D448  060A          		LD	B,SDDATAE-SDDATA	;(FCB)ファイルの先頭クラスタ
  D44A                	S16LOOP:				;(FCB)ファイルのサイズ(バイト単位)
  D44A  1A            		LD	A,(DE)
  D44B  13            		INC	DE
  D44C  3253D4        		LD	(S16PAT+2),A
  D44F  7E            		LD	A,(HL)
  D450  23            		INC	HL
  D451  FD7700        	S16PAT:	LD	(IY+0),A
  D454  10F4          		DJNZ	S16LOOP
                      	
  D456  AF            		XOR	A
  D457  FD770C        		LD	(IY+12),A	;(FCB)カレント・ブロック
  D45A  FD221CD5      		LD	(OFCB+1),IY
  D45E                	FEND0F:
  D45E  C303D5        		JP	FEND
                      	
  D461                	_SYS10:		;(BDOS)ファイルのクローズ
  D461  CDBFDD        		CALL	SETDRV
  D464  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D467  D6FE          		SUB	0FEH
  D469  37            		SCF
  D46A  3F            		CCF
  D46B  2032          		JR	NZ,FEND10
  D46D                	_S10A:				;Write
  D46D  FD770E        		LD	(IY+14),A	;(FCB)レコード・サイズ/アクセスするディレクトリのクラスタ番号+1
  D470  FD770F        		LD	(IY+15),A
                      	
  D473  FD341C        		INC	(IY+28)		;0FEH->0FFH ;オープン・モード
  D476  CDF3E1        		CALL	SETTMS
                      	
  D479  FD7E1D        		LD	A,(IY+29)	;(FCB)ディレクトリ・モード
  D47C  32A0EC        		LD	(_DIRF),A
  D47F  FD5E1E        		LD	E,(IY+30)	;(FCB)ディレクトリ・ポジション
  D482  FD561F        		LD	D,(IY+31)
  D485  CD14DF        		CALL	DC
  D488  3879          		JR	C,FEND
                      	
  D48A  FD7E19        		LD	A,(IY+25)	;(FCB)ディレクトリ・ロケーション
  D48D  E61F          	SDECM1:	AND	01FH		;自己書き換え(1セクタ辺りのディレクトリエントリ数-1) 1024=01FH / 512=00FH / 256=7
  D48F  6F            		LD	L,A
  D490  2600          		LD	H,0
  D492  29            		ADD	HL,HL		;*2
  D493  29            		ADD	HL,HL		;*4
  D494  29            		ADD	HL,HL		;*8
  D495  29            		ADD	HL,HL		;*16
  D496  29            		ADD	HL,HL		;*32
  D497  ED4B7EEC      		LD	BC,(_DTBUF)
  D49B  09            		ADD	HL,BC
                      	
  D49C  CD0AE1        		CALL	SDIRENT
  D49F                	FEND10:
  D49F  1862          		JR	FEND
                      	
  D4A1                	OPENDD:
  D4A1  FD361CFD      		LD	(IY+28),0FDH	;(FCB)オープン・モード
  D4A5  FD360D20      		LD	(IY+13),020H	;(FCB)属性(アトリビュート)
  D4A9  CDF8E1        		CALL	SETTMSX
  D4AC  1855          		JR	FEND
                      	
  D4AE                	_SYS11:		;(BDOS)最初のファイルの検索
  D4AE  CDBFDD        		CALL	SETDRV
  D4B1  CD5BDF        		CALL	CHKDDX
  D4B4  3818          		JR	C,_S11A
  D4B6  FDE5          		PUSH	IY
  D4B8  E1            		POP	HL
  D4B9  ED5B8AEC      		LD	DE,(_DTA)
  D4BD  010C00        		LD	BC,12
  D4C0  EDB0          		LDIR
  D4C2  3E20          		LD	A,020H
  D4C4  12            		LD	(DE),A
  D4C5  13            		INC	DE
  D4C6  62            		LD	H,D
  D4C7  6B            		LD	L,E
  D4C8  13            		INC	DE
  D4C9  0E13          		LD	C,19
  D4CB  70            		LD	(HL),B
  D4CC  1833          		JR	_S11B
  D4CE                	_S11A:
  D4CE  CD13DE        		CALL	SOPEN
  D4D1                	_S12X1:
  D4D1  3830          		JR	C,FEND
  D4D3  CDB1DE        		CALL	SOPENE2
  D4D6  ED5B8AEC      		LD	DE,(_DTA)
  D4DA  3A88EC        		LD	A,(_DRV)
  D4DD  3C            		INC	A
  D4DE  12            		LD	(DE),A
  D4DF  D5            		PUSH	DE
  D4E0  13            		INC	DE
  D4E1  012000        		LD	BC,32
  D4E4  EDB0          		LDIR
  D4E6  FD6E0E        		LD	L,(IY+14)	;(FCB)レコード・サイズ/アクセスするディレクトリのクラスタ番号+1
  D4E9  FD660F        		LD	H,(IY+15)
  D4EC  22F4EB        		LD	(SCDIR),HL
  D4EF  2A9AEC        		LD	HL,(_FBPS)
  D4F2  22F6EB        		LD	(SFBPS),HL
  D4F5  2A9FEC        		LD	HL,(_FILEN)
  D4F8  22F8EB        		LD	(SFNDF),HL	;Directory position and Flags
  D4FB  E1            		POP	HL
  D4FC  119EE2        		LD	DE,SFILE
  D4FF  0E21          		LD	C,33
  D501                	_S11B:
  D501  EDB0          		LDIR
  D503                	FEND:
  D503  9F            		SBC	A,A		;CF=0 A=0 : CF=1 A=0FFH
  D504                	FENDE:
  D504  FDE1          		POP	IY
  D506  C1            		POP	BC
  D507  D1            		POP	DE
  D508  E1            		POP	HL
  D509  C9            		RET
                      	
  D50A                	_SYS12:		;(BDOS)次のファイルの検索
  D50A  E5            		PUSH	HL
  D50B  D5            		PUSH	DE
  D50C  C5            		PUSH	BC
  D50D  FDE5          		PUSH	IY
  D50F  CD7BDE        		CALL	NOPEN
  D512  18BD          		JR	_S12X1
                      	
  D514                	_S16K:
  D514  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  D517  FEFD          		CP	0FDH		;Device(0FDH)
  D519  37            		SCF
  D51A  C8            		RET	Z
                      	
  D51B  110000        	OFCB:	LD	DE,0
  D51E  D5            		PUSH	DE
  D51F  061A          		LD	B,26		;First cluster
  D521                	S16K1:
  D521  13            		INC	DE
  D522  23            		INC	HL
  D523  10FC          		DJNZ	S16K1
                      	
  D525  1A            		LD	A,(DE)
  D526  BE            		CP	(HL)
  D527  2013          		JR	NZ,S16K2
  D529  13            		INC	DE
  D52A  23            		INC	HL
  D52B  1A            		LD	A,(DE)
  D52C  BE            		CP	(HL)
  D52D  200D          		JR	NZ,S16K2
                      	
  D52F  E1            		POP	HL
  D530  FDE5          		PUSH	IY
  D532  D1            		POP	DE
  D533  1A            		LD	A,(DE)		;Drive
  D534  BE            		CP	(HL)
  D535  2005          		JR	NZ,S16K2
                      					;ここはCFが必ず0
  D537  ED52          		SBC	HL,DE		;CP HL,DE
  D539  37            		SCF
  D53A  C0            		RET	NZ
  D53B  E5            		PUSH	HL
  D53C                	S16K2:
  D53C  E1            		POP	HL
  D53D  FDE5          		PUSH	IY
  D53F  D1            		POP	DE
  D540                	_SYS13:		;(BDOS)ファイルの削除
  D540  CDBFDD        		CALL	SETDRV
  D543  CD24E0        		CALL	KILL
  D546                	FEND13:
  D546  18BB          		JR	FEND
                      	
  D548                	_SYS14:		;(BDOS)シーケンシャルな読み出し
  D548  CDBFDD        		CALL	SETDRV
  D54B  CD25E2        		CALL	PUSHRR
  D54E  CD66E2        		CALL	GETSEQ
                      	
  D551  CD7AE2        		CALL	RB_READ
  D554  E5            		PUSH	HL
  D555  CD39E2        		CALL	SETSEQ
  D558                	SREAD:
  D558  E1            		POP	HL
                      	
  D559  C601          		ADD	A,001H
  D55B  38A6          		JR	C,FEND
                      	
  D55D  7D            		LD	A,L
  D55E  D601          		SUB	001H
  D560                	FENDX:
  D560  9F            		SBC	A,A
  D561  E603          		AND	3
  D563  1F            		RRA
  D564  189E          		JR	FENDE
                      	
  D566                	_SYS15:		;(BDOS)シーケンシャルな書き込み
  D566  CDBFDD        		CALL	SETDRV
  D569  CD25E2        		CALL	PUSHRR
  D56C  CD66E2        		CALL	GETSEQ
                      	
  D56F  CD73E2        		CALL	RB_WRITE
  D572  E5            		PUSH	HL
  D573  CD39E2        		CALL	SETSEQ
  D576                	SWRITE:
  D576  E1            		POP	HL
                      	
  D577  C6FF          		ADD	A,0FFH
  D579  18E5          		JR	FENDX
                      	
  D57B                	_SYS17:		;(BDOS)ファイル名の変更
  D57B  CDBFDD        		CALL	SETDRV
  D57E  CD80E0        		CALL	NAME
  D581  18C3          		JR	FEND13
                      	
  D583                	_SYS16:		;(BDOS)ファイルの作成
  D583  CDBFDD        		CALL	SETDRV
                      	
  D586  CDFAE0        		CALL	CHKWILDX
  D589  38BB          		JR	C,FEND13
  D58B  FD7E01        		LD	A,(IY+1)	;(FCB)主ファイル名
  D58E  FE05          		CP	5
  D590  2805          		JR	Z,_S16X2
  D592  FE21          		CP	021H
  D594  DA46D5        		JP	C,FEND13
  D597                	_S16X2:
                      	;				Clear FCB
  D597  FDE5          		PUSH	IY
  D599  E1            		POP	HL
  D59A  011000        		LD	BC,16
  D59D  09            		ADD	HL,BC
  D59E                	_S16X1:
  D59E  70            		LD	(HL),B		;B=0
  D59F  23            		INC	HL
  D5A0  0D            		DEC	C
  D5A1  20FB          		JR	NZ,_S16X1
                      	
  D5A3  CDF8E1        		CALL	SETTMSX
  D5A6  FD360DFF      		LD	(IY+13),0FFH	;(FCB)Attribute
  D5AA  CDDFDD        		CALL	SOPENX
  D5AD  3F            		CCF
  D5AE  CC14D5        		CALL	Z,_S16K
  D5B1  D4C2DE        		CALL	NC,COPEN
  D5B4  D40AE1        		CALL	NC,SDIRENT
  D5B7  C31CD4        		JP	_S16XX
                      	
  D5BA                	_SYS21:		;(BDOS)ランダムな読み出し
                      	
  D5BA  CDBFDD        		CALL	SETDRV
  D5BD  CD25E2        		CALL	PUSHRR
  D5C0  FD6E21        		LD	L,(IY+33)	;(FCB)Random record
  D5C3  FD6622        		LD	H,(IY+34)
                      	
  D5C6  CD7AE2        		CALL	RB_READ
  D5C9  E5            		PUSH	HL
  D5CA  CD50E2        		CALL	POPRR
  D5CD  1889          		JR	SREAD
                      	
  D5CF                	_SYS22:		;(BDOS)ランダムな書き込み
  D5CF                	_SYS28:		;(BDOS)ランダムな書き込み・その2
  D5CF  CDBFDD        		CALL	SETDRV
  D5D2  CD25E2        		CALL	PUSHRR
  D5D5  FD6E21        		LD	L,(IY+33)	;(FCB)Random record
  D5D8  FD6622        		LD	H,(IY+34)
                      	
  D5DB  CD73E2        		CALL	RB_WRITE
  D5DE  E5            		PUSH	HL
  D5DF  CD50E2        		CALL	POPRR
  D5E2  1892          		JR	SWRITE
                      	
  D5E4                	_SYS18:		;(BDOS)ログイン・ベクトルの獲得
  D5E4  21FF00        		LD	HL,000FFH
  D5E7  AF            		XOR	A
  D5E8  C9            		RET
                      	
  D5E9                	_SYS19:		;(BDOS)カレント・ドライブ番号の獲得
  D5E9  3A87EC        		LD	A,(_DVSW)
  D5EC  A7            		AND	A
  D5ED  C9            		RET
                      	
  D5EE                	_SYS1A:		;(BDOS)DTAの設定
  D5EE  ED538AEC      		LD	(_DTA),DE
  D5F2  AF            		XOR	A
  D5F3  C9            		RET
                      	
  D5F4                	_SYS1B:		;(BDOS)ディスク情報の獲得
  D5F4  7B            		LD	A,E
  D5F5  CDD2DD        		CALL	GETDRV
  D5F8  CDDCEC        		CALL	_GETDPB
  D5FB  D4E2EC        		CALL	NC,_RDFATX
  D5FE  210000        		LD	HL,0
  D601  D4D8E1        		CALL	NC,DSKF
                      	
  D604  ED5BD9E1      		LD	DE,(MAXCLP+1)	;DPB_08_MAXCL-1
  D608  1B            		DEC	DE		;DE←クラスタの総数
  D609  FD2A7CEC      		LD	IY,(_FATBF)	;IY←メモリ上のFATの先頭アドレス
  D60D  9F            		SBC	A,A
  D60E  D8            		RET	C
  D60F  4F            		LD	C,A		;C=0
  D610  DD7E0F        		LD	A,(IX+00FH)	;DPB_0F_BPS
  D613  E60F          		AND	00FH
  D615  47            		LD	B,A
  D616  DD7E07        		LD	A,(IX+7)	;DPB_07_SECPCL
  D619  C9            		RET
                      	
  D61A                	_SYS1D:		;(BDOS)書き込みが禁止されているディスクの調査
  D61A  AF            		XOR	A
  D61B  67            		LD	H,A
  D61C  6F            		LD	L,A
  D61D  C9            		RET
                      	
  D61E                	_SYS1F:		;(BDOS)ディスク装置のパラメータの読み出し
  D61E  2100ED        		LD	HL,DEVICE
  D621  7B            		LD	A,E
  D622  C3DCEC        		JP	_GETDPB
                      	
  D625                	_SYS23:		;(BDOS)ファイル・サイズの獲得
  D625  E5            		PUSH	HL
  D626  2A1EEC        		LD	HL,(STABLE+2*00FH)	;ファイルのオープン
  D629  CD0F00        		CALL	JP_HL
  D62C  3814          		JR	C,_S23X1
                      	
  D62E  D5            		PUSH	DE		;EX DE,IY
  D62F  FDE3          		EX	(SP),IY		;
                      	;	POP	DE		;
                      	;	PUSH	DE		;DEを破壊しないように注意vv
  D631  CD56E2        		CALL	GETSIZE
  D634                	_S24X1:
  D634  FD7521        		LD	(IY+33),L	;(FCB)Random record
  D637  FD7422        		LD	(IY+34),H
  D63A  FD362300      		LD	(IY+35),0
                      	;	POP	DE		;^^^^^^^^^^^^^^^^^^^^^^^^
                      	;	PUSH	DE		;EX DE,IY
  D63E  FDE3          		EX	(SP),IY		;
  D640  D1            		POP	DE		;
                      	
  D641  AF            		XOR	A
  D642                	_S23X1:
  D642  E1            		POP	HL
  D643  C9            		RET
                      	
  D644                	_SYS24:		;(BDOS)ランダム・レコード・フィールドの設定
  D644  E5            		PUSH	HL
  D645  D5            		PUSH	DE		;EX DE,IY
  D646  FDE3          		EX	(SP),IY		;
                      	;	POP	DE		;
                      	;	PUSH	DE		;DEを破壊しないように注意vv
  D648  CD66E2        		CALL	GETSEQ
  D64B  18E7          		JR	_S24X1		;^^^^^^^^^^^^^^^^^^^^^^^^
                      	
  D64D                	_SYS29:		;(BDOS)ファイル名の解析
  D64D  C5            		PUSH	BC
  D64E  E5            		PUSH	HL
  D64F  CDD3DC        		CALL	FILE
  D652  E1            		POP	HL
  D653  C1            		POP	BC
  D654                	S29X1:
  D654  C5            		PUSH	BC
  D655  D5            		PUSH	DE
  D656  E5            		PUSH	HL
  D657  EB            		EX	DE,HL
  D658  21DB00        		LD	HL,FDRV
  D65B  010D00        		LD	BC,13
  D65E  EDB0          		LDIR
  D660  70            		LD	(HL),B
  D661  0E03          		LD	C,3
  D663  EDB0          		LDIR
  D665  E1            		POP	HL
  D666  D1            		POP	DE
  D667  C1            		POP	BC
  D668  AF            		XOR	A
  D669  C9            		RET
                      	
  D66A                	_SYS30:		;(BDOS)論理セクタを用いた書き込み
  D66A  C5            		PUSH	BC
  D66B  0154E8        		LD	BC,DWT16
  D66E  1804          		JR	S2FX
  D670                	_SYS2F:
  D670  C5            		PUSH	BC
  D671  0135E8        		LD	BC,DRD16
  D674                	S2FX:
  D674  ED4389D6      		LD	(S2FPAT+1),BC
  D678  CDDFEC        		CALL	_FFLUSH
                      	
  D67B  D5            		PUSH	DE
  D67C  E5            		PUSH	HL
  D67D  7D            		LD	A,L		;Drive
  D67E  CDD9EC        		CALL	_CHGDRV
  D681  380D          		JR	C,S30X2
  D683  44            		LD	B,H		;Number of clusters
  D684  2A8AEC        		LD	HL,(_DTA)
  D687                	S30X:
  D687  C5            		PUSH	BC
  D688  CD35E8        	S2FPAT:	CALL	DRD16
  D68B  C1            		POP	BC
  D68C  3802          		JR	C,S30X2
  D68E  10F7          		DJNZ	S30X
  D690                	S30X2:
  D690  E1            		POP	HL
  D691  D1            		POP	DE
  D692  C1            		POP	BC
  D693  9F            		SBC	A,A
  D694  C9            		RET
                      	
                      	;LDIO.ASM
                      	
                      	;	LSX-Dodgers IO
                      	
                      	
  D695                	BIOS:
  D695  E5            		PUSH	HL
  D696  210081        		LD	HL,08100H
  D699  39            		ADD	HL,SP
  D69A  E1            		POP	HL
  D69B  300E          		JR	NC,BIOS2
  D69D                	BIOS1:
  D69D  CDA5D6        		CALL	BIOS3
  D6A0  061E          		LD	B,01EH
  D6A2  ED79          		OUT	(C),A
  D6A4  C9            		RET
  D6A5                	BIOS3:
  D6A5  C5            		PUSH	BC
  D6A6  061D          		LD	B,01DH
  D6A8  ED79          		OUT	(C),A
  D6AA  C9            		RET
  D6AB                	BIOS2:
  D6AB  ED73B6D6      		LD	(SPPAT+1),SP	;スタックがBIOS-ROMと被っている場合
  D6AF  31D4FF        		LD	SP,EXTSP
  D6B2  CD9DD6        		CALL	BIOS1
  D6B5  310000        	SPPAT:	LD	SP,0
  D6B8  C9            		RET
                      	
  D6B9                	INT:
  D6B9  F5            		PUSH	AF
  D6BA  E5            		PUSH	HL
  D6BB  210001        		LD	HL,00100H
  D6BE  39            		ADD	HL,SP
  D6BF  380C          		JR	C,INTP1X
  D6C1  ED73C9D6      		LD	(INTSP+1),SP
  D6C5  CDD5D6        		CALL	INTP1
  D6C8  310000        	INTSP:	LD	SP,0
  D6CB  1803          		JR	INTPE
  D6CD                	INTP1X:
  D6CD  CDD5D6        		CALL	INTP1
  D6D0                	INTPE:
  D6D0  E1            		POP	HL
  D6D1                	INTPE2:
  D6D1  F1            		POP	AF
  D6D2                	INTCTCE:
  D6D2  FB            		EI
  D6D3  ED4D          		RETI
  D6D5                	INTP1:
  D6D5  C5            		PUSH	BC
                      	
  D6D6  CDDFDA        		CALL	IN49SB
  D6D9  67            		LD	H,A
  D6DA  CDDFDA        		CALL	IN49SB
  D6DD  6F            		LD	L,A
                      	
  D6DE  CB64          		BIT	4,H		;[GRAPH]
  D6E0  2010          		JR	NZ,SCEXE
  D6E2  7D            		LD	A,L
  D6E3  EE09          		XOR	9
  D6E5  282A          		JR	Z,DIAN
  D6E7  7C            		LD	A,H
  D6E8  0F            		RRCA			;[CTRL]
  D6E9  300F          		JR	NC,SCL
  D6EB  0F            		RRCA			;[SHIFT]
  D6EC  3804          		JR	C,SCEXE
  D6EE  3E80          		LD	A,080H
  D6F0  180F          		JR	SCG1
  D6F2                	SCEXE:
  D6F2  2292EC        		LD	(_KEYD),HL
  D6F5  CD46D7        		CALL	KEYSET1
                      	
  D6F8  C1            		POP	BC
  D6F9  C9            		RET
  D6FA                	SCL:
  D6FA  7D            		LD	A,L
  D6FB  FE08          		CP	008H
  D6FD  280D          		JR	Z,RESET
                      	
  D6FF  3E02          		LD	A,002H
  D701                	SCG1:
  D701  E5            		PUSH	HL
  D702  21BFEC        		LD	HL,WK1FD0
  D705  AE            		XOR	(HL)
  D706  CD97CC        		CALL	S1FD0
  D709  E1            		POP	HL
  D70A  18E6          		JR	SCEXE
                      	
  D70C                	RESET:
  D70C  3E1D          		LD	A,01DH
  D70E  D300          		OUT	(0),A
  D710  C7            		RST	0
                      	
  D711                	DIAN:
  D711  6F            		LD	L,A
  D712  C5            		PUSH	BC
  D713  01B01F        		LD	BC,01FB0H
  D716  ED78          		IN	A,(C)
  D718  EE80          		XOR	080H
  D71A  ED79          		OUT	(C),A
  D71C  C1            		POP	BC
  D71D  18D3          		JR	SCEXE
                      	
  D71F                	INTCTC2:
  D71F  F5            		PUSH	AF
  D720  3E00          	INTCPAT:LD	A,000H
  D722  3D            		DEC	A
  D723  3221D7        		LD	(INTCPAT+1),A
  D726  20A9          		JR	NZ,INTPE2
                      	
  D728  3A92EC        		LD	A,(_KEYD)
  D72B  B7            		OR	A
  D72C  28A3          		JR	Z,INTPE2
  D72E                	KEYSET0:
  D72E  E5            		PUSH	HL
  D72F  2A90EC        		LD	HL,(_KEYPS)
  D732  7C            		LD	A,H
  D733  AD            		XOR	L
  D734  2006          		JR	NZ,INTC2A
                      	
  D736  2A92EC        		LD	HL,(_KEYD)
  D739  CD70D7        		CALL	KEYSET
  D73C                	INTC2A:
  D73C  3A94EC        		LD	A,(_KEYSP)
  D73F  E60F          		AND	00FH
  D741  3221D7        		LD	(INTCPAT+1),A
                      	
  D744  188A          		JR	INTPE
                      	
  D746                	KEYSET1:
  D746  CB6C          		BIT	5,H
  D748  F5            		PUSH	AF
  D749  ED4B8CEC      		LD	BC,(_CTC)
  D74D  78            		LD	A,B
  D74E  B1            		OR	C
  D74F  2006          		JR	NZ,KEYS10E
                      	
  D751  F1            		POP	AF
  D752  201C          		JR	NZ,KEYSET
  D754  F5            		PUSH	AF
  D755  18D7          		JR	KEYSET0
  D757                	KEYS10E:
  D757  F1            		POP	AF
  D758  C8            		RET	Z
  D759  F5            		PUSH	AF
  D75A  3E03          		LD	A,3		;CTC STOP
  D75C  ED79          		OUT	(C),A
  D75E  F1            		POP	AF
                      	
  D75F  B7            		OR	A
  D760  C8            		RET	Z
                      	
  D761  E5            		PUSH	HL
  D762  2A94EC        		LD	HL,(_KEYSP)
  D765  3EA7          		LD	A,0A7H
  D767  ED79          		OUT	(C),A
  D769  ED69          		OUT	(C),L
  D76B  7C            		LD	A,H
  D76C  3221D7        		LD	(INTCPAT+1),A
  D76F  E1            		POP	HL
                      	
  D770                	KEYSET:
  D770  7D            		LD	A,L
  D771  CB7C          		BIT	7,H
  D773  CCA0D7        		CALL	Z,FKEY
  D776  CB74          		BIT	6,H
  D778  C0            		RET	NZ
  D779                	KEYBS:
  D779  B7            		OR	A
  D77A  C8            		RET	Z
  D77B                	KEYBS1:
  D77B  FE03          		CP	3
  D77D  CC93D7        		CALL	Z,KEYBC
  D780  E5            		PUSH	HL
  D781  F5            		PUSH	AF
  D782  2A90EC        		LD	HL,(_KEYPS)
  D785  2C            		INC	L
  D786  7D            		LD	A,L
  D787  BC            		CP	H
  D788  2812          		JR	Z,POP_AF_HL_SCF_RET
  D78A  3290EC        		LD	(_KEYPS),A
  D78D  26FE          		LD	H,KEYBF/256
  D78F  F1            		POP	AF
  D790  77            		LD	(HL),A
  D791  E1            		POP	HL
  D792  C9            		RET
                      	
  D793                	KEYBC:
  D793  E5            		PUSH	HL
  D794  210000        		LD	HL,0
  D797  2290EC        		LD	(_KEYPS),HL
  D79A  E1            		POP	HL
  D79B  C9            		RET
                      	
  D79C                	POP_AF_HL_SCF_RET:
  D79C  F1            		POP	AF
  D79D  E1            		POP	HL
  D79E  37            		SCF
  D79F  C9            		RET
                      	
  D7A0                	FKEY:
  D7A0  CB75          		BIT	6,L
  D7A2  C8            		RET	Z
  D7A3  3E1B          		LD	A,01BH
  D7A5  CD7BD7        		CALL	KEYBS1
  D7A8  7D            		LD	A,L
  D7A9  C6AF          		ADD	A,020H-'q'
  D7AB  CB7D          		BIT	7,L
  D7AD  C8            		RET	Z
  D7AE  2E50          		LD	L,'P'
  D7B0  D690          		SUB	0E1H+020H-'q'
  D7B2  2810          		JR	Z,KEYBSL
  D7B4  2C            		INC	L
  D7B5  3D            		DEC	A
  D7B6  280C          		JR	Z,KEYBSL
  D7B8  2C            		INC	L
  D7B9  D609          		SUB	0EBH-0E2H
  D7BB  2807          		JR	Z,KEYBSL
  D7BD  2E43          		LD	L,'C'
  D7BF  3D            		DEC	A
  D7C0  2802          		JR	Z,KEYBSL
  D7C2  2E58          		LD	L,'X'
  D7C4                	KEYBSL:
  D7C4  7D            		LD	A,L
  D7C5  18B4          		JR	KEYBS1
                      	
  D7C7                	_SYS01:		;(BDOS)コンソール入力
  D7C7  CDA3D3        		CALL	_SYS07
  D7CA                	MSG_:
  D7CA  F5            		PUSH	AF
  D7CB  D5            		PUSH	DE
  D7CC  5F            		LD	E,A
  D7CD  CDD3D7        		CALL	_SYS02
  D7D0  D1            		POP	DE
  D7D1  F1            		POP	AF
  D7D2  C9            		RET
                      	
  D7D3                	_SYS02:		;(BDOS)コンソール出力
  D7D3  CDE5D7        		CALL	BREAK
  D7D6  1805          		JR	PRINTX
                      	
  D7D8                	_SYS06:		;(BDOS)コンソール直接入出力
  D7D8  7B            		LD	A,E
  D7D9  3C            		INC	A
  D7DA  CACAEC        		JP	Z,_INKEY
  D7DD                	PRINTX:
  D7DD  C3CDEC        		JP	_PRINT
                      	
  D7E0                	_SYS08:		;(BDOS)エコーなしコンソール入力
  D7E0  CDA3D3        		CALL	_SYS07
  D7E3  1804          		JR	BREAK1
  D7E5                	BREAK:
  D7E5  FB            		EI
  D7E6  3A92EC        		LD	A,(_KEYD)
  D7E9                	BREAK1:
  D7E9  FE03          		CP	3
  D7EB  CA0000        		JP	Z,0
  D7EE  FE13          		CP	013H
  D7F0  C0            		RET	NZ
                      	
  D7F1                	PAUSE:
  D7F1  CD93D7        		CALL	KEYBC
                      	
  D7F4                	FLGET:
  D7F4  CDDFEC        		CALL	_FFLUSH
  D7F7  C5            		PUSH	BC
  D7F8  E5            		PUSH	HL
  D7F9  ED4B8EEC      		LD	BC,(_TXADR)
  D7FD  CBE8          		SET	5,B
  D7FF  ED60          		IN	H,(C)
  D801                	FLGET1:
  D801  3A93EC        		LD	A,(_KEYD+1)
  D804  0F            		RRCA
  D805  0F            		RRCA
  D806  E610          		AND	010H
  D808  F608          		OR	8
  D80A  ED68          		IN	L,(C)
  D80C  B5            		OR	L
  D80D  ED79          		OUT	(C),A
  D80F  CDCAEC        		CALL	_INKEY
  D812  28ED          		JR	Z,FLGET1
  D814  ED61          		OUT	(C),H
  D816  E1            		POP	HL
  D817  C1            		POP	BC
  D818  C9            		RET
                      	
  D819                	_SYS0A:		;(BDOS)文字列入力
  D819  C5            		PUSH	BC
  D81A  E5            		PUSH	HL
  D81B  D5            		PUSH	DE
  D81C  CD3ADC        		CALL	GETL
  D81F  1100FF        		LD	DE,KBUF
  D822  E1            		POP	HL
  D823  E5            		PUSH	HL
  D824  0E00          		LD	C,0
  D826  3004          		JR	NC,SAX0
  D828  23            		INC	HL
  D829  23            		INC	HL
  D82A  1808          		JR	SAX4
  D82C                	SAX0:
  D82C  46            		LD	B,(HL)
  D82D  23            		INC	HL
  D82E                	SAX1:
  D82E  23            		INC	HL
  D82F  1A            		LD	A,(DE)
  D830  13            		INC	DE
  D831  B7            		OR	A
  D832  2004          		JR	NZ,SAX2
  D834                	SAX4:
  D834  360D          		LD	(HL),00DH
  D836  1804          		JR	SAX3
  D838                	SAX2:
  D838  77            		LD	(HL),A
  D839  0C            		INC	C
  D83A  10F2          		DJNZ	SAX1
  D83C                	SAX3:
  D83C  D1            		POP	DE
  D83D  79            		LD	A,C
  D83E  13            		INC	DE
  D83F  12            		LD	(DE),A
  D840  1B            		DEC	DE
  D841  E1            		POP	HL
  D842  C1            		POP	BC
  D843  A7            		AND	A
  D844  C9            		RET
                      	
  D845                	_SYS0B:		;(BDOS)コンソール状態のチェック
  D845  CDE5D7        		CALL	BREAK
  D848  3A92EC        		LD	A,(_KEYD)
  D84B  B7            		OR	A
  D84C  C8            		RET	Z
  D84D                	CONSTX:
  D84D  CDDFEC        		CALL	_FFLUSH
  D850  E5            		PUSH	HL
  D851  2A90EC        		LD	HL,(_KEYPS)
  D854  7C            		LD	A,H
  D855  AD            		XOR	L
  D856  E1            		POP	HL
  D857  C6FF          		ADD	A,0FFH
  D859  9F            		SBC	A,A
  D85A  C9            		RET
                      	
  D85B                	_SYS2A:		;(BDOS)日付の獲得
  D85B  C5            		PUSH	BC
  D85C  3EED          		LD	A,0EDH		;Read calendar
  D85E  CDFADA        		CALL	COMOUT
  D861  CD7ED8        		CALL	IN49SB_BCD	;YY
  D864  6F            		LD	L,A
  D865  2600          		LD	H,0
                      	;	LD	DE,1900		;0076CH
                      	;	CP	90		;90以上は1900年代 1990-1999
                      	;	JR	NC,RDDATE1	;90未満は2000年代 2000-2089
                      	;	LD	E,0D0H		;2000 & 0FFH D=007H
  D867  11D007        		LD	DE,2000		;すべて2000年代で処理 2000-2099
  D86A                	RDDATE1:
  D86A  19            		ADD	HL,DE
  D86B  CDDFDA        		CALL	IN49SB		;MM
  D86E  57            		LD	D,A
  D86F  CD7ED8        		CALL	IN49SB_BCD	;DD
  D872  5F            		LD	E,A
  D873  7A            		LD	A,D
  D874  E607          		AND	7
  D876  0604          		LD	B,4
  D878                	RDDATE2:
  D878  CB3A          		SRL	D
  D87A  10FC          		DJNZ	RDDATE2
  D87C  C1            		POP	BC
  D87D  C9            		RET
  D87E                	IN49SB_BCD:
  D87E  CDDFDA        		CALL	IN49SB
                      	;------------------------
                      	;BCDの10進数化
                      	;in
                      	;	A  : BCD
                      	;out
                      	;	A  : 10進数
                      	;------------------------
  D881  4F            		LD	C,A
  D882  E6F0          		AND	0F0H	;10の位
  D884  0F            		RRCA
  D885  47            		LD	B,A
  D886  0F            		RRCA
  D887  0F            		RRCA
  D888  80            		ADD	A,B
  D889  47            		LD	B,A
  D88A  79            		LD	A,C
  D88B  E60F          		AND	00FH	;1の位
  D88D  80            		ADD	A,B
  D88E  C9            		RET
                      	
  D88F                	_SYS2C:		;(BDOS)時刻の獲得
  D88F  C5            		PUSH	BC
  D890  3EEF          		LD	A,0EFH		;Read time
  D892  CDFADA        		CALL	COMOUT
  D895  CD7ED8        		CALL	IN49SB_BCD	;TT
  D898  67            		LD	H,A
  D899  CD7ED8        		CALL	IN49SB_BCD	;MM
  D89C  6F            		LD	L,A
  D89D  CD7ED8        		CALL	IN49SB_BCD	;SS
  D8A0  57            		LD	D,A
  D8A1  C1            		POP	BC
  D8A2  AF            		XOR	A
  D8A3  C9            		RET
                      	
  D8A4                	MSX1:
  D8A4  5F            		LD	E,A
  D8A5  CDCDEC        		CALL	_PRINT
  D8A8                	MSX:
  D8A8  7E            		LD	A,(HL)
  D8A9  23            		INC	HL
  D8AA  B7            		OR	A
  D8AB  20F7          		JR	NZ,MSX1
  D8AD  C9            		RET
                      	
  D8AE                	ESC1:
  D8AE  7B            		LD	A,E
  D8AF  FE41          		CP	'A'
  D8B1  CAEDD9        		JP	Z,CTRL1E
  D8B4  FE42          		CP	'B'
  D8B6  CA65DB        		JP	Z,CTRL1F
  D8B9  FE43          		CP	'C'
  D8BB  CAFAD9        		JP	Z,CTRL1C
  D8BE  FE44          		CP	'D'
  D8C0  CAE3D9        		JP	Z,CTRL1D
  D8C3  FE45          		CP	'E'
  D8C5  2802          		JR	Z,CT0CX
  D8C7  FE6A          		CP	'j'
  D8C9                	CT0CX:
  D8C9  CA38DB        		JP	Z,CTRL0C
  D8CC  FE48          		CP	'H'
  D8CE  CA78DA        		JP	Z,CTRL0B
  D8D1  FE4A          		CP	'J'
  D8D3  CA3BDB        		JP	Z,CTRL1A
  D8D6  FE4B          		CP	'K'
  D8D8  CA3ADA        		JP	Z,CTRL05
  D8DB  FE4C          		CP	'L'
  D8DD  CA7ADB        		JP	Z,CTRL0E
  D8E0  FE78          		CP	'x'
  D8E2  2804          		JR	Z,ESC1X
  D8E4  FE79          		CP	'y'
  D8E6  2002          		JR	NZ,ESC1Y
  D8E8                	ESC1X:
  D8E8  3601          		LD	(HL),1
  D8EA                	ESC1Y:
  D8EA  FE3D          		CP	'='
  D8EC  2804          		JR	Z,ESC1W
  D8EE  FE59          		CP	'Y'
  D8F0  2002          		JR	NZ,ESC1Z
  D8F2                	ESC1W:
  D8F2  3602          		LD	(HL),2
  D8F4                	ESC1Z:
  D8F4  FE20          		CP	020H
  D8F6  3802          		JR	C,ESC1C
  D8F8  87            		ADD	A,A
  D8F9  D0            		RET	NC
  D8FA                	ESC1C:
  D8FA  E1            		POP	HL
  D8FB  184A          		JR	ANK
                      	
  D8FD                	ESC:
  D8FD  2158D9        		LD	HL,PRINTE5
  D900  E5            		PUSH	HL
  D901  2123D9        		LD	HL,ESCFLG+1
  D904  3600          		LD	(HL),0
  D906  3D            		DEC	A
  D907  28A5          		JR	Z,ESC1
  D909  3D            		DEC	A
  D90A  2009          		JR	NZ,ESC2
  D90C  3603          		LD	(HL),3
  D90E  7B            		LD	A,E
  D90F  D620          		SUB	020H
  D911  3218D9        		LD	(ESCYP+1),A
  D914  C9            		RET
  D915                	ESC2:
  D915  3D            		DEC	A
  D916  C0            		RET	NZ
  D917  2600          	ESCYP:	LD	H,0
  D919  7B            		LD	A,E
  D91A  D620          		SUB	020H
  D91C  6F            		LD	L,A
  D91D  C3D6EC        		JP	_LOC
                      	
  D920                	PRINT:
  D920  C5            		PUSH	BC
  D921  E5            		PUSH	HL
  D922  3E00          	ESCFLG:	LD	A,000H
  D924  B7            		OR	A
  D925  20D6          		JR	NZ,ESC
                      	
  D927  3E1F          		LD	A,01FH
  D929  BB            		CP	E
  D92A  3030          		JR	NC,CTRL
  D92C                	PRINTC:
  D92C  A7            	INSFLG:	AND	A
  D92D  DC03DB        		CALL	C,CTRL12
                      	
  D930  3E00          	KANFLG:	LD	A,000H
  D932  B7            		OR	A
  D933  203F          		JR	NZ,KANJI2
  D935  7B            	X1KPAT:	LD	A,E
  D936  FE80          		CP	080H
  D938  380D          		JR	C,ANK
  D93A  FEA0          		CP	0A0H
  D93C  3804          		JR	C,KANJI1
  D93E  FEE0          		CP	0E0H
  D940  3805          		JR	C,ANK
  D942                	KANJI1:
  D942  3231D9        		LD	(KANFLG+1),A
  D945  1811          		JR	PRINTE5
  D947                	ANK:
  D947  ED4B8EEC      		LD	BC,(_TXADR)
  D94B  78            		LD	A,B
  D94C  F638          		OR	038H
  D94E  47            		LD	B,A
  D94F  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令	kanji
  D951  CB98          		RES	3,B
  D953  ED59          		OUT	(C),E		;Text
  D955                	KANJIE:
  D955  CDBFD9        		CALL	PRINTE7
  D958                	PRINTE5:
  D958  E1            		POP	HL
  D959  C1            		POP	BC
  D95A  AF            		XOR	A
  D95B  C9            		RET
                      	
  D95C                	CTRL:
  D95C  CDA6D9        		CALL	KANCLR
  D95F  3EA7          		LD	A,0A7H		;AND	A
  D961  322CD9        		LD	(INSFLG),A
  D964  7B            		LD	A,E
  D965  87            		ADD	A,A
  D966  F680          		OR	080H
  D968  6F            		LD	L,A
  D969  26EB          		LD	H,CTRLTB/256
  D96B  7E            		LD	A,(HL)
  D96C  2C            		INC	L
  D96D  66            		LD	H,(HL)
  D96E  6F            		LD	L,A
  D96F  CD0F00        		CALL	JP_HL
  D972  18E4          		JR	PRINTE5
                      	
  D974                	KANJI2:
  D974  D5            		PUSH	DE
  D975  57            		LD	D,A
  D976  01812F        		LD	BC,02F81H	;SFTJIS
  D979  DF            		RST	018H
  D97A  01C32F        		LD	BC,02FC3H	;Instead or JISVRM
  D97D  DF            		RST	018H
                      	
  D97E  ED4B8EEC      		LD	BC,(_TXADR)
  D982  78            		LD	A,B
  D983  F638          		OR	038H
  D985  47            		LD	B,A
  D986  ED51          		OUT	(C),D		;kanji
  D988  CB98          		RES	3,B
  D98A  ED59          		OUT	(C),E		;Text
  D98C  CDBFD9        		CALL	PRINTE7
  D98F  ED4B8EEC      		LD	BC,(_TXADR)
  D993  78            		LD	A,B
  D994  F638          		OR	038H
  D996  47            		LD	B,A
  D997  CBF2          		SET	6,D
  D999  ED51          		OUT	(C),D		;Kanji
  D99B  CB98          		RES	3,B
  D99D  ED59          		OUT	(C),E		;Text
  D99F  D1            		POP	DE
  D9A0  AF            		XOR	A
  D9A1  3231D9        		LD	(KANFLG+1),A
  D9A4  18AF          		JR	KANJIE
                      	
  D9A6                	KANCLR:
  D9A6  3A31D9        		LD	A,(KANFLG+1)
  D9A9  B7            		OR	A
  D9AA  C8            		RET	Z
  D9AB  ED4B8EEC      		LD	BC,(_TXADR)
  D9AF  78            		LD	A,B
  D9B0  F638          		OR	038H
  D9B2  47            		LD	B,A
  D9B3  AF            		XOR	A
  D9B4  3231D9        		LD	(KANFLG+1),A
  D9B7  ED79          		OUT	(C),A		;Kanji
  D9B9  CB98          		RES	3,B
  D9BB  3E20          		LD	A,020H
  D9BD  ED79          		OUT	(C),A		;Text
  D9BF                	PRINTE7:
  D9BF  CBA0          		RES	4,B
  D9C1                	PRINTE6:
  D9C1  3A96EC        		LD	A,(_COLORF)
  D9C4                	PRINTE4:
  D9C4  ED79          		OUT	(C),A		;Color
  D9C6  78            		LD	A,B
  D9C7  E607          		AND	7
  D9C9  47            		LD	B,A
  D9CA                	PRINTE2:
  D9CA  03            		INC	BC
  D9CB                	PRINTE3:
  D9CB  2ABAEC        		LD	HL,(CRTCD+10)
  D9CE  A7            		AND	A
  D9CF  ED4A          		ADC	HL,BC
  D9D1                	PRINTE8:
  D9D1  2805          		JR	Z,PRINT2
  D9D3                	PRINTE1:
  D9D3  ED438EEC      		LD	(_TXADR),BC
  D9D7                	PRINTE:
  D9D7  C9            		RET
                      	
  D9D8                	PRINT2:
  D9D8  CD80DB        		CALL	SCR
  D9DB  2ABCEC        		LD	HL,(CRTCD+12)
  D9DE  09            		ADD	HL,BC
  D9DF  228EEC        		LD	(_TXADR),HL
  D9E2  C9            		RET
                      	
  D9E3                	CTRL08:
  D9E3                	CTRL1D:
  D9E3  ED4B8EEC      		LD	BC,(_TXADR)
  D9E7  78            		LD	A,B
  D9E8  B1            		OR	C
  D9E9  C8            		RET	Z
  D9EA  0B            		DEC	BC
  D9EB  18E6          		JR	PRINTE1
                      	
  D9ED                	CTRL1E:
  D9ED  ED4B8EEC      		LD	BC,(_TXADR)
  D9F1  2ABCEC        		LD	HL,(CRTCD+12)
  D9F4  09            		ADD	HL,BC
  D9F5  D0            		RET	NC
  D9F6  44            		LD	B,H
  D9F7  4D            		LD	C,L
  D9F8  18D9          		JR	PRINTE1
                      	
  D9FA                	CTRL1C:
  D9FA  ED4B8EEC      		LD	BC,(_TXADR)
  D9FE  18CA          		JR	PRINTE2
                      	
  DA00                	CTRL09:
  DA00  ED4B8EEC      		LD	BC,(_TXADR)
  DA04  79            		LD	A,C
  DA05  E6F8          		AND	0F8H
  DA07  C608          		ADD	A,8
  DA09  4F            		LD	C,A
  DA0A  88            		ADC	A,B
  DA0B  91            		SUB	C
  DA0C  47            		LD	B,A
  DA0D  18BC          		JR	PRINTE3
                      	
  DA0F                	CTRL02:
  DA0F  2A8EEC        		LD	HL,(_TXADR)
  DA12  7C            		LD	A,H
  DA13  B5            		OR	L
  DA14  C8            		RET	Z
  DA15  2B            		DEC	HL
  DA16  228EEC        		LD	(_TXADR),HL
  DA19  D5            		PUSH	DE
  DA1A  CDD3EC        		CALL	_POS
  DA1D  3AB1EC        		LD	A,(CRTCD+1)
  DA20  95            		SUB	L
  DA21  6F            		LD	L,A
  DA22  2D            		DEC	L
  DA23  2638          		LD	H,038H
  DA25  ED4B8EEC      		LD	BC,(_TXADR)
  DA29  09            		ADD	HL,BC
  DA2A  44            		LD	B,H
  DA2B  4D            		LD	C,L
  DA2C  110020        		LD	DE,02000H	;D:Text E:kanji
  DA2F  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DA32                	C8X1:
  DA32  CD1FDB        		CALL	C12S
  DA35  0B            		DEC	BC
  DA36  20FA          		JR	NZ,C8X1
  DA38  D1            		POP	DE
  DA39  C9            		RET
                      	
  DA3A                	CTRL05:
  DA3A  CDD3EC        		CALL	_POS
  DA3D  3AB1EC        		LD	A,(CRTCD+1)
  DA40  95            		SUB	L
  DA41  6F            		LD	L,A
  DA42  2620          		LD	H,020H
  DA44  ED4B8EEC      		LD	BC,(_TXADR)
  DA48                	C05X1:
  DA48  78            		LD	A,B
  DA49  F638          		OR	038H
  DA4B  47            		LD	B,A
  DA4C  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令	kanji
  DA4E  CB98          		RES	3,B
  DA50  ED61          		OUT	(C),H		;Text
  DA52  CBA0          		RES	4,B
  DA54  3A96EC        		LD	A,(_COLORF)
  DA57  ED79          		OUT	(C),A		;Color
  DA59  03            		INC	BC
  DA5A  2D            		DEC	L
  DA5B  20EB          		JR	NZ,C05X1
  DA5D  C9            		RET
                      	
  DA5E                	CTRL0D:
  DA5E  CDD3EC        		CALL	_POS
  DA61  2E00          		LD	L,0
  DA63                	LOC:
  DA63  C5            		PUSH	BC
  DA64  E5            		PUSH	HL
  DA65  CDA6D9        		CALL	KANCLR
  DA68  CD8BDA        		CALL	LOC1
  DA6B  ED438EEC      		LD	(_TXADR),BC
  DA6F  E1            		POP	HL
  DA70  C1            		POP	BC
  DA71  C9            		RET
                      	
  DA72                	CTRL01:
  DA72  3E37          		LD	A,037H		;SCF
  DA74  322CD9        		LD	(INSFLG),A
  DA77  C9            		RET
                      	
  DA78                	CTRL0B:
  DA78  210000        		LD	HL,0
  DA7B  228EEC        		LD	(_TXADR),HL
  DA7E  C9            		RET
                      	
  DA7F                	PRINTS:
  DA7F  CDE5D7        		CALL	BREAK
  DA82  C3CDEC        		JP	_PRINT
                      	
  DA85                	CTRL1B:
  DA85  3E01          		LD	A,1
  DA87  3223D9        		LD	(ESCFLG+1),A
  DA8A  C9            		RET
                      	
  DA8B                	LOC1:
  DA8B  44            		LD	B,H
  DA8C  4D            		LD	C,L
  DA8D  04            		INC	B
  DA8E  05            		DEC	B
  DA8F  C8            		RET	Z
  DA90  D5            		PUSH	DE
  DA91  ED5BB1EC      		LD	DE,(CRTCD+1)
  DA95  210000        		LD	HL,0
  DA98  55            		LD	D,L
  DA99                	LOC2:
  DA99  19            		ADD	HL,DE
  DA9A  10FD          		DJNZ	LOC2
  DA9C  09            		ADD	HL,BC
  DA9D  D1            		POP	DE
  DA9E                	LOC3:
  DA9E  44            		LD	B,H
  DA9F  4D            		LD	C,L
  DAA0  C9            		RET
                      	
  DAA1                	CONOUT1:
  DAA1  CDB3DA        		CALL	CURSOR
  DAA4  59            		LD	E,C
  DAA5  CDCDEC        		CALL	_PRINT
  DAA8  7B            		LD	A,E
  DAA9  FE0A          		CP	00AH
  DAAB  2006          		JR	NZ,CURSOR
  DAAD  CD5EDA        		CALL	CTRL0D
  DAB0  CD3ADA        		CALL	CTRL05
  DAB3                	CURSOR:
  DAB3  C5            		PUSH	BC
  DAB4  ED4B8EEC      		LD	BC,(_TXADR)
  DAB8  CBE8          		SET	5,B
  DABA  ED78          		IN	A,(C)
  DABC  EE18          		XOR	018H
  DABE  ED79          		OUT	(C),A
  DAC0  C1            		POP	BC
  DAC1  C9            		RET
                      	
  DAC2                	CTRL07:
  DAC2  2170EB        		LD	HL,BEEPD
  DAC5                	BEEP1:
  DAC5  7E            		LD	A,(HL)
  DAC6  23            		INC	HL
  DAC7  FEFF          		CP	0FFH
  DAC9  C8            		RET	Z
  DACA  F3            		DI
  DACB  061C          		LD	B,01CH
  DACD  ED79          		OUT	(C),A
  DACF  EDA3          		OUTI
  DAD1  FB            		EI
  DAD2  18F1          		JR	BEEP1
                      	
  DAD4                	OT49SB:
  DAD4  C5            		PUSH	BC
  DAD5  CDF0DA        		CALL	CANW
  DAD8  010019        		LD	BC,01900H
  DADB  ED79          		OUT	(C),A
  DADD  C1            		POP	BC
  DADE  C9            		RET
                      	
  DADF                	IN49SB:
  DADF  C5            		PUSH	BC
  DAE0  01011A        		LD	BC,01A01H
  DAE3                	CANR:
  DAE3  ED78          		IN	A,(C)
  DAE5  E620          		AND	020H
  DAE7  20FA          		JR	NZ,CANR
  DAE9  010019        		LD	BC,01900H
  DAEC  ED78          		IN	A,(C)
  DAEE  C1            		POP	BC
  DAEF  C9            		RET
                      	
  DAF0                	CANW:
  DAF0  01011A        		LD	BC,01A01H
  DAF3  ED48          		IN	C,(C)
  DAF5  CB71          		BIT	6,C
  DAF7  20F7          		JR	NZ,CANW
  DAF9  C9            		RET
                      	
  DAFA                	COMOUT:
  DAFA  FB            		EI
  DAFB  CDD4DA        		CALL	OT49SB
  DAFE  CDF0DA        		CALL	CANW
  DB01  F3            		DI
  DB02  C9            		RET
                      	
  DB03                	CTRL12:
  DB03  D5            		PUSH	DE
  DB04  CDD3EC        		CALL	_POS
  DB07  3AB1EC        		LD	A,(CRTCD+1)
  DB0A  95            		SUB	L
  DB0B  ED4B8EEC      		LD	BC,(_TXADR)
  DB0F  110020        		LD	DE,02000H	;D:Text E:Kanji
  DB12  2A96EC        		LD	HL,(_COLORF)	;L:Color
  DB15  CBE8          		SET	5,B
  DB17                	C12X1:
  DB17  CD1FDB        		CALL	C12S
  DB1A  03            		INC	BC
  DB1B  20FA          		JR	NZ,C12X1
  DB1D  D1            		POP	DE
  DB1E  C9            		RET
                      	
  DB1F                	C12S:
  DB1F  CBE0          		SET	4,B
  DB21  CBD8          		SET	3,B
  DB23  ED60          		IN	H,(C)
  DB25  ED59          	X1PAT:	OUT	(C),E
  DB27  5C            		LD	E,H
  DB28  CB98          		RES	3,B
  DB2A  ED60          		IN	H,(C)
  DB2C  ED51          		OUT	(C),D
  DB2E  54            		LD	D,H
  DB2F  CBA0          		RES	4,B
  DB31  ED60          		IN	H,(C)
  DB33  ED69          		OUT	(C),L
  DB35  6C            		LD	L,H
  DB36  3D            		DEC	A
  DB37  C9            		RET
                      	
  DB38                	CTRL0C:
  DB38  CD78DA        		CALL	CTRL0B
  DB3B                	CTRL1A:
  DB3B  ED4B8EEC      		LD	BC,(_TXADR)
  DB3F                	C1AX1:
  DB3F  78            		LD	A,B
  DB40  F638          		OR	038H
  DB42  47            		LD	B,A
  DB43  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令	kanji
  DB45  CB98          		RES	3,B
  DB47  3E20          		LD	A,020H
  DB49  ED79          		OUT	(C),A		;Text
  DB4B  CBA0          		RES	4,B
  DB4D  3A96EC        		LD	A,(_COLORF)
  DB50  ED79          		OUT	(C),A		;Color
  DB52  03            		INC	BC
  DB53  CBA8          		RES	5,B
  DB55  2ABAEC        		LD	HL,(CRTCD+10)
  DB58  09            		ADD	HL,BC
  DB59  30E4          		JR	NC,C1AX1
  DB5B  C9            		RET
                      	
  DB5C                	CTRL04:
  DB5C  CDD3EC        		CALL	_POS
  DB5F  7D            		LD	A,L
  DB60  B7            		OR	A
  DB61  C8            		RET	Z
  DB62                	CTRL03:
  DB62  CD5EDA        		CALL	CTRL0D
  DB65                	CTRL0A:
  DB65                	CTRL1F:
  DB65  ED4B8EEC      		LD	BC,(_TXADR)
  DB69  2AB1EC        		LD	HL,(CRTCD+1)
  DB6C  2600          		LD	H,0
  DB6E  09            		ADD	HL,BC
  DB6F  44            		LD	B,H
  DB70  4D            		LD	C,L
  DB71  2ABAEC        		LD	HL,(CRTCD+10)
  DB74  09            		ADD	HL,BC
  DB75  3F            		CCF
  DB76  9F            		SBC	A,A
  DB77  C3D1D9        		JP	PRINTE8
                      	
  DB7A                	CTRL0E:
  DB7A  CDD3EC        		CALL	_POS
  DB7D  7C            		LD	A,H
  DB7E  1804          		JR	SCR1
  DB80                	SCR:
  DB80  3A97EC        		LD	A,(_LINE)
  DB83  3D            		DEC	A
  DB84                	SCR1:
  DB84  C5            		PUSH	BC
  DB85  D5            		PUSH	DE
  DB86  01801F        		LD	BC,01F80H	;DMA
  DB89  1EC3          		LD	E,0C3H
  DB8B  ED59          		OUT	(C),E
  DB8D  119A65        		LD	DE,0659AH
  DB90  ED59          		OUT	(C),E
  DB92  ED51          		OUT	(C),D
  DB94  114F00        		LD	DE,79
  DB97  ED59          		OUT	(C),E
  DB99  ED51          		OUT	(C),D
                      	
  DB9B  210038        		LD	HL,03800H
  DB9E  11181C        		LD	DE,01C18H
  DBA1  ED51          		OUT	(C),D
  DBA3  ED59          		OUT	(C),E
                      	
  DBA5                	SCRUP1:
  DBA5  B7            		OR	A
  DBA6  2839          		JR	Z,SCRCL
  DBA8  F5            		PUSH	AF
  DBA9  CDC2DB        		CALL	UPSUB		;kanji
  DBAC  ED5BBCEC      		LD	DE,(CRTCD+12)
  DBB0  16F7          		LD	D,0F7H
  DBB2  19            		ADD	HL,DE
  DBB3  D5            		PUSH	DE
  DBB4  CDC2DB        		CALL	UPSUB		;Text
  DBB7  D1            		POP	DE
  DBB8  19            		ADD	HL,DE
  DBB9  CDC2DB        		CALL	UPSUB		;Color
  DBBC  CBE4          		SET	4,H
  DBBE  F1            		POP	AF
  DBBF  3D            		DEC	A
  DBC0  18E3          		JR	SCRUP1
                      	
  DBC2                	UPSUB:
  DBC2  ED5BB1EC      		LD	DE,(CRTCD+1)
  DBC6  1600          		LD	D,0
  DBC8  3ECD          		LD	A,0CDH
  DBCA  ED79          		OUT	(C),A
  DBCC  ED69          		OUT	(C),L		;SOURCE
  DBCE  ED61          		OUT	(C),H
  DBD0  19            		ADD	HL,DE
  DBD1  3E1D          		LD	A,01DH
  DBD3  ED79          		OUT	(C),A		;DEST
  DBD5  ED69          		OUT	(C),L
  DBD7  ED61          		OUT	(C),H
  DBD9  1187CF        		LD	DE,0CF87H
  DBDC  ED51          		OUT	(C),D
  DBDE  ED59          		OUT	(C),E
  DBE0  C9            		RET
                      	
  DBE1                	SCRCL:
  DBE1  44            		LD	B,H
  DBE2  4D            		LD	C,L
  DBE3  215020        		LD	HL,02000H+80
  DBE6  3A96EC        		LD	A,(_COLORF)
  DBE9                	SCRCL1:
  DBE9  ED71          		DB	0EDH,071H	;OUT (C),0	Z80未定義命令
  DBEB  CB98          		RES	3,B
  DBED  ED61          		OUT	(C),H
  DBEF  CBA0          		RES	4,B
  DBF1  ED79          		OUT	(C),A
  DBF3  CBD8          		SET	3,B
  DBF5  CBE0          		SET	4,B
  DBF7  03            		INC	BC
  DBF8  2D            		DEC	L
  DBF9  20EE          		JR	NZ,SCRCL1
  DBFB  D1            		POP	DE
  DBFC  C1            		POP	BC
  DBFD  C9            		RET
                      	
  DBFE                	SCRN:
  DBFE  D5            		PUSH	DE
  DBFF  ED58          		IN	E,(C)		;Text
  DC01  CBD8          		SET	3,B
  DC03  ED50          		IN	D,(C)		;Kanji
  DC05  2819          		JR	Z,SCRNE
  DC07  AF            		XOR	A
  DC08  C5            		PUSH	BC
  DC09  013730        		LD	BC,03037H	;VRMJIS
  DC0C  DF            		RST	018H
  DC0D  01522F        		LD	BC,02F52H	;JISSFT
  DC10  DF            		RST	018H
  DC11  C1            		POP	BC
  DC12  ED78          		IN	A,(C)
  DC14  CB98          		RES	3,B
  DC16  E640          		AND	040H
  DC18  2003          		JR	NZ,SCRN1
  DC1A  7A            		LD	A,D
  DC1B  D1            		POP	DE
  DC1C  C9            		RET
  DC1D                	SCRN1:
  DC1D  7B            		LD	A,E
  DC1E  D1            		POP	DE
  DC1F  C9            		RET
                      	
  DC20                	SCRNE:
  DC20  D1            		POP	DE
  DC21  CB98          		RES	3,B
  DC23                	SCRNX:
  DC23  ED78          		IN	A,(C)
  DC25  C9            		RET
                      	
  DC26                	POS:
  DC26  2A8EEC        		LD	HL,(_TXADR)
  DC29  C5            		PUSH	BC
  DC2A  ED4BBCEC      		LD	BC,(CRTCD+12)
  DC2E  AF            		XOR	A
  DC2F                	POS1:
  DC2F  09            		ADD	HL,BC
  DC30  3C            		INC	A
  DC31  38FC          		JR	C,POS1
  DC33  ED42          		SBC	HL,BC
  DC35  3D            		DEC	A
  DC36  67            		LD	H,A
  DC37  C1            		POP	BC
  DC38  A7            		AND	A
  DC39  C9            		RET
                      	
  DC3A                	GETL:
  DC3A  CDD3EC        		CALL	_POS
  DC3D  E5            		PUSH	HL
  DC3E                	GETL1:
  DC3E  CDD3EC        		CALL	_POS
  DC41  C1            		POP	BC
  DC42  C5            		PUSH	BC
  DC43  7D            		LD	A,L
  DC44  91            		SUB	C
  DC45  69            		LD	L,C
  DC46  4F            		LD	C,A
  DC47  DCD6EC        		CALL	C,_LOC
  DC4A                	GET1W:
  DC4A  CDE0D7        		CALL	_SYS08
  DC4D  FE08          		CP	8
  DC4F  2007          		JR	NZ,GETL1X
  DC51  0D            		DEC	C
  DC52  CB79          		BIT	7,C
  DC54  2002          		JR	NZ,GETL1X
  DC56  3E02          		LD	A,2
  DC58                	GETL1X:
  DC58  FE1B          		CP	01BH
  DC5A  2016          		JR	NZ,GETL1V
  DC5C  CDE0D7        		CALL	_SYS08
  DC5F  FE22          		CP	022H
  DC61  2008          		JR	NZ,GETL1Y
  DC63  2100FF        		LD	HL,KBUF
  DC66  CDA8D8        		CALL	MSX
  DC69  180E          		JR	GETL1Z
  DC6B                	GETL1Y:
  DC6B  F5            		PUSH	AF
  DC6C  1E1B          		LD	E,01BH
  DC6E  CDCDEC        		CALL	_PRINT
  DC71  F1            		POP	AF
  DC72                	GETL1V:
  DC72  5F            		LD	E,A
  DC73  CD72DA        		CALL	CTRL01
  DC76  CDCDEC        		CALL	_PRINT
  DC79                	GETL1Z:
  DC79  7B            		LD	A,E
  DC7A  FE0D          		CP	00DH
  DC7C  20C0          		JR	NZ,GETL1
                      	
  DC7E  2100FF        		LD	HL,KBUF
  DC81  AF            		XOR	A
  DC82  ED4BB0EC      		LD	BC,(CRTCD)
  DC86                	GETL0:
  DC86  77            		LD	(HL),A
  DC87  23            		INC	HL
  DC88  10FC          		DJNZ	GETL0
                      	
  DC8A  D1            		POP	DE
  DC8B  CDD3EC        		CALL	_POS
  DC8E  6B            		LD	L,E
  DC8F  3AB1EC        		LD	A,(CRTCD+1)
  DC92  95            		SUB	L
  DC93  57            		LD	D,A
  DC94  CD8BDA        		CALL	LOC1
  DC97  78            		LD	A,B
  DC98  F630          		OR	030H
  DC9A  47            		LD	B,A
  DC9B  5A            		LD	E,D
  DC9C  2100FF        		LD	HL,KBUF
  DC9F                	GETL2:
  DC9F  CDD0EC        		CALL	_SCRN
  DCA2  03            		INC	BC
  DCA3  77            		LD	(HL),A
  DCA4  23            		INC	HL
  DCA5  1D            		DEC	E
  DCA6  20F7          		JR	NZ,GETL2
  DCA8                	GETL3:
  DCA8  2B            		DEC	HL
  DCA9  7E            		LD	A,(HL)
  DCAA  FE21          		CP	021H
  DCAC  D0            		RET	NC
  DCAD  3600          		LD	(HL),0
  DCAF  15            		DEC	D
  DCB0  20F6          		JR	NZ,GETL3
  DCB2  C9            		RET
                      	
  DCB3                	INKEY:
  DCB3  FB            		EI
  DCB4  E5            		PUSH	HL
  DCB5  2A90EC        		LD	HL,(_KEYPS)
  DCB8  7C            		LD	A,H
  DCB9  AD            		XOR	L
  DCBA  2809          		JR	Z,INKEY1
  DCBC  7C            		LD	A,H
  DCBD  3C            		INC	A
  DCBE  3291EC        		LD	(_KEYPS+1),A
  DCC1  6F            		LD	L,A
  DCC2  26FE          		LD	H,KEYBF/256
  DCC4  7E            		LD	A,(HL)
  DCC5                	INKEY1:
  DCC5  E1            		POP	HL
  DCC6  B7            		OR	A
  DCC7  C9            		RET
                      	
  1164                	AT_RS	EQU	SCR1-AT_SCR1
                      	
                      	;LDFILE.ASM
                      	
                      	;	LSX-Dodgers FILE
                      	
  DCC8                	FILEC:
  DCC8  CDD3DC        		CALL	FILE
  DCCB                	FILEC2:
  DCCB  3ADC00        		LD	A,(FDRV+1)
  DCCE  FE20          		CP	020H
  DCD0  C8            		RET	Z
  DCD1  183B          		JR	SETDIR1
                      	
  DCD3                	FILE:
  DCD3  AF            		XOR	A
  DCD4  32DB00        		LD	(FDRV),A
  DCD7  67            		LD	H,A
  DCD8  6F            		LD	L,A
  DCD9  22E900        		LD	(FDRV+14),HL
  DCDC  CDADDD        		CALL	SPCUT
  DCDF  CD92DD        		CALL	CCHK3
  DCE2  2812          		JR	Z,DEVI1
  DCE4  13            		INC	DE
  DCE5  1A            		LD	A,(DE)
  DCE6  1B            		DEC	DE
  DCE7  FE3A          		CP	':'
  DCE9  200B          		JR	NZ,DEVI1
  DCEB  1A            		LD	A,(DE)		;DRIVE
  DCEC  CDD5DF        		CALL	CAP
  DCEF  D640          		SUB	'@'
  DCF1  13            		INC	DE
  DCF2  13            		INC	DE
  DCF3  32DB00        		LD	(FDRV),A
  DCF6                	DEVI1:
  DCF6  1A            		LD	A,(DE)
  DCF7  D65C          		SUB	05CH
  DCF9  200B          		JR	NZ,NOROOT
  DCFB  210000        		LD	HL,0
  DCFE  22F500        		LD	(FDRV+26),HL
  DD01  2C            		INC	L
  DD02  22E900        		LD	(FDRV+14),HL
  DD05  13            		INC	DE
  DD06                	NOROOT:
                      	
  DD06                	SETDIR:
  DD06  CD32DD        		CALL	FILED
  DD09  1A            		LD	A,(DE)
  DD0A  FE5C          		CP	05CH
  DD0C  C0            		RET	NZ
  DD0D  13            		INC	DE
  DD0E                	SETDIR1:
  DD0E  3E10          		LD	A,010H		;Directory
  DD10  32E800        		LD	(FDRV+13),A
  DD13  D5            		PUSH	DE
  DD14  11DB00        		LD	DE,FDRV
  DD17  2A1EEC        		LD	HL,(STABLE+2*00FH)
  DD1A  CD0F00        		CALL	JP_HL
  DD1D  D1            		POP	DE
  DD1E  B7            		OR	A
  DD1F  C0            		RET	NZ
                      	
  DD20  3AE800        		LD	A,(FDRV+13)
  DD23  CB67          		BIT	4,A
  DD25  C8            		RET	Z
                      	
  DD26  CD79DD        		CALL	FILEI
  DD29  2AF500        		LD	HL,(FDRV+26)
  DD2C  23            		INC	HL
  DD2D  22E900        		LD	(FDRV+14),HL
  DD30  18D4          		JR	SETDIR
                      	
  DD32                	FILED:
  DD32  CD79DD        		CALL	FILEI
                      	
  DD35  0608          		LD	B,8
  DD37                	FILE2:
  DD37  CD87DD        		CALL	CCHKF
  DD3A  C8            		RET	Z
  DD3B  FE2A          		CP	'*'
  DD3D  282E          		JR	Z,FILE9
  DD3F  FE2E          		CP	'.'
  DD41  280C          		JR	Z,FILE4
  DD43  77            		LD	(HL),A
  DD44  23            		INC	HL
  DD45  10F0          		DJNZ	FILE2
                      	
  DD47                	FILE3:
  DD47  CD87DD        		CALL	CCHKF
  DD4A  C8            		RET	Z
  DD4B  FE2E          		CP	'.'
  DD4D  20F8          		JR	NZ,FILE3
                      	
  DD4F                	FILE4:
  DD4F  21E400        		LD	HL,FNAME+8
  DD52  0603          		LD	B,3
                      	
  DD54                	FILE4L:
  DD54  CD87DD        		CALL	CCHKF
  DD57  C8            		RET	Z
  DD58  FE2E          		CP	'.'
  DD5A  2008          		JR	NZ,FILE12
  DD5C  32DC00        		LD	(FNAME),A	;Parent directory(..)
  DD5F  32DD00        		LD	(FNAME+1),A
  DD62  3E20          		LD	A,020H
  DD64                	FILE12:
  DD64  FE2A          		CP	'*'
  DD66  280A          		JR	Z,FILE10
  DD68  77            		LD	(HL),A
  DD69  23            		INC	HL
  DD6A  10E8          		DJNZ	FILE4L
  DD6C  C9            		RET
                      	
  DD6D                	FILE9:
  DD6D  CD72DD        		CALL	FILE10
  DD70  18D5          		JR	FILE3
                      	
  DD72                	FILE10:
  DD72  3E3F          		LD	A,'?'
                      	
  DD74                	FILE7:
  DD74  77            		LD	(HL),A
  DD75  23            		INC	HL
  DD76  10FC          		DJNZ	FILE7
  DD78  C9            		RET
                      	
  DD79                	FILEI:
  DD79  3E20          		LD	A,020H
  DD7B  01000B        		LD	BC,11*256
  DD7E  21DC00        		LD	HL,FNAME
  DD81  E5            		PUSH	HL
  DD82  CD74DD        		CALL	FILE7
  DD85  E1            		POP	HL
  DD86  C9            		RET
                      	
  DD87                	CCHKF:
  DD87  1A            		LD	A,(DE)
  DD88  CD8FDD        		CALL	CCHK2
  DD8B  C8            		RET	Z
  DD8C  C3E7E0        		JP	FKAN
                      	
  DD8F                	CCHK2:
  DD8F  0C            		INC	C
  DD90  0D            		DEC	C
  DD91  C0            		RET	NZ
  DD92                	CCHK3:
  DD92  FE2B          		CP	'+'
  DD94  C8            		RET	Z
  DD95  FE2C          		CP	','
  DD97  C8            		RET	Z
  DD98  FE2F          		CP	'/'
  DD9A  C8            		RET	Z
  DD9B  FE3A          		CP	':'
  DD9D  C8            		RET	Z
  DD9E  FE3B          		CP	';'
  DDA0  C8            		RET	Z
  DDA1  FE3D          		CP	'='
  DDA3  C8            		RET	Z
  DDA4  FE5C          		CP	05CH
  DDA6  C8            		RET	Z
  DDA7  FE20          		CP	020H
  DDA9  D0            		RET	NC
  DDAA  BF            		CP	A		;Z=1
  DDAB  C9            		RET
                      	
  DDAC                	SS1:
  DDAC  13            		INC	DE
  DDAD                	SPCUT:
  DDAD  1A            		LD	A,(DE)
  DDAE  FE20          		CP	020H
  DDB0  28FA          		JR	Z,SS1
  DDB2  C9            		RET
                      	
  DDB3                	SETDRVF:
  DDB3  11DB00        		LD	DE,FDRV
  DDB6                	SETDRV0:
  DDB6  CDBFDD        		CALL	SETDRV
  DDB9  FDE1          		POP	IY
  DDBB  C1            		POP	BC
  DDBC  D1            		POP	DE
  DDBD  E1            		POP	HL
  DDBE  C9            		RET
                      	
  DDBF                	SETDRV:
  DDBF  E3            		EX	(SP),HL		;HL=RETRN ADDRESS
  DDC0  D5            		PUSH	DE		;PUSH HL/DE/BC/IY
  DDC1  C5            		PUSH	BC
  DDC2  1A            		LD	A,(DE)
  DDC3  D5            		PUSH	DE
  DDC4  FDE3          		EX	(SP),IY
                      	
  DDC6  CDD2DD        		CALL	GETDRV
  DDC9  3C            		INC	A
  DDCA  FD7700        		LD	(IY+0),A	;(FCB)ドライブ番号
  DDCD  3D            		DEC	A
  DDCE  CDD9EC        		CALL	_CHGDRV
                      	
  DDD1  E9            		JP	(HL)
                      	
  DDD2                	GETDRV:
  DDD2  E67F          		AND	07FH
  DDD4  D601          		SUB	001H
  DDD6  3003          		JR	NC,GETDRV1
  DDD8  3A87EC        		LD	A,(_DVSW)	;Current Drive
  DDDB                	GETDRV1:
  DDDB  3288EC        		LD	(_DRV),A
  DDDE  C9            		RET
                      	
  DDDF                	SOPENX:
  DDDF  CD5BDF        		CALL	CHKDDX
  DDE2  3802          		JR	C,SOPENX1
  DDE4  C1            		POP	BC
  DDE5  E9            		JP	(HL)
  DDE6                	SOPENX1:
  DDE6  119EE2        		LD	DE,SFILE
  DDE9  1A            		LD	A,(DE)
  DDEA  FDBE00        		CP	(IY+0)		;(FCB)ドライブ番号
  DDED  2024          		JR	NZ,SOPEN
  DDEF  13            		INC	DE
  DDF0  FDE5          		PUSH	IY
  DDF2  E1            		POP	HL
  DDF3  23            		INC	HL
  DDF4  CD8BDF        		CALL	CPFILE
  DDF7  201A          		JR	NZ,SOPEN
                      	
  DDF9  2AF4EB        		LD	HL,(SCDIR)
  DDFC  FD750E        		LD	(IY+14),L	;(FCB)アクセスするディレクトリのクラスタ番号+1
  DDFF  FD740F        		LD	(IY+15),H
                      	
  DE02  2AF8EB        		LD	HL,(SFNDF)	;Direcroty location and Flags
  DE05  229FEC        		LD	(_FILEN),HL
                      	
  DE08  ED5BF6EB      		LD	DE,(SFBPS)
  DE0C  219EE2        		LD	HL,SFILE
  DE0F  36FF          		LD	(HL),0FFH
  DE11  23            		INC	HL
  DE12  C9            		RET
  DE13                	SOPEN:
  DE13  2123DF        		LD	HL,FILESE
  DE16                	SOPENC:
  DE16  2253DE        		LD	(OPENPAT+1),HL
                      	
  DE19  CDE2EC        		CALL	_RDFATX		;Detect Media
  DE1C  385A          		JR	C,RDDERR
                      	
  DE1E  AF            		XOR	A
  DE1F  329FEC        		LD	(_FILEN),A
  DE22                	SOPEN0:
  DE22  CD11E0        		CALL	LDDIRX
  DE25  281C          		JR	Z,SDIRX1
                      	
  DE27  CDFAE6        		CALL	MULSPC
  DE2A  CD14DF        		CALL	DC		;Sub Directory
  DE2D  3808          		JR	C,SDIRX0
  DE2F  2A7EEC        		LD	HL,(_DTBUF)
  DE32  7E            		LD	A,(HL)
  DE33  FE2E          		CP	'.'
  DE35  2810          		JR	Z,SOPEN1
  DE37                	SDIRX0:
  DE37  AF            		XOR	A
  DE38  32A0EC        		LD	(_DIRF),A
  DE3B  FD360E01      		LD	(IY+14),1	;(FCB)レコード・サイズ
  DE3F  FD360F00      		LD	(IY+15),0
  DE43                	SDIRX1:
  DE43  ED5BFCEB      		LD	DE,(_DIRPS)	;Root Directory
                      	
  DE47                	SOPEN1:
  DE47  0E20          	SDECPAT:LD	C,32		;自己書き換え 1セクタ辺りのディレクトリエントリ数  1024=32 / 512=16
  DE49                	SOPEN1X:
  DE49  CD14DF        		CALL	DC		;FILE SEARCH
  DE4C  382A          		JR	C,RDDERR
  DE4E  2A7EEC        		LD	HL,(_DTBUF)
  DE51                	SOPEN2:
  DE51  D5            		PUSH	DE
  DE52  CD23DF        	OPENPAT:CALL	FILESE		;(Self-rewriting)
  DE55  D1            		POP	DE
  DE56  3868          		JR	C,SOPENE
  DE58  281B          		JR	Z,NOTSE
  DE5A                	SOPEN3:
  DE5A  3AA0EC        		LD	A,(_DIRF)
  DE5D  B7            		OR	A
  DE5E  200C          		JR	NZ,SOPEN5
  DE60  13            		INC	DE		;ルートディレクトリ
  DE61  E5            		PUSH	HL
  DE62  210C00        	MD_PAT:	LD	HL,12		;(Self-rewriting)MAXDIR
  DE65  ED52          		SBC	HL,DE		;CF=0 なので SUB HL,DE
  DE67  E1            		POP	HL
  DE68  20DD          		JR	NZ,SOPEN1
  DE6A  1807          		JR	SOPEN6
  DE6C                	SOPEN5:
  DE6C  CDECE6        		CALL	GNCLX	;END DIR
  DE6F  D8            		RET	C
  DE70  CDCCDF        		CALL	ENDCLX
  DE73                	SOPEN6:
  DE73  38D2          		JR	C,SOPEN1
  DE75                	NOTSE:
  DE75  37            		SCF			;CF=1
  DE76  9F            		SBC	A,A		;A=0FFH
  DE77  C9            		RET
                      	
  DE78                	RDDERR:
  DE78  BF            		CP	A		;READ ERR CF=1 ZF=1
  DE79  37            		SCF
  DE7A  C9            		RET
                      	
  DE7B                	NOPEN:
  DE7B  2123DF        		LD	HL,FILESE
  DE7E  2253DE        		LD	(OPENPAT+1),HL
  DE81  FD2A98EC      		LD	IY,(_FCB)
  DE85  CDFAE0        		CALL	CHKWILDX
  DE88  30EB          		JR	NC,NOTSE
  DE8A  FD7E00        		LD	A,(IY+0)	;(FCB)ドライブ番号
  DE8D  3D            		DEC	A
  DE8E  3288EC        		LD	(_DRV),A
  DE91  CDD9EC        		CALL	_CHGDRV
  DE94  D8            		RET	C
                      	
  DE95  CD11E0        		CALL	LDDIRX
  DE98  ED5B9AEC      		LD	DE,(_FBPS)
  DE9C  CD14DF        		CALL	DC
  DE9F  38D7          		JR	C,RDDERR
  DEA1  3A9EEC        		LD	A,(_FBCNT)
  DEA4  3D            		DEC	A
  DEA5  28B3          		JR	Z,SOPEN3
  DEA7                	NOPEN2:
  DEA7  2A9CEC        		LD	HL,(_FBAD)
  DEAA  012000        		LD	BC,020H
  DEAD  09            		ADD	HL,BC
  DEAE  4F            		LD	C,A
  DEAF  18A0          		JR	SOPEN2
                      	
  DEB1                	SOPENE2:
  DEB1  229CEC        		LD	(_FBAD),HL
  DEB4  79            		LD	A,C
  DEB5  329EEC        		LD	(_FBCNT),A
  DEB8  ED539AEC      		LD	(_FBPS),DE
  DEBC  FD2298EC      		LD	(_FCB),IY
  DEC0                	SOPENE:
  DEC0  AF            		XOR	A
  DEC1  C9            		RET
                      	
  DEC2                	COPEN:
  DEC2  FD360D20      		LD	(IY+13),020H	;(FCB)属性(アトリビュート)
                      	
  DEC6  2140DF        		LD	HL,NEXTSE
  DEC9  CD16DE        		CALL	SOPENC
  DECC  D0            		RET	NC
  DECD  C8            		RET	Z
  DECE  3AA0EC        		LD	A,(_DIRF)
  DED1  D601          		SUB	001H
  DED3  D8            		RET	C
  DED4  0601          		LD	B,1
  DED6  CD56E1        		CALL	WRDF
  DED9  D8            		RET	C
  DEDA  ED5BFEEB      		LD	DE,(_CLPS)
  DEDE  D5            		PUSH	DE
  DEDF  CDB4DF        		CALL	DCPAT
  DEE2  CD97E5        		CALL	DRDNX
  DEE5  2A7EEC        		LD	HL,(_DTBUF)	;ディレクトリエントリを0クリア
  DEE8  5D            		LD	E,L
  DEE9  54            		LD	D,H
  DEEA  13            		INC	DE		;DE,DTBUF+1
  DEEB  01FF03        	SECSZM1:LD	BC,003FFH	;自己書き換え セクタサイズ-1(0x3FF:1023 or 0x1FF:511 or 0xFF:255)
  DEEE  AF            		XOR	A		;データバッファをセクタサイズ分ゼロクリア
  DEEF  77            		LD	(HL),A
  DEF0  EDB0          		LDIR
                      	
  DEF2  3AA0EC        		LD	A,(_DIRF)
  DEF5  B7            		OR	A
  DEF6  2817          		JR	Z,COPENE	;ルートディレクトリ
                      	
  DEF8  D1            		POP	DE		;DE=(_CLPS)
  DEF9  D5            		PUSH	DE
  DEFA  3AFDE6        		LD	A,(SPCPAT+1)	;1クラスタの論理セクタ数
  DEFD                	COPEN1:
  DEFD  3D            		DEC	A
  DEFE  280F          		JR	Z,COPENE	;1セクタ辺りのセクタ数が2以上の場合
  DF00  F5            		PUSH	AF		;データバッファに入らないセクタもゼロクリア
  DF01  13            		INC	DE
  DF02  D5            		PUSH	DE
  DF03  C5            		PUSH	BC
  DF04  CDB4DF        		CALL	DCPAT
  DF07  CD54E8        		CALL	DWT16
  DF0A  C1            		POP	BC
  DF0B  D1            		POP	DE
  DF0C  F1            		POP	AF
  DF0D  18EE          		JR	COPEN1
  DF0F                	COPENE:
  DF0F  2A7EEC        		LD	HL,(_DTBUF)
  DF12  D1            		POP	DE
  DF13  C9            		RET
                      	
  DF14                	DC:
  DF14  ED53FEEB      		LD	(_CLPS),DE
  DF18  C5            		PUSH	BC
  DF19  D5            		PUSH	DE
  DF1A  CDB4DF        		CALL	DCPAT
  DF1D  CD7BE5        		CALL	DRDX
  DF20  D1            		POP	DE
  DF21  C1            		POP	BC
  DF22  C9            		RET
                      	
  DF23                	FILESE:
  DF23  7E            		LD	A,(HL)
  DF24  B7            		OR	A
  DF25  C8            		RET	Z		;END:ZF=1 CF=0
  DF26  FEE5          		CP	0E5H
  DF28  280E          		JR	Z,FILESE1
  DF2A  FDE5          		PUSH	IY
  DF2C  D1            		POP	DE
  DF2D  13            		INC	DE
  DF2E  E5            		PUSH	HL
  DF2F  CD8BDF        		CALL	CPFILE
  DF32  CCACDF        		CALL	Z,CPFILE2
  DF35  E1            		POP	HL
  DF36  37            		SCF
  DF37  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DF38                	FILESE1:
  DF38  CD4FDF        		CALL	FNEXT
  DF3B  20E6          		JR	NZ,FILESE
  DF3D                	ZF0_CF0_AFF_RET:
  DF3D  F6FF          		OR	0FFH		;ZF=0 CF=0
  DF3F  C9            		RET
                      	
  DF40                	NEXTSE:
  DF40  7E            		LD	A,(HL)
  DF41  B7            		OR	A
  DF42  37            		SCF
  DF43  C8            		RET	Z		;!!!:ZF=1 CF=1
  DF44  FEE5          		CP	0E5H
  DF46  37            		SCF
  DF47  C8            		RET	Z		;!!!:(ZF=1) CF=1
  DF48  CD4FDF        		CALL	FNEXT
  DF4B  20F3          		JR	NZ,NEXTSE
  DF4D  18EE          		JR	ZF0_CF0_AFF_RET
                      	
  DF4F                	FNEXT:
  DF4F  E5            		PUSH	HL
  DF50  219FEC        		LD	HL,_FILEN
  DF53  34            		INC	(HL)
  DF54  E1            		POP	HL
  DF55  112000        		LD	DE,020H
  DF58  19            		ADD	HL,DE
  DF59  0D            		DEC	C
  DF5A  C9            		RET
                      	
  DF5B                	CHKDDX:
  DF5B  CDFAE0        		CALL	CHKWILDX
  DF5E  D8            		RET	C
  DF5F  FDE5          		PUSH	IY
  DF61  D1            		POP	DE
  DF62  13            		INC	DE
  DF63  2162EC        		LD	HL,DDTB
  DF66  0604          		LD	B,DDS
  DF68                	CPNAME:
  DF68  C5            		PUSH	BC
  DF69  D5            		PUSH	DE
  DF6A  1170E5        		LD	DE,CPBUF
  DF6D  010400        		LD	BC,4
  DF70  EDB0          		LDIR
  DF72  D1            		POP	DE
  DF73  D5            		PUSH	DE
  DF74  E5            		PUSH	HL
  DF75  2170E5        		LD	HL,CPBUF
  DF78  CD8BDF        		CALL	CPFILE
  DF7B  E1            		POP	HL
  DF7C  D1            		POP	DE
  DF7D  C1            		POP	BC
  DF7E  2005          		JR	NZ,CPNAME1
  DF80  7E            		LD	A,(HL)
  DF81  23            		INC	HL
  DF82  66            		LD	H,(HL)
  DF83  6F            		LD	L,A
  DF84  C9            		RET
  DF85                	CPNAME1:
  DF85  23            		INC	HL
  DF86  23            		INC	HL
  DF87  10DF          		DJNZ	CPNAME
  DF89  37            		SCF
  DF8A  C9            		RET
                      	
  DF8B                	CPFILE:
  DF8B  C5            		PUSH	BC
  DF8C  01000B        		LD	BC,00B00H
  DF8F                	CPSTR1:
  DF8F  1A            		LD	A,(DE)
  DF90  FE3F          		CP	'?'		;Wild card
  DF92  2812          		JR	Z,CPSTR2
  DF94  7E            		LD	A,(HL)
  DF95  CDE0E0        		CALL	FKANC
  DF98  E5            		PUSH	HL
  DF99  67            		LD	H,A
  DF9A  1A            		LD	A,(DE)
  DF9B  CB01          		RLC	C
  DF9D  CDE0E0        		CALL	FKANC
  DFA0  CB09          		RRC	C
  DFA2  BC            		CP	H		;CP (HL),(DE)
  DFA3  E1            		POP	HL
  DFA4  2004          		JR	NZ,CPSTR3
  DFA6                	CPSTR2:
  DFA6  13            		INC	DE
  DFA7  23            		INC	HL
  DFA8  10E5          		DJNZ	CPSTR1
  DFAA                	CPSTR3:
  DFAA  C1            		POP	BC
  DFAB  C9            		RET
                      	
  DFAC                	CPFILE2:
  DFAC  FD7E0D        		LD	A,(IY+13)	;(FCB)属性(アトリビュート)
  DFAF  F6E1          		OR	0E1H
  DFB1  2F            		CPL
  DFB2  A6            		AND	(HL)
  DFB3  C9            		RET
                      	
  DFB4                	DCPAT:
  DFB4  2A7EEC        		LD	HL,(_DTBUF)
  DFB7  3AA0EC        		LD	A,(_DIRF)
  DFBA  B7            		OR	A
  DFBB  C8            		RET	Z
                      	
  DFBC                	CLUST:
  DFBC  E5            		PUSH	HL
  DFBD  210800        	CLSPAT:	LD	HL,8	;+8 (2D)  !ADDCL (Self-rewriting)
  DFC0  19            		ADD	HL,DE
  DFC1  EB            		EX	DE,HL
  DFC2  E1            		POP	HL
  DFC3  C9            		RET
                      	;ADD_DE_A:
                      	;	ADD	A,E	;DE=DE+A
                      	;	LD	E,A
                      	;	ADC	A,D
                      	;	SUB	E
                      	;	LD	D,A
                      	;	RET
                      	
  DFC4                	ENDCL:
  DFC4  7A            		LD	A,D	;END CLUSTER
  DFC5  FE01          	CLPAT1:	CP	1	;164=356	(Self-rewriting)
  DFC7  C0            		RET	NZ
  DFC8  7B            		LD	A,E
  DFC9  FE64          	CLPAT2:	CP	064H	;		(Self-rewriting)
  DFCB  C9            		RET
                      	
  DFCC                	ENDCLX:
  DFCC  D5            		PUSH	DE
  DFCD  CD07E7        		CALL	DIVSPC
  DFD0  CDC4DF        		CALL	ENDCL
  DFD3  D1            		POP	DE
  DFD4  C9            		RET
  DFD5                	CAP:
  DFD5  FE61          		CP	'a'
  DFD7  D8            		RET	C
  DFD8  FE7B          		CP	'z'+1
  DFDA  D0            		RET	NC
  DFDB  D620          		SUB	020H
  DFDD  C9            		RET
  DFDE                	CAP2:
  DFDE  CDD5DF        		CALL	CAP
  DFE1                	CAP3:
  DFE1  CDEADF        		CALL	CAP4
  DFE4  FE21          		CP	021H
  DFE6  D0            		RET	NC
  DFE7  3EA0          		LD	A,0A0H
  DFE9  C9            		RET
  DFEA                	CAP4:
  DFEA  FE05          		CP	5
  DFEC  C0            		RET	NZ
  DFED  3EE5          		LD	A,0E5H
  DFEF  C9            		RET
                      	
  DFF0                	CHDIR:
  DFF0  CDA5E9        		CALL	GETDPBD
  DFF3  3806          		JR	C,CHDIR2
  DFF5  DD751A        		LD	(IX+01AH),L		;_SDIR_
  DFF8  DD741B        		LD	(IX+01BH),H		;_SDIR_+1
  DFFB                	CHDIR2:
  DFFB  DDE1          		POP	IX
  DFFD  C9            		RET
                      	
  DFFE                	LDDIR:
  DFFE  CDA5E9        		CALL	GETDPBD
  E001  DD5E1A        		LD	E,(IX+01AH)		;_SDIR_
  E004  DD561B        		LD	D,(IX+01BH)		;_SDIR_+1
  E007  13            		INC	DE
  E008  FD730E        		LD	(IY+14),E	;(FCB)アクセスするディレクトリのクラスタ番号+1
  E00B  FD720F        		LD	(IY+15),D
  E00E  1B            		DEC	DE
  E00F  18EA          		JR	CHDIR2
                      	
  E011                	LDDIRX:
  E011  FD5E0E        		LD	E,(IY+14)	;(FCB)アクセスするディレクトリのクラスタ番号+1
  E014  FD560F        		LD	D,(IY+15)
  E017  1B            		DEC	DE
  E018  CDC4DF        		CALL	ENDCL
  E01B  D4FEDF        		CALL	NC,LDDIR
  E01E                	LDDIRS:
  E01E  7A            		LD	A,D
  E01F  B3            		OR	E
  E020  32A0EC        		LD	(_DIRF),A
  E023  C9            		RET
                      	
  E024                	KILL:
  E024  CDFAE0        		CALL	CHKWILDX
  E027  383A          		JR	C,KILLW
  E029  CD5BDF        		CALL	CHKDDX
  E02C  3F            		CCF
  E02D  D4E6DD        		CALL	NC,SOPENX1
  E030                	KILLS:
  E030  3E1F          		LD	A,01FH
  E032  D476E0        		CALL	NC,CHKATT
  E035  D8            		RET	C
  E036                	KILLSX:
  E036  36E5          		LD	(HL),0E5H	;DIR
  E038  CDD4E0        		CALL	WTDB
  E03B  111A00        		LD	DE,01AH
  E03E  19            		ADD	HL,DE
  E03F  5E            		LD	E,(HL)
  E040  23            		INC	HL
  E041  56            		LD	D,(HL)
  E042  1804          		JR	KILLS2
  E044                	KILLS1:
  E044  ED5BFEEB      		LD	DE,(_CLPS)	;FAT
  E048                	KILLS2:
  E048  CDC4DF        		CALL	ENDCL
  E04B  D0            		RET	NC		;CF=0
  E04C  21FEFF        		LD	HL,0-2
  E04F  19            		ADD	HL,DE
  E050  D0            		RET	NC		;DE= 0 or 1
  E051  D5            		PUSH	DE
  E052  CDF7EC        		CALL	_GNCL
  E055  ED53FEEB      		LD	(_CLPS),DE
  E059  D1            		POP	DE
  E05A  210000        		LD	HL,0
  E05D  D4FAEC        		CALL	NC,_SNCL
  E060  30E2          		JR	NC,KILLS1
  E062  C9            		RET
                      	
  E063                	KILLW:
  E063  CD13DE        		CALL	SOPEN
  E066                	KILLW1:
  E066  380B          		JR	C,KILLW2
  E068  CDB1DE        		CALL	SOPENE2
  E06B  CD30E0        		CALL	KILLS
  E06E  CD7BDE        		CALL	NOPEN
  E071  18F3          		JR	KILLW1
  E073                	KILLW2:
  E073  C8            		RET	Z
  E074  3F            		CCF
  E075  C9            		RET
                      	
  E076                	CHKATT:
  E076  E5            		PUSH	HL
  E077  110B00        		LD	DE,00BH
  E07A  19            		ADD	HL,DE
  E07B  A6            		AND	(HL)
  E07C  E1            		POP	HL
  E07D  C8            		RET	Z
  E07E  37            		SCF
  E07F  C9            		RET
                      	
  E080                	NAME:
  E080  CDFAE0        		CALL	CHKWILDX
  E083  D8            		RET	C
  E084  110400        		LD	DE,4
  E087  19            		ADD	HL,DE
  E088  22A0E0        		LD	(NAMEP+2),HL
  E08B  23            		INC	HL
  E08C  CDFEE0        		CALL	CHKWILD
  E08F  D8            		RET	C
                      	
  E090  CDE6DD        		CALL	SOPENX1
  E093  3E0F          		LD	A,00FH
  E095  D476E0        		CALL	NC,CHKATT
  E098  D8            		RET	C
                      	
  E099  FD7E00        		LD	A,(IY+0)
  E09C  FDE5          		PUSH	IY
  E09E  FD210000      	NAMEP:	LD	IY,0
  E0A2  FD7700        		LD	(IY+0),A
  E0A5  CDE6DD        		CALL	SOPENX1
  E0A8  FDE3          		EX	(SP),IY
  E0AA  3F            		CCF
  E0AB  D413DE        		CALL	NC,SOPEN
  E0AE  EB            		EX	DE,HL
  E0AF  E1            		POP	HL
  E0B0  D8            		RET	C
                      	
  E0B1                	SETNAME:
  E0B1  01000B        		LD	BC,11*256
  E0B4  23            		INC	HL
  E0B5  7E            		LD	A,(HL)
  E0B6  FEE5          		CP	0E5H
  E0B8  2004          		JR	NZ,SNAME1
  E0BA  3E05          		LD	A,5
  E0BC  180E          		JR	SNAME3
  E0BE                	SNAME1:
  E0BE  7E            		LD	A,(HL)
  E0BF  0C            		INC	C
  E0C0  0D            		DEC	C
  E0C1  2009          		JR	NZ,SNAME3
  E0C3  CDD5DF        		CALL	CAP
  E0C6  FEA0          		CP	0A0H
  E0C8  2002          		JR	NZ,SNAME3
  E0CA  3E20          		LD	A,020H
  E0CC                	SNAME3:
  E0CC  12            		LD	(DE),A
  E0CD  7E            		LD	A,(HL)
  E0CE  23            		INC	HL
  E0CF  CDE7E0        		CALL	FKAN
  E0D2  10EA          		DJNZ	SNAME1
  E0D4                	WTDB:
  E0D4  3EFF          		LD	A,0FFH
  E0D6  329EE2        		LD	(SFILE),A
  E0D9                	SWTDBF:
  E0D9  3E01          		LD	A,1
  E0DB  32A4EC        		LD	(_WTDBF),A
  E0DE  AF            		XOR	A
  E0DF  C9            		RET
                      	
  E0E0                	FKANC:
  E0E0  CB41          		BIT	0,C
  E0E2  CCDEDF        		CALL	Z,CAP2
  E0E5  1801          		JR	FKANX
  E0E7                	FKAN:
  E0E7  13            		INC	DE
  E0E8                	FKANX:
  E0E8  CB41          		BIT	0,C
  E0EA  CB81          		RES	0,C
  E0EC  C0            		RET	NZ
  E0ED  FE80          		CP	080H
  E0EF  D8            		RET	C
  E0F0  FEA0          		CP	0A0H
  E0F2  3803          		JR	C,FKAN1
  E0F4  FEE0          		CP	0E0H
  E0F6  D8            		RET	C
  E0F7                	FKAN1:
  E0F7  0C            		INC	C
  E0F8  A7            		AND	A
  E0F9  C9            		RET
                      	
  E0FA                	CHKWILDX:
  E0FA  FDE5          		PUSH	IY
  E0FC  E1            		POP	HL
  E0FD  23            		INC	HL
  E0FE                	CHKWILD:
  E0FE  060B          		LD	B,11
  E100  3E3F          		LD	A,'?'
  E102                	CHKWIL1:
  E102  BE            		CP	(HL)
  E103  23            		INC	HL
  E104  37            		SCF
  E105  C8            		RET	Z
  E106  10FA          		DJNZ	CHKWIL1
  E108  AF            		XOR	A
  E109  C9            		RET
                      	
  E10A                	SDIRENT:		;IY=FCB HL=DIR
  E10A  D5            		PUSH	DE
  E10B  E5            		PUSH	HL
  E10C  FDE5          		PUSH	IY
  E10E  D1            		POP	DE
  E10F  EB            		EX	DE,HL
  E110  CDB1E0        		CALL	SETNAME
                      	;				Attribute
  E113  FD7E0D        		LD	A,(IY+13)	;(FCB)属性(アトリビュート)
  E116  12            		LD	(DE),A
  E117  13            		INC	DE
                      	;				Reserved
  E118  AF            		XOR	A
  E119  060A          		LD	B,10
  E11B                	SDE1:
  E11B  12            		LD	(DE),A
  E11C  13            		INC	DE
  E11D  10FC          		DJNZ	SDE1
                      						;(FCB)ファイルを最後に変更した時刻
  E11F  21EAEB        		LD	HL,SDDATA		;(FCB)ファイルを最後に変更した日付
  E122  060A          		LD	B,SDDATAE-SDDATA	;(FCB)ファイルの先頭クラスタ
  E124                	SDLOOP:					;(FCB)ファイルのサイズ(バイト単位)
  E124  7E            		LD	A,(HL)
  E125  23            		INC	HL
  E126  322BE1        		LD	(SDPAT+2),A
  E129  FD7E00        	SDPAT:	LD	A,(IY+0)	;LD A,(IY+A)
  E12C  12            		LD	(DE),A
  E12D  13            		INC	DE
  E12E  10F4          		DJNZ	SDLOOP
                      	
  E130  AF            		XOR	A
  E131  E1            		POP	HL
  E132  D1            		POP	DE
  E133  C9            		RET
                      	
  E134                	WOPEN:
  E134  FD7E0D        		LD	A,(IY+13)	;(FCB)属性(アトリビュート)
  E137  E61F          		AND	01FH
  E139  37            		SCF
  E13A  C0            		RET	NZ
  E13B  FD361CFE      		LD	(IY+28),0FEH	;(FCB)オープン・モード
  E13F                	TOPEN2:
  E13F  AF            		XOR	A
  E140                	TOPEN:				;Initializes the time stamp
  E140  FD3617FF      		LD	(IY+23),0FFH	;(FCB)ファイルを最後に変更した時刻
  E144  C9            		RET
                      	
  E145                	WRDFX:
  E145  3AFDE6        		LD	A,(SPCPAT+1)	;1クラスタの論理セクタ
  E148                	L_WRFX:
  E148  1F            		RRA		;->CF
  E149  3804          		JR	C,E_WRFX
  E14B  CB39          		SRL	C	;C=C/2
  E14D  18F9          		JR	L_WRFX
  E14F                	E_WRFX:
  E14F  41            		LD	B,C
  E150  04            		INC	B
  E151  3E37          		LD	A,037H		;SCF
  E153  3294E5        		LD	(DRDN1),A
                      	
  E156                	WRDF:				;Bクラスタ分FATを確保する
  E156  110200        		LD	DE,2
  E159  CDFAE6        		CALL	MULSPC
  E15C                	WRDF1:
  E15C  C5            		PUSH	BC
  E15D  D5            		PUSH	DE
  E15E  CD07E7        		CALL	DIVSPC
  E161  CDF7EC        		CALL	_GNCL
  E164  3824          		JR	C,WRDF3
  E166  7A            		LD	A,D		;空いているかチェック
  E167  B3            		OR	E
  E168  2032          		JR	NZ,WRDF4
  E16A  E1            		POP	HL		;HL=空いているクラスタ
  E16B  E5            		PUSH	HL
  E16C  ED5BFEEB      		LD	DE,(_CLPS)	;DE=元の(_CLPS)
  E170  22FEEB        		LD	(_CLPS),HL
  E173  7A            		LD	A,D		;元の(_CLPS)が 0 か?
  E174  B3            		OR	E
  E175  EB            		EX	DE,HL		;
  E176  CD07E7        		CALL	DIVSPC		;ここでフラグは変化しない
  E179  EB            		EX	DE,HL		;
  E17A  2008          		JR	NZ,WRDF2
  E17C  FD751A        		LD	(IY+26),L	;(FCB)ファイルの先頭クラスタ
  E17F  FD741B        		LD	(IY+27),H	;元が空の場合はFCBにクラスタをセットする
  E182  1806          		JR	WRDF3
  E184                	WRDF2:
  E184  CD07E7        		CALL	DIVSPC
  E187  CDFAEC        		CALL	_SNCL
  E18A                	WRDF3:
  E18A  D1            		POP	DE
  E18B  C1            		POP	BC
  E18C  D8            		RET	C
  E18D  100F          		DJNZ	WRDF5		;ここでループカウンタチェック
  E18F  ED5BFEEB      		LD	DE,(_CLPS)
  E193  CD07E7        		CALL	DIVSPC
  E196  21FFFF        		LD	HL,0FFFFH	;FATエントリ終了(EOCマーク)
  E199  C3FAEC        		JP	_SNCL
                      	
  E19C                	WRDF4:				;DEクラスタが空じゃないので次に移動する
  E19C  D1            		POP	DE
  E19D  C1            		POP	BC
  E19E                	WRDF5:
  E19E  CD07E7        		CALL	DIVSPC
  E1A1  13            		INC	DE
  E1A2  CDC4DF        		CALL	ENDCL
  E1A5  CDFAE6        		CALL	MULSPC
  E1A8  38B2          		JR	C,WRDF1
  E1AA  37            		SCF
  E1AB  C9            		RET
                      	
  E1AC                	RWXR:
  E1AC  3A0CE5        		LD	A,(SECSZ+2)	;1024=4 / 512=2 / 256=1
  E1AF                	L_RWX:
  E1AF  1F            		RRA		;->CF
  E1B0  3806          		JR	C,E_RWX
  E1B2  CB38          		SRL	B	;BC=BC/2
  E1B4  CB19          		RR	C	;
  E1B6  18F7          		JR	L_RWX
  E1B8                	E_RWX:
  E1B8  FD5E1A        		LD	E,(IY+26)	;(FCB)ファイルの先頭クラスタ
  E1BB  FD561B        		LD	D,(IY+27)
  E1BE  CDFAE6        		CALL	MULSPC
  E1C1                	RWX1:
  E1C1  ED53FEEB      		LD	(_CLPS),DE
  E1C5  7A            		LD	A,D
  E1C6  B3            		OR	E
  E1C7  37            		SCF
  E1C8  C8            		RET	Z	;RET DE==0
                      	
  E1C9  78            		LD	A,B
  E1CA  B1            		OR	C
  E1CB  C8            		RET	Z	;RET BC==0
                      	
  E1CC  CDECE6        		CALL	GNCLX
  E1CF  D8            		RET	C
  E1D0  0B            		DEC	BC
                      	
  E1D1  CDCCDF        		CALL	ENDCLX
  E1D4  38EB          		JR	C,RWX1
  E1D6  37            		SCF
  E1D7  C9            		RET
                      	
  E1D8                	DSKF:
  E1D8  110000        	MAXCLP:	LD	DE,0
  E1DB  210000        		LD	HL,0
  E1DE                	DSKF1:
  E1DE  D5            		PUSH	DE
  E1DF  CDF7EC        		CALL	_GNCL
  E1E2  380C          		JR	C,POPSCF
  E1E4  7A            		LD	A,D
  E1E5  B3            		OR	E
  E1E6  2001          		JR	NZ,DSKF2
  E1E8  23            		INC	HL
  E1E9                	DSKF2:
  E1E9  D1            		POP	DE
  E1EA  1B            		DEC	DE
  E1EB  7A            		LD	A,D
  E1EC  B3            		OR	E
  E1ED  20EF          		JR	NZ,DSKF1
  E1EF  C9            		RET
                      	
  E1F0                	POPSCF:
  E1F0  F1            		POP	AF
  E1F1  37            		SCF
  E1F2  C9            		RET
                      	
  E1F3                	SETTMS:
  E1F3  FD7E17        		LD	A,(IY+23)	;(FCB)ファイルを最後に変更した時刻
  E1F6  3C            		INC	A
  E1F7  C0            		RET	NZ		;ファイルが更新されていない
  E1F8                	SETTMSX:			;FCBに日付時刻をセットする
  E1F8  CD8FD8        		CALL	_SYS2C		;(BDOS)時刻の獲得
                      					;H←時  L←分  D←秒
  E1FB  CB25          		SLA	L		;L=L/2
  E1FD  CB25          		SLA	L		;L=L/2
  E1FF  29            		ADD	HL,HL		;*2
  E200  29            		ADD	HL,HL		;*4
  E201  29            		ADD	HL,HL		;*8
  E202  7A            		LD	A,D
  E203  0F            		RRCA			;bit.0->7->->->0->C
  E204  E61F          		AND	01FH
  E206  B5            		OR	L
  E207  FD7716        		LD	(IY+22),A	;(FCB)ファイルを最後に変更した時刻
  E20A  FD7417        		LD	(IY+23),H
                      	
  E20D  CD5BD8        		CALL	_SYS2A		;(BDOS)日付の獲得
                      					;HL←年  D←月  E←日
  E210  0144F8        		LD	BC,0-1980
  E213  09            		ADD	HL,BC
  E214  65            		LD	H,L
                      	
  E215  7A            		LD	A,D
  E216  87            		ADD	A,A		;*2
  E217  87            		ADD	A,A		;*4
  E218  87            		ADD	A,A		;*8
  E219  87            		ADD	A,A		;*16
  E21A  6F            		LD	L,A
  E21B  29            		ADD	HL,HL		;*32
  E21C  7D            		LD	A,L
  E21D  B3            		OR	E
  E21E  FD7714        		LD	(IY+20),A	;(FCB)ファイルを最後に変更した日付
  E221  FD7415        		LD	(IY+21),H
  E224  C9            		RET
                      	
  E225                	PUSHRR:
  E225  CD2BE2        		CALL	SUBRR
  E228                	POPRR1:
  E228  EDB0          		LDIR
  E22A  C9            		RET
                      	
  E22B                	SUBRR:
  E22B  FDE5          		PUSH	IY
  E22D  E1            		POP	HL
  E22E  112100        		LD	DE,33
  E231  19            		ADD	HL,DE
  E232  11BFE2        		LD	DE,HLBUF
  E235  010300        		LD	BC,3
  E238  C9            		RET
                      	
  E239                	SETSEQ:
  E239  F5            		PUSH	AF		;AHL=Random record
  E23A  FD7E21        		LD	A,(IY+33)	;(FCB)ランダム・レコード
  E23D  FD6E22        		LD	L,(IY+34)
  E240  FD6623        		LD	H,(IY+35)
                      	
  E243  CD5FE2        		CALL	SSQ1
                      	
  E246  29            		ADD	HL,HL
  E247  CB3D          		SRL	L		;L=L/2
  E249  FD7520        		LD	(IY+32),L	;(FCB)カレント・レコード
  E24C  FD740C        		LD	(IY+12),H	;(FCB)カレント・ブロック
  E24F  F1            		POP	AF
                      	
  E250                	POPRR:
  E250  CD2BE2        		CALL	SUBRR
  E253  EB            		EX	DE,HL
  E254  18D2          		JR	POPRR1
                      	
  E256                	GETSIZE:
  E256  FD7E10        		LD	A,(IY+16)	;(FCB)ファイルのサイズ(バイト単位)
  E259  FD6E11        		LD	L,(IY+17)
  E25C  FD6612        		LD	H,(IY+18)
  E25F                	SSQ1:				;バイト単位からCP/Mのレコード単位を求める（1レコード=128バイト）
  E25F  87            		ADD	A,A		;in HLA => out HL
  E260  ED6A          		ADC	HL,HL
  E262  B7            		OR	A
  E263  C8            		RET	Z
  E264  23            		INC	HL
  E265  C9            		RET
                      	
  E266                	GETSEQ:
  E266  FD6E20        		LD	L,(IY+32)	;(FCB)カレント・レコード
  E269  FD660C        		LD	H,(IY+12)	;(FCB)カレント・ブロック
                      	
  E26C  CB25          		SLA	L	;L=L*2
                      	
  E26E  CB3C          		SRL	H	;HL=HL/2
  E270  CB1D          		RR	L	;
  E272  C9            		RET
                      	
  E273                	RB_WRITE:
  E273  C5            		PUSH	BC
  E274  ED4B4CEC      		LD	BC,(STABLE+2*026H)	;(BDOS)ランダム・ブロック・ライト
  E278  1805          		JR	RBRW
  E27A                	RB_READ:
  E27A  C5            		PUSH	BC
  E27B  ED4B4EEC      		LD	BC,(STABLE+2*027H)	;(BDOS)ランダム・ブロック・リード
  E27F                	RBRW:
  E27F  AF            		XOR	A	;HLA = HL*128
  E280  CB3C          		SRL	H	;HL=HL/2
  E282  CB1D          		RR	L	;
  E284  1F            		RRA			;HLA
  E285  FD7721        		LD	(IY+33),A	;(FCB)ランダム・レコード
  E288  FD7522        		LD	(IY+34),L
  E28B  FD7423        		LD	(IY+35),H
  E28E  218000        		LD	HL,128
                      	
  E291  FDE5          		PUSH	IY
  E293  D1            		POP	DE
  E294  D5            		PUSH	DE
  E295  CD9CE2        		CALL	JP_BC
  E298  FDE1          		POP	IY
  E29A  C1            		POP	BC
  E29B  C9            		RET
  E29C                	JP_BC:
  E29C  C5            		PUSH	BC
  E29D  C9            		RET
                      	
  E29E                	SFILE:	DS	33		;DRV FILENAME
  E2BF                	HLBUF:	DS	3		;Random record buffer
                      	
                      	;LDFILE2.ASM
                      	
                      	;	LSX-Dodgers FILE2
                      	
  E2C2                	RBWDD:
  E2C2  E5            		PUSH	HL
  E2C3  C1            		POP	BC
  E2C4  219CE3        		LD	HL,NUL
  E2C7  CDD0E3        		CALL	DDX
  E2CA  2003          		JR	NZ,RBWDD2
  E2CC  2A08EC        		LD	HL,(STABLE+2*4)
  E2CF                	RBWDD2:
  E2CF  FE43          		CP	'C'
  E2D1  2003          		JR	NZ,RBWDD3
  E2D3  217FDA        		LD	HL,PRINTS
  E2D6                	RBWDD3:
  E2D6  FE50          		CP	'P'
  E2D8  2003          		JR	NZ,RBWDD4
  E2DA  2A0AEC        		LD	HL,(STABLE+2*5)
  E2DD                	RBWDD4:
  E2DD  22EBE2        		LD	(RBWDDP+1),HL
  E2E0  2A8AEC        		LD	HL,(_DTA)
  E2E3                	RBWDD1:
  E2E3  78            		LD	A,B
  E2E4  B1            		OR	C
  E2E5                	RBWDD5:
  E2E5  CA97E3        		JP	Z,RBW1
  E2E8  5E            		LD	E,(HL)
  E2E9  23            		INC	HL
  E2EA  CDD3D7        	RBWDDP:	CALL	_SYS02
  E2ED  DAB3E3        		JP	C,RBRERR
  E2F0  3E1A          		LD	A,01AH
  E2F2  BB            		CP	E
  E2F3  28F0          		JR	Z,RBWDD5
  E2F5  0B            		DEC	BC
  E2F6  18EB          		JR	RBWDD1
                      	
                      					;Write random block
  E2F8                	_SYS26:		;(BDOS)ランダム・ブロック・ライト
  E2F8  AF            		XOR	A
  E2F9  3294E5        		LD	(DRDN1),A	;NOP
  E2FC  224EE5        		LD	(LEFT+1),HL	;HL←書き込むレコード数
  E2FF  2270E5        		LD	(LEFTX),HL
  E302  CDBFDD        		CALL	SETDRV
                      	
  E305  CDBAE4        		CALL	RBX0
  E308  DA9EE3        		JP	C,RBWERR
  E30B  28B5          		JR	Z,RBWDD		;デバイスデスクプリタ
  E30D  CD34E1        		CALL	WOPEN
  E310  DA9EE3        		JP	C,RBWERR
  E313  7C            		LD	A,H
  E314  B5            		OR	L
  E315  CA97E3        		JP	Z,RBW1
                      	
  E318  2B            		DEC	HL
                      	
  E319  CD66E5        		CALL	GET_RR_CDE	;CDE=Random record
                      	
  E31C  AF            		XOR	A	;AHL=HL+CDE
  E31D  19            		ADD	HL,DE
  E31E  89            		ADC	A,C
                      	
  E31F  47            		LD	B,A
  E320  4C            		LD	C,H
                      	
  E321  CDACE1        		CALL	RWXR
  E324  DC45E1        		CALL	C,WRDFX
  E327  DA9EE3        		JP	C,RBWERR
                      		
  E32A  CDE3E4        		CALL	RBX2
  E32D  281A          		JR	Z,RBWB		;NZ=セクタ以下の端数がある
  E32F  CDF6E4        		CALL	RBXA		
  E332  386A          		JR	C,RBWERR
  E334  EB            		EX	DE,HL
  E335  C5            		PUSH	BC
  E336  EDB0          		LDIR
  E338  2272E5        		LD	(DTAX),HL
                      	
  E33B  CDD9E0        		CALL	SWTDBF		;バッファデータは更新された
                      	
  E33E  2A70E5        		LD	HL,(LEFTX)
  E341  D1            		POP	DE
  E342  ED52          		SBC	HL,DE
  E344  2270E5        		LD	(LEFTX),HL
  E347  282E          		JR	Z,RBWEND
                      	
  E349                	RBWB:
  E349  CD2AE5        		CALL	RBXB
  E34C  2813          		JR	Z,RBWC
  E34E                	RBWB1:
  E34E  C5            		PUSH	BC
  E34F  D5            		PUSH	DE
  E350  CDBCDF        		CALL	CLUST
  E353  CD54E8        		CALL	DWT16
  E356  D1            		POP	DE
  E357  C1            		POP	BC
  E358  3844          		JR	C,RBWERR
  E35A  CDECE6        		CALL	GNCLX
  E35D  383F          		JR	C,RBWERR
  E35F  10ED          		DJNZ	RBWB1
  E361                	RBWC:
  E361  CD42E5        		CALL	RBXC
  E364  2811          		JR	Z,RBWEND
                      	
  E366  CDBCDF        		CALL	CLUST
  E369  CD93E5        		CALL	DRDN
  E36C  3830          		JR	C,RBWERR
  E36E  ED5B7EEC      		LD	DE,(_DTBUF)
  E372  EDB0          		LDIR
  E374  CDD9E0        		CALL	SWTDBF		;バッファデータは更新された
  E377                	RBWEND:
  E377  CD4DE5        		CALL	RBXEND
                      	
  E37A  CDC9E4        		CALL	RBX1
  E37D  3018          		JR	NC,RBW1
  E37F  2A4EE5        		LD	HL,(LEFT+1)
  E382  FD5E10        		LD	E,(IY+16)	;(FCB)ファイルのサイズ(バイト単位)
  E385  FD5611        		LD	D,(IY+17)	;CDE=File size
  E388  FD4E12        		LD	C,(IY+18)
  E38B  AF            		XOR	A
  E38C  19            		ADD	HL,DE
  E38D  89            		ADC	A,C
  E38E  FD7510        		LD	(IY+16),L	;(FCB)ファイルのサイズ(バイト単位)
  E391  FD7411        		LD	(IY+17),H
  E394  FD7712        		LD	(IY+18),A
  E397                	RBW1:
  E397  FDE1          		POP	IY
  E399  C1            		POP	BC
  E39A  D1            		POP	DE
  E39B  E1            		POP	HL
  E39C                	NUL:
  E39C  AF            		XOR	A
  E39D  C9            		RET
                      	
  E39E                	RBWERR:
  E39E  FDE5          		PUSH	IY
  E3A0  D1            		POP	DE
  E3A1  2A20EC        		LD	HL,(STABLE+2*010H)
  E3A4  CD0F00        		CALL	JP_HL
  E3A7                	RBRERR1:
  E3A7  3E01          		LD	A,001H
  E3A9                	RBRERR2:
  E3A9  FDE1          		POP	IY
  E3AB  C1            		POP	BC
  E3AC  D1            		POP	DE
  E3AD  E1            		POP	HL
  E3AE  37            		SCF
  E3AF  210000        		LD	HL,0
  E3B2  C9            		RET
                      	
  E3B3                	RBRERR:
  E3B3  3EFF          		LD	A,0FFH
  E3B5  18F2          		JR	RBRERR2
                      	
  E3B7                	RBRFL:
  E3B7  3E00          	RBRFLP:	LD	A,000H
  E3B9  FE0D          		CP	00DH
  E3BB  2005          		JR	NZ,RBRFL1
  E3BD  D5            		PUSH	DE
  E3BE  1E0A          		LD	E,00AH
  E3C0  1805          		JR	RBRFL2
  E3C2                	RBRFL1:
  E3C2  D5            		PUSH	DE
  E3C3  CDA3D3        		CALL	_SYS07
  E3C6  5F            		LD	E,A
  E3C7                	RBRFL2:
  E3C7  CDCDEC        		CALL	_PRINT
  E3CA  7B            		LD	A,E
  E3CB  D1            		POP	DE
  E3CC  32B8E3        		LD	(RBRFLP+1),A
  E3CF  C9            		RET
  E3D0                	DDX:
  E3D0  FD7E01        		LD	A,(IY+1)	;(FCB)主ファイル名
  E3D3  CDD5DF        		CALL	CAP
  E3D6  FE41          		CP	'A'
  E3D8  C9            		RET
                      	
  E3D9                	RBRDD:
  E3D9  E5            		PUSH	HL
  E3DA  C1            		POP	BC
  E3DB  21B7E3        		LD	HL,RBRFL
  E3DE  CDD0E3        		CALL	DDX
  E3E1  2005          		JR	NZ,RBRDD2
  E3E3  2A06EC        		LD	HL,(STABLE+2*3)
  E3E6  1804          		JR	RBRDD3
  E3E8                	RBRDD2:
  E3E8  FE43          		CP	'C'
  E3EA  202C          		JR	NZ,RBRDERR
  E3EC                	RBRDD3:
  E3EC  22FCE3        		LD	(RBRDDP+1),HL
                      	
  E3EF  ED5B8AEC      		LD	DE,(_DTA)
  E3F3  210000        		LD	HL,0
  E3F6                	RBRDD1:
  E3F6  78            		LD	A,B
  E3F7  B1            		OR	C
  E3F8  2818          		JR	Z,RBRDDE1
  E3FA  23            		INC	HL
  E3FB  CDB7E3        	RBRDDP:	CALL	RBRFL
  E3FE  380D          		JR	C,RBRDDE
  E400  FE1A          		CP	01AH
  E402  2809          		JR	Z,RBRDDE
  E404  FE03          		CP	3
  E406  2805          		JR	Z,RBRDDE
  E408  12            		LD	(DE),A
  E409  13            		INC	DE
  E40A  0B            		DEC	BC
  E40B  18E9          		JR	RBRDD1
                      	
  E40D                	RBRDDE:
  E40D  3E1A          		LD	A,01AH
  E40F  12            		LD	(DE),A
  E410                	RBRDDE2:
  E410  AF            		XOR	A
  E411  3C            		INC	A
  E412                	RBRDDE1:
  E412  32A6E4        		LD	(RBRAP+1),A
  E415  C39FE4        		JP	RBREND0
  E418                	RBRDERR:
  E418  210000        		LD	HL,0
  E41B  18F3          		JR	RBRDDE2
                      	
                      					;Read random block
  E41D                	_SYS27:		;(BDOS)ランダム・ブロック・リード
  E41D  2270E5        		LD	(LEFTX),HL
  E420  CDBFDD        		CALL	SETDRV
                      	
  E423  FDCB0D66      		BIT	4,(IY+13)	;(FCB)属性(アトリビュート)
  E427  C2A8E4        		JP	NZ,RBRDIR	;ディレクトリ
  E42A  CDBAE4        		CALL	RBX0
  E42D  DAB3E3        		JP	C,RBRERR
  E430  28A7          		JR	Z,RBRDD
  E432  CDC9E4        		CALL	RBX1
  E435  DAA7E3        		JP	C,RBRERR1
  E438  79            		LD	A,C
  E439  EB            		EX	DE,HL
  E43A  ED52          		SBC	HL,DE		;CP 0HL,CDE
  E43C  19            		ADD	HL,DE
  E43D  DE00          		SBC	A,000H
  E43F  3801          		JR	C,RBR1
  E441  EB            		EX	DE,HL
  E442                	RBR1:
  E442  9F            		SBC	A,A
  E443  E601          		AND	1
  E445  32A6E4        		LD	(RBRAP+1),A
                      	
  E448  7C            		LD	A,H
  E449  B5            		OR	L
  E44A  CA9FE4        		JP	Z,RBREND0
                      	
  E44D  224EE5        		LD	(LEFT+1),HL	;Read record byte
  E450  2270E5        		LD	(LEFTX),HL
                      	
  E453  CDE3E4        		CALL	RBX2
  E456  2819          		JR	Z,RBRB
  E458  CDF6E4        		CALL	RBXA
  E45B  DAB3E3        		JP	C,RBRERR
  E45E  C5            		PUSH	BC
  E45F  EDB0          		LDIR
  E461  ED5372E5      		LD	(DTAX),DE
  E465  2A70E5        		LD	HL,(LEFTX)
  E468  D1            		POP	DE
  E469  A7            		AND	A
  E46A  ED52          		SBC	HL,DE
  E46C  2270E5        		LD	(LEFTX),HL
  E46F  282B          		JR	Z,RBREND
                      	
  E471                	RBRB:
  E471  CD2AE5        		CALL	RBXB
  E474  2812          		JR	Z,RBRC
  E476                	RBRB1:
  E476  C5            		PUSH	BC
  E477  D5            		PUSH	DE
  E478  CDBCDF        		CALL	CLUST
  E47B  CD35E8        		CALL	DRD16
  E47E  D1            		POP	DE
  E47F  C1            		POP	BC
  E480  D4ECE6        		CALL	NC,GNCLX
  E483  DAB3E3        		JP	C,RBRERR
  E486  10EE          		DJNZ	RBRB1
  E488                	RBRC:
  E488  CD42E5        		CALL	RBXC
  E48B  280F          		JR	Z,RBREND
                      	
  E48D  CDBCDF        		CALL	CLUST
  E490  CD7BE5        		CALL	DRDX
  E493  DAB3E3        		JP	C,RBRERR
  E496  EB            		EX	DE,HL
  E497  2A7EEC        		LD	HL,(_DTBUF)
  E49A  EDB0          		LDIR
  E49C                	RBREND:
  E49C  CD4DE5        		CALL	RBXEND
  E49F                	RBREND0:
  E49F  FDE1          		POP	IY
  E4A1  C1            		POP	BC
  E4A2  D1            		POP	DE
  E4A3  F1            		POP	AF	;(HL)
  E4A4  AF            		XOR	A
  E4A5  3E00          	RBRAP:	LD	A,000H
  E4A7  C9            		RET
                      	
  E4A8                	RBRDIR:
  E4A8  FD6E1A        		LD	L,(IY+26)	;(FCB)ファイルの先頭クラスタ
  E4AB  FD661B        		LD	H,(IY+27)
  E4AE  CDF0DF        		CALL	CHDIR
  E4B1  AF            		XOR	A
  E4B2  67            		LD	H,A
  E4B3  6F            		LD	L,A
  E4B4  3C            		INC	A
  E4B5  32A6E4        		LD	(RBRAP+1),A
  E4B8  18E5          		JR	RBREND0
                      	
  E4BA                	RBX0:
  E4BA  2A8AEC        		LD	HL,(_DTA)
  E4BD  2272E5        		LD	(DTAX),HL
  E4C0  2A70E5        		LD	HL,(LEFTX)
  E4C3  FD7E1C        		LD	A,(IY+28)	;(FCB)オープン・モード
  E4C6  D6FD          		SUB	0FDH
  E4C8  C9            		RET
                      	
  E4C9                	RBX1:
  E4C9  E5            		PUSH	HL		;Record byte
                      					;AHL=File size
  E4CA  FD6E10        		LD	L,(IY+16)	;ファイルのサイズ(バイト単位)
  E4CD  FD6611        		LD	H,(IY+17)
  E4D0  FD7E12        		LD	A,(IY+18)
                      	
  E4D3  CD66E5        		CALL	GET_RR_CDE	;CDE=Random record
                      	
  E4D6  A7            		AND	A
  E4D7  ED52          		SBC	HL,DE
  E4D9  99            		SBC	A,C
  E4DA  D1            		POP	DE
                      	
  E4DB  D8            		RET	C
  E4DC  4F            		LD	C,A
  E4DD  EB            		EX	DE,HL	;CDE=File byte	HL=Record byte
  E4DE  B2            		OR	D
  E4DF  B3            		OR	E
  E4E0  C0            		RET	NZ
  E4E1  37            		SCF
  E4E2  C9            		RET
                      	
  E4E3                	RBX2:				;Cluster settings
  E4E3  FD4E22        		LD	C,(IY+34)	;(+33)(FCB)ランダム・レコード
  E4E6  FD4623        		LD	B,(IY+35)
  E4E9  CDACE1        		CALL	RWXR
  E4EC  3AEDDE        		LD	A,(SECSZM1+2)	;1024=3 / 512=1 / 256=0
  E4EF  FDA622        		AND	(IY+34)
  E4F2  FDB621        		OR	(IY+33)
  E4F5  C9            		RET
                      	
  E4F6                	RBXA:
  E4F6  D5            		PUSH	DE
  E4F7  CDBCDF        		CALL	CLUST
  E4FA  CD7BE5        		CALL	DRDX
  E4FD  D1            		POP	DE
  E4FE  D8            		RET	C
  E4FF  CDECE6        		CALL	GNCLX
  E502  D8            		RET	C
  E503  ED53FEEB      		LD	(_CLPS),DE
                      	
  E507  FD4E21        		LD	C,(IY+33)	;(FCB)ランダム・レコード
  E50A  210004        	SECSZ:	LD	HL,0400H	;自己書き換え 1024=0400H / 512=0200H ここに1セクタのサイズが格納される
  E50D  7C            		LD	A,H
  E50E  3D            		DEC	A		;1024=3 / 512=1
  E50F  FDA622        		AND	(IY+34)		;(FCB)ランダム・レコード
  E512  47            		LD	B,A		;BCに1セクタ以下の端数が入る
  E513  ED42          		SBC	HL,BC		;残りを計算
                      	
  E515  ED5B70E5      		LD	DE,(LEFTX)
  E519  ED52          		SBC	HL,DE		;CP HL,DE
  E51B  19            		ADD	HL,DE		;
  E51C  3801          		JR	C,RBXA1		;DEとHLを比較して大きい方をHLに
  E51E  EB            		EX	DE,HL
  E51F                	RBXA1:
  E51F  E5            		PUSH	HL
  E520  2A7EEC        		LD	HL,(_DTBUF)
  E523  09            		ADD	HL,BC
  E524  ED5B72E5      		LD	DE,(DTAX)
  E528  C1            		POP	BC
  E529  C9            		RET
                      	
  E52A                	RBXB:
  E52A  2A72E5        		LD	HL,(DTAX)
  E52D  ED5BFEEB      		LD	DE,(_CLPS)
  E531  3A71E5        		LD	A,(LEFTX+1)
  E534  47            		LD	B,A
  E535  3A0CE5        		LD	A,(SECSZ+2)	;1024=4 / 512=2 / 256=1
  E538                	RBXB1:
  E538  1F            		RRA		;->CF
  E539  3804          		JR	C,RBXB2
  E53B  CB38          		SRL	B	;B=B/2
  E53D  18F9          		JR	RBXB1
  E53F                	RBXB2:
  E53F  78            		LD	A,B
  E540  B7            		OR	A
  E541  C9            		RET
                      	
  E542                	RBXC:
  E542  ED4B70E5      		LD	BC,(LEFTX)
  E546  3AEDDE        		LD	A,(SECSZM1+2)	;1024=3 / 512=1 / 256=0
  E549  A0            		AND	B
  E54A  47            		LD	B,A		;1セクタ以下の端数がない場合はZ
  E54B  B1            		OR	C
  E54C  C9            		RET
                      	
  E54D                	RBXEND:
  E54D  110000        	LEFT:	LD	DE,0
  E550  AF            		XOR	A
  E551  FD6E21        		LD	L,(IY+33)	;(FCB)ランダム・レコード
  E554  FD6622        		LD	H,(IY+34)
  E557  19            		ADD	HL,DE
  E558  FD8E23        		ADC	A,(IY+35)
  E55B  FD7521        		LD	(IY+33),L	;(FCB)ランダム・レコード
  E55E  FD7422        		LD	(IY+34),H
  E561  FD7723        		LD	(IY+35),A
  E564  EB            		EX	DE,HL		;HL=Read byte
  E565  C9            		RET
                      	
  E566                	GET_RR_CDE:			;CDE=Random record
  E566  FD5E21        		LD	E,(IY+33)	;(FCB)ランダム・レコード
  E569  FD5622        		LD	D,(IY+34)
  E56C  FD4E23        		LD	C,(IY+35)
  E56F  C9            		RET
                      	
  E570                	CPBUF:
  E570  0000          	LEFTX:	DW	0
  E572  0000          	DTAX:	DW	0
  E574  20            		DB	020H	;DS 7,20h
  E575  20            		DB	020H
  E576  20            		DB	020H
  E577  20            		DB	020H
  E578  20            		DB	020H
  E579  20            		DB	020H
  E57A  20            		DB	020H
                      	;
                      	
                      	;LDDIO.ASM
                      	
                      	;	LSX-Dodgers DIO
                      	
  E57B                	DRDX:
  E57B  CDB1E5        		CALL	DRDY
  E57E  C8            		RET	Z
  E57F  CD9BE5        		CALL	DRDX1		;データバッファの情報を保存
  E582  D8            		RET	C
  E583  E5            		PUSH	HL
  E584  C5            		PUSH	BC
  E585  D5            		PUSH	DE
  E586  2A7EEC        		LD	HL,(_DTBUF)
  E589  CD35E8        		CALL	DRD16
  E58C  DCACE5        		CALL	C,DRDNE
  E58F                	POP_DE_BC_HL_RET:
  E58F  D1            		POP	DE
  E590  C1            		POP	BC
  E591  E1            		POP	HL
  E592  C9            		RET
                      	
  E593                	DRDN:
  E593  AF            		XOR	A
  E594  00            	DRDN1:	NOP			;自己書き換え NOP / SCF
  E595  30E4          		JR	NC,DRDX
  E597                	DRDNX:
  E597  CDB1E5        		CALL	DRDY
  E59A  C8            		RET	Z
  E59B                	DRDX1:				;データバッファの情報を保存
  E59B  CDC2E5        		CALL	DWTX
  E59E  ED53A6EC      		LD	(_DBSEC),DE
  E5A2  3A88EC        		LD	A,(_DRV)
  E5A5  32A5EC        		LD	(_DBDRV),A
  E5A8  CDD9EC        		CALL	_CHGDRV
  E5AB  D0            		RET	NC
  E5AC                	DRDNE:
  E5AC  9F            		SBC	A,A		;CF=1ならばA=0FFH
  E5AD  32A5EC        		LD	(_DBDRV),A
  E5B0  C9            		RET
                      	
  E5B1                	DRDY:
  E5B1  E5            		PUSH	HL
  E5B2  3A88EC        		LD	A,(_DRV)
  E5B5  21A5EC        		LD	HL,_DBDRV
  E5B8  AE            		XOR	(HL)
  E5B9  2005          		JR	NZ,POP_HL_RET
                      	
  E5BB  2AA6EC        		LD	HL,(_DBSEC)
  E5BE  ED52          		SBC	HL,DE		;CF=0
  E5C0                	POP_HL_RET:
  E5C0  E1            		POP	HL
  E5C1  C9            		RET
                      	
  E5C2                	DWTX:
  E5C2  3AA4EC        		LD	A,(_WTDBF)
  E5C5  B7            		OR	A
  E5C6  C8            		RET	Z
  E5C7  AF            		XOR	A
  E5C8  32A4EC        		LD	(_WTDBF),A
                      	
  E5CB  E5            		PUSH	HL
  E5CC  C5            		PUSH	BC
  E5CD  D5            		PUSH	DE
  E5CE  3AA5EC        		LD	A,(_DBDRV)
  E5D1  CDD9EC        		CALL	_CHGDRV
  E5D4  ED5BA6EC      		LD	DE,(_DBSEC)
  E5D8  2A7EEC        		LD	HL,(_DTBUF)
  E5DB  D454E8        		CALL	NC,DWT16
  E5DE  18AF          		JR	POP_DE_BC_HL_RET
                      	
  E5E0                	RDFATX:
  E5E0  E5            		PUSH	HL
  E5E1  3A88EC        		LD	A,(_DRV)
  E5E4  21AAEC        		LD	HL,_FATDRV
  E5E7  AE            		XOR	(HL)
  E5E8  28D6          		JR	Z,POP_HL_RET
                      	
  E5EA  C5            		PUSH	BC
  E5EB  D5            		PUSH	DE
  E5EC  DDE5          		PUSH	IX
  E5EE  CD0AE6        		CALL	WTFATX
  E5F1  3813          		JR	C,POP_IX_DE_BC_HL_RET
                      	
  E5F3  AF            		XOR	A
  E5F4  32ABEC        		LD	(_FATIX),A
  E5F7  3A88EC        		LD	A,(_DRV)
  E5FA  32AAEC        		LD	(_FATDRV),A
  E5FD  CDE5EC        		CALL	_RDFAT
  E600                	RDFATE2:
  E600  3004          		JR	NC,POP_IX_DE_BC_HL_RET
  E602  9F            		SBC	A,A		;A=0xFF
  E603  32AAEC        		LD	(_FATDRV),A
  E606                	POP_IX_DE_BC_HL_RET:
  E606  DDE1          		POP	IX
  E608  1885          		JR	POP_DE_BC_HL_RET
                      	
  E60A                	WTFATX:
  E60A  3AA2EC        		LD	A,(_WTFATF)
  E60D  B7            		OR	A
  E60E  C8            		RET	Z
  E60F  E5            		PUSH	HL
  E610  3AAAEC        		LD	A,(_FATDRV)
  E613  21A5EC        		LD	HL,_DBDRV
  E616  AE            		XOR	(HL)
  E617  CCC2E5        		CALL	Z,DWTX
  E61A  38A4          		JR	C,POP_HL_RET
  E61C  C5            		PUSH	BC
  E61D  D5            		PUSH	DE
  E61E  DDE5          		PUSH	IX
  E620  CD61E8        		CALL	WTFAT
  E623  AF            		XOR	A
  E624  32A2EC        		LD	(_WTFATF),A
  E627  18DD          		JR	POP_IX_DE_BC_HL_RET
                      	
  E629                	NCL1:
  E629  7A            		LD	A,D
  E62A  B3            		OR	E
  E62B  37            		SCF
  E62C  C8            		RET	Z
                      	
  E62D  7A            		LD	A,D
  E62E  E608          		AND	8		;DE(targetCluster >= 0x800)
  E630                	N16CL1X:
  E630  E5            		PUSH	HL
  E631  3250E6        		LD	(NCLPAT+2),A	;_FATIX
  E634  2AAAEC        		LD	HL,(_FATDRV)	;L=_FATDRV H=_FATIX
  E637  BC            		CP	H
  E638  3A88EC        		LD	A,(_DRV)	;この間でフラグは変化しない
  E63B  324FE6        		LD	(NCLPAT+1),A	;_FATDRV
  E63E  2005          		JR	NZ,NCL2		;FATIXが違う
  E640  BD            		CP	L
  E641  2002          		JR	NZ,NCL2		;ドライブが違う
  E643  E1            		POP	HL
  E644  C9            		RET
  E645                	NCL2:
  E645  C5            		PUSH	BC
  E646  D5            		PUSH	DE
  E647  DDE5          		PUSH	IX
  E649  CD0AE6        		CALL	WTFATX
  E64C  38B8          		JR	C,POP_IX_DE_BC_HL_RET
  E64E  010000        	NCLPAT:	LD	BC,0		;自己書き換え C=_FATDRV B=_FATIX
  E651  ED43AAEC      		LD	(_FATDRV),BC
  E655  CD43E8        		CALL	RDFATS
  E658  18A6          		JR	RDFATE2
                      	
  E65A                	NCL3:
  E65A  CB9A          		RES	3,D
  E65C  6B            		LD	L,E
  E65D  62            		LD	H,D
  E65E  CB3C          		SRL	H	;
  E660  CB1D          		RR	L	;HLA=HLA/2
  E662  1F            		RRA		;
  E663  ED4B7CEC      		LD	BC,(_FATBF)
  E667  19            		ADD	HL,DE
  E668  09            		ADD	HL,BC
  E669  17            		RLA
  E66A  C9            		RET
                      	
  E66B                	N16CL1:
  E66B  7A            		LD	A,D
  E66C  B3            		OR	E
  E66D  37            		SCF
  E66E  C8            		RET	Z
                      	
  E66F  7A            		LD	A,D
  E670  CB3F          		SRL	A	;/2
  E672  CB3F          		SRL	A	;/2
  E674  18BA          		JR	N16CL1X
                      	
  E676                	GNCL:
  E676  CD29E6        		CALL	NCL1		;GET NEXT CLUSTER
  E679  D8            		RET	C
  E67A  C5            		PUSH	BC
  E67B  E5            		PUSH	HL
  E67C  CD5AE6        		CALL	NCL3
  E67F  3809          		JR	C,GNC1
  E681  5E            		LD	E,(HL)
  E682  23            		INC	HL
  E683  7E            		LD	A,(HL)
  E684  E60F          		AND	00FH
  E686  57            		LD	D,A
  E687  E1            		POP	HL
  E688  C1            		POP	BC
  E689  C9            		RET
  E68A                	GNC1:
  E68A  7E            		LD	A,(HL)
  E68B  23            		INC	HL
  E68C  56            		LD	D,(HL)
  E68D  0604          		LD	B,4
  E68F                	GNC1L:
  E68F  CB3A          		SRL	D	;DA=DA/2
  E691  1F            		RRA		;
  E692  10FB          		DJNZ	GNC1L
                      	
  E694  5F            		LD	E,A
  E695  E1            		POP	HL
  E696  C1            		POP	BC
  E697  A7            		AND	A
  E698  C9            		RET
                      	
  E699                	SNCL:
  E699  CD29E6        		CALL	NCL1
  E69C  D8            		RET	C
                      	;				SET NEXT CLUSTER
  E69D  E5            		PUSH	HL
  E69E  C5            		PUSH	BC
  E69F  D5            		PUSH	DE
  E6A0  E5            		PUSH	HL
  E6A1  CD5AE6        		CALL	NCL3
  E6A4  D1            		POP	DE
                      	;CF=ODD
  E6A5  7E            		LD	A,(HL)
  E6A6  73            		LD	(HL),E
  E6A7  3806          		JR	C,SNC1
                      	;EVEN
                      	;M[0] = E
                      	;M[1] = (M[1] & 0xF0) | (D & 0x0F)
  E6A9  23            		INC	HL
  E6AA  ED67          		RRD		;M={A[3:0],E[3:0]}
  E6AC  7A            		LD	A,D
  E6AD  1804          		JR	SNC11
  E6AF                	SNC1:
                      	;ODD
                      	;HL[0] = (HL[0]&0x0F) | (E<<4)
                      	;HL[1] = DE>>4
  E6AF  ED6F          		RLD		;M={D[3:0],E[7:4]}
  E6B1  23            		INC	HL
  E6B2  72            		LD	(HL),D	;M={D[3:0],E[7:4]}
  E6B3                	SNC11:
  E6B3  ED6F          		RLD		;M={M[7:4],D[3:0]}
  E6B5  B7            		OR	A
  E6B6  D1            		POP	DE
  E6B7  C1            		POP	BC
  E6B8  E1            		POP	HL
  E6B9                	FAT_CHANGED:
  E6B9  3E01          		LD	A,1
  E6BB  32A2EC        		LD	(_WTFATF),A
  E6BE  C9            		RET
                      	
  E6BF                	N16CL3:
  E6BF  C5            		PUSH	BC
  E6C0  6B            		LD	L,E
  E6C1  7A            		LD	A,D
  E6C2  E603          		AND	3
  E6C4  67            		LD	H,A
  E6C5  29            		ADD	HL,HL
  E6C6  ED4B7CEC      		LD	BC,(_FATBF)
  E6CA  09            		ADD	HL,BC
  E6CB  C1            		POP	BC
  E6CC  C9            		RET
                      	
  E6CD                	GNCL16:
  E6CD  CD6BE6        		CALL	N16CL1		;GET NEXT CLUSTER for FAT16
  E6D0  D8            		RET	C
  E6D1  E5            		PUSH	HL
  E6D2  CDBFE6        		CALL	N16CL3
  E6D5  5E            		LD	E,(HL)
  E6D6  23            		INC	HL
  E6D7  56            		LD	D,(HL)
  E6D8  E1            		POP	HL
  E6D9  C9            		RET
                      	
  E6DA                	SNCL16:
  E6DA  CD6BE6        		CALL	N16CL1		;GET NEXT CLUSTER for FAT16
  E6DD  D8            		RET	C
  E6DE  D5            		PUSH	DE
  E6DF  E5            		PUSH	HL
  E6E0  CDBFE6        		CALL	N16CL3
  E6E3  D1            		POP	DE		;HL
  E6E4  73            		LD	(HL),E
  E6E5  23            		INC	HL
  E6E6  72            		LD	(HL),D
  E6E7  6B            		LD	L,E
  E6E8  62            		LD	H,D
  E6E9  D1            		POP	DE
  E6EA  18CD          		JR	FAT_CHANGED
                      	
                      	;------------------------
                      	;次のセクタを探す際に「1クラスタの論理セクタ数」を掛けてまとめて扱う
                      	;in
                      	;	DE : セクタ番号×1クラスタの論理セクタ数＋α
                      	;out
                      	;	DE : 次のセクタ番号×1クラスタの論理セクタ数＋α
                      	;note
                      	;	「FAT12」最大12ビット + 「1クラスタの論理セクタ数」4ビットで計16ビットとして扱う
                      	;------------------------
  E6EC                	GNCLX:
  E6EC  7B            		LD	A,E
  E6ED  3C            		INC	A
  E6EE  E600          	NCPAT:	AND	0	;自己書き換え　1クラスタの論理セクタ数-1
  E6F0  2802          		JR	Z,GNCLX1
  E6F2  13            		INC	DE	;クラスタを跨がない場合は単純に+1する
  E6F3  C9            		RET
  E6F4                	GNCLX1:
  E6F4  CD07E7        		CALL	DIVSPC	;クラスタを跨ぐ場合は
  E6F7  CDF7EC        		CALL	_GNCL	;次のクラスタを探す
                      	
                      	;------------------------
                      	;クラスタと「1クラスタの論理セクタ数」を掛ける
                      	;in
                      	;	DE : セクタ番号
                      	;out
                      	;	DE : 掛けられた値
                      	;note
                      	;	DE以外のレジスタとフラグは保持する
                      	;------------------------
  E6FA                	MULSPC:
  E6FA  F5            		PUSH	AF
  E6FB  EB            		EX	DE,HL
  E6FC  3E01          	SPCPAT:	LD	A,1		;自己書き換え（1クラスタの論理セクタ数）
  E6FE                	CLDBL:
  E6FE  0F            		RRCA			;->CF
  E6FF  3803          		JR	C,CLDBL_RET
  E701  29            		ADD	HL,HL		;*2
  E702  18FA          		JR	CLDBL
  E704                	CLDBL_RET:
  E704  EB            		EX	DE,HL
  E705                	POP_AF_RET
  E705  F1            		POP	AF
  E706  C9            		RET
                      	
                      	;------------------------
                      	;「1クラスタの論理セクタ数」を割って論理セクタだけに戻す
                      	;in
                      	;	DE : 掛けられた値
                      	;out
                      	;	DE : セクタ番号
                      	;note
                      	;	DE以外のレジスタとフラグは保持する
                      	;------------------------
  E707                	DIVSPC:
  E707  F5            		PUSH	AF
  E708  3AFDE6        		LD	A,(SPCPAT+1)	;1クラスタの論理セクタ
  E70B                	CLDIV1:
  E70B  0F            		RRCA			;->CF
  E70C  38F7          		JR	C,POP_AF_RET
  E70E  CB3A          		SRL	D		;DE=DE/2
  E710  CB1B          		RR	E		;
  E712  18F7          		JR	CLDIV1
                      	
  E714                	RDFAT:
  E714  3E80          		LD	A,080H
  E716  327FEB        		LD	(CHECK),A
  E719                	RDFAT1:
  E719  3A88EC        		LD	A,(_DRV)
  E71C  CDAEE9        		CALL	CHGDRVR
  E71F  D8            		RET	C
  E720  DD7E12        		LD	A,(IX+012H)	;DPB_12_DEVICE
  E723  CB6F          		BIT	5,A
  E725  CA2BE8        		JP	Z,RDFAT0X
  E728  217FEB        		LD	HL,CHECK
  E72B  A6            		AND	(HL)
  E72C  77            		LD	(HL),A
  E72D  110000        		LD	DE,0		;BPB
  E730  2A7CEC        		LD	HL,(_FATBF)
  E733  CD35E8        		CALL	DRD16
  E736  3024          		JR	NC,GET_BPB
  E738  217FEB        		LD	HL,CHECK
  E73B  CB06          		RLC	(HL)
  E73D  3F            		CCF
  E73E  D8            		RET	C
  E73F  DDCB0A1E      		RR	(IX+00AH)	;DPB_0A_FDMODE
  E743  3F            		CCF			;フロッピーディスクのMFMモードを切り替える
  E744  DDCB0A16      		RL	(IX+00AH)	;DPB_0A_FDMODE
  E748  3EFF          		LD	A,0FFH
  E74A  3289EC        		LD	(_DSK),A
  E74D  3A84EC        		LD	A,(_DRIVE)
  E750  E603          		AND	3
  E752  F680          		OR	080H
  E754  6F            		LD	L,A
  E755  26EC          		LD	H,_CYL0/256
  E757  3EFF          		LD	A,0FFH
  E759  77            		LD	(HL),A
  E75A  18BD          		JR	RDFAT1
  E75C                	GET_BPB:
  E75C  FDE5          		PUSH	IY
  E75E  FD2A7CEC      		LD	IY,(_FATBF)	;BPB
                      	
  E762  FD7E00        		LD	A,(IY+0)	;BS_JmpBoot
  E765  FEEB          		CP	0EBH		;Short jump
  E767  280C          		JR	Z,BPBOK
  E769  FEE9          		CP	0E9H		;Near jump
  E76B  2808          		JR	Z,BPBOK
  E76D  FE60          		CP	060H		;X68k
  E76F  2804          		JR	Z,BPBOK
  E771                	NOT_BPB
  E771  FDE1          		POP	IY
  E773  37            		SCF
  E774  C9            		RET
  E775                	BPBOK:
  E775  FD7E0D        		LD	A,(IY+13)	;BPB_SecPerClus
  E778  DD7707        		LD	(IX+7),A	;DPB_07_SECPCL
                      	
  E77B  FD7E10        		LD	A,(IY+16)	;BPB_NumFATs
  E77E  FE02          		CP	2		;>2:NC
  E780  FD7E0C        		LD	A,(IY+12)	;BPB_BytsPerSec
  E783  3806          		JR	C,BPBFAT1
  E785  FE05          		CP	5
  E787  30E8          		JR	NC,NOT_BPB	;1セクタ1024以上は無効
  E789  F680          		OR	080H
  E78B                	BPBFAT1:
  E78B  DD770F        		LD	(IX+00FH),A	;DPB_0F_BPS
                      	
  E78E  FD7E16        		LD	A,(IY+22)	;BPB_FATSz16
  E791  DD7700        		LD	(IX+0),A	;DPB_00_FATLN
  E794  FD7E17        		LD	A,(IY+23)	;BPB_FATSz16
  E797  DD7701        		LD	(IX+1),A	;DPB_00_FATLN
                      	
  E79A  FD6E0E        		LD	L,(IY+14)	;BPB_RsvdSecCnt
  E79D  FD660F        		LD	H,(IY+15)
  E7A0  DD750E        		LD	(IX+00EH),L	;DPB_0E_FATPS
  E7A3  FD5E16        		LD	E,(IY+22)	;BPB_FATSz16
  E7A6  FD5617        		LD	D,(IY+23)
  E7A9  FD4610        		LD	B,(IY+16)	;BPB_NumFATs
  E7AC                	BPBDP1:				;BPB_FATSz16 * BPB_NumFATs
  E7AC  19            		ADD	HL,DE
  E7AD  10FD          		DJNZ	BPBDP1
  E7AF                	BPBDP2:
  E7AF  DD7510        		LD	(IX+010H),L	;DPB_10_DIRPS
  E7B2  DD7411        		LD	(IX+011H),H
  E7B5  E5            		PUSH	HL
                      	
  E7B6  FD6E11        		LD	L,(IY+17)	;BPB_RootEntCnt
  E7B9  FD6612        		LD	H,(IY+18)
  E7BC  FD7E0C        		LD	A,(IY+12)	;BPB_BytsPerSec
  E7BF  0606          		LD	B,6
  E7C1                	BPBBPS1:
  E7C1  05            		DEC	B
  E7C2  0F            		RRCA
  E7C3  30FC          		JR	NC,BPBBPS1
  E7C5                	BPBDE1:
  E7C5  29            		ADD	HL,HL
  E7C6  10FD          		DJNZ	BPBDE1
                      	
  E7C8  7C            		LD	A,H
  E7C9  DD770B        		LD	(IX+00BH),A	;DPB_0B_DIRSCNT
                      	
  E7CC  D1            		POP	DE		;DPB_10_DIRPS
  E7CD  6C            		LD	L,H
  E7CE  2600          		LD	H,0
  E7D0  19            		ADD	HL,DE		;MAXDIR
  E7D1  E5            		PUSH	HL
  E7D2  FD4E0D        		LD	C,(IY+13)	;BPB_SecPerClus
  E7D5  CB21          		SLA	C
  E7D7  AF            		XOR	A
  E7D8  47            		LD	B,A
  E7D9  ED42          		SBC	HL,BC
  E7DB  DD7514        		LD	(IX+014H),L	;DPB_14_ADDCL16
  E7DE  DD7415        		LD	(IX+015H),H
                      	
  E7E1  FD6E13        		LD	L,(IY+19)	;BPB_TotSec16
  E7E4  FD6614        		LD	H,(IY+20)
  E7E7  D1            		POP	DE		;DE=DPB_0B_MAXDIR
  E7E8  7C            		LD	A,H
  E7E9  B5            		OR	L
  E7EA  2885          		JR	Z,NOT_BPB	;セクタ数が16ビットを超えるものは危険なので扱わない
  E7EC  ED52          		SBC	HL,DE
  E7EE  FD460D        		LD	B,(IY+13)	;BPB_SecPerClus
  E7F1                	BPBTC1:				;総クラスタ数 = 総セクタ数 / セクタサイズ
  E7F1  CB18          		RR	B
  E7F3  3806          		JR	C,BPBTC2
  E7F5  CB3C          		SRL	H
  E7F7  CB1D          		RR	L
  E7F9  18F6          		JR	BPBTC1
  E7FB                	BPBTC2:
  E7FB  23            		INC	HL
  E7FC  23            		INC	HL
  E7FD  DD7508        		LD	(IX+8),L	;DPB_08_MAXCL
  E800  DD7409        		LD	(IX+9),H
                      	
  E803  FD7E15        		LD	A,(IY+21)	;BPB_Media
  E806  DD7706        		LD	(IX+6),A	;DPB_06_FATID
                      	
  E809  DDCB0A7E      		BIT	7,(IX+00AH)	;DPB_0A_FDMODE
  E80D  2817          		JR	Z,NOT_FD
  E80F  2E28          		LD	L,40		;MAXCYLの設定（要検討）
  E811  FEFD          		CP	0FDH	;2D
  E813  2808          		JR	Z,SETCYL
  E815  2E4D          		LD	L,77
  E817  FEFE          		CP	0FEH	;2HD
  E819  2802          		JR	Z,SETCYL
  E81B  2E50          		LD	L,80	;その他2DD等
  E81D                	SETCYL:
  E81D  DD750C        		LD	(IX+00CH),L	;DPB_0C_MAXCYL
  E820  FD7E18        		LD	A,(IY+24)	;BPB_SecPerTr
  E823  DD770D        		LD	(IX+00DH),A	;DPB_0D_MAXSEC
  E826                	NOT_FD:
  E826  FDE1          		POP	IY
  E828  CDFBE8        		CALL	CHGDRV2
  E82B                	RDFAT0X:
  E82B  CD43E8        		CALL	RDFATS
  E82E  D8            		RET	C
  E82F  DDBE06        		CP	(IX+6)		;DPB_06_FATID
  E832  C8            		RET	Z
  E833  37            		SCF
  E834  C9            		RET
                      	
  E835                	DRD16:
  E835  0E00          		LD	C,0
  E837                	DRD24:
  E837  DDE5          		PUSH	IX
  E839  DD2AA8EC      		LD	IX,(_DPB)
  E83D  CDC6EA        	DRDPAT:	CALL	FDRD		;自己書き換え（ディスク読み込み）
  E840                	POP_IX_RET:
  E840  DDE1          		POP	IX
  E842  C9            		RET
                      	
  E843                	RDFATS:
  E843  CD80E8        		CALL	FATSETUP
  E846  D8            		RET	C
  E847                	RDFATL:
  E847  C5            		PUSH	BC
  E848  CD35E8        		CALL	DRD16
  E84B  C1            		POP	BC
  E84C  D8            		RET	C
  E84D  10F8          		DJNZ	RDFATL
  E84F  2A7CEC        		LD	HL,(_FATBF)
  E852  7E            		LD	A,(HL)
  E853  C9            		RET
                      	
  E854                	DWT16:
  E854  0E00          		LD	C,0
  E856                	DWT24:
  E856  DDE5          		PUSH	IX
  E858  DD2AA8EC      		LD	IX,(_DPB)
  E85C  CDBDEA        	DWTPAT:	CALL	FDWT		;自己書き換え（ディスク書き込み）
  E85F  18DF          		JR	POP_IX_RET
                      	
  E861                	WTFAT:
  E861  CD80E8        		CALL	FATSETUP
  E864  D477E8        		CALL	NC,WTFATL
  E867  D8            		RET	C
  E868  DDCB0F7E      		BIT	7,(IX+00FH)	;DPB_0F_BPS
  E86C  C8            		RET	Z		;予備FATが無い
  E86D  CD87E8        		CALL	FATS2
  E870  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E873                	WTFAT2:
  E873  13            		INC	DE
  E874  3D            		DEC	A
  E875  20FC          		JR	NZ,WTFAT2
  E877                	WTFATL:
  E877  C5            		PUSH	BC
  E878  CD54E8        		CALL	DWT16
  E87B  C1            		POP	BC
  E87C  D8            		RET	C
  E87D  10F8          		DJNZ	WTFATL
  E87F  C9            		RET
                      	;------------------------
                      	;FATのセットアップ
                      	;out
                      	;	B  : FATセクタ数
                      	;	DE : FAT先頭セクタ番号
                      	;	HL : FATバッファポインタ
                      	;	CF : 1=ドライブ切り替えエラー
                      	;note
                      	;	FATサイズがFATバッファを超える場合は
                      	;	対象クラスタ領域==(_FATIX)によって
                      	;	FAT12:FATの前半3KBと後半3KBを切り替える
                      	;	FAT16:対象クラスタ1024毎に2KBを切り替える
                      	;------------------------
  E880                	FATSETUP:
  E880  3AAAEC        		LD	A,(_FATDRV)
  E883  CDAEE9        		CALL	CHGDRVR		;ドライブ切り替え
  E886  D8            		RET	C
  E887                	FATS2:
  E887  ED5BFAEB      		LD	DE,(_FATPS)	;fat sector pos
  E88B  C38EE8        	FATSX:	JP	FATSETUP12	;自己書き換え
                      	
  E88E                	FATSETUP12:
  E88E  2A7CEC        		LD	HL,(_FATBF)
  E891  3E18          		LD	A,24		;3072 / 256 FATバッファに読み込めるセクタ数
  E893  DD460F        		LD	B,(IX+00FH)	;DPB_0F_BPS
  E896                	L_FATS2:
  E896  1F            		RRA			;CF=0 なので A=A/2
  E897  CB18          		RR	B		;->CF
  E899  30FB          		JR	NC,L_FATS2
                      	
  E89B  DD4600        		LD	B,(IX+0)	;DPB_00_FATLN
  E89E  B8            		CP	B
  E89F  D0            		RET	NC		;DPB_00_FATLN x sectorSize < fatBufSize
                      	;targetCluster
  E8A0  4F            		LD	C,A		;C = skipCount
  E8A1  3AABEC        		LD	A,(_FATIX)	;(targetCluster >= 0x800)
  E8A4  B7            		OR	A
  E8A5  2806          		JR	Z,FATS3
                      	;(targerCluster>=0x800)
  E8A7                	FAT_SKP:
  E8A7  13            		INC	DE		;FATPS++
  E8A8  05            		DEC	B		;FATSIZE--
  E8A9  0D            		DEC	C		;skipCnt--
  E8AA  20FB          		JR	NZ,FAT_SKP
  E8AC  48            		LD	C,B
  E8AD                	FATS3:
  E8AD  41            		LD	B,C		;3 or 6 or 12
  E8AE  AF            		XOR	A
  E8AF  C9            		RET
                      	
  E8B0                	FATSETUP16:
  E8B0  DD7E0F        		LD	A,(IX+00FH)	;DPB_0F_BPS 512=2 1024=4
  E8B3  0610          		LD	B,16		;2048 / 256 FATバッファに読み込むセクタ数 512=4/1024=2
  E8B5  67            		LD	H,A		;DPB_0F_BPS
  E8B6                	L_F16S2:
  E8B6  CB38          		SRL	B		;/2
  E8B8  1F            		RRA			;->CF
  E8B9  30FB          		JR	NC,L_F16S2
                      	
  E8BB  7C            		LD	A,H		;DPB_0F_BPS
  E8BC  2AABEC        		LD	HL,(_FATIX)	;範囲は0-63(0-03FH):65535*2/2048
  E8BF  2600          		LD	H,0
  E8C1  4D            		LD	C,L		;_FATIX
  E8C2                	L_F16S3:
  E8C2  29            		ADD	HL,HL
  E8C3  87            		ADD	A,A
  E8C4  CB5F          		BIT	3,A
  E8C6  28FA          		JR	Z,L_F16S3
                      	
  E8C8  19            		ADD	HL,DE
  E8C9  EB            		EX	DE,HL
                      	
  E8CA  79            		LD	A,C		;_FATIX
  E8CB  DD6E00        		LD	L,(IX+0)	;DPB_00_FATLN
  E8CE  2D            		DEC	L		;DPB_00_FATLN-1
  E8CF  AD            		XOR	L		;Lと同じか比較してCFを0に
  E8D0  2005          		JR	NZ,F16E		;FATバッファが最後の場合はFATセクタ数を調整
  E8D2  7D            		LD	A,L		;DPB_00_FATLN-1
  E8D3  05            		DEC	B
  E8D4  A0            		AND	B
  E8D5  47            		LD	B,A
  E8D6  04            		INC	B
  E8D7                	F16E:
  E8D7  2A7CEC        		LD	HL,(_FATBF)
  E8DA  C9            		RET
                      	
  E8DB                	CHGDRV:
  E8DB  E5            		PUSH	HL
  E8DC  2189EC        		LD	HL,_DSK
  E8DF  BE            		CP	(HL)
  E8E0  280A          		JR	Z,CHGDRVE
  E8E2                	CHGDRV1:
  E8E2  DDE5          		PUSH	IX
  E8E4  CDEEE8        		CALL	CHGDRV0
  E8E7  3A89EC        		LD	A,(_DSK)
  E8EA  DDE1          		POP	IX
  E8EC                	CHGDRVE:
  E8EC  E1            		POP	HL
  E8ED  C9            		RET
                      	
  E8EE                	CHGDRV0:
  E8EE  6F            		LD	L,A
  E8EF  CDDCEC        		CALL	_GETDPB
  E8F2  D8            		RET	C
  E8F3  DD22A8EC      		LD	(_DPB),IX
  E8F7  7D            		LD	A,L
  E8F8  3289EC        		LD	(_DSK),A
  E8FB                	CHGDRV2:
  E8FB  F3            		DI
  E8FC  C5            		PUSH	BC
  E8FD  D5            		PUSH	DE
  E8FE  ED7363E9      		LD	(SPPAT2+1),SP
                      	
  E902  DDF9          		LD	SP,IX
                      	
  E904  E1            		POP	HL		;L=DPB_00_FATLN
  E905  E1            		POP	HL		;DPB_02_DRD
  E906  223EE8        		LD	(DRDPAT+1),HL
                      	
  E909  E1            		POP	HL
  E90A  225DE8        		LD	(DWTPAT+1),HL	;DPB_04_DWT
                      	
  E90D  E1            		POP	HL		;L=DPB_06_FATID H=DPB_07_SECPCL
  E90E  7C            		LD	A,H
  E90F  32FDE6        		LD	(SPCPAT+1),A	;1クラスタの論理セクタ数
  E912  3D            		DEC	A
  E913  32EFE6        		LD	(NCPAT+1),A
                      	
  E916  E1            		POP	HL		;DPB_08_MAXCL
  E917  7D            		LD	A,L
  E918  32CADF        		LD	(CLPAT2+1),A
  E91B  7C            		LD	A,H
  E91C  32C6DF        		LD	(CLPAT1+1),A
  E91F  2B            		DEC	HL
  E920  22D9E1        		LD	(MAXCLP+1),HL
                      	
  E923  E1            		POP	HL		;L=DPB_0A_FDMODE H=DPB_0B_DIRSCNT
  E924  7D            		LD	A,L
  E925  F6FE          		OR	0FEH
  E927  3268EA        		LD	(FDMODE+1),A
  E92A  07            		RLCA
  E92B  E603          		AND	3
  E92D  3250EA        		LD	(FSPAT+1),A
  E930  4C            		LD	C,H
                      	
  E931  E1            		POP	HL		;L=DPB_0C_MAXCYL H=DPB_0D_MAXSEC
  E932  7D            		LD	A,L
  E933  32A1EC        		LD	(_MAXCYL),A
  E936  7C            		LD	A,H
  E937  32F9E9        		LD	(MAXSEC+1),A
                      	
  E93A  E1            		POP	HL		;L=DPB_0E_FATPS H=DPB_0F_BPS
  E93B  7C            		LD	A,H		;DPB_0F_BPS
  E93C  E607          		AND	7
  E93E  320CE5        		LD	(SECSZ+2),A	;1セクタのサイズの上位1バイト 0x400 - 0x200 - 0x100
  E941  3D            		DEC	A		;1セクタ512 2D/2DD/2HC/2HQ(2HD1.44MB)等
                      					;1セクタ1024 2HD/EMM/BRAM
                      					;1セクタ256 GRAM等
                      					;1024	512	256
  E942  32EDDE        		LD	(SECSZM1+2),A	;3	1	0	1セクタのサイズ-1したものの上位1バイト (0x3FF - 0x1FF - 0xFF)
  E945  3C            		INC	A		;4	2	1
  E946  87            		ADD	A,A		;8	4	2
  E947  87            		ADD	A,A		;010H	8	4
  E948  87            		ADD	A,A		;020H	010H	8
  E949  3248DE        		LD	(SDECPAT+1),A	;1セクタ辺りのディレクトリエントリ数
  E94C  3D            		DEC	A		;01FH	00FH	7
  E94D  328ED4        		LD	(SDECM1+1),A	;1セクタ辺りのディレクトリエントリ数-1
                      	
  E950  2600          		LD	H,0
  E952  22FAEB        		LD	(_FATPS),HL
                      	
  E955  E1            		POP	HL		;L=DPB_10_DIRPS
  E956  22FCEB        		LD	(_DIRPS),HL
                      	
  E959  E1            		POP	HL		;L=DPB_12_DEVICE H=DPB_13_UNITNO
  E95A  7C            		LD	A,H
  E95B  3284EC        		LD	(_DRIVE),A
                      	
  E95E  E1            		POP	HL		;DPB_14_ADDCL16
  E95F  22BEDF        		LD	(CLSPAT+1),HL
                      	
  E962  310000        	SPPAT2:	LD	SP,0		;元のSPを復元
  E965  FB            		EI
  E966  2AFCEB        		LD	HL,(_DIRPS)
  E969  0600          		LD	B,0
  E96B  09            		ADD	HL,BC
  E96C  2263DE        		LD	(MD_PAT+1),HL
                      	
  E96F  2AD9E1        		LD	HL,(MAXCLP+1);
  E972  11F60F        		LD	DE,4086
  E975  B7            		OR	A
  E976  ED52          		SBC	HL,DE
  E978  300F          		JR	NC,SETFAT16
  E97A  2176E6        		LD	HL,GNCL		;FAT12
  E97D  1199E6        		LD	DE,SNCL
  E980  018EE8        		LD	BC,FATSETUP12
  E983  DDCB0FAE      		RES	5,(IX+00FH)	;DPB_0F_BPS(FAT12)
  E987  180D          		JR	EXTRA1
  E989                	SETFAT16:
  E989  21CDE6        		LD	HL,GNCL16	;FAT16
  E98C  11DAE6        		LD	DE,SNCL16
  E98F  01B0E8        		LD	BC,FATSETUP16
  E992  DDCB0FEE      		SET	5,(IX+00FH)	;DPB_0F_BPS(FAT16)
  E996                	EXTRA1:
  E996  22F8EC        		LD	(GNCPAT+1),HL
  E999  ED53FBEC      		LD	(SNCPAT+1),DE
  E99D  ED438CE8      		LD	(FATSX+1),BC
  E9A1  D1            		POP	DE
  E9A2  C1            		POP	BC
  E9A3  AF            		XOR	A
  E9A4  C9            		RET
                      	
  E9A5                	GETDPBD:
  E9A5  DDE3          		EX	(SP),IX
  E9A7  DDE5          		PUSH	IX
  E9A9  3A88EC        		LD	A,(_DRV)
  E9AC  1807          		JR	GETDPB1
                      	
  E9AE                	CHGDRVR:
  E9AE  CDD9EC        		CALL	_CHGDRV
  E9B1  D8            		RET	C
  E9B2  3A89EC        		LD	A,(_DSK)
  E9B5                	GETDPB1:
  E9B5  C3DCEC        		JP	_GETDPB
                      	
  E9B8                	GETDPB:
  E9B8  FE08          		CP	8
  E9BA  3F            		CCF
  E9BB  D8            		RET	C
  E9BC  0F            		RRCA
  E9BD  0F            		RRCA
  E9BE  0F            		RRCA
  E9BF  DD            		DB	0DDH		;Z80未定義命令
  E9C0  6F            		LD	L,A		;LD	IXL,A
  E9C1  DD            		DB	0DDH		;Z80未定義命令
  E9C2  26ED          		LD	H,DEVICE/256	;LD	IXH,DEVICE/256
  E9C4  DD7E00        		LD	A,(IX+0)	;DPB_00_FATLN
  E9C7  B7            		OR	A		;CF=0の為
  E9C8  DDCB0F76      		BIT	6,(IX+00FH)	;DPB_0F_BPS
  E9CC  C0            		RET	NZ		;FAT16
  E9CD  DDCB126E      		BIT	5,(IX+012H)	;DPB_12_DEVICE
  E9D1  C0            		RET	NZ		;BPB
  E9D2  FE01          		CP	001H		;A=0 THEN CF=1
  E9D4  C9            		RET
                      	
  E9D5                	FFLUSH:
  E9D5  F5            		PUSH	AF
  E9D6  3EFF          		LD	A,0FFH
  E9D8  329EE2        		LD	(SFILE),A
  E9DB  CDC2E5        		CALL	DWTX
  E9DE  3EFF          		LD	A,0FFH
  E9E0  32A5EC        		LD	(_DBDRV),A
  E9E3  CD0AE6        		CALL	WTFATX
  E9E6  AF            		XOR	A
  E9E7  32ABEC        		LD	(_FATIX),A
  E9EA  2F            		CPL
  E9EB  32AAEC        		LD	(_FATDRV),A
  E9EE  F1            		POP	AF
  E9EF  C9            		RET
                      	
                      	
                      	;LDDISK.ASM
                      	
                      	;	LSX-Dodgers DISK
                      	
                      	
  E9F0                	SEEK:
  E9F0  7A            		LD	A,D
  E9F1  B3            		OR	E
  E9F2  3E01          		LD	A,001H
  E9F4  2811          		JR	Z,DIV3
                      	
  E9F6  0610          		LD	B,16
  E9F8  0E00          	MAXSEC:	LD	C,000H
  E9FA  AF            		XOR	A
  E9FB  EB            		EX	DE,HL
  E9FC                	DIV1:
  E9FC  29            		ADD	HL,HL
  E9FD  8F            		ADC	A,A
  E9FE  B9            		CP	C
  E9FF  3802          		JR	C,DIV2
  EA01  91            		SUB	C
  EA02  2C            		INC	L
  EA03                	DIV2:
  EA03  10F7          		DJNZ	DIV1
                      	
  EA05  3C            		INC	A	;最小のセクタは１固定
  EA06  55            		LD	D,L	;Quotient(TRACK)
  EA07                	DIV3:
  EA07  5F            		LD	E,A	;Remainder
  EA08  CB3A          		SRL	D	;CYLINDER
  EA0A  9F            		SBC	A,A
  EA0B  E610          		AND	010H	;SIDE
  EA0D  4F            		LD	C,A
                      	
  EA0E  3A84EC        		LD	A,(_DRIVE)
  EA11  FE04          		CP	4
  EA13  3F            		CCF
  EA14  D8            		RET	C
  EA15  B1            		OR	C
  EA16  3294EA        		LD	(MOPAT+1),A	;Motor off data
  EA19  01FC0F        		LD	BC,00FFCH
  EA1C  F680          		OR	080H		;Mortor on
  EA1E  ED79          		OUT	(C),A
                      	
  EA20  CD66EA        		CALL	SETMODE
  EA23  D8            		RET	C
                      	
  EA24  CDA9EA        		CALL	DRIVE
  EA27  FEFF          		CP	0FFH		;A=0FFH Unknown CYLINDER
  EA29  CC88EA        		CALL	Z,FDCRES	;Restore
  EA2C  0EF9          		LD	C,0F9H
  EA2E  ED79          		OUT	(C),A		;Currrent CYLINDER
  EA30  92            		SUB	D
  EA31  C8            		RET	Z		;No seek
                      	
  EA32  3A86EC        		LD	A,(_ISEEK)
  EA35  4F            		LD	C,A
                      	
  EA36  3AA1EC        		LD	A,(_MAXCYL)	;Max CYLINDER
  EA39  3D            		DEC	A
  EA3A  BA            		CP	D		;Over CYLINDER
  EA3B  D8            		RET	C
                      	
  EA3C  B9            		CP	C		;for Built-in 2DD
  EA3D  3803          		JR	C,SETM2
  EA3F  78            		LD	A,B		;B=00FH
  EA40  DBFE          		IN	A,(0FEH)		;2HD mode for 2DD seek
  EA42                	SETM2:
  EA42  78            		LD	A,B
  EA43  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  EA45  0EFB          		LD	C,0FBH
  EA47  ED51          		OUT	(C),D
  EA49  72            		LD	(HL),D
  EA4A  0E18          		LD	C,018H		;Seek
  EA4C                	FDCCMD2:
  EA4C  3A85EC        		LD	A,(_SEEKSP)
  EA4F  E6FF          	FSPAT:	AND	0FFH
  EA51  B1            		OR	C
                      	
  EA52                	FDCCMD:
  EA52  CD9FEA        		CALL	COMSET
                      	
  EA55  3E80          	FDCPAT:	LD	A,080H		;FDC COMMAND(Self-rewriting)
  EA57  E620          		AND	020H		;Write data Write track
  EA59  3C            		INC	A
                      	
  EA5A                	SST:
  EA5A  0E00          		LD	C,0
  EA5C                	SST1:
  EA5C  0D            		DEC	C		; 4
  EA5D  20FD          		JR	NZ,SST1		;12 * 256 / 4 = About 1ms
  EA5F  3D            		DEC	A
  EA60  20FA          		JR	NZ,SST1
                      	
  EA62  3C            		INC	A		;A=1
  EA63  CD71EA        		CALL	READY
  EA66                	SETMODE:
  EA66  78            		LD	A,B		;B=00FH
  EA67  DBFF          	FDMODE:	IN	A,(0FFH)		;Floppy mode(2D/2HD) (Self-rewriting)
                      	
  EA69  78            		LD	A,B
  EA6A  DBFD          		IN	A,(0FDH)		;MFM mode
                      	
  EA6C  CDA3EA        		CALL	DELAY0		;Head select time
  EA6F  3E81          		LD	A,081H
  EA71                	READY:
  EA71  327BEA        		LD	(WAITA+1),A
  EA74  E5            		PUSH	HL
  EA75  0EF8          		LD	C,0F8H
  EA77  61            		LD	H,C
  EA78                	READY2:
  EA78  ED78          		IN	A,(C)
  EA7A  E681          	WAITA:	AND	081H		;NOT READY,BUSY
  EA7C  2808          		JR	Z,READYE
  EA7E  E3            		EX	(SP),HL		;wait 19clock
  EA7F  E3            		EX	(SP),HL		; //
  EA80  2B            		DEC	HL
  EA81  7C            		LD	A,H
  EA82  B5            		OR	L
  EA83  20F3          		JR	NZ,READY2
  EA85  37            		SCF
  EA86                	READYE:
  EA86  E1            		POP	HL
  EA87  C9            		RET
                      	
  EA88                	FDCRES:
  EA88  3600          		LD	(HL),0
  EA8A  0E08          		LD	C,8
  EA8C  18BE          		JR	FDCCMD2
                      	
  EA8E                	FDMOFF:
  EA8E  F5            		PUSH	AF
  EA8F  C5            		PUSH	BC
  EA90  01FC0F        		LD	BC,00FFCH	;Motor off
  EA93  3E00          	MOPAT:	LD	A,000H		;(Self-rewriting)
  EA95  ED79          		OUT	(C),A
  EA97  C1            		POP	BC
  EA98  F1            		POP	AF
  EA99  C9            		RET
                      	
  EA9A                	SECSET:
  EA9A  01FA0F        		LD	BC,00FFAH
  EA9D  ED59          		OUT	(C),E
  EA9F                	COMSET:
  EA9F  0EF8          		LD	C,0F8H
  EAA1  ED79          		OUT	(C),A
  EAA3                	DELAY0:
  EAA3  3E1A          		LD	A,26
  EAA5                	DELAY:
  EAA5  3D            		DEC	A
  EAA6  20FD          		JR	NZ,DELAY
  EAA8  C9            		RET
                      	
  EAA9                	DRIVE:
  EAA9  2A84EC        		LD	HL,(_DRIVE)
  EAAC  26EC          		LD	H,_CYL0/256
  EAAE  CBFD          		SET	7,L
  EAB0  7E            		LD	A,(HL)
  EAB1  C9            		RET
                      	
  EAB2                	RNF:
  EAB2  CDA9EA        		CALL	DRIVE
  EAB5  36FF          		LD	(HL),0FFH
  EAB7  C9            		RET
                      	
  EAB8  02            	RETRY:	DB	2
                      	
                      	
                      	;	FLOPPY DISK DRIVER(DMA)
                      	
                      	
  EAB9                	WTTRK:
  EAB9  3EF4          		LD	A,0F4H
  EABB  1802          		JR	WTTRK1
  EABD                	FDWT:
  EABD  3EA0          		LD	A,0A0H
  EABF                	WTTRK1:
  EABF  3256EA        		LD	(FDCPAT+1),A
  EAC2  3E10          		LD	A,16
  EAC4  1807          		JR	DISK
                      	
  EAC6                	FDRD:
  EAC6  3E80          		LD	A,080H
  EAC8  3256EA        		LD	(FDCPAT+1),A
  EACB  3E0E          		LD	A,14
                      	
  EACD                	DISK:
  EACD  32E0EA        		LD	(DMAPAT+1),A
                      	
  EAD0  226BEB        		LD	(DMAD+11),HL
  EAD3                	DISKR:
  EAD3  3E02          		LD	A,2		;Retry count
  EAD5  32B8EA        		LD	(RETRY),A
  EAD8                	DISK2:
  EAD8  D5            		PUSH	DE
  EAD9  CDF0E9        		CALL	SEEK
  EADC  3842          		JR	C,ERRF
  EADE  F3            		DI
                      	
  EADF  3E0E          	DMAPAT:	LD	A,14		;自己書き換え
  EAE1  2160EB        		LD	HL,DMAD
  EAE4  CD56EB        		CALL	SETDMA
  EAE7  ED49          		OUT	(C),C		;OUT 01F87H,087H
  EAE9  3A56EA        		LD	A,(FDCPAT+1)
  EAEC  C5            		PUSH	BC
  EAED  CD9AEA        		CALL	SECSET
  EAF0  2A6BEB        		LD	HL,(DMAD+11)
  EAF3  23            		INC	HL
  EAF4  1106BB        		LD	DE,0BB06H	;READ DMA
                      	
  EAF7  3E03          		LD	A,3
  EAF9  CD71EA        		CALL	READY
  EAFC  ED78          		IN	A,(C)
                      	
  EAFE  C1            		POP	BC
  EAFF  ED51          		OUT	(C),D
  EB01  ED59          		OUT	(C),E
  EB03  ED58          		IN	E,(C)
  EB05  ED50          		IN	D,(C)
  EB07  19            		ADD	HL,DE
  EB08  D1            		POP	DE
  EB09  13            		INC	DE
  EB0A  FB            		EI
  EB0B  CD8EEA        		CALL	FDMOFF
  EB0E  B7            		OR	A
  EB0F  C8            		RET	Z
  EB10  1B            		DEC	DE
  EB11  CB67          		BIT	4,A
  EB13  C4B2EA        		CALL	NZ,RNF
  EB16                	DISKE2:
  EB16  21B8EA        		LD	HL,RETRY
  EB19  35            		DEC	(HL)
  EB1A  20BC          		JR	NZ,DISK2
  EB1C  B7            		OR	A
  EB1D  2834          		JR	Z,ERR
  EB1F  D5            		PUSH	DE
  EB20                	ERRF:
  EB20  D1            		POP	DE
  EB21                	DELP:
  EB21  CDB2EA        		CALL	RNF
  EB24  CD8EEA        		CALL	FDMOFF
  EB27  3A85EC        		LD	A,(_SEEKSP)
  EB2A  87            		ADD	A,A
  EB2B  9F            		SBC	A,A
  EB2C  3825          		JR	C,ERR
  EB2E                	DELP1:
  EB2E  D5            		PUSH	DE
  EB2F  21C0EB        		LD	HL,DEMES
  EB32  CDA8D8        		CALL	MSX
  EB35  CD93D7        		CALL	KEYBC
  EB38                	DELP2:
  EB38  CDCAEC        		CALL	_INKEY
  EB3B  28FB          		JR	Z,DELP2
                      	
  EB3D  D1            		POP	DE
  EB3E  CDD5DF        		CALL	CAP
  EB41  FE52          		CP	'R'		;Retry
  EB43  CAD3EA        		JP	Z,DISKR
  EB46  FE49          		CP	'I'		;Ignore
  EB48  2807          		JR	Z,IGNORE
  EB4A  FE41          		CP	'A'		;Abort
  EB4C  20E0          		JR	NZ,DELP1
  EB4E  C39AD3        		JP	BOOT
  EB51                	IGNORE:
  EB51  3EFF          		LD	A,0FFH
  EB53                	ERR:
  EB53  BF            		CP	A
  EB54  37            		SCF
  EB55  C9            		RET
                      	
  EB56                	SETDMA:
  EB56  01871F        		LD	BC,01F87H
  EB59                	SDMA:
  EB59  04            		INC	B
  EB5A  EDA3          		OUTI
  EB5C  3D            		DEC	A
  EB5D  20FA          		JR	NZ,SDMA
  EB5F  C9            		RET
                      	
  EB60  C37DFB0FFFFF2C	DMAD:	DB	0C3H,07DH,0FBH,00FH,0FFH,0FFH,02CH,010H		;X1turbo
  EB68  80928D0000CF01		DB	080H,092H,08DH,000H,000H,0CFH,001H,0CFH		;DISK DMA
                      	
  EB70                	DMAE:
                      	
  1FFA                	AT_R	EQU	WTTRK-AT_WTTRK
                      	
                      	;LDCALL.ASM
                      	
                      	;	LSX-Dodgers TABLES
                      	
  EB70  008E01000B000C	BEEPD:	DB	0,08EH,1,0,00BH,0,00CH,010H
  EB78  073E08100D00FF		DB	007H,03EH,008H,010H,00DH,0,0FFH
                      	
  EB7F  00            	CHECK:	DB	0
                      	
                      	;	CTRLTB:アドレス下位1バイトが080Hになるように
                      	
  EB80                	CTRLTB:
  EB80  D7D972DA0FDA62		DW	PRINTE,CTRL01,CTRL02,CTRL03
  EB88  5CDB3ADA3BDBC2		DW	CTRL04,CTRL05,CTRL1A,CTRL07
  EB90  E3D900DA65DB78		DW	CTRL08,CTRL09,CTRL0A,CTRL0B
  EB98  38DB5EDA7ADBD7		DW	CTRL0C,CTRL0D,CTRL0E,PRINTE
  EBA0  D7D9D7D972DAD7		DW	PRINTE,PRINTE,CTRL01,PRINTE
  EBA8  D7D9D7D9D7D9D7		DW	PRINTE,PRINTE,PRINTE,PRINTE
  EBB0  D7D9D7D93BDB85		DW	PRINTE,PRINTE,CTRL1A,CTRL1B
  EBB8  FAD9E3D9EDD965		DW	CTRL1C,CTRL1D,CTRL1E,CTRL1F
                      	
  EBC0  0307          	DEMES:	DB	3,7
  EBC2  44657669636520		DB	"Device I/O Error",5,3
  EBD4  41626F72742052		DB	"Abort Retry Ignore?",5,3,0
                      	
  EBEA  1617          	SDDATA:	DB	22,23		;(FCB)ファイルを最後に変更した時刻
  EBEC  1415          		DB	20,21		;(FCB)ファイルを最後に変更した日付
  EBEE  1A1B          		DB	26,27		;(FCB)ファイルの先頭クラスタ
  EBF0  10111213      		DB	16,17,18,19	;(FCB)ファイルのサイズ(バイト単位)
  EBF4                	SDDATAE:
                      	
  EBF4                	SCDIR:	DS	2		;+14 +15
  EBF6                	SFBPS:	DS	2		;FBPS
  EBF8                	SFNDF:	DS	2		;FILEN DIRF
                      	
  EBFA  0000          	_FATPS:	DW	0
  EBFC  0000          	_DIRPS:	DW	0
  EBFE  0000          	_CLPS:	DW	0
                      	
  EC00                	_PE:
                      	
                      	;	LSX-Dodgers SYSTEM CALL
                      	;	STABLE:アドレス下位1バイトが0になるように
                      	
  EC00                	STABLE:
                      	;0
  EC00  0000C7D7D3D72E		DW	 00000H,_SYS01,_SYS02,_SYS03
  EC08  5ECCD0D3D8D7A3		DW	_SYS04,_SYS05,_SYS06,_SYS07
  EC10  E0D7D5D319D845		DW	_SYS08,_SYS09,_SYS0A,_SYS0B
  EC18  E4D3EAD3F9D30C		DW	_SYS0C,_SYS0D,_SYS0E,_SYS0F
                      	;1
  EC20  61D4AED40AD540		DW	_SYS10,_SYS11,_SYS12,_SYS13
  EC28  48D566D583D57B		DW	_SYS14,_SYS15,_SYS16,_SYS17
  EC30  E4D5E9D5EED5F4		DW	_SYS18,_SYS19,_SYS1A,_SYS1B
  EC38  D3D31AD6D3D31E		DW	_SYS1C,_SYS1D,_SYS1E,_SYS1F
                      	;2
  EC40  D3D3BAD5CFD525		DW	_SYS20,_SYS21,_SYS22,_SYS23
  EC48  44D6D0D3F8E21D		DW	_SYS24,_ERROR,_SYS26,_SYS27
  EC50  CFD54DD65BD8D0		DW	_SYS28,_SYS29,_SYS2A,_SYS2B
  EC58  8FD8D0D3D3D370		DW	_SYS2C,_SYS2D,_SYS2E,_SYS2F
                      	;3
  EC60  6AD6          		DW	_SYS30
                      	
                      	;LDWORK.ASM
                      	
                      	;	LSX-Dodgers WORK
                      	
  0004                	DDS	EQU	4
  EC62                	DDTB:
  EC62  434F4E20      		DB	"CON "
  EC66  A1D4          		DW	OPENDD
  EC68  41555820      		DB	"AUX "
  EC6C  A1D4          		DW	OPENDD
  EC6E  50524E20      		DB	"PRN "
  EC72  A1D4          		DW	OPENDD
  EC74  4E554C20      		DB	"NUL "
  EC78  A1D4          		DW	OPENDD
                      	
  EC7A                		DS	2
  EC7C  00EE          	_FATBF:	DW	FATBF
  EC7E  00FA          	_DTBUF:	DW	DTBUF
                      	
                      	;	_CYL0:アドレス下位1バイトが080Hになるように
  EC80  FF            	_CYL0:	DB	0FFH	;Cylinder
  EC81  FF            	_CYL1:	DB	0FFH	;Cylinder
  EC82  FF            	_CYL2:	DB	0FFH	;Cylinder
  EC83  FF            	_CYL3:	DB	0FFH	;Cylinder
  EC84  00            	_DRIVE:	DB	0	;unit number
  EC85  00            	_SEEKSP:DB	0	;Seek speed
  EC86  FF            	_ISEEK:	DB	0FFH	;
  EC87  00            	_DVSW:	DB	0
  EC88  00            	_DRV:	DB	0
  EC89  FF            	_DSK:	DB	0FFH
  EC8A  8000          	_DTA:	DW	00080H
  EC8C  0000          	_CTC:	DW	0
  EC8E  0000          	_TXADR:	DW	0
  EC90  0000          	_KEYPS	DW	0
  EC92  00FF          	_KEYD	DW	0FF00H
  EC94  C210          	_KEYSP:	DW	010C2H
  EC96  07            	_COLORF:DB	7
  EC97  19            	_LINE:	DB	LINE
                      	
  EC98  0000          	_FCB:	DW	0
  EC9A  0000          	_FBPS:	DW	0	;SEARCH FILES
  EC9C  0000          	_FBAD:	DW	0	;    //
  EC9E  00            	_FBCNT:	DB	0	;    //
  EC9F  00            	_FILEN:	DB	0
  ECA0  00            	_DIRF:	DB	0
  ECA1  00            	_MAXCYL:DB	0
  ECA2  00            	_WTFATF:DB	0	;FATバッファの更新フラグ
  ECA3                			DS	1
  ECA4  00            	_WTDBF:	DB	0	;データバッファの更新フラグ
  ECA5  FF            	_DBDRV:	DB	0FFH	;データバッファにあるデータを読み込んだドライブ
  ECA6  0000          	_DBSEC:	DW	0	;データバッファにあるデータを読み込んだセクタ番号
  ECA8  0000          	_DPB:	DW	0
  ECAA  FF            	_FATDRV:DB	0FFH	;FATバッファに読み込んでいるドライブ
  ECAB  00            	_FATIX:	DB	0	;FATバッファに読み込んでいるインデックス
                      	
  ECAC                		DS	4
                      	
  ECB0  6F5059381F0219	CRTCD:	DB	06FH,050H,059H,038H,01FH,002H,019H,01CH
  ECB8  0007          		DB	000H,007H
  ECBA  30F8B0FF      		DW	0-80*LINE,0-80
  ECBE  0C            		DB	00CH
  ECBF  A0            	WK1FD0:	DB	0A0H
                      	
  ECC0  D2D6          	CTC0:	DW	INTCTCE
  ECC2  D2D6          	CTC1:	DW	INTCTCE
  ECC4  1FD7          	CTC2:	DW	INTCTC2
  ECC6  D2D6          	CTC3:	DW	INTCTCE
  ECC8  B9D6          	INTVEC:	DW	INT
                      	
                      	;	JUMP
                      	
  ECCA  C3B3DC        	_INKEY:	JP	INKEY
  ECCD  C320D9        	_PRINT:	JP	PRINT
  ECD0  C3FEDB        	_SCRN:	JP	SCRN
  ECD3  C326DC        	_POS:	JP	POS
  ECD6  C363DA        	_LOC:	JP	LOC
  ECD9  C3DBE8        	_CHGDRV:JP	CHGDRV
  ECDC  C3B8E9        	_GETDPB:JP	GETDPB
  ECDF  C3D5E9        	_FFLUSH:JP	FFLUSH
  ECE2  C3E0E5        	_RDFATX:JP	RDFATX
  ECE5  C314E7        	_RDFAT:	JP	RDFAT
  ECE8  C3B9EA        	_WTTRK:	JP	WTTRK
  ECEB  C3C6EA        	_FDRD:	JP	FDRD
  ECEE  C3BDEA        	_FDWT:	JP	FDWT
  ECF1  C335E8        	_DRD:	JP	DRD16
  ECF4  C354E8        	_DWT:	JP	DWT16
  ECF7                	_GNCL:
  ECF7  C376E6        	GNCPAT:	JP	GNCL		;自己書き換え
  ECFA                	_SNCL:
  ECFA  C399E6        	SNCPAT:	JP	SNCL		;自己書き換え
  ECFD  C38BCE        	_COMANL:JP	COMANL
                      	
  ED00                	WE:
                      	
                      	;LDDPB.ASM
                      	
                      	;	LSX-Dodgers DPB
                      	
  ED00                	DEVICE:
                      	
                      	;	A:
                      	
  ED00  0200          		DW	2	;DPB_00_FATLN
  ED02  EBEC          		DW	_FDRD	;DPB_02_DRD
  ED04  EEEC          		DW	_FDWT	;DPB_04_DWT
  ED06  FD            		DB	0FDH	;DPB_06_FATID
  ED07  02            		DB	2	;DPB_07_SECPCL
  ED08  6401          		DW	356	;DPB_08_MAXCL
  ED0A  FF            		DB	0FFH	;DPB_0A_FDMODE	0FFH=2D / 0FEH=2HD
  ED0B  07            		DB	7	;DPB_0B_DIRSCNT
  ED0C  28            		DB	40	;DPB_0C_MAXCYL
  ED0D  09            		DB	9	;DPB_0D_MAXSEC	Number of sectors
  ED0E  01            		DB	1	;DPB_0E_FATPS
  ED0F  82            		DB	082H	;DPB_0F_BPS
  ED10  0500          		DW	5	;DPB_10_DIRPS
  ED12  A7            		DB	0A7H	;DPB_12_DEVICE	Device Number
  ED13  00            		DB	0	;DPB_13_UNITNO
  ED14  0800          		DW	8	;DPB_14_ADDCL16
  ED16  0000          		DW	0	;DPB_16
  ED18  0000          		DW	0	;DPB_18
  ED1A  0000          		DW	0	;DPB_1A_SDIR
  ED1C  46444430      		DB	"FDD0"	;DPB_1C_NAME
                      	
                      	;	B:
                      	
  ED20  0200          		DW	2	;DPB_00_FATLN
  ED22  EBEC          		DW	_FDRD	;DPB_02_DRD
  ED24  EEEC          		DW	_FDWT	;DPB_04_DWT
  ED26  FD            		DB	0FDH	;DPB_06_FATID
  ED27  02            		DB	2	;DPB_07_SECPCL
  ED28  6401          		DW	356	;DPB_08_MAXCL
  ED2A  FF            		DB	0FFH	;DPB_0A_FDMODE	0FFH=2D / 0FEH=2HD
  ED2B  07            		DB	7	;DPB_0B_DIRSCNT
  ED2C  28            		DB	40	;DPB_0C_MAXCYL
  ED2D  09            		DB	9	;DPB_0D_MAXSEC	Number of sectors
  ED2E  01            		DB	1	;DPB_0E_FATPS
  ED2F  82            		DB	082H	;DPB_0F_BPS
  ED30  0500          		DW	5	;DPB_10_DIRPS
  ED32  A7            		DB	0A7H	;DPB_12_DEVICE	Device Number
  ED33  01            		DB	1	;DPB_13_UNITNO
  ED34  0800          		DW	8	;DPB_14_ADDCL16
  ED36  0000          		DW	0	;DPB_16
  ED38  0000          		DW	0	;DPB_18
  ED3A  0000          		DW	0	;DPB_1A_SDIR
  ED3C  46444431      		DB	"FDD1"	;DPB_1C_NAME
                      	
                      	;	C:
                      	
  ED40  0200          		DW	2	;DPB_00_FATLN
  ED42  EBEC          		DW	_FDRD	;DPB_02_DRD
  ED44  EEEC          		DW	_FDWT	;DPB_04_DWT
  ED46  FD            		DB	0FDH	;DPB_06_FATID
  ED47  02            		DB	2	;DPB_07_SECPCL
  ED48  6401          		DW	356	;DPB_08_MAXCL
  ED4A  FF            		DB	0FFH	;DPB_0A_FDMODE	0FFH=2D / 0FEH=2HD
  ED4B  07            		DB	7	;DPB_0B_DIRSCNT
  ED4C  28            		DB	40	;DPB_0C_MAXCYL
  ED4D  09            		DB	9	;DPB_0D_MAXSEC	Number of sectors
  ED4E  01            		DB	1	;DPB_0E_FATPS
  ED4F  82            		DB	082H	;DPB_0F_BPS
  ED50  0500          		DW	5	;DPB_10_DIRPS
  ED52  A7            		DB	0A7H	;DPB_12_DEVICE	Device Number
  ED53  02            		DB	2	;DPB_13_UNITNO
  ED54  0800          		DW	8	;DPB_14_ADDCL16
  ED56  0000          		DW	0	;DPB_16
  ED58  0000          		DW	0	;DPB_18
  ED5A  0000          		DW	0	;DPB_1A_SDIR
  ED5C  46444432      		DB	"FDD2"	;DPB_1C_NAME
                      	
                      	;	D:
                      	
  ED60  0200          		DW	2	;DPB_00_FATLN
  ED62  EBEC          		DW	_FDRD	;DPB_02_DRD
  ED64  EEEC          		DW	_FDWT	;DPB_04_DWT
  ED66  FD            		DB	0FDH	;DPB_06_FATID
  ED67  02            		DB	2	;DPB_07_SECPCL
  ED68  6401          		DW	356	;DPB_08_MAXCL
  ED6A  FF            		DB	0FFH	;DPB_0A_FDMODE	0FFH=2D / 0FEH=2HD
  ED6B  07            		DB	7	;DPB_0B_DIRSCNT
  ED6C  28            		DB	40	;DPB_0C_MAXCYL
  ED6D  09            		DB	9	;DPB_0D_MAXSEC	Number of sectors
  ED6E  01            		DB	1	;DPB_0E_FATPS
  ED6F  82            		DB	082H	;DPB_0F_BPS
  ED70  0500          		DW	5	;DPB_10_DIRPS
  ED72  A7            		DB	0A7H	;DPB_12_DEVICE
  ED73  03            		DB	3	;DPB_13_UNITNO
  ED74  0800          		DW	8	;DPB_14_ADDCL16
  ED76  0000          		DW	0	;DPB_16
  ED78  0000          		DW	0	;DPB_18
  ED7A  0000          		DW	0	;DPB_1A_SDIR
  ED7C  46444433      		DB	"FDD3"	;DPB_1C_NAME
                      	
                      	;	E:
                      	
  ED80  0000          	EMMFL:	DW	0	;DPB_00_FATLN
  ED82  29CD          	EMMRD:	DW	EDRDC	;DPB_02_DRD
  ED84  26CD          	EMMWR:	DW	EDWTC	;DPB_04_DWT
  ED86  FE            		DB	0FEH	;DPB_06_FATID
  ED87  01            		DB	1	;DPB_07_SECPCL
  ED88  0000          	EMMCL:	DW	0	;DPB_08_MAXCL
  ED8A  00            		DB	0	;DPB_0A_FDMODE
  ED8B  06            		DB	6	;DPB_0B_DIRSCNT
  ED8C  00            	EMMBL:	DB	0	;DPB_0C_MAXCYL
  ED8D  01            		DB	1	;DPB_0D_MAXSEC
  ED8E  01            		DB	1	;DPB_0E_FATPS
  ED8F  04            		DB	4	;DPB_0F_BPS
  ED90  0500          		DW	5	;DPB_10_DIRPS
  ED92  06            		DB	6	;DPB_12_DEVICE
  ED93  00            	EMMDV:	DB	0	;DPB_13_UNITNO
  ED94  0900          		DW	9	;DPB_14_ADDCL16
  ED96  0000          		DW	0	;DPB_16
  ED98  0000          		DW	0	;DPB_18
  ED9A  0000          		DW	0	;DPB_1A_SDIR
  ED9C  454D4D30      		DB	"EMM0"	;DPB_1C_NAME
                      	
                      	;	F:
                      	
  EDA0  0000          	BANKFL:	DW	0	;DPB_00_FATLN
  EDA2  A4CC          		DW	BDRDC	;DPB_02_DRD
  EDA4  C7CC          		DW	BDWTC	;DPB_04_DWT
  EDA6  F9            		DB	0F9H	;DPB_06_FATID
  EDA7  01            		DB	1	;DPB_07_SECPCL
  EDA8  0000          	BANKCL:	DW	0	;DPB_08_MAXCL
  EDAA  00            		DB	0	;DPB_0A_FDMODE
  EDAB  04            		DB	4	;DPB_0B_DIRSCNT
  EDAC  00            		DB	0	;DPB_0C_MAXCYL
  EDAD  01            		DB	1	;DPB_0D_MAXSEC
  EDAE  00            		DB	0	;DPB_0E_FATPS
  EDAF  04            		DB	4	;DPB_0F_BPS
  EDB0  0100          		DW	1	;DPB_10_DIRPS
  EDB2  0B            		DB	00BH	;DPB_12_DEVICE
  EDB3  00            		DB	0	;DPB_13_UNITNO
  EDB4  0300          		DW	3	;DPB_14_ADDCL16
  EDB6  0000          		DW	0	;DPB_16
  EDB8  0000          		DW	0	;DPB_18
  EDBA  0000          		DW	0	;DPB_1A_SDIR
  EDBC  4252414D      		DB	"BRAM"	;DPB_1C_NAME
                      	
                      	;	G:
                      	
  EDC0  0100          		DW	1	;DPB_00_FATLN
  EDC2  75CC          		DW	GDRD	;DPB_02_DRD
  EDC4  80CC          		DW	GDWT	;DPB_04_DWT
  EDC6  F9            		DB	0F9H	;DPB_06_FATID
  EDC7  04            		DB	4	;DPB_07_SECPCL
  EDC8  3000          		DW	48	;DPB_08_MAXCL
  EDCA  00            		DB	0	;DPB_0A_FDMODE
  EDCB  04            		DB	4	;DPB_0B_DIRSCNT
  EDCC  00            		DB	0	;DPB_0C_MAXCYL
  EDCD  01            		DB	1	;DPB_0D_MAXSEC
  EDCE  00            		DB	0	;DPB_0E_FATPS
  EDCF  01            		DB	1	;DPB_0F_BPS
  EDD0  0400          		DW	4	;DPB_10_DIRPS
  EDD2  05            		DB	5	;DPB_12_DEVICE
  EDD3  01            		DB	1	;DPB_13_UNITNO
  EDD4  0000          		DW	0	;DPB_14_ADDCL16
  EDD6  0000          		DW	0	;DPB_16
  EDD8  0000          		DW	0	;DPB_18
  EDDA  0000          		DW	0	;DPB_1A_SDIR
  EDDC  4752414D      		DB	"GRAM"	;DPB_1C_NAME
                      	
                      	
                      	
  EDE0  00            	LDEND:	DB	0
                      	
  EDE1                		END
